//     Underscore.js 1.4.4
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

/*! jQuery v1.9.1 | (c) 2005, 2012 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery.min.map
*/

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*
 * jPicker 1.1.6
 *
 * jQuery Plugin for Photoshop style color picker
 *
 * Copyright (c) 2010 Christopher T. Tillman
 * Digital Magic Productions, Inc. (http://www.digitalmagicpro.com/)
 * MIT style license, FREE to use, alter, copy, sell, and especially ENHANCE
 *
 * Painstakingly ported from John Dyers' excellent work on his own color picker based on the Prototype framework.
 *
 * John Dyers' website: (http://johndyer.name)
 * Color Picker page:   (http://johndyer.name/post/2007/09/PhotoShop-like-JavaScript-Color-Picker.aspx)
 *
 *
 * MODIFICATIONS:
 *
 * @date: 2013-05-03
 * @author: Alistair Brown <alistair.brown@typecast.com>
 * @notes: Converts mouse movement for the colour bar to be be read as horizontal.
 *     In addition, a new image is used (and specified through the init settings).
 * @location: line 94 - line 100 (also lines 59, 72 and 87)
 *
 * @date: 2013-05-07
 * @author: Alistair Brown <alistair.brown@typecast.com>
 * @notes: Removal of global variable leak of variable 'i' by prefixing 'var'.
 * @location: line 1792 and line 1873
 *
 */

/**
 * Castor - a cross site POSTing JavaScript logging library for Loggly
 * 
 * Copyright (c) 2011 Loggly, Inc.
 * All rights reserved.
 *
 * Author: Mike Blume <mike@loggly.com>
 * Date: April 14, 2012
 * 
 * Sample usage (replace with your own Loggly HTTP input URL):

  <script src="/js/loggly.js" type="text/javascript"></script>
  <script type="text/javascript">
    window.onload=function(){
      // use http or https depending on your page context
      castor = new loggly.castor({ url: 'http://logs.loggly.com/inputs/a4e839e9-4227-49aa-9d28-e18e5ba5a818', level: 'WARN'});
      castor.log({url: window.location.href});
    }
  </script>

 */

/*

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/

//     Underscore.js 1.3.3
//     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore is freely distributable under the MIT license.
//     Portions of Underscore are inspired or borrowed from Prototype,
//     Oliver Steele's Functional, and John Resig's Micro-Templating.
//     For all details and documentation:
//     http://documentcloud.github.com/underscore

/**
 * @license Handlebars hbs 0.4.0 - Alex Sexton, but Handlebars has it's own licensing junk
 *
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/require-cs for details on the plugin this was based off of
 */

// Chosen, a Select Box Enhancer for jQuery and Prototype
// by Patrick Filler for Harvest, http://getharvest.com
//
// Version 1.0.0
// Full source at https://github.com/harvesthq/chosen
// Copyright (c) 2011 Harvest http://getharvest.com

/*
html5slider - a JS implementation of <input type=range> for Firefox 16 and up
https://github.com/fryn/html5slider

Copyright (c) 2010-2012 Frank Yan, <http://frankyan.com>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

/*! jQuery UI - v1.10.3 - 2013-05-12
* http://jqueryui.com
* Includes: jquery.ui.position.js
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */

/*! sprintf.js | Copyright (c) 2007-2013 Alexandru Marasteanu <hello at alexei dot ro> | 3 clause BSD license */

/*!
	Colorbox v1.4.26 - 2013-06-30
	jQuery lightbox and modal window plugin
	(c) 2013 Jack Moore - http://www.jacklmoore.com/colorbox
	license: http://www.opensource.org/licenses/mit-license.php
*/

/*
 *  Based on code from:
 *
 * XRegExp 1.5.0
 * (c) 2007-2010 Steven Levithan
 * MIT License
 * <http://xregexp.com>
 * Provides an augmented, extensible, cross-browser implementation of regular expressions,
 * including support for additional syntax, flags, and methods
 */

// https://github.com/kriskowal/es5-shim
// Copyright 2009-2012 by contributors, MIT License

// vim:set ts=4 sts=4 sw=4 st:
// -- kriskowal Kris Kowal Copyright (C) 2009-2010 MIT License
// -- tlrobinson Tom Robinson Copyright (C) 2009-2010 MIT License (Narwhal Project)
// -- dantman Daniel Friesen Copyright(C) 2010 XXX No License Specified
// -- fschaefer Florian Sch√§fer Copyright (C) 2010 MIT License
// -- Irakli Gozalishvili Copyright (C) 2010 MIT License

/*!
    Copyright (c) 2009, 280 North Inc. http://280north.com/
    MIT License. http://github.com/280north/narwhal/blob/master/README.md
*/

/* ***** BEGIN LICENSE BLOCK *****
 * Distributed under the BSD license:
 *
 * Copyright (c) 2010, Ajax.org B.V.
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Ajax.org B.V. nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * ***** END LICENSE BLOCK ***** */

/*! @license
==========================================================================
SproutCore -- JavaScript Application Framework
copyright 2006-2009, Sprout Systems Inc., Apple Inc. and contributors.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the "Software"),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.

SproutCore and the SproutCore logo are trademarks of Sprout Systems, Inc.

For more information about SproutCore, visit http://www.sproutcore.com


==========================================================================
@license */

/* ***** BEGIN LICENSE BLOCK *****
 * Distributed under the BSD license:
 *
 * Copyright (c) 2010, Ajax.org B.V.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Ajax.org B.V. nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * ***** END LICENSE BLOCK ***** */

/*
 * based on code from:
 *
 * @license RequireJS text 0.25.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*
XRegExp Unicode plugin pack: Categories 1.0
(c) 2010 Steven Levithan
MIT License
<http://xregexp.com>
Uses the Unicode 5.2 character database

This package for the XRegExp Unicode plugin enables the following Unicode categories (aka properties):

L - Letter (the top-level Letter category is included in the Unicode plugin base script)
    Ll - Lowercase letter
    Lu - Uppercase letter
    Lt - Titlecase letter
    Lm - Modifier letter
    Lo - Letter without case
M - Mark
    Mn - Non-spacing mark
    Mc - Spacing combining mark
    Me - Enclosing mark
N - Number
    Nd - Decimal digit
    Nl - Letter number
    No -  Other number
P - Punctuation
    Pd - Dash punctuation
    Ps - Open punctuation
    Pe - Close punctuation
    Pi - Initial punctuation
    Pf - Final punctuation
    Pc - Connector punctuation
    Po - Other punctuation
S - Symbol
    Sm - Math symbol
    Sc - Currency symbol
    Sk - Modifier symbol
    So - Other symbol
Z - Separator
    Zs - Space separator
    Zl - Line separator
    Zp - Paragraph separator
C - Other
    Cc - Control
    Cf - Format
    Co - Private use
    Cs - Surrogate
    Cn - Unassigned

Example usage:

    \p{N}
    \p{Cn}
*/

/*
  html2canvas 0.4.0 <http://html2canvas.hertzen.com>
  Copyright (c) 2013 Niklas von Hertzen (@niklasvh)

  Released under MIT License
*/

/*
 * Derived from jQuery.contents()
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */

!function(){(function(){var e=this,t=e._,i={},n=Array.prototype,s=Object.prototype,r=Function.prototype,o=n.push,a=n.slice,l=n.concat,c=s.toString,u=s.hasOwnProperty,h=n.forEach,d=n.map,p=n.reduce,f=n.reduceRight,g=n.filter,m=n.every,v=n.some,y=n.indexOf,_=n.lastIndexOf,b=Array.isArray,w=Object.keys,C=r.bind,x=function(e){return e instanceof x?e:this instanceof x?void(this._wrapped=e):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.4.4";var E=x.each=x.forEach=function(e,t,n){if(null!=e)if(h&&e.forEach===h)e.forEach(t,n);else if(e.length===+e.length){for(var s=0,r=e.length;r>s;s++)if(t.call(n,e[s],s,e)===i)return}else for(var o in e)if(x.has(e,o)&&t.call(n,e[o],o,e)===i)return};x.map=x.collect=function(e,t,i){var n=[];return null==e?n:d&&e.map===d?e.map(t,i):(E(e,function(e,s,r){n[n.length]=t.call(i,e,s,r)}),n)};var S="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=x.bind(t,n)),s?e.reduce(t,i):e.reduce(t);if(E(e,function(e,r,o){s?i=t.call(n,i,e,r,o):(i=e,s=!0)}),!s)throw new TypeError(S);return i},x.reduceRight=x.foldr=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=x.bind(t,n)),s?e.reduceRight(t,i):e.reduceRight(t);var r=e.length;if(r!==+r){var o=x.keys(e);r=o.length}if(E(e,function(a,l,c){l=o?o[--r]:--r,s?i=t.call(n,i,e[l],l,c):(i=e[l],s=!0)}),!s)throw new TypeError(S);return i},x.find=x.detect=function(e,t,i){var n;return A(e,function(e,s,r){return t.call(i,e,s,r)?(n=e,!0):void 0}),n},x.filter=x.select=function(e,t,i){var n=[];return null==e?n:g&&e.filter===g?e.filter(t,i):(E(e,function(e,s,r){t.call(i,e,s,r)&&(n[n.length]=e)}),n)},x.reject=function(e,t,i){return x.filter(e,function(e,n,s){return!t.call(i,e,n,s)},i)},x.every=x.all=function(e,t,n){t||(t=x.identity);var s=!0;return null==e?s:m&&e.every===m?e.every(t,n):(E(e,function(e,r,o){return(s=s&&t.call(n,e,r,o))?void 0:i}),!!s)};var A=x.some=x.any=function(e,t,n){t||(t=x.identity);var s=!1;return null==e?s:v&&e.some===v?e.some(t,n):(E(e,function(e,r,o){return s||(s=t.call(n,e,r,o))?i:void 0}),!!s)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):A(e,function(e){return e===t})},x.invoke=function(e,t){var i=a.call(arguments,2),n=x.isFunction(t);return x.map(e,function(e){return(n?t:e[t]).apply(e,i)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,i){return x.isEmpty(t)?i?null:[]:x[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-(1/0);var n={computed:-(1/0),value:-(1/0)};return E(e,function(e,s,r){var o=t?t.call(i,e,s,r):e;o>=n.computed&&(n={value:e,computed:o})}),n.value},x.min=function(e,t,i){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var n={computed:1/0,value:1/0};return E(e,function(e,s,r){var o=t?t.call(i,e,s,r):e;o<n.computed&&(n={value:e,computed:o})}),n.value},x.shuffle=function(e){var t,i=0,n=[];return E(e,function(e){t=x.random(i++),n[i-1]=n[t],n[t]=e}),n};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,i){var n=k(t);return x.pluck(x.map(e,function(e,t,s){return{value:e,index:t,criteria:n.call(i,e,t,s)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index<t.index?-1:1}),"value")};var F=function(e,t,i,n){var s={},r=k(t||x.identity);return E(e,function(t,o){var a=r.call(i,t,o,e);n(s,a,t)}),s};x.groupBy=function(e,t,i){return F(e,t,i,function(e,t,i){(x.has(e,t)?e[t]:e[t]=[]).push(i)})},x.countBy=function(e,t,i){return F(e,t,i,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,i,n){i=null==i?x.identity:k(i);for(var s=i.call(n,t),r=0,o=e.length;o>r;){var a=r+o>>>1;i.call(n,e[a])<s?r=a+1:o=a}return r},x.toArray=function(e){return e?x.isArray(e)?a.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,i){return null!=e?null==t||i?e[0]:a.call(e,0,t):void 0},x.initial=function(e,t,i){return a.call(e,0,e.length-(null==t||i?1:t))},x.last=function(e,t,i){return null!=e?null==t||i?e[e.length-1]:a.call(e,Math.max(e.length-t,0)):void 0},x.rest=x.tail=x.drop=function(e,t,i){return a.call(e,null==t||i?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var D=function(e,t,i){return E(e,function(e){x.isArray(e)?t?o.apply(i,e):D(e,t,i):i.push(e)}),i};x.flatten=function(e,t){return D(e,t,[])},x.without=function(e){return x.difference(e,a.call(arguments,1))},x.uniq=x.unique=function(e,t,i,n){x.isFunction(t)&&(n=i,i=t,t=!1);var s=i?x.map(e,i,n):e,r=[],o=[];return E(s,function(i,n){(t?n&&o[o.length-1]===i:x.contains(o,i))||(o.push(i),r.push(e[n]))}),r},x.union=function(){return x.uniq(l.apply(n,arguments))},x.intersection=function(e){var t=a.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=l.apply(n,a.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=a.call(arguments),t=x.max(x.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=x.pluck(e,""+n);return i},x.object=function(e,t){if(null==e)return{};for(var i={},n=0,s=e.length;s>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},x.indexOf=function(e,t,i){if(null==e)return-1;var n=0,s=e.length;if(i){if("number"!=typeof i)return n=x.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,s+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;s>n;n++)if(e[n]===t)return n;return-1},x.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(_&&e.lastIndexOf===_)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var s=n?i:e.length;s--;)if(e[s]===t)return s;return-1},x.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=0,r=new Array(n);n>s;)r[s++]=e,e+=i;return r},x.bind=function(e,t){if(e.bind===C&&C)return C.apply(e,a.call(arguments,1));var i=a.call(arguments,2);return function(){return e.apply(t,i.concat(a.call(arguments)))}},x.partial=function(e){var t=a.call(arguments,1);return function(){return e.apply(this,t.concat(a.call(arguments)))}},x.bindAll=function(e){var t=a.call(arguments,1);return 0===t.length&&(t=x.functions(e)),E(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var i={};return t||(t=x.identity),function(){var n=t.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},x.delay=function(e,t){var i=a.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(a.call(arguments,1)))},x.throttle=function(e,t){var i,n,s,r,o=0,a=function(){o=new Date,s=null,r=e.apply(i,n)};return function(){var l=new Date,c=t-(l-o);return i=this,n=arguments,0>=c?(clearTimeout(s),s=null,o=l,r=e.apply(i,n)):s||(s=setTimeout(a,c)),r}},x.debounce=function(e,t,i){var n,s;return function(){var r=this,o=arguments,a=function(){n=null,i||(s=e.apply(r,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(a,t),l&&(s=e.apply(r,o)),s}},x.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var i=[e];return o.apply(i,arguments),t.apply(this,i)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},x.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)x.has(e,i)&&(t[t.length]=i);return t},x.values=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push(e[i]);return t},x.pairs=function(e){var t=[];for(var i in e)x.has(e,i)&&t.push([i,e[i]]);return t},x.invert=function(e){var t={};for(var i in e)x.has(e,i)&&(t[e[i]]=i);return t},x.functions=x.methods=function(e){var t=[];for(var i in e)x.isFunction(e[i])&&t.push(i);return t.sort()},x.extend=function(e){return E(a.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},x.pick=function(e){var t={},i=l.apply(n,a.call(arguments,1));return E(i,function(i){i in e&&(t[i]=e[i])}),t},x.omit=function(e){var t={},i=l.apply(n,a.call(arguments,1));for(var s in e)x.contains(i,s)||(t[s]=e[s]);return t},x.defaults=function(e){return E(a.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var T=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var s=c.call(e);if(s!=c.call(t))return!1;switch(s){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var r=i.length;r--;)if(i[r]==e)return n[r]==t;i.push(e),n.push(t);var o=0,a=!0;if("[object Array]"==s){if(o=e.length,a=o==t.length)for(;o--&&(a=T(e[o],t[o],i,n)););}else{var l=e.constructor,u=t.constructor;if(l!==u&&!(x.isFunction(l)&&l instanceof l&&x.isFunction(u)&&u instanceof u))return!1;for(var h in e)if(x.has(e,h)&&(o++,!(a=x.has(t,h)&&T(e[h],t[h],i,n))))break;if(a){for(h in t)if(x.has(t,h)&&!o--)break;a=!o}}return i.pop(),n.pop(),a};x.isEqual=function(e,t){return T(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!(!e||1!==e.nodeType)},x.isArray=b||function(e){return"[object Array]"==c.call(e)},x.isObject=function(e){return e===Object(e)},E(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return c.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!(!e||!x.has(e,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return u.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,i){for(var n=Array(e),s=0;e>s;s++)n[s]=t.call(i,s);return n},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var $={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};$.unescape=x.invert($.escape);var B={escape:new RegExp("["+x.keys($.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys($.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(B[e],function(t){return $[e][t]})}}),x.result=function(e,t){if(null==e)return null;var i=e[t];return x.isFunction(i)?i.call(e):i},x.mixin=function(e){E(x.functions(e),function(t){var i=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),P.call(this,i.apply(x,e))}})};var j=0;x.uniqueId=function(e){var t=++j+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var M=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},I=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,i){var n;i=x.defaults({},i,x.templateSettings);var s=new RegExp([(i.escape||M).source,(i.interpolate||M).source,(i.evaluate||M).source].join("|")+"|$","g"),r=0,o="__p+='";e.replace(s,function(t,i,n,s,a){return o+=e.slice(r,a).replace(I,function(e){return"\\"+L[e]}),i&&(o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),r=a+t.length,t}),o+="';\n",i.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(t)return n(t,x);var l=function(e){return n.call(this,e,x)};return l.source="function("+(i.variable||"obj")+"){\n"+o+"}",l},x.chain=function(e){return x(e).chain()};var P=function(e){return this._chain?x(e).chain():e};x.mixin(x),E(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];x.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],P.call(this,i)}}),E(["concat","join","slice"],function(e){var t=n[e];x.prototype[e]=function(){return P.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}).call(this),function(e,t){function i(e){var t=e.length,i=le.type(e);return le.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||"function"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function n(e){var t=xe[e]={};return le.each(e.match(ue)||[],function(e,i){t[i]=!0}),t}function s(e,i,n,s){if(le.acceptData(e)){var r,o,a=le.expando,l="string"==typeof i,c=e.nodeType,u=c?le.cache:e,h=c?e[a]:e[a]&&a;if(h&&u[h]&&(s||u[h].data)||!l||n!==t)return h||(c?e[a]=h=Z.pop()||le.guid++:h=a),u[h]||(u[h]={},c||(u[h].toJSON=le.noop)),("object"==typeof i||"function"==typeof i)&&(s?u[h]=le.extend(u[h],i):u[h].data=le.extend(u[h].data,i)),r=u[h],s||(r.data||(r.data={}),r=r.data),n!==t&&(r[le.camelCase(i)]=n),l?(o=r[i],null==o&&(o=r[le.camelCase(i)])):o=r,o}}function r(e,t,i){if(le.acceptData(e)){var n,s,r,o=e.nodeType,l=o?le.cache:e,c=o?e[le.expando]:le.expando;if(l[c]){if(t&&(r=i?l[c]:l[c].data)){le.isArray(t)?t=t.concat(le.map(t,le.camelCase)):t in r?t=[t]:(t=le.camelCase(t),t=t in r?[t]:t.split(" "));for(n=0,s=t.length;s>n;n++)delete r[t[n]];if(!(i?a:le.isEmptyObject)(r))return}(i||(delete l[c].data,a(l[c])))&&(o?le.cleanData([e],!0):le.support.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}function o(e,i,n){if(n===t&&1===e.nodeType){var s="data-"+i.replace(Se,"-$1").toLowerCase();if(n=e.getAttribute(s),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ee.test(n)?le.parseJSON(n):n}catch(r){}le.data(e,i,n)}else n=t}return n}function a(e){var t;for(t in e)if(("data"!==t||!le.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(){return!0}function c(){return!1}function u(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,i){if(t=t||0,le.isFunction(t))return le.grep(e,function(e,n){var s=!!t.call(e,n,e);return s===i});if(t.nodeType)return le.grep(e,function(e){return e===t===i});if("string"==typeof t){var n=le.grep(e,function(e){return 1===e.nodeType});if(He.test(t))return le.filter(t,n,!i);t=le.filter(t,n)}return le.grep(e,function(e){return le.inArray(e,t)>=0===i})}function d(e){var t=Ue.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function p(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function f(e){var t=e.getAttributeNode("type");return e.type=(t&&t.specified)+"/"+e.type,e}function g(e){var t=st.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var i,n=0;null!=(i=e[n]);n++)le._data(i,"globalEval",!t||le._data(t[n],"globalEval"))}function v(e,t){if(1===t.nodeType&&le.hasData(e)){var i,n,s,r=le._data(e),o=le._data(t,r),a=r.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,s=a[i].length;s>n;n++)le.event.add(t,i,a[i][n])}o.data&&(o.data=le.extend({},o.data))}}function y(e,t){var i,n,s;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!le.support.noCloneEvent&&t[le.expando]){s=le._data(t);for(n in s.events)le.removeEvent(t,n,s.handle);t.removeAttribute(le.expando)}"script"===i&&t.text!==e.text?(f(t).text=e.text,g(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),le.support.html5Clone&&e.innerHTML&&!le.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&tt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}}function _(e,i){var n,s,r=0,o=typeof e.getElementsByTagName!==Q?e.getElementsByTagName(i||"*"):typeof e.querySelectorAll!==Q?e.querySelectorAll(i||"*"):t;if(!o)for(o=[],n=e.childNodes||e;null!=(s=n[r]);r++)!i||le.nodeName(s,i)?o.push(s):le.merge(o,_(s,i));return i===t||i&&le.nodeName(e,i)?le.merge([e],o):o}function b(e){tt.test(e.type)&&(e.defaultChecked=e.checked)}function w(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,s=Et.length;s--;)if(t=Et[s]+i,t in e)return t;return n}function C(e,t){return e=t||e,"none"===le.css(e,"display")||!le.contains(e.ownerDocument,e)}function x(e,t){for(var i,n,s,r=[],o=0,a=e.length;a>o;o++)n=e[o],n.style&&(r[o]=le._data(n,"olddisplay"),i=n.style.display,t?(r[o]||"none"!==i||(n.style.display=""),""===n.style.display&&C(n)&&(r[o]=le._data(n,"olddisplay",k(n.nodeName)))):r[o]||(s=C(n),(i&&"none"!==i||!s)&&le._data(n,"olddisplay",s?i:le.css(n,"display"))));for(o=0;a>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?r[o]||"":"none"));return e}function E(e,t,i){var n=vt.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function S(e,t,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===t?1:0,o=0;4>r;r+=2)"margin"===i&&(o+=le.css(e,i+xt[r],!0,s)),n?("content"===i&&(o-=le.css(e,"padding"+xt[r],!0,s)),"margin"!==i&&(o-=le.css(e,"border"+xt[r]+"Width",!0,s))):(o+=le.css(e,"padding"+xt[r],!0,s),"padding"!==i&&(o+=le.css(e,"border"+xt[r]+"Width",!0,s)));return o}function A(e,t,i){var n=!0,s="width"===t?e.offsetWidth:e.offsetHeight,r=ut(e),o=le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,r);if(0>=s||null==s){if(s=ht(e,t,r),(0>s||null==s)&&(s=e.style[t]),yt.test(s))return s;n=o&&(le.support.boxSizingReliable||s===e.style[t]),s=parseFloat(s)||0}return s+S(e,t,i||(o?"border":"content"),n,r)+"px"}function k(e){var t=G,i=bt[e];return i||(i=F(e,t),"none"!==i&&i||(ct=(ct||le("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ct[0].contentWindow||ct[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),i=F(e,t),ct.detach()),bt[e]=i),i}function F(e,t){var i=le(t.createElement(e)).appendTo(t.body),n=le.css(i[0],"display");return i.remove(),n}function D(e,t,i,n){var s;if(le.isArray(t))le.each(t,function(t,s){i||At.test(e)?n(e,s):D(e+"["+("object"==typeof s?t:"")+"]",s,i,n)});else if(i||"object"!==le.type(t))n(e,t);else for(s in t)D(e+"["+s+"]",t[s],i,n)}function T(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,s=0,r=t.toLowerCase().match(ue)||[];if(le.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function $(e,i,n,s){function r(l){var c;return o[l]=!0,le.each(e[l]||[],function(e,l){var u=l(i,n,s);return"string"!=typeof u||a||o[u]?a?!(c=u):t:(i.dataTypes.unshift(u),r(u),!1)}),c}var o={},a=e===Ht;return r(i.dataTypes[0])||!o["*"]&&r("*")}function B(e,i){var n,s,r=le.ajaxSettings.flatOptions||{};for(s in i)i[s]!==t&&((r[s]?e:n||(n={}))[s]=i[s]);return n&&le.extend(!0,e,n),e}function j(e,i,n){var s,r,o,a,l=e.contents,c=e.dataTypes,u=e.responseFields;for(a in u)a in n&&(i[u[a]]=n[a]);for(;"*"===c[0];)c.shift(),r===t&&(r=e.mimeType||i.getResponseHeader("Content-Type"));if(r)for(a in l)if(l[a]&&l[a].test(r)){c.unshift(a);break}if(c[0]in n)o=c[0];else{for(a in n){if(!c[0]||e.converters[a+" "+c[0]]){o=a;break}s||(s=a)}o=o||s}return o?(o!==c[0]&&c.unshift(o),n[o]):t}function M(e,t){var i,n,s,r,o={},a=0,l=e.dataTypes.slice(),c=l[0];if(e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l[1])for(s in e.converters)o[s.toLowerCase()]=e.converters[s];for(;n=l[++a];)if("*"!==n){if("*"!==c&&c!==n){if(s=o[c+" "+n]||o["* "+n],!s)for(i in o)if(r=i.split(" "),r[1]===n&&(s=o[c+" "+r[0]]||o["* "+r[0]])){s===!0?s=o[i]:o[i]!==!0&&(n=r[0],l.splice(a--,0,n));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+c+" to "+n}}}c=n}return{state:"success",data:t}}function L(){try{return new e.XMLHttpRequest}catch(t){}}function I(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function P(){return setTimeout(function(){Jt=t}),Jt=le.now()}function R(e,t){le.each(t,function(t,i){for(var n=(si[t]||[]).concat(si["*"]),s=0,r=n.length;r>s;s++)if(n[s].call(e,t,i))return})}function O(e,t,i){var n,s,r=0,o=ni.length,a=le.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var t=Jt||P(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,r=1-n,o=0,l=c.tweens.length;l>o;o++)c.tweens[o].run(r);return a.notifyWith(e,[c,r,i]),1>r&&l?i:(a.resolveWith(e,[c]),!1)},c=a.promise({elem:e,props:le.extend({},t),opts:le.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Jt||P(),duration:i.duration,tweens:[],createTween:function(t,i){var n=le.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)c.tweens[i].run(1);return t?a.resolveWith(e,[c,t]):a.rejectWith(e,[c,t]),this}}),u=c.props;for(N(u,c.opts.specialEasing);o>r;r++)if(n=ni[r].call(c,e,u,c.opts))return n;return R(c,u),le.isFunction(c.opts.start)&&c.opts.start.call(e,c),le.fx.timer(le.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function N(e,t){var i,n,s,r,o;for(s in e)if(n=le.camelCase(s),r=t[n],i=e[s],le.isArray(i)&&(r=i[1],i=e[s]=i[0]),s!==n&&(e[n]=i,delete e[s]),o=le.cssHooks[n],o&&"expand"in o){i=o.expand(i),delete e[n];for(s in i)s in e||(e[s]=i[s],t[s]=r)}else t[n]=r}function q(e,t,i){var n,s,r,o,a,l,c,u,h,d=this,p=e.style,f={},g=[],m=e.nodeType&&C(e);i.queue||(u=le._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,h=u.empty.fire,u.empty.fire=function(){u.unqueued||h()}),u.unqueued++,d.always(function(){d.always(function(){u.unqueued--,le.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===le.css(e,"display")&&"none"===le.css(e,"float")&&(le.support.inlineBlockNeedsLayout&&"inline"!==k(e.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",le.support.shrinkWrapBlocks||d.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(s in t)if(o=t[s],ei.exec(o)){if(delete t[s],l=l||"toggle"===o,o===(m?"hide":"show"))continue;g.push(s)}if(r=g.length){a=le._data(e,"fxshow")||le._data(e,"fxshow",{}),"hidden"in a&&(m=a.hidden),l&&(a.hidden=!m),m?le(e).show():d.done(function(){le(e).hide()}),d.done(function(){var t;le._removeData(e,"fxshow");for(t in f)le.style(e,t,f[t])});for(s=0;r>s;s++)n=g[s],c=d.createTween(n,m?a[n]:0),f[n]=a[n]||le.style(e,n),n in a||(a[n]=c.start,m&&(c.end=c.start,c.start="width"===n||"height"===n?1:0))}}function z(e,t,i,n,s){return new z.prototype.init(e,t,i,n,s)}function H(e,t){var i,n={height:e},s=0;for(t=t?1:0;4>s;s+=2-t)i=xt[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function V(e){return le.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var W,U,Q=typeof t,G=e.document,K=e.location,Y=e.jQuery,X=e.$,J={},Z=[],ee="1.9.1",te=Z.concat,ie=Z.push,ne=Z.slice,se=Z.indexOf,re=J.toString,oe=J.hasOwnProperty,ae=ee.trim,le=function(e,t){return new le.fn.init(e,t,U)},ce=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ue=/\S+/g,he=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,de=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,pe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,fe=/^[\],:{}\s]*$/,ge=/(?:^|:|,)(?:\s*\[)+/g,me=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ve=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,ye=/^-ms-/,_e=/-([\da-z])/gi,be=function(e,t){return t.toUpperCase()},we=function(e){(G.addEventListener||"load"===e.type||"complete"===G.readyState)&&(Ce(),le.ready())},Ce=function(){G.addEventListener?(G.removeEventListener("DOMContentLoaded",we,!1),e.removeEventListener("load",we,!1)):(G.detachEvent("onreadystatechange",we),e.detachEvent("onload",we))};le.fn=le.prototype={jquery:ee,constructor:le,init:function(e,i,n){var s,r;if(!e)return this;if("string"==typeof e){if(s="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:de.exec(e),!s||!s[1]&&i)return!i||i.jquery?(i||n).find(e):this.constructor(i).find(e);if(s[1]){if(i=i instanceof le?i[0]:i,le.merge(this,le.parseHTML(s[1],i&&i.nodeType?i.ownerDocument||i:G,!0)),pe.test(s[1])&&le.isPlainObject(i))for(s in i)le.isFunction(this[s])?this[s](i[s]):this.attr(s,i[s]);return this}if(r=G.getElementById(s[2]),r&&r.parentNode){if(r.id!==s[2])return n.find(e);this.length=1,this[0]=r}return this.context=G,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):le.isFunction(e)?n.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),le.makeArray(e,this))},selector:"",length:0,size:function(){return this.length},toArray:function(){return ne.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=le.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return le.each(this,e,t)},ready:function(e){return le.ready.promise().done(e),this},slice:function(){return this.pushStack(ne.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},map:function(e){return this.pushStack(le.map(this,function(t,i){return e.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:ie,sort:[].sort,splice:[].splice},le.fn.init.prototype=le.fn,le.extend=le.fn.extend=function(){var e,i,n,s,r,o,a=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"object"==typeof a||le.isFunction(a)||(a={}),c===l&&(a=this,--l);c>l;l++)if(null!=(r=arguments[l]))for(s in r)e=a[s],n=r[s],a!==n&&(u&&n&&(le.isPlainObject(n)||(i=le.isArray(n)))?(i?(i=!1,o=e&&le.isArray(e)?e:[]):o=e&&le.isPlainObject(e)?e:{},a[s]=le.extend(u,o,n)):n!==t&&(a[s]=n));return a},le.extend({noConflict:function(t){return e.$===le&&(e.$=X),t&&e.jQuery===le&&(e.jQuery=Y),le},isReady:!1,readyWait:1,holdReady:function(e){e?le.readyWait++:le.ready(!0)},ready:function(e){if(e===!0?!--le.readyWait:!le.isReady){if(!G.body)return setTimeout(le.ready);le.isReady=!0,e!==!0&&--le.readyWait>0||(W.resolveWith(G,[le]),le.fn.trigger&&le(G).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===le.type(e)},isArray:Array.isArray||function(e){return"array"===le.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?J[re.call(e)]||"object":typeof e},isPlainObject:function(e){if(!e||"object"!==le.type(e)||e.nodeType||le.isWindow(e))return!1;try{if(e.constructor&&!oe.call(e,"constructor")&&!oe.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(i){return!1}var n;for(n in e);return n===t||oe.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||G;var n=pe.exec(e),s=!i&&[];return n?[t.createElement(n[1])]:(n=le.buildFragment([e],t,s),s&&le(s).remove(),le.merge([],n.childNodes))},parseJSON:function(i){return e.JSON&&e.JSON.parse?e.JSON.parse(i):null===i?i:"string"==typeof i&&(i=le.trim(i),i&&fe.test(i.replace(me,"@").replace(ve,"]").replace(ge,"")))?Function("return "+i)():(le.error("Invalid JSON: "+i),t)},parseXML:function(i){var n,s;if(!i||"string"!=typeof i)return null;try{e.DOMParser?(s=new DOMParser,n=s.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(r){n=t}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||le.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(t){t&&le.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(ye,"ms-").replace(_e,be)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var s,r=0,o=e.length,a=i(e);if(n){if(a)for(;o>r&&(s=t.apply(e[r],n),s!==!1);r++);else for(r in e)if(s=t.apply(e[r],n),s===!1)break}else if(a)for(;o>r&&(s=t.call(e[r],r,e[r]),s!==!1);r++);else for(r in e)if(s=t.call(e[r],r,e[r]),s===!1)break;return e},trim:ae&&!ae.call("\ufeff¬†")?function(e){return null==e?"":ae.call(e)}:function(e){return null==e?"":(e+"").replace(he,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?le.merge(n,"string"==typeof e?[e]:e):ie.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(se)return se.call(t,e,i);for(n=t.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,i){var n=i.length,s=e.length,r=0;if("number"==typeof n)for(;n>r;r++)e[s++]=i[r];else for(;i[r]!==t;)e[s++]=i[r++];return e.length=s,e},grep:function(e,t,i){var n,s=[],r=0,o=e.length;for(i=!!i;o>r;r++)n=!!t(e[r],r),i!==n&&s.push(e[r]);return s},map:function(e,t,n){var s,r=0,o=e.length,a=i(e),l=[];if(a)for(;o>r;r++)s=t(e[r],r,n),null!=s&&(l[l.length]=s);else for(r in e)s=t(e[r],r,n),null!=s&&(l[l.length]=s);return te.apply([],l)},guid:1,proxy:function(e,i){var n,s,r;return"string"==typeof i&&(r=e[i],i=e,e=r),le.isFunction(e)?(n=ne.call(arguments,2),s=function(){return e.apply(i||this,n.concat(ne.call(arguments)))},s.guid=e.guid=e.guid||le.guid++,s):t},access:function(e,i,n,s,r,o,a){var l=0,c=e.length,u=null==n;if("object"===le.type(n)){r=!0;for(l in n)le.access(e,i,l,n[l],!0,o,a)}else if(s!==t&&(r=!0,le.isFunction(s)||(a=!0),u&&(a?(i.call(e,s),i=null):(u=i,i=function(e,t,i){return u.call(le(e),i)})),i))for(;c>l;l++)i(e[l],n,a?s:s.call(e[l],l,i(e[l],n)));return r?e:u?i.call(e):c?i(e[0],n):o},now:function(){return(new Date).getTime()}}),le.ready.promise=function(t){if(!W)if(W=le.Deferred(),"complete"===G.readyState)setTimeout(le.ready);else if(G.addEventListener)G.addEventListener("DOMContentLoaded",we,!1),e.addEventListener("load",we,!1);else{G.attachEvent("onreadystatechange",we),e.attachEvent("onload",we);var i=!1;try{i=null==e.frameElement&&G.documentElement}catch(n){}i&&i.doScroll&&function s(){if(!le.isReady){try{i.doScroll("left")}catch(e){return setTimeout(s,50)}Ce(),le.ready()}}()}return W.promise(t)},le.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){J["[object "+t+"]"]=t.toLowerCase()}),U=le(G);var xe={};le.Callbacks=function(e){e="string"==typeof e?xe[e]||n(e):le.extend({},e);var i,s,r,o,a,l,c=[],u=!e.once&&[],h=function(t){for(s=e.memory&&t,r=!0,a=l||0,l=0,o=c.length,i=!0;c&&o>a;a++)if(c[a].apply(t[0],t[1])===!1&&e.stopOnFalse){s=!1;break}i=!1,c&&(u?u.length&&h(u.shift()):s?c=[]:d.disable());
},d={add:function(){if(c){var t=c.length;!function n(t){le.each(t,function(t,i){var s=le.type(i);"function"===s?e.unique&&d.has(i)||c.push(i):i&&i.length&&"string"!==s&&n(i)})}(arguments),i?o=c.length:s&&(l=t,h(s))}return this},remove:function(){return c&&le.each(arguments,function(e,t){for(var n;(n=le.inArray(t,c,n))>-1;)c.splice(n,1),i&&(o>=n&&o--,a>=n&&a--)}),this},has:function(e){return e?le.inArray(e,c)>-1:!(!c||!c.length)},empty:function(){return c=[],this},disable:function(){return c=u=s=t,this},disabled:function(){return!c},lock:function(){return u=t,s||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],!c||r&&!u||(i?u.push(t):h(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!r}};return d},le.extend({Deferred:function(e){var t=[["resolve","done",le.Callbacks("once memory"),"resolved"],["reject","fail",le.Callbacks("once memory"),"rejected"],["notify","progress",le.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var e=arguments;return le.Deferred(function(i){le.each(t,function(t,r){var o=r[0],a=le.isFunction(e[t])&&e[t];s[r[1]](function(){var e=a&&a.apply(this,arguments);e&&le.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?le.extend(e,n):n}},s={};return n.pipe=n.then,le.each(t,function(e,r){var o=r[2],a=r[3];n[r[1]]=o.add,a&&o.add(function(){i=a},t[1^e][2].disable,t[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=o.fireWith}),n.promise(s),e&&e.call(s,s),s},when:function(e){var t,i,n,s=0,r=ne.call(arguments),o=r.length,a=1!==o||e&&le.isFunction(e.promise)?o:0,l=1===a?e:le.Deferred(),c=function(e,i,n){return function(s){i[e]=this,n[e]=arguments.length>1?ne.call(arguments):s,n===t?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(t=Array(o),i=Array(o),n=Array(o);o>s;s++)r[s]&&le.isFunction(r[s].promise)?r[s].promise().done(c(s,n,r)).fail(l.reject).progress(c(s,i,t)):--a;return a||l.resolveWith(n,r),l.promise()}}),le.support=function(){var t,i,n,s,r,o,a,l,c,u,h=G.createElement("div");if(h.setAttribute("className","t"),h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=h.getElementsByTagName("*"),n=h.getElementsByTagName("a")[0],!i||!n||!i.length)return{};r=G.createElement("select"),a=r.appendChild(G.createElement("option")),s=h.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",t={getSetAttribute:"t"!==h.className,leadingWhitespace:3===h.firstChild.nodeType,tbody:!h.getElementsByTagName("tbody").length,htmlSerialize:!!h.getElementsByTagName("link").length,style:/top/.test(n.getAttribute("style")),hrefNormalized:"/a"===n.getAttribute("href"),opacity:/^0.5/.test(n.style.opacity),cssFloat:!!n.style.cssFloat,checkOn:!!s.value,optSelected:a.selected,enctype:!!G.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==G.createElement("nav").cloneNode(!0).outerHTML,boxModel:"CSS1Compat"===G.compatMode,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,r.disabled=!0,t.optDisabled=!a.disabled;try{delete h.test}catch(d){t.deleteExpando=!1}s=G.createElement("input"),s.setAttribute("value",""),t.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),o=G.createDocumentFragment(),o.appendChild(s),t.appendChecked=s.checked,t.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,h.attachEvent&&(h.attachEvent("onclick",function(){t.noCloneEvent=!1}),h.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})h.setAttribute(l="on"+u,"t"),t[u+"Bubbles"]=l in e||h.attributes[l].expando===!1;return h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===h.style.backgroundClip,le(function(){var i,n,s,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=G.getElementsByTagName("body")[0];o&&(i=G.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(h),h.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=h.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&0===s[0].offsetHeight,h.innerHTML="",h.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=4===h.offsetWidth,t.doesNotIncludeMarginInBodyOffset=1!==o.offsetTop,e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(h,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(h,null)||{width:"4px"}).width,n=h.appendChild(G.createElement("div")),n.style.cssText=h.style.cssText=r,n.style.marginRight=n.style.width="0",h.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(n,null)||{}).marginRight)),typeof h.style.zoom!==Q&&(h.innerHTML="",h.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===h.offsetWidth,h.style.display="block",h.innerHTML="<div></div>",h.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==h.offsetWidth,t.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(i),i=h=s=n=null)}),i=r=o=a=n=s=null,t}();var Ee=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Se=/([A-Z])/g;le.extend({cache:{},expando:"jQuery"+(ee+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?le.cache[e[le.expando]]:e[le.expando],!!e&&!a(e)},data:function(e,t,i){return s(e,t,i)},removeData:function(e,t){return r(e,t)},_data:function(e,t,i){return s(e,t,i,!0)},_removeData:function(e,t){return r(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&le.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),le.fn.extend({data:function(e,i){var n,s,r=this[0],a=0,l=null;if(e===t){if(this.length&&(l=le.data(r),1===r.nodeType&&!le._data(r,"parsedAttrs"))){for(n=r.attributes;n.length>a;a++)s=n[a].name,s.indexOf("data-")||(s=le.camelCase(s.slice(5)),o(r,s,l[s]));le._data(r,"parsedAttrs",!0)}return l}return"object"==typeof e?this.each(function(){le.data(this,e)}):le.access(this,function(i){return i===t?r?o(r,e,le.data(r,e)):null:(this.each(function(){le.data(this,e,i)}),t)},null,i,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){le.removeData(this,e)})}}),le.extend({queue:function(e,i,n){var s;return e?(i=(i||"fx")+"queue",s=le._data(e,i),n&&(!s||le.isArray(n)?s=le._data(e,i,le.makeArray(n)):s.push(n)),s||[]):t},dequeue:function(e,t){t=t||"fx";var i=le.queue(e,t),n=i.length,s=i.shift(),r=le._queueHooks(e,t),o=function(){le.dequeue(e,t)};"inprogress"===s&&(s=i.shift(),n--),r.cur=s,s&&("fx"===t&&i.unshift("inprogress"),delete r.stop,s.call(e,o,r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return le._data(e,i)||le._data(e,i,{empty:le.Callbacks("once memory").add(function(){le._removeData(e,t+"queue"),le._removeData(e,i)})})}}),le.fn.extend({queue:function(e,i){var n=2;return"string"!=typeof e&&(i=e,e="fx",n--),n>arguments.length?le.queue(this[0],e):i===t?this:this.each(function(){var t=le.queue(this,e,i);le._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&le.dequeue(this,e)})},dequeue:function(e){return this.each(function(){le.dequeue(this,e)})},delay:function(e,t){return e=le.fx?le.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,i){var n,s=1,r=le.Deferred(),o=this,a=this.length,l=function(){--s||r.resolveWith(o,[o])};for("string"!=typeof e&&(i=e,e=t),e=e||"fx";a--;)n=le._data(o[a],e+"queueHooks"),n&&n.empty&&(s++,n.empty.add(l));return l(),r.promise(i)}});var Ae,ke,Fe=/[\t\r\n]/g,De=/\r/g,Te=/^(?:input|select|textarea|button|object)$/i,$e=/^(?:a|area)$/i,Be=/^(?:checked|selected|autofocus|autoplay|async|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped)$/i,je=/^(?:checked|selected)$/i,Me=le.support.getSetAttribute,Le=le.support.input;le.fn.extend({attr:function(e,t){return le.access(this,le.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){le.removeAttr(this,e)})},prop:function(e,t){return le.access(this,le.prop,e,t,arguments.length>1)},removeProp:function(e){return e=le.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(i){}})},addClass:function(e){var t,i,n,s,r,o=0,a=this.length,l="string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).addClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ue)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Fe," "):" ")){for(r=0;s=t[r++];)0>n.indexOf(" "+s+" ")&&(n+=s+" ");i.className=le.trim(n)}return this},removeClass:function(e){var t,i,n,s,r,o=0,a=this.length,l=0===arguments.length||"string"==typeof e&&e;if(le.isFunction(e))return this.each(function(t){le(this).removeClass(e.call(this,t,this.className))});if(l)for(t=(e||"").match(ue)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Fe," "):"")){for(r=0;s=t[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");i.className=e?le.trim(n):""}return this},toggleClass:function(e,t){var i=typeof e,n="boolean"==typeof t;return le.isFunction(e)?this.each(function(i){le(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var s,r=0,o=le(this),a=t,l=e.match(ue)||[];s=l[r++];)a=n?a:!o.hasClass(s),o[a?"addClass":"removeClass"](s);else(i===Q||"boolean"===i)&&(this.className&&le._data(this,"__className__",this.className),this.className=this.className||e===!1?"":le._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Fe," ").indexOf(t)>=0)return!0;return!1},val:function(e){var i,n,s,r=this[0];return arguments.length?(s=le.isFunction(e),this.each(function(i){var r,o=le(this);1===this.nodeType&&(r=s?e.call(this,i,o.val()):e,null==r?r="":"number"==typeof r?r+="":le.isArray(r)&&(r=le.map(r,function(e){return null==e?"":e+""})),n=le.valHooks[this.type]||le.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==t||(this.value=r))})):r?(n=le.valHooks[r.type]||le.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==t?i:(i=r.value,"string"==typeof i?i.replace(De,""):null==i?"":i)):void 0}}),le.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){for(var t,i,n=e.options,s=e.selectedIndex,r="select-one"===e.type||0>s,o=r?null:[],a=r?s+1:n.length,l=0>s?a:r?s:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==s||(le.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&le.nodeName(i.parentNode,"optgroup"))){if(t=le(i).val(),r)return t;o.push(t)}return o},set:function(e,t){var i=le.makeArray(t);return le(e).find("option").each(function(){this.selected=le.inArray(le(this).val(),i)>=0}),i.length||(e.selectedIndex=-1),i}}},attr:function(e,i,n){var s,r,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?typeof e.getAttribute===Q?le.prop(e,i,n):(r=1!==a||!le.isXMLDoc(e),r&&(i=i.toLowerCase(),s=le.attrHooks[i]||(Be.test(i)?ke:Ae)),n===t?s&&r&&"get"in s&&null!==(o=s.get(e,i))?o:(typeof e.getAttribute!==Q&&(o=e.getAttribute(i)),null==o?t:o):null!==n?s&&r&&"set"in s&&(o=s.set(e,n,i))!==t?o:(e.setAttribute(i,n+""),n):(le.removeAttr(e,i),t)):void 0},removeAttr:function(e,t){var i,n,s=0,r=t&&t.match(ue);if(r&&1===e.nodeType)for(;i=r[s++];)n=le.propFix[i]||i,Be.test(i)?!Me&&je.test(i)?e[le.camelCase("default-"+i)]=e[n]=!1:e[n]=!1:le.attr(e,i,""),e.removeAttribute(Me?i:n)},attrHooks:{type:{set:function(e,t){if(!le.support.radioValue&&"radio"===t&&le.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,i,n){var s,r,o,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(o=1!==a||!le.isXMLDoc(e),o&&(i=le.propFix[i]||i,r=le.propHooks[i]),n!==t?r&&"set"in r&&(s=r.set(e,n,i))!==t?s:e[i]=n:r&&"get"in r&&null!==(s=r.get(e,i))?s:e[i]):void 0},propHooks:{tabIndex:{get:function(e){var i=e.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):Te.test(e.nodeName)||$e.test(e.nodeName)&&e.href?0:t}}}}),ke={get:function(e,i){var n=le.prop(e,i),s="boolean"==typeof n&&e.getAttribute(i),r="boolean"==typeof n?Le&&Me?null!=s:je.test(i)?e[le.camelCase("default-"+i)]:!!s:e.getAttributeNode(i);return r&&r.value!==!1?i.toLowerCase():t},set:function(e,t,i){return t===!1?le.removeAttr(e,i):Le&&Me||!je.test(i)?e.setAttribute(!Me&&le.propFix[i]||i,i):e[le.camelCase("default-"+i)]=e[i]=!0,i}},Le&&Me||(le.attrHooks.value={get:function(e,i){var n=e.getAttributeNode(i);return le.nodeName(e,"input")?e.defaultValue:n&&n.specified?n.value:t},set:function(e,i,n){return le.nodeName(e,"input")?(e.defaultValue=i,t):Ae&&Ae.set(e,i,n)}}),Me||(Ae=le.valHooks.button={get:function(e,i){var n=e.getAttributeNode(i);return n&&("id"===i||"name"===i||"coords"===i?""!==n.value:n.specified)?n.value:t},set:function(e,i,n){var s=e.getAttributeNode(n);return s||e.setAttributeNode(s=e.ownerDocument.createAttribute(n)),s.value=i+="","value"===n||i===e.getAttribute(n)?i:t}},le.attrHooks.contenteditable={get:Ae.get,set:function(e,t,i){Ae.set(e,""===t?!1:t,i)}},le.each(["width","height"],function(e,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{set:function(e,n){return""===n?(e.setAttribute(i,"auto"),n):t}})})),le.support.hrefNormalized||(le.each(["href","src","width","height"],function(e,i){le.attrHooks[i]=le.extend(le.attrHooks[i],{get:function(e){var n=e.getAttribute(i,2);return null==n?t:n}})}),le.each(["href","src"],function(e,t){le.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}})),le.support.style||(le.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),le.support.optSelected||(le.propHooks.selected=le.extend(le.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),le.support.enctype||(le.propFix.enctype="encoding"),le.support.checkOn||le.each(["radio","checkbox"],function(){le.valHooks[this]={get:function(e){return null===e.getAttribute("value")?"on":e.value}}}),le.each(["radio","checkbox"],function(){le.valHooks[this]=le.extend(le.valHooks[this],{set:function(e,i){return le.isArray(i)?e.checked=le.inArray(le(e).val(),i)>=0:t}})});var Ie=/^(?:input|select|textarea)$/i,Pe=/^key/,Re=/^(?:mouse|contextmenu)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,Ne=/^([^.]*)(?:\.(.+)|)$/;le.event={global:{},add:function(e,i,n,s,r){var o,a,l,c,u,h,d,p,f,g,m,v=le._data(e);if(v){for(n.handler&&(c=n,n=c.handler,r=c.selector),n.guid||(n.guid=le.guid++),(a=v.events)||(a=v.events={}),(h=v.handle)||(h=v.handle=function(e){return typeof le===Q||e&&le.event.triggered===e.type?t:le.event.dispatch.apply(h.elem,arguments)},h.elem=e),i=(i||"").match(ue)||[""],l=i.length;l--;)o=Ne.exec(i[l])||[],f=m=o[1],g=(o[2]||"").split(".").sort(),u=le.event.special[f]||{},f=(r?u.delegateType:u.bindType)||f,u=le.event.special[f]||{},d=le.extend({type:f,origType:m,data:s,handler:n,guid:n.guid,selector:r,needsContext:r&&le.expr.match.needsContext.test(r),namespace:g.join(".")},c),(p=a[f])||(p=a[f]=[],p.delegateCount=0,u.setup&&u.setup.call(e,s,g,h)!==!1||(e.addEventListener?e.addEventListener(f,h,!1):e.attachEvent&&e.attachEvent("on"+f,h))),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),r?p.splice(p.delegateCount++,0,d):p.push(d),le.event.global[f]=!0;e=null}},remove:function(e,t,i,n,s){var r,o,a,l,c,u,h,d,p,f,g,m=le.hasData(e)&&le._data(e);if(m&&(u=m.events)){for(t=(t||"").match(ue)||[""],c=t.length;c--;)if(a=Ne.exec(t[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=le.event.special[p]||{},p=(n?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=d.length;r--;)o=d[r],!s&&g!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(d.splice(r,1),o.selector&&d.delegateCount--,h.remove&&h.remove.call(e,o));l&&!d.length&&(h.teardown&&h.teardown.call(e,f,m.handle)!==!1||le.removeEvent(e,p,m.handle),delete u[p])}else for(p in u)le.event.remove(e,p+t[c],i,n,!0);le.isEmptyObject(u)&&(delete m.handle,le._removeData(e,"events"))}},trigger:function(i,n,s,r){var o,a,l,c,u,h,d,p=[s||G],f=oe.call(i,"type")?i.type:i,g=oe.call(i,"namespace")?i.namespace.split("."):[];if(l=h=s=s||G,3!==s.nodeType&&8!==s.nodeType&&!Oe.test(f+le.event.triggered)&&(f.indexOf(".")>=0&&(g=f.split("."),f=g.shift(),g.sort()),a=0>f.indexOf(":")&&"on"+f,i=i[le.expando]?i:new le.Event(f,"object"==typeof i&&i),i.isTrigger=!0,i.namespace=g.join("."),i.namespace_re=i.namespace?RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=t,i.target||(i.target=s),n=null==n?[i]:le.makeArray(n,[i]),u=le.event.special[f]||{},r||!u.trigger||u.trigger.apply(s,n)!==!1)){if(!r&&!u.noBubble&&!le.isWindow(s)){for(c=u.delegateType||f,Oe.test(c+f)||(l=l.parentNode);l;l=l.parentNode)p.push(l),h=l;h===(s.ownerDocument||G)&&p.push(h.defaultView||h.parentWindow||e)}for(d=0;(l=p[d++])&&!i.isPropagationStopped();)i.type=d>1?c:u.bindType||f,o=(le._data(l,"events")||{})[i.type]&&le._data(l,"handle"),o&&o.apply(l,n),o=a&&l[a],o&&le.acceptData(l)&&o.apply&&o.apply(l,n)===!1&&i.preventDefault();if(i.type=f,!(r||i.isDefaultPrevented()||u._default&&u._default.apply(s.ownerDocument,n)!==!1||"click"===f&&le.nodeName(s,"a")||!le.acceptData(s)||!a||!s[f]||le.isWindow(s))){h=s[a],h&&(s[a]=null),le.event.triggered=f;try{s[f]()}catch(m){}le.event.triggered=t,h&&(s[a]=h)}return i.result}},dispatch:function(e){e=le.event.fix(e);var i,n,s,r,o,a=[],l=ne.call(arguments),c=(le._data(this,"events")||{})[e.type]||[],u=le.event.special[e.type]||{};if(l[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(a=le.event.handlers.call(this,e,c),i=0;(r=a[i++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,o=0;(s=r.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,n=((le.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,l),n!==t&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,i){var n,s,r,o,a=[],l=i.delegateCount,c=e.target;if(l&&c.nodeType&&(!e.button||"click"!==e.type))for(;c!=this;c=c.parentNode||this)if(1===c.nodeType&&(c.disabled!==!0||"click"!==e.type)){for(r=[],o=0;l>o;o++)s=i[o],n=s.selector+" ",r[n]===t&&(r[n]=s.needsContext?le(n,this).index(c)>=0:le.find(n,this,null,[c]).length),r[n]&&r.push(s);r.length&&a.push({elem:c,handlers:r})}return i.length>l&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(e){if(e[le.expando])return e;var t,i,n,s=e.type,r=e,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=Re.test(s)?this.mouseHooks:Pe.test(s)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new le.Event(r),t=n.length;t--;)i=n[t],e[i]=r[i];return e.target||(e.target=r.srcElement||G),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,r):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,i){var n,s,r,o=i.button,a=i.fromElement;return null==e.pageX&&null!=i.clientX&&(s=e.target.ownerDocument||G,r=s.documentElement,n=s.body,e.pageX=i.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),e.pageY=i.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?i.toElement:a),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},click:{trigger:function(){return le.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t}},focus:{trigger:function(){if(this!==G.activeElement&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===G.activeElement&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var s=le.extend(new le.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?le.event.trigger(s,null,t):le.event.dispatch.call(t,s),s.isDefaultPrevented()&&i.preventDefault()}},le.removeEvent=G.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===Q&&(e[n]=null),e.detachEvent(n,i))},le.Event=function(e,i){return this instanceof le.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?l:c):this.type=e,i&&le.extend(this,i),this.timeStamp=e&&e.timeStamp||le.now(),this[le.expando]=!0,t):new le.Event(e,i)},le.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},le.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){le.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,s=e.relatedTarget,r=e.handleObj;return(!s||s!==n&&!le.contains(n,s))&&(e.type=r.origType,i=r.handler.apply(this,arguments),e.type=t),i}}}),le.support.submitBubbles||(le.event.special.submit={setup:function(){return le.nodeName(this,"form")?!1:(le.event.add(this,"click._submit keypress._submit",function(e){var i=e.target,n=le.nodeName(i,"input")||le.nodeName(i,"button")?i.form:t;n&&!le._data(n,"submitBubbles")&&(le.event.add(n,"submit._submit",function(e){e._submit_bubble=!0}),le._data(n,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&le.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return le.nodeName(this,"form")?!1:(le.event.remove(this,"._submit"),t)}}),le.support.changeBubbles||(le.event.special.change={setup:function(){return Ie.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(le.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),le.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),le.event.simulate("change",this,e,!0)})),!1):(le.event.add(this,"beforeactivate._change",function(e){var t=e.target;Ie.test(t.nodeName)&&!le._data(t,"changeBubbles")&&(le.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||le.event.simulate("change",this.parentNode,e,!0)}),le._data(t,"changeBubbles",!0))}),t)},handle:function(e){var i=e.target;return this!==i||e.isSimulated||e.isTrigger||"radio"!==i.type&&"checkbox"!==i.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return le.event.remove(this,"._change"),!Ie.test(this.nodeName)}}),le.support.focusinBubbles||le.each({focus:"focusin",blur:"focusout"},function(e,t){var i=0,n=function(e){le.event.simulate(t,e.target,le.event.fix(e),!0)};le.event.special[t]={setup:function(){0===i++&&G.addEventListener(e,n,!0)},teardown:function(){0===--i&&G.removeEventListener(e,n,!0)}}}),le.fn.extend({on:function(e,i,n,s,r){var o,a;if("object"==typeof e){"string"!=typeof i&&(n=n||i,i=t);for(o in e)this.on(o,i,n,e[o],r);return this}if(null==n&&null==s?(s=i,n=i=t):null==s&&("string"==typeof i?(s=n,n=t):(s=n,n=i,i=t)),s===!1)s=c;else if(!s)return this;return 1===r&&(a=s,s=function(e){return le().off(e),a.apply(this,arguments)},s.guid=a.guid||(a.guid=le.guid++)),this.each(function(){le.event.add(this,e,s,n,i)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,i,n){var s,r;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,le(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(r in e)this.off(r,i,e[r]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=t),n===!1&&(n=c),this.each(function(){le.event.remove(this,e,n,i)})},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)},trigger:function(e,t){return this.each(function(){le.event.trigger(e,t,this)})},triggerHandler:function(e,i){var n=this[0];return n?le.event.trigger(e,i,n,!0):t}}),function(e,t){function i(e){return fe.test(e+"")}function n(){var e,t=[];return e=function(i,n){return t.push(i+=" ")>E.cacheLength&&delete e[t.shift()],e[i]=n}}function s(e){return e[O]=!0,e}function r(e){var t=$.createElement("div");try{return e(t)}catch(i){return!1}finally{t=null}}function o(e,t,i,n){var s,r,o,a,l,c,u,p,f,g;if((t?t.ownerDocument||t:N)!==$&&T(t),t=t||$,i=i||[],!e||"string"!=typeof e)return i;if(1!==(a=t.nodeType)&&9!==a)return[];if(!j&&!n){if(s=ge.exec(e))if(o=s[1]){if(9===a){if(r=t.getElementById(o),!r||!r.parentNode)return i;if(r.id===o)return i.push(r),i}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(o))&&P(t,r)&&r.id===o)return i.push(r),i}else{if(s[2])return X.apply(i,J.call(t.getElementsByTagName(e),0)),i;if((o=s[3])&&q.getByClassName&&t.getElementsByClassName)return X.apply(i,J.call(t.getElementsByClassName(o),0)),i}if(q.qsa&&!M.test(e)){if(u=!0,p=O,f=t,g=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(c=h(e),(u=t.getAttribute("id"))?p=u.replace(ye,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+d(c[l]);f=pe.test(e)&&t.parentNode||t,g=c.join(",")}if(g)try{return X.apply(i,J.call(f.querySelectorAll(g),0)),i}catch(m){}finally{u||t.removeAttribute("id")}}}return b(e.replace(oe,"$1"),t,i,n)}function a(e,t){var i=t&&e,n=i&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function l(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function c(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function u(e){return s(function(t){return t=+t,s(function(i,n){for(var s,r=e([],i.length,t),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))})})}function h(e,t){var i,n,s,r,a,l,c,u=W[e+" "];if(u)return t?0:u.slice(0);for(a=e,l=[],c=E.preFilter;a;){(!i||(n=ae.exec(a)))&&(n&&(a=a.slice(n[0].length)||a),l.push(s=[])),i=!1,(n=ce.exec(a))&&(i=n.shift(),s.push({value:i,type:n[0].replace(oe," ")}),a=a.slice(i.length));for(r in E.filter)!(n=de[r].exec(a))||c[r]&&!(n=c[r](n))||(i=n.shift(),s.push({value:i,type:r,matches:n}),a=a.slice(i.length));if(!i)break}return t?a.length:a?o.error(e):W(e,l).slice(0)}function d(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,s=i&&"parentNode"===n,r=H++;return t.first?function(t,i,r){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,r)}:function(t,i,o){var a,l,c,u=z+" "+r;if(o){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,o))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(c=t[O]||(t[O]={}),(l=c[n])&&l[0]===u){if((a=l[1])===!0||a===x)return a===!0}else if(l=c[n]=[u],l[1]=e(t,i,o)||x,l[1]===!0)return!0}}function f(e){return e.length>1?function(t,i,n){for(var s=e.length;s--;)if(!e[s](t,i,n))return!1;return!0}:e[0]}function g(e,t,i,n,s){for(var r,o=[],a=0,l=e.length,c=null!=t;l>a;a++)(r=e[a])&&(!i||i(r,n,s))&&(o.push(r),c&&t.push(a));return o}function m(e,t,i,n,r,o){return n&&!n[O]&&(n=m(n)),r&&!r[O]&&(r=m(r,o)),s(function(s,o,a,l){var c,u,h,d=[],p=[],f=o.length,m=s||_(t||"*",a.nodeType?[a]:a,[]),v=!e||!s&&t?m:g(m,d,e,a,l),y=i?r||(s?e:f||n)?[]:o:v;if(i&&i(v,y,a,l),n)for(c=g(y,p),n(c,[],a,l),u=c.length;u--;)(h=c[u])&&(y[p[u]]=!(v[p[u]]=h));if(s){if(r||e){if(r){for(c=[],u=y.length;u--;)(h=y[u])&&c.push(v[u]=h);r(null,y=[],c,l)}for(u=y.length;u--;)(h=y[u])&&(c=r?Z.call(s,h):d[u])>-1&&(s[c]=!(o[c]=h))}}else y=g(y===o?y.splice(f,y.length):y),r?r(null,o,y,l):X.apply(o,y)})}function v(e){for(var t,i,n,s=e.length,r=E.relative[e[0].type],o=r||E.relative[" "],a=r?1:0,l=p(function(e){return e===t},o,!0),c=p(function(e){return Z.call(t,e)>-1},o,!0),u=[function(e,i,n){return!r&&(n||i!==D)||((t=i).nodeType?l(e,i,n):c(e,i,n))}];s>a;a++)if(i=E.relative[e[a].type])u=[p(f(u),i)];else{if(i=E.filter[e[a].type].apply(null,e[a].matches),i[O]){for(n=++a;s>n&&!E.relative[e[n].type];n++);return m(a>1&&f(u),a>1&&d(e.slice(0,a-1)).replace(oe,"$1"),i,n>a&&v(e.slice(a,n)),s>n&&v(e=e.slice(n)),s>n&&d(e))}u.push(i)}return f(u)}function y(e,t){var i=0,n=t.length>0,r=e.length>0,a=function(s,a,l,c,u){var h,d,p,f=[],m=0,v="0",y=s&&[],_=null!=u,b=D,w=s||r&&E.find.TAG("*",u&&a.parentNode||a),C=z+=null==b?1:Math.random()||.1;for(_&&(D=a!==$&&a,x=i);null!=(h=w[v]);v++){if(r&&h){for(d=0;p=e[d++];)if(p(h,a,l)){c.push(h);break}_&&(z=C,x=++i)}n&&((h=!p&&h)&&m--,s&&y.push(h))}if(m+=v,n&&v!==m){for(d=0;p=t[d++];)p(y,f,a,l);if(s){if(m>0)for(;v--;)y[v]||f[v]||(f[v]=Y.call(c));f=g(f)}X.apply(c,f),_&&!s&&f.length>0&&m+t.length>1&&o.uniqueSort(c)}return _&&(z=C,D=b),y};return n?s(a):a}function _(e,t,i){for(var n=0,s=t.length;s>n;n++)o(e,t[n],i);return i}function b(e,t,i,n){var s,r,o,a,l,c=h(e);if(!n&&1===c.length){if(r=c[0]=c[0].slice(0),r.length>2&&"ID"===(o=r[0]).type&&9===t.nodeType&&!j&&E.relative[r[1].type]){if(t=E.find.ID(o.matches[0].replace(be,we),t)[0],!t)return i;e=e.slice(r.shift().value.length)}for(s=de.needsContext.test(e)?0:r.length;s--&&(o=r[s],!E.relative[a=o.type]);)if((l=E.find[a])&&(n=l(o.matches[0].replace(be,we),pe.test(r[0].type)&&t.parentNode||t))){if(r.splice(s,1),e=n.length&&d(r),!e)return X.apply(i,J.call(n,0)),i;break}}return k(e,c)(n,t,j,i,pe.test(e)),i}function w(){}var C,x,E,S,A,k,F,D,T,$,B,j,M,L,I,P,R,O="sizzle"+-new Date,N=e.document,q={},z=0,H=0,V=n(),W=n(),U=n(),Q=typeof t,G=1<<31,K=[],Y=K.pop,X=K.push,J=K.slice,Z=K.indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(this[t]===e)return t;return-1},ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ie=te.replace("w","w#"),ne="([*^$|!~]?=)",se="\\["+ee+"*("+te+")"+ee+"*(?:"+ne+ee+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ie+")|)|)"+ee+"*\\]",re=":("+te+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+se.replace(3,8)+")*)|.*)\\)|)",oe=RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),ae=RegExp("^"+ee+"*,"+ee+"*"),ce=RegExp("^"+ee+"*([\\x20\\t\\r\\n\\f>+~])"+ee+"*"),ue=RegExp(re),he=RegExp("^"+ie+"$"),de={
ID:RegExp("^#("+te+")"),CLASS:RegExp("^\\.("+te+")"),NAME:RegExp("^\\[name=['\"]?("+te+")['\"]?\\]"),TAG:RegExp("^("+te.replace("w","w*")+")"),ATTR:RegExp("^"+se),PSEUDO:RegExp("^"+re),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),needsContext:RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},pe=/[\x20\t\r\n\f]*[+~]/,fe=/^[^{]+\{\s*\[native code/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,me=/^(?:input|select|textarea|button)$/i,ve=/^h\d$/i,ye=/'|\\/g,_e=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,be=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,we=function(e,t){var i="0x"+t-65536;return i!==i?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(55296|i>>10,56320|1023&i)};try{J.call(N.documentElement.childNodes,0)[0].nodeType}catch(Ce){J=function(e){for(var t,i=[];t=this[e++];)i.push(t);return i}}A=o.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},T=o.setDocument=function(e){var n=e?e.ownerDocument||e:N;return n!==$&&9===n.nodeType&&n.documentElement?($=n,B=n.documentElement,j=A(n),q.tagNameNoComments=r(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),q.attributes=r(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return"boolean"!==t&&"string"!==t}),q.getByClassName=r(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",e.getElementsByClassName&&e.getElementsByClassName("e").length?(e.lastChild.className="e",2===e.getElementsByClassName("e").length):!1}),q.getByName=r(function(e){e.id=O+0,e.innerHTML="<a name='"+O+"'></a><div name='"+O+"'></div>",B.insertBefore(e,B.firstChild);var t=n.getElementsByName&&n.getElementsByName(O).length===2+n.getElementsByName(O+0).length;return q.getIdNotName=!n.getElementById(O),B.removeChild(e),t}),E.attrHandle=r(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==Q&&"#"===e.firstChild.getAttribute("href")})?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},q.getIdNotName?(E.find.ID=function(e,t){if(typeof t.getElementById!==Q&&!j){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},E.filter.ID=function(e){var t=e.replace(be,we);return function(e){return e.getAttribute("id")===t}}):(E.find.ID=function(e,i){if(typeof i.getElementById!==Q&&!j){var n=i.getElementById(e);return n?n.id===e||typeof n.getAttributeNode!==Q&&n.getAttributeNode("id").value===e?[n]:t:[]}},E.filter.ID=function(e){var t=e.replace(be,we);return function(e){var i=typeof e.getAttributeNode!==Q&&e.getAttributeNode("id");return i&&i.value===t}}),E.find.TAG=q.tagNameNoComments?function(e,i){return typeof i.getElementsByTagName!==Q?i.getElementsByTagName(e):t}:function(e,t){var i,n=[],s=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},E.find.NAME=q.getByName&&function(e,i){return typeof i.getElementsByName!==Q?i.getElementsByName(name):t},E.find.CLASS=q.getByClassName&&function(e,i){return typeof i.getElementsByClassName===Q||j?t:i.getElementsByClassName(e)},L=[],M=[":focus"],(q.qsa=i(n.querySelectorAll))&&(r(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||M.push("\\["+ee+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||M.push(":checked")}),r(function(e){e.innerHTML="<input type='hidden' i=''/>",e.querySelectorAll("[i^='']").length&&M.push("[*^$]="+ee+"*(?:\"\"|'')"),e.querySelectorAll(":enabled").length||M.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),M.push(",.*:")})),(q.matchesSelector=i(I=B.matchesSelector||B.mozMatchesSelector||B.webkitMatchesSelector||B.oMatchesSelector||B.msMatchesSelector))&&r(function(e){q.disconnectedMatch=I.call(e,"div"),I.call(e,"[s!='']:x"),L.push("!=",re)}),M=RegExp(M.join("|")),L=RegExp(L.join("|")),P=i(B.contains)||B.compareDocumentPosition?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},R=B.compareDocumentPosition?function(e,t){var i;return e===t?(F=!0,0):(i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t))?1&i||e.parentNode&&11===e.parentNode.nodeType?e===n||P(N,e)?-1:t===n||P(N,t)?1:0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,s=0,r=e.parentNode,o=t.parentNode,l=[e],c=[t];if(e===t)return F=!0,0;if(!r||!o)return e===n?-1:t===n?1:r?-1:o?1:0;if(r===o)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[s]===c[s];)s++;return s?a(l[s],c[s]):l[s]===N?-1:c[s]===N?1:0},F=!1,[0,0].sort(R),q.detectDuplicates=F,$):$},o.matches=function(e,t){return o(e,null,null,t)},o.matchesSelector=function(e,t){if((e.ownerDocument||e)!==$&&T(e),t=t.replace(_e,"='$1']"),!(!q.matchesSelector||j||L&&L.test(t)||M.test(t)))try{var i=I.call(e,t);if(i||q.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(n){}return o(t,$,null,[e]).length>0},o.contains=function(e,t){return(e.ownerDocument||e)!==$&&T(e),P(e,t)},o.attr=function(e,t){var i;return(e.ownerDocument||e)!==$&&T(e),j||(t=t.toLowerCase()),(i=E.attrHandle[t])?i(e):j||q.attributes?e.getAttribute(t):((i=e.getAttributeNode(t))||e.getAttribute(t))&&e[t]===!0?t:i&&i.specified?i.value:null},o.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},o.uniqueSort=function(e){var t,i=[],n=1,s=0;if(F=!q.detectDuplicates,e.sort(R),F){for(;t=e[n];n++)t===e[n-1]&&(s=i.push(n));for(;s--;)e.splice(i[s],1)}return e},S=o.getText=function(e){var t,i="",n=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[n];n++)i+=S(t);return i},E=o.selectors={cacheLength:50,createPseudo:s,match:de,find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,we),e[3]=(e[4]||e[5]||"").replace(be,we),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||o.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&o.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return de.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:i&&ue.test(i)&&(t=h(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){return"*"===e?function(){return!0}:(e=e.replace(be,we).toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=V[e+" "];return t||(t=RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&V(e,function(e){return t.test(e.className||typeof e.getAttribute!==Q&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var s=o.attr(n,e);return null==s?"!="===t:t?(s+="","="===t?s===i:"!="===t?s!==i:"^="===t?i&&0===s.indexOf(i):"*="===t?i&&s.indexOf(i)>-1:"$="===t?i&&s.slice(-i.length)===i:"~="===t?(" "+s+" ").indexOf(i)>-1:"|="===t?s===i||s.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,i,n,s){var r="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===s?function(e){return!!e.parentNode}:function(t,i,l){var c,u,h,d,p,f,g=r!==o?"nextSibling":"previousSibling",m=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!l&&!a;if(m){if(r){for(;g;){for(h=t;h=h[g];)if(a?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?m.firstChild:m.lastChild],o&&y){for(u=m[O]||(m[O]={}),c=u[e]||[],p=c[0]===z&&c[1],d=c[0]===z&&c[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===t){u[e]=[z,p,d];break}}else if(y&&(c=(t[O]||(t[O]={}))[e])&&c[0]===z)d=c[1];else for(;(h=++p&&h&&h[g]||(d=p=0)||f.pop())&&((a?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[O]||(h[O]={}))[e]=[z,d]),h!==t)););return d-=s,d===n||0===d%n&&d/n>=0}}},PSEUDO:function(e,t){var i,n=E.pseudos[e]||E.setFilters[e.toLowerCase()]||o.error("unsupported pseudo: "+e);return n[O]?n(t):n.length>1?(i=[e,e,"",t],E.setFilters.hasOwnProperty(e.toLowerCase())?s(function(e,i){for(var s,r=n(e,t),o=r.length;o--;)s=Z.call(e,r[o]),e[s]=!(i[s]=r[o])}):function(e){return n(e,0,i)}):n}},pseudos:{not:s(function(e){var t=[],i=[],n=k(e.replace(oe,"$1"));return n[O]?s(function(e,t,i,s){for(var r,o=n(e,null,s,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))}):function(e,s,r){return t[0]=e,n(t,null,r,i),!i.pop()}}),has:s(function(e){return function(t){return o(e,t).length>0}}),contains:s(function(e){return function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:s(function(e){return he.test(e||"")||o.error("unsupported lang: "+e),e=e.replace(be,we).toLowerCase(),function(t){var i;do if(i=j?t.getAttribute("xml:lang")||t.getAttribute("lang"):t.lang)return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===B},focus:function(e){return e===$.activeElement&&(!$.hasFocus||$.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!E.pseudos.empty(e)},header:function(e){return ve.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,i){return[0>i?i+t:i]}),even:u(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:u(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:u(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:u(function(e,t,i){for(var n=0>i?i+t:i;t>++n;)e.push(n);return e})}};for(C in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})E.pseudos[C]=l(C);for(C in{submit:!0,reset:!0})E.pseudos[C]=c(C);k=o.compile=function(e,t){var i,n=[],s=[],r=U[e+" "];if(!r){for(t||(t=h(e)),i=t.length;i--;)r=v(t[i]),r[O]?n.push(r):s.push(r);r=U(e,y(s,n))}return r},E.pseudos.nth=E.pseudos.eq,E.filters=w.prototype=E.pseudos,E.setFilters=new w,T(),o.attr=le.attr,le.find=o,le.expr=o.selectors,le.expr[":"]=le.expr.pseudos,le.unique=o.uniqueSort,le.text=o.getText,le.isXMLDoc=o.isXML,le.contains=o.contains}(e);var qe=/Until$/,ze=/^(?:parents|prev(?:Until|All))/,He=/^.[^:#\[\.,]*$/,Ve=le.expr.match.needsContext,We={children:!0,contents:!0,next:!0,prev:!0};le.fn.extend({find:function(e){var t,i,n,s=this.length;if("string"!=typeof e)return n=this,this.pushStack(le(e).filter(function(){for(t=0;s>t;t++)if(le.contains(n[t],this))return!0}));for(i=[],t=0;s>t;t++)le.find(e,this[t],i);return i=this.pushStack(s>1?le.unique(i):i),i.selector=(this.selector?this.selector+" ":"")+e,i},has:function(e){var t,i=le(e,this),n=i.length;return this.filter(function(){for(t=0;n>t;t++)if(le.contains(this,i[t]))return!0})},not:function(e){return this.pushStack(h(this,e,!1))},filter:function(e){return this.pushStack(h(this,e,!0))},is:function(e){return!!e&&("string"==typeof e?Ve.test(e)?le(e,this.context).index(this[0])>=0:le.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){for(var i,n=0,s=this.length,r=[],o=Ve.test(e)||"string"!=typeof e?le(e,t||this.context):0;s>n;n++)for(i=this[n];i&&i.ownerDocument&&i!==t&&11!==i.nodeType;){if(o?o.index(i)>-1:le.find.matchesSelector(i,e)){r.push(i);break}i=i.parentNode}return this.pushStack(r.length>1?le.unique(r):r)},index:function(e){return e?"string"==typeof e?le.inArray(this[0],le(e)):le.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var i="string"==typeof e?le(e,t):le.makeArray(e&&e.nodeType?[e]:e),n=le.merge(this.get(),i);return this.pushStack(le.unique(n))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),le.fn.andSelf=le.fn.addBack,le.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return le.dir(e,"parentNode")},parentsUntil:function(e,t,i){return le.dir(e,"parentNode",i)},next:function(e){return u(e,"nextSibling")},prev:function(e){return u(e,"previousSibling")},nextAll:function(e){return le.dir(e,"nextSibling")},prevAll:function(e){return le.dir(e,"previousSibling")},nextUntil:function(e,t,i){return le.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return le.dir(e,"previousSibling",i)},siblings:function(e){return le.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return le.sibling(e.firstChild)},contents:function(e){return le.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:le.merge([],e.childNodes)}},function(e,t){le.fn[e]=function(i,n){var s=le.map(this,t,i);return qe.test(e)||(n=i),n&&"string"==typeof n&&(s=le.filter(n,s)),s=this.length>1&&!We[e]?le.unique(s):s,this.length>1&&ze.test(e)&&(s=s.reverse()),this.pushStack(s)}}),le.extend({filter:function(e,t,i){return i&&(e=":not("+e+")"),1===t.length?le.find.matchesSelector(t[0],e)?[t[0]]:[]:le.find.matches(e,t)},dir:function(e,i,n){for(var s=[],r=e[i];r&&9!==r.nodeType&&(n===t||1!==r.nodeType||!le(r).is(n));)1===r.nodeType&&s.push(r),r=r[i];return s},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}});var Ue="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Qe=/ jQuery\d+="(?:null|\d+)"/g,Ge=RegExp("<(?:"+Ue+")[\\s/>]","i"),Ke=/^\s+/,Ye=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Xe=/<([\w:]+)/,Je=/<tbody/i,Ze=/<|&#?\w+;/,et=/<(?:script|style|link)/i,tt=/^(?:checkbox|radio)$/i,it=/checked\s*(?:[^=]|=\s*.checked.)/i,nt=/^$|\/(?:java|ecma)script/i,st=/^true\/(.*)/,rt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ot={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:le.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},at=d(G),lt=at.appendChild(G.createElement("div"));ot.optgroup=ot.option,ot.tbody=ot.tfoot=ot.colgroup=ot.caption=ot.thead,ot.th=ot.td,le.fn.extend({text:function(e){return le.access(this,function(e){return e===t?le.text(this):this.empty().append((this[0]&&this[0].ownerDocument||G).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(le.isFunction(e))return this.each(function(t){le(this).wrapAll(e.call(this,t))});if(this[0]){var t=le(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return le.isFunction(e)?this.each(function(t){le(this).wrapInner(e.call(this,t))}):this.each(function(){var t=le(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=le.isFunction(e);return this.each(function(i){le(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){le.nodeName(this,"body")||le(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&this.insertBefore(e,this.firstChild)})},before:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,!1,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=0;null!=(i=this[n]);n++)(!e||le.filter(e,[i]).length>0)&&(t||1!==i.nodeType||le.cleanData(_(i)),i.parentNode&&(t&&le.contains(i.ownerDocument,i)&&m(_(i,"script")),i.parentNode.removeChild(i)));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&le.cleanData(_(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&le.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return le.clone(this,e,t)})},html:function(e){return le.access(this,function(e){var i=this[0]||{},n=0,s=this.length;if(e===t)return 1===i.nodeType?i.innerHTML.replace(Qe,""):t;if(!("string"!=typeof e||et.test(e)||!le.support.htmlSerialize&&Ge.test(e)||!le.support.leadingWhitespace&&Ke.test(e)||ot[(Xe.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Ye,"<$1></$2>");try{for(;s>n;n++)i=this[n]||{},1===i.nodeType&&(le.cleanData(_(i,!1)),i.innerHTML=e);i=0}catch(r){}}i&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){var t=le.isFunction(e);return t||"string"==typeof e||(e=le(e).not(this).detach()),this.domManip([e],!0,function(e){var t=this.nextSibling,i=this.parentNode;i&&(le(this).remove(),i.insertBefore(e,t))})},detach:function(e){return this.remove(e,!0)},domManip:function(e,i,n){e=te.apply([],e);var s,r,o,a,l,c,u=0,h=this.length,d=this,m=h-1,v=e[0],y=le.isFunction(v);if(y||!(1>=h||"string"!=typeof v||le.support.checkClone)&&it.test(v))return this.each(function(s){var r=d.eq(s);y&&(e[0]=v.call(this,s,i?r.html():t)),r.domManip(e,i,n)});if(h&&(c=le.buildFragment(e,this[0].ownerDocument,!1,this),s=c.firstChild,1===c.childNodes.length&&(c=s),s)){for(i=i&&le.nodeName(s,"tr"),a=le.map(_(c,"script"),f),o=a.length;h>u;u++)r=c,u!==m&&(r=le.clone(r,!0,!0),o&&le.merge(a,_(r,"script"))),n.call(i&&le.nodeName(this[u],"table")?p(this[u],"tbody"):this[u],r,u);if(o)for(l=a[a.length-1].ownerDocument,le.map(a,g),u=0;o>u;u++)r=a[u],nt.test(r.type||"")&&!le._data(r,"globalEval")&&le.contains(l,r)&&(r.src?le.ajax({url:r.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):le.globalEval((r.text||r.textContent||r.innerHTML||"").replace(rt,"")));c=s=null}return this}}),le.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){le.fn[e]=function(e){for(var i,n=0,s=[],r=le(e),o=r.length-1;o>=n;n++)i=n===o?this:this.clone(!0),le(r[n])[t](i),ie.apply(s,i.get());return this.pushStack(s)}}),le.extend({clone:function(e,t,i){var n,s,r,o,a,l=le.contains(e.ownerDocument,e);if(le.support.html5Clone||le.isXMLDoc(e)||!Ge.test("<"+e.nodeName+">")?r=e.cloneNode(!0):(lt.innerHTML=e.outerHTML,lt.removeChild(r=lt.firstChild)),!(le.support.noCloneEvent&&le.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||le.isXMLDoc(e)))for(n=_(r),a=_(e),o=0;null!=(s=a[o]);++o)n[o]&&y(s,n[o]);if(t)if(i)for(a=a||_(e),n=n||_(r),o=0;null!=(s=a[o]);o++)v(s,n[o]);else v(e,r);return n=_(r,"script"),n.length>0&&m(n,!l&&_(e,"script")),n=a=s=null,r},buildFragment:function(e,t,i,n){for(var s,r,o,a,l,c,u,h=e.length,p=d(t),f=[],g=0;h>g;g++)if(r=e[g],r||0===r)if("object"===le.type(r))le.merge(f,r.nodeType?[r]:r);else if(Ze.test(r)){for(a=a||p.appendChild(t.createElement("div")),l=(Xe.exec(r)||["",""])[1].toLowerCase(),u=ot[l]||ot._default,a.innerHTML=u[1]+r.replace(Ye,"<$1></$2>")+u[2],s=u[0];s--;)a=a.lastChild;if(!le.support.leadingWhitespace&&Ke.test(r)&&f.push(t.createTextNode(Ke.exec(r)[0])),!le.support.tbody)for(r="table"!==l||Je.test(r)?"<table>"!==u[1]||Je.test(r)?0:a:a.firstChild,s=r&&r.childNodes.length;s--;)le.nodeName(c=r.childNodes[s],"tbody")&&!c.childNodes.length&&r.removeChild(c);for(le.merge(f,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=p.lastChild}else f.push(t.createTextNode(r));for(a&&p.removeChild(a),le.support.appendChecked||le.grep(_(f,"input"),b),g=0;r=f[g++];)if((!n||-1===le.inArray(r,n))&&(o=le.contains(r.ownerDocument,r),a=_(p.appendChild(r),"script"),o&&m(a),i))for(s=0;r=a[s++];)nt.test(r.type||"")&&i.push(r);return a=null,p},cleanData:function(e,t){for(var i,n,s,r,o=0,a=le.expando,l=le.cache,c=le.support.deleteExpando,u=le.event.special;null!=(i=e[o]);o++)if((t||le.acceptData(i))&&(s=i[a],r=s&&l[s])){if(r.events)for(n in r.events)u[n]?le.event.remove(i,n):le.removeEvent(i,n,r.handle);l[s]&&(delete l[s],c?delete i[a]:typeof i.removeAttribute!==Q?i.removeAttribute(a):i[a]=null,Z.push(s))}}});var ct,ut,ht,dt=/alpha\([^)]*\)/i,pt=/opacity\s*=\s*([^)]*)/,ft=/^(top|right|bottom|left)$/,gt=/^(none|table(?!-c[ea]).+)/,mt=/^margin/,vt=RegExp("^("+ce+")(.*)$","i"),yt=RegExp("^("+ce+")(?!px)[a-z%]+$","i"),_t=RegExp("^([+-])=("+ce+")","i"),bt={BODY:"block"},wt={position:"absolute",visibility:"hidden",display:"block"},Ct={letterSpacing:0,fontWeight:400},xt=["Top","Right","Bottom","Left"],Et=["Webkit","O","Moz","ms"];le.fn.extend({css:function(e,i){return le.access(this,function(e,i,n){var s,r,o={},a=0;if(le.isArray(i)){for(r=ut(e),s=i.length;s>a;a++)o[i[a]]=le.css(e,i[a],!1,r);return o}return n!==t?le.style(e,i,n):le.css(e,i)},e,i,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){var t="boolean"==typeof e;return this.each(function(){(t?e:C(this))?le(this).show():le(this).hide()})}}),le.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=ht(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":le.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,i,n,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,a,l=le.camelCase(i),c=e.style;if(i=le.cssProps[l]||(le.cssProps[l]=w(c,l)),a=le.cssHooks[i]||le.cssHooks[l],n===t)return a&&"get"in a&&(r=a.get(e,!1,s))!==t?r:c[i];if(o=typeof n,"string"===o&&(r=_t.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(le.css(e,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||le.cssNumber[l]||(n+="px"),le.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(c[i]="inherit"),a&&"set"in a&&(n=a.set(e,n,s))===t)))try{c[i]=n}catch(u){}}},css:function(e,i,n,s){var r,o,a,l=le.camelCase(i);return i=le.cssProps[l]||(le.cssProps[l]=w(e.style,l)),a=le.cssHooks[i]||le.cssHooks[l],a&&"get"in a&&(o=a.get(e,!0,n)),o===t&&(o=ht(e,i,s)),"normal"===o&&i in Ct&&(o=Ct[i]),""===n||n?(r=parseFloat(o),n===!0||le.isNumeric(r)?r||0:o):o},swap:function(e,t,i,n){var s,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];s=i.apply(e,n||[]);for(r in t)e.style[r]=o[r];return s}}),e.getComputedStyle?(ut=function(t){return e.getComputedStyle(t,null)},ht=function(e,i,n){var s,r,o,a=n||ut(e),l=a?a.getPropertyValue(i)||a[i]:t,c=e.style;return a&&(""!==l||le.contains(e.ownerDocument,e)||(l=le.style(e,i)),yt.test(l)&&mt.test(i)&&(s=c.width,r=c.minWidth,o=c.maxWidth,c.minWidth=c.maxWidth=c.width=l,l=a.width,c.width=s,c.minWidth=r,c.maxWidth=o)),l}):G.documentElement.currentStyle&&(ut=function(e){return e.currentStyle},ht=function(e,i,n){var s,r,o,a=n||ut(e),l=a?a[i]:t,c=e.style;return null==l&&c&&c[i]&&(l=c[i]),yt.test(l)&&!ft.test(i)&&(s=c.left,r=e.runtimeStyle,o=r&&r.left,o&&(r.left=e.currentStyle.left),c.left="fontSize"===i?"1em":l,l=c.pixelLeft+"px",c.left=s,o&&(r.left=o)),""===l?"auto":l}),le.each(["height","width"],function(e,i){le.cssHooks[i]={get:function(e,n,s){return n?0===e.offsetWidth&&gt.test(le.css(e,"display"))?le.swap(e,wt,function(){return A(e,i,s)}):A(e,i,s):t},set:function(e,t,n){var s=n&&ut(e);return E(e,t,n?S(e,i,n,le.support.boxSizing&&"border-box"===le.css(e,"boxSizing",!1,s),s):0)}}}),le.support.opacity||(le.cssHooks.opacity={get:function(e,t){return pt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,s=le.isNumeric(t)?"alpha(opacity="+100*t+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===le.trim(r.replace(dt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=dt.test(r)?r.replace(dt,s):r+" "+s)}}),le(function(){le.support.reliableMarginRight||(le.cssHooks.marginRight={get:function(e,i){return i?le.swap(e,{display:"inline-block"},ht,[e,"marginRight"]):t}}),!le.support.pixelPosition&&le.fn.position&&le.each(["top","left"],function(e,i){le.cssHooks[i]={get:function(e,n){return n?(n=ht(e,i),yt.test(n)?le(e).position()[i]+"px":n):t}}})}),le.expr&&le.expr.filters&&(le.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!le.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||le.css(e,"display"))},le.expr.filters.visible=function(e){return!le.expr.filters.hidden(e)}),le.each({margin:"",padding:"",border:"Width"},function(e,t){le.cssHooks[e+t]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];4>n;n++)s[e+xt[n]+t]=r[n]||r[n-2]||r[0];return s}},mt.test(e)||(le.cssHooks[e+t].set=E)});var St=/%20/g,At=/\[\]$/,kt=/\r?\n/g,Ft=/^(?:submit|button|image|reset|file)$/i,Dt=/^(?:input|select|textarea|keygen)/i;le.fn.extend({serialize:function(){return le.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=le.prop(this,"elements");return e?le.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!le(this).is(":disabled")&&Dt.test(this.nodeName)&&!Ft.test(e)&&(this.checked||!tt.test(e))}).map(function(e,t){var i=le(this).val();return null==i?null:le.isArray(i)?le.map(i,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:i.replace(kt,"\r\n")}}).get()}}),le.param=function(e,i){var n,s=[],r=function(e,t){t=le.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(i===t&&(i=le.ajaxSettings&&le.ajaxSettings.traditional),le.isArray(e)||e.jquery&&!le.isPlainObject(e))le.each(e,function(){r(this.name,this.value)});else for(n in e)D(n,e[n],i,r);return s.join("&").replace(St,"+")},le.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){le.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),le.fn.hover=function(e,t){return this.mouseenter(e).mouseleave(t||e)};var Tt,$t,Bt=le.now(),jt=/\?/,Mt=/#.*$/,Lt=/([?&])_=[^&]*/,It=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Rt=/^(?:GET|HEAD)$/,Ot=/^\/\//,Nt=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,qt=le.fn.load,zt={},Ht={},Vt="*/".concat("*");try{$t=K.href}catch(Wt){$t=G.createElement("a"),$t.href="",$t=$t.href}Tt=Nt.exec($t.toLowerCase())||[],le.fn.load=function(e,i,n){if("string"!=typeof e&&qt)return qt.apply(this,arguments);var s,r,o,a=this,l=e.indexOf(" ");return l>=0&&(s=e.slice(l,e.length),e=e.slice(0,l)),le.isFunction(i)?(n=i,i=t):i&&"object"==typeof i&&(o="POST"),a.length>0&&le.ajax({url:e,type:o,dataType:"html",data:i}).done(function(e){r=arguments,a.html(s?le("<div>").append(le.parseHTML(e)).find(s):e)}).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},le.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){le.fn[t]=function(e){return this.on(t,e)}}),le.each(["get","post"],function(e,i){le[i]=function(e,n,s,r){return le.isFunction(n)&&(r=r||s,s=n,n=t),le.ajax({url:e,type:i,dataType:r,data:n,success:s})}}),le.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:$t,type:"GET",isLocal:Pt.test(Tt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Vt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":le.parseJSON,"text xml":le.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?B(B(e,le.ajaxSettings),t):B(le.ajaxSettings,e)},ajaxPrefilter:T(zt),ajaxTransport:T(Ht),ajax:function(e,i){function n(e,i,n,s){var r,h,y,_,w,x=i;2!==b&&(b=2,l&&clearTimeout(l),u=t,a=s||"",C.readyState=e>0?4:0,n&&(_=j(d,C,n)),e>=200&&300>e||304===e?(d.ifModified&&(w=C.getResponseHeader("Last-Modified"),w&&(le.lastModified[o]=w),w=C.getResponseHeader("etag"),w&&(le.etag[o]=w)),204===e?(r=!0,x="nocontent"):304===e?(r=!0,x="notmodified"):(r=M(d,_),x=r.state,h=r.data,y=r.error,r=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),C.status=e,C.statusText=(i||x)+"",r?g.resolveWith(p,[h,x,C]):g.rejectWith(p,[C,x,y]),C.statusCode(v),v=t,c&&f.trigger(r?"ajaxSuccess":"ajaxError",[C,d,r?h:y]),m.fireWith(p,[C,x]),c&&(f.trigger("ajaxComplete",[C,d]),--le.active||le.event.trigger("ajaxStop")))}"object"==typeof e&&(i=e,e=t),i=i||{};var s,r,o,a,l,c,u,h,d=le.ajaxSetup({},i),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?le(p):le.event,g=le.Deferred(),m=le.Callbacks("once memory"),v=d.statusCode||{},y={},_={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!h)for(h={};t=It.exec(a);)h[t[1].toLowerCase()]=t[2];t=h[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?a:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=_[i]=_[i]||e,y[e]=t),this},overrideMimeType:function(e){return b||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)v[t]=[v[t],e[t]];else C.always(e[C.status]);return this},abort:function(e){var t=e||w;return u&&u.abort(t),n(0,t),this}};if(g.promise(C).complete=m.add,C.success=C.done,C.error=C.fail,d.url=((e||d.url||$t)+"").replace(Mt,"").replace(Ot,Tt[1]+"//"),d.type=i.method||i.type||d.method||d.type,d.dataTypes=le.trim(d.dataType||"*").toLowerCase().match(ue)||[""],null==d.crossDomain&&(s=Nt.exec(d.url.toLowerCase()),d.crossDomain=!(!s||s[1]===Tt[1]&&s[2]===Tt[2]&&(s[3]||("http:"===s[1]?80:443))==(Tt[3]||("http:"===Tt[1]?80:443)))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=le.param(d.data,d.traditional)),$(zt,d,i,C),2===b)return C;c=d.global,c&&0===le.active++&&le.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Rt.test(d.type),o=d.url,d.hasContent||(d.data&&(o=d.url+=(jt.test(o)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Lt.test(o)?o.replace(Lt,"$1_="+Bt++):o+(jt.test(o)?"&":"?")+"_="+Bt++)),d.ifModified&&(le.lastModified[o]&&C.setRequestHeader("If-Modified-Since",le.lastModified[o]),le.etag[o]&&C.setRequestHeader("If-None-Match",le.etag[o])),(d.data&&d.hasContent&&d.contentType!==!1||i.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Vt+"; q=0.01":""):d.accepts["*"]);for(r in d.headers)C.setRequestHeader(r,d.headers[r]);if(d.beforeSend&&(d.beforeSend.call(p,C,d)===!1||2===b))return C.abort();w="abort";for(r in{
success:1,error:1,complete:1})C[r](d[r]);if(u=$(Ht,d,i,C)){C.readyState=1,c&&f.trigger("ajaxSend",[C,d]),d.async&&d.timeout>0&&(l=setTimeout(function(){C.abort("timeout")},d.timeout));try{b=1,u.send(y,n)}catch(x){if(!(2>b))throw x;n(-1,x)}}else n(-1,"No Transport");return C},getScript:function(e,i){return le.get(e,t,i,"script")},getJSON:function(e,t,i){return le.get(e,t,i,"json")}}),le.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return le.globalEval(e),e}}}),le.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),le.ajaxTransport("script",function(e){if(e.crossDomain){var i,n=G.head||le("head")[0]||G.documentElement;return{send:function(t,s){i=G.createElement("script"),i.async=!0,e.scriptCharset&&(i.charset=e.scriptCharset),i.src=e.url,i.onload=i.onreadystatechange=function(e,t){(t||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,t||s(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(t,!0)}}}});var Ut=[],Qt=/(=)\?(?=&|$)|\?\?/;le.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ut.pop()||le.expando+"_"+Bt++;return this[e]=!0,e}}),le.ajaxPrefilter("json jsonp",function(i,n,s){var r,o,a,l=i.jsonp!==!1&&(Qt.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(r=i.jsonpCallback=le.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Qt,"$1"+r):i.jsonp!==!1&&(i.url+=(jt.test(i.url)?"&":"?")+i.jsonp+"="+r),i.converters["script json"]=function(){return a||le.error(r+" was not called"),a[0]},i.dataTypes[0]="json",o=e[r],e[r]=function(){a=arguments},s.always(function(){e[r]=o,i[r]&&(i.jsonpCallback=n.jsonpCallback,Ut.push(r)),a&&le.isFunction(o)&&o(a[0]),a=o=t}),"script"):t});var Gt,Kt,Yt=0,Xt=e.ActiveXObject&&function(){var e;for(e in Gt)Gt[e](t,!0)};le.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&L()||I()}:L,Kt=le.ajaxSettings.xhr(),le.support.cors=!!Kt&&"withCredentials"in Kt,Kt=le.support.ajax=!!Kt,Kt&&le.ajaxTransport(function(i){if(!i.crossDomain||le.support.cors){var n;return{send:function(s,r){var o,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(a in s)l.setRequestHeader(a,s[a])}catch(c){}l.send(i.hasContent&&i.data||null),n=function(e,s){var a,c,u,h;try{if(n&&(s||4===l.readyState))if(n=t,o&&(l.onreadystatechange=le.noop,Xt&&delete Gt[o]),s)4!==l.readyState&&l.abort();else{h={},a=l.status,c=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(h.text=l.responseText);try{u=l.statusText}catch(d){u=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=h.text?200:404}}catch(p){s||r(-1,p)}h&&r(a,u,h,c)},i.async?4===l.readyState?setTimeout(n):(o=++Yt,Xt&&(Gt||(Gt={},le(e).unload(Xt)),Gt[o]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(t,!0)}}}});var Jt,Zt,ei=/^(?:toggle|show|hide)$/,ti=RegExp("^(?:([+-])=|)("+ce+")([a-z%]*)$","i"),ii=/queueHooks$/,ni=[q],si={"*":[function(e,t){var i,n,s=this.createTween(e,t),r=ti.exec(t),o=s.cur(),a=+o||0,l=1,c=20;if(r){if(i=+r[2],n=r[3]||(le.cssNumber[e]?"":"px"),"px"!==n&&a){a=le.css(s.elem,e,!0)||i||1;do l=l||".5",a/=l,le.style(s.elem,e,a+n);while(l!==(l=s.cur()/o)&&1!==l&&--c)}s.unit=n,s.start=a,s.end=r[1]?a+(r[1]+1)*i:i}return s}]};le.Animation=le.extend(O,{tweener:function(e,t){le.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,s=e.length;s>n;n++)i=e[n],si[i]=si[i]||[],si[i].unshift(t)},prefilter:function(e,t){t?ni.unshift(e):ni.push(e)}}),le.Tween=z,z.prototype={constructor:z,init:function(e,t,i,n,s,r){this.elem=e,this.prop=i,this.easing=s||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(le.cssNumber[i]?"":"px")},cur:function(){var e=z.propHooks[this.prop];return e&&e.get?e.get(this):z.propHooks._default.get(this)},run:function(e){var t,i=z.propHooks[this.prop];return this.pos=t=this.options.duration?le.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=le.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){le.fx.step[e.prop]?le.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[le.cssProps[e.prop]]||le.cssHooks[e.prop])?le.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},le.each(["toggle","show","hide"],function(e,t){var i=le.fn[t];le.fn[t]=function(e,n,s){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(H(t,!0),e,n,s)}}),le.fn.extend({fadeTo:function(e,t,i,n){return this.filter(C).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var s=le.isEmptyObject(e),r=le.speed(t,i,n),o=function(){var t=O(this,le.extend({},e),r);o.finish=function(){t.stop(!0)},(s||le._data(this,"finish"))&&t.stop(!0)};return o.finish=o,s||r.queue===!1?this.each(o):this.queue(r.queue,o)},stop:function(e,i,n){var s=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=i,i=e,e=t),i&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",r=le.timers,o=le._data(this);if(i)o[i]&&o[i].stop&&s(o[i]);else for(i in o)o[i]&&o[i].stop&&ii.test(i)&&s(o[i]);for(i=r.length;i--;)r[i].elem!==this||null!=e&&r[i].queue!==e||(r[i].anim.stop(n),t=!1,r.splice(i,1));(t||!n)&&le.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=le._data(this),n=i[e+"queue"],s=i[e+"queueHooks"],r=le.timers,o=n?n.length:0;for(i.finish=!0,le.queue(this,e,[]),s&&s.cur&&s.cur.finish&&s.cur.finish.call(this),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;o>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),le.each({slideDown:H("show"),slideUp:H("hide"),slideToggle:H("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){le.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),le.speed=function(e,t,i){var n=e&&"object"==typeof e?le.extend({},e):{complete:i||!i&&t||le.isFunction(e)&&e,duration:e,easing:i&&t||t&&!le.isFunction(t)&&t};return n.duration=le.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in le.fx.speeds?le.fx.speeds[n.duration]:le.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){le.isFunction(n.old)&&n.old.call(this),n.queue&&le.dequeue(this,n.queue)},n},le.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},le.timers=[],le.fx=z.prototype.init,le.fx.tick=function(){var e,i=le.timers,n=0;for(Jt=le.now();i.length>n;n++)e=i[n],e()||i[n]!==e||i.splice(n--,1);i.length||le.fx.stop(),Jt=t},le.fx.timer=function(e){e()&&le.timers.push(e)&&le.fx.start()},le.fx.interval=13,le.fx.start=function(){Zt||(Zt=setInterval(le.fx.tick,le.fx.interval))},le.fx.stop=function(){clearInterval(Zt),Zt=null},le.fx.speeds={slow:600,fast:200,_default:400},le.fx.step={},le.expr&&le.expr.filters&&(le.expr.filters.animated=function(e){return le.grep(le.timers,function(t){return e===t.elem}).length}),le.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){le.offset.setOffset(this,e,t)});var i,n,s={top:0,left:0},r=this[0],o=r&&r.ownerDocument;return o?(i=o.documentElement,le.contains(i,r)?(typeof r.getBoundingClientRect!==Q&&(s=r.getBoundingClientRect()),n=V(o),{top:s.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):s):void 0},le.offset={setOffset:function(e,t,i){var n=le.css(e,"position");"static"===n&&(e.style.position="relative");var s,r,o=le(e),a=o.offset(),l=le.css(e,"top"),c=le.css(e,"left"),u=("absolute"===n||"fixed"===n)&&le.inArray("auto",[l,c])>-1,h={},d={};u?(d=o.position(),s=d.top,r=d.left):(s=parseFloat(l)||0,r=parseFloat(c)||0),le.isFunction(t)&&(t=t.call(e,i,a)),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):o.css(h)}},le.fn.extend({position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===le.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),le.nodeName(e[0],"html")||(i=e.offset()),i.top+=le.css(e[0],"borderTopWidth",!0),i.left+=le.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-le.css(n,"marginTop",!0),left:t.left-i.left-le.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||G.documentElement;e&&!le.nodeName(e,"html")&&"static"===le.css(e,"position");)e=e.offsetParent;return e||G.documentElement})}}),le.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,i){var n=/Y/.test(i);le.fn[e]=function(s){return le.access(this,function(e,s,r){var o=V(e);return r===t?o?i in o?o[i]:o.document.documentElement[s]:e[s]:(o?o.scrollTo(n?le(o).scrollLeft():r,n?r:le(o).scrollTop()):e[s]=r,t)},e,s,arguments.length,null)}}),le.each({Height:"height",Width:"width"},function(e,i){le.each({padding:"inner"+e,content:i,"":"outer"+e},function(n,s){le.fn[s]=function(s,r){var o=arguments.length&&(n||"boolean"!=typeof s),a=n||(s===!0||r===!0?"margin":"border");return le.access(this,function(i,n,s){var r;return le.isWindow(i)?i.document.documentElement["client"+e]:9===i.nodeType?(r=i.documentElement,Math.max(i.body["scroll"+e],r["scroll"+e],i.body["offset"+e],r["offset"+e],r["client"+e])):s===t?le.css(i,n,a):le.style(i,n,s,a)},i,o?s:t,o,null)}})}),e.jQuery=e.$=le,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return le})}(window),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone-amd",["underscore","jquery","exports"],function(i,n,s){e.Backbone=t(e,s,i,n)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender)}(this,function(e,t,i,n){var s=e.Backbone,r=[],o=r.push,a=r.slice,l=r.splice;t.VERSION="0.9.10",t.$=n,t.noConflict=function(){return e.Backbone=s,this},t.emulateHTTP=!1,t.emulateJSON=!1;var c=/\s+/,u=function(e,t,i,n){if(!i)return!0;if("object"==typeof i)for(var s in i)e[t].apply(e,[s,i[s]].concat(n));else{if(!c.test(i))return!0;for(var r=i.split(c),o=0,a=r.length;a>o;o++)e[t].apply(e,[r[o]].concat(n))}},h=function(e,t){var i,n=-1,s=e.length;switch(t.length){case 0:for(;++n<s;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=e[n]).callback.call(i.ctx,t[0]);return;case 2:for(;++n<s;)(i=e[n]).callback.call(i.ctx,t[0],t[1]);return;case 3:for(;++n<s;)(i=e[n]).callback.call(i.ctx,t[0],t[1],t[2]);return;default:for(;++n<s;)(i=e[n]).callback.apply(i.ctx,t)}},d=t.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var s=this,r=i.once(function(){s.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n),this},off:function(e,t,n){var s,r,o,a,l,c,h,d;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(a=e?[e]:i.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],s=this._events[e]){if(o=[],t||n)for(h=0,d=s.length;d>h;h++)r=s[h],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&o.push(r);this._events[e]=o}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&h(i,t),n&&h(n,arguments),this},listenTo:function(e,t,n){var s=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=i.uniqueId("l"));return s[r]=e,e.on(t,"object"==typeof t?this:n,this),this},stopListening:function(e,t,i){var n=this._listeners;if(n){if(e)e.off(t,"object"==typeof t?this:i,this),t||i||delete n[e._listenerId];else{"object"==typeof t&&(i=this);for(var s in n)n[s].off(t,i,this);this._listeners={}}return this}}};d.bind=d.on,d.unbind=d.off,i.extend(t,d);var p=t.Model=function(e,t){var n,s=e||{};this.cid=i.uniqueId("c"),this.attributes={},t&&t.collection&&(this.collection=t.collection),t&&t.parse&&(s=this.parse(s,t)||{}),(n=i.result(this,"defaults"))&&(s=i.defaults({},s,n)),this.set(s,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(p.prototype,d,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var s,r,o,a,l,c,u,h;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;o=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(s in r)t=r[s],i.isEqual(h[s],t)||a.push(s),i.isEqual(u[s],t)?delete this.changed[s]:this.changed[s]=t,o?delete h[s]:h[s]=t;if(!l){a.length&&(this._pending=!0);for(var d=0,p=a.length;p>d;d++)this.trigger("change:"+a[d],this,h[a[d]],n)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,s=this._changing?this._previousAttributes:this.attributes;for(var r in e)i.isEqual(s[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){return e.set(e.parse(i,n),n)?void(t&&t(e,i,n)):!1},this.sync("read",this,e)},save:function(e,t,n){var s,r,o,a,l=this.attributes;return null==e||"object"==typeof e?(s=e,n=t):(s={})[e]=t,!s||n&&n.wait||this.set(s,n)?(n=i.extend({validate:!0},n),this._validate(s,n)?(s&&n.wait&&(this.attributes=i.extend({},l,s)),void 0===n.parse&&(n.parse=!0),r=n.success,n.success=function(e,t,n){e.attributes=l;var o=e.parse(t,n);return n.wait&&(o=i.extend(s||{},o)),i.isObject(o)&&!e.set(o,n)?!1:void(r&&r(e,t,n))},o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=s),a=this.sync(o,this,n),s&&n.wait&&(this.attributes=l),a):!1):!1},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,s=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(e,t,i){(i.wait||e.isNew())&&s(),n&&n(e,t,i)},this.isNew())return e.success(this,null,e),!1;var r=this.sync("delete",this,e);return e.wait||s(),r},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||B();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))};i.extend(f.prototype,d,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){e=i.isArray(e)?e.slice():[e],t||(t={});var n,s,r,a,c,u,h,d,p,f;for(h=[],d=t.at,p=this.comparator&&null==d&&0!=t.sort,f=i.isString(this.comparator)?this.comparator:null,n=0,s=e.length;s>n;n++)(r=this._prepareModel(a=e[n],t))?(c=this.get(r))?t.merge&&(c.set(a===r?r.attributes:a,t),p&&!u&&c.hasChanged(f)&&(u=!0)):(h.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)):this.trigger("invalid",this,a,t);if(h.length&&(p&&(u=!0),this.length+=h.length,null!=d?l.apply(this.models,[d,0].concat(h)):o.apply(this.models,h)),u&&this.sort({silent:!0}),t.silent)return this;for(n=0,s=h.length;s>n;n++)(r=h[n]).trigger("add",r,this,t);return u&&this.trigger("sort",this,t),this},remove:function(e,t){e=i.isArray(e)?e.slice():[e],t||(t={});var n,s,r,o;for(n=0,s=e.length;s>n;n++)o=this.get(e[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null!=e?(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e]):void 0},at:function(e){return this.models[e]},where:function(e){return i.isEmpty(e)?[]:this.filter(function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},update:function(e,t){t=i.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,s,r,o,a=[],l=[],c={};if(i.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(s=0,r=e.length;r>s;s++)n=e[s],o=this.get(n),t.remove&&o&&(c[o.cid]=!0),(t.add&&!o||t.merge&&o)&&a.push(n);if(t.remove)for(s=0,r=this.models.length;r>s;s++)n=this.models[s],c[n.cid]||l.push(n);return l.length&&this.remove(l,t),a.length&&this.add(a,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,s=this.models.length;s>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,i,n){var s=n.update?"update":"reset";e[s](i,n),t&&t(e,i,n)},this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,s=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),s&&s(e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var s=i.isFunction(t)?t:function(e){return e.get(t)};return i.sortedIndex(this.models,e,s,n)}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(g,function(e){f.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var m=["groupBy","countBy","sortBy"];i.each(m,function(e){f.prototype[e]=function(t,n){var s=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,s,n)}});var v=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,b=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(v.prototype,d,{initialize:function(){},route:function(e,n,s){return i.isRegExp(e)||(e=this._routeToRegExp(e)),s||(s=this[n]),t.history.route(e,i.bind(function(i){var r=this._extractParameters(e,i);s&&s.apply(this,r),this.trigger.apply(this,["route:"+n].concat(r)),this.trigger("route",n,r),t.history.trigger("route",this,n,r)},this)),this},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes)for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(w,"\\$&").replace(y,"(?:$1)?").replace(_,function(e,t){return t?e:"([^/]+)"}).replace(b,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var C=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},x=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,S=/msie [\w.]+/,A=/\/$/;C.started=!1,i.extend(C.prototype,d,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var i=this.root.replace(A,"");e.indexOf(i)||(e=e.substr(i.length))}else e=this.getHash();return e.replace(x,"")},start:function(e){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=i.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),s=document.documentMode,r=S.exec(navigator.userAgent.toLowerCase())&&(!s||7>=s);this.root=("/"+this.root+"/").replace(E,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(x,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),C.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=i.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!C.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var i=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new C;var k=t.View=function(e){this.cid=i.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},F=/^(\S+)\s*(.*)$/,D=["model","collection","el","id","attributes","className","tagName","events"];i.extend(k.prototype,d,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(e||(e=i.result(this,"events"))){this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),!n)throw new Error('Method "'+e[t]+'" does not exist');var s=t.match(F),r=s[1],o=s[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,n):this.$el.on(r,o,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(e){this.options&&(e=i.extend({},i.result(this,"options"),e)),i.extend(this,i.pick(e,D)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}});var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.sync=function(e,n,s){var r=T[e];i.defaults(s||(s={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:r,dataType:"json"};if(s.url||(o.url=i.result(n,"url")||B()),null!=s.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(s.attrs||n.toJSON(s))),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",s.emulateJSON&&(o.data._method=r);var a=s.beforeSend;s.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===o.type||s.emulateJSON||(o.processData=!1);var l=s.success;s.success=function(e){l&&l(n,e,s),n.trigger("sync",n,e,s)};var c=s.error;s.error=function(e){c&&c(n,e,s),n.trigger("error",n,e,s)};var u=s.xhr=t.ajax(i.extend(o,s));return n.trigger("request",n,u,s),u},t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var $=function(e,t){var n,s=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},i.extend(n,s,t);var r=function(){this.constructor=n};return r.prototype=s.prototype,n.prototype=new r,e&&i.extend(n.prototype,e),n.__super__=s.prototype,n};p.extend=f.extend=v.extend=k.extend=C.extend=$;var B=function(){throw new Error('A "url" property or function must be specified')};return t}),define("core/typecastError",[],function(){var e=function(e,t){Error.call(this,t),this.message=t,this.errorCode=e};return e.prototype=new Error,e.prototype.constructor=e,e.prototype.name="TypecastError",e.prototype.getCode=function(){return this.errorCode},e.prototype.getMessage=function(){return this.message},e}),define("core/utils/typeof",[],function(){var e=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);return null===e?"null":void 0===e?"undefined":t.toLowerCase()};return e}),define("core/utils/is",["core/utils/typeof"],function(e){var t,i={};return t=function(t,n){if("string"!==e(n))throw new Error("is(value, type) expects type to be a string");return"function"===e(i[n])?i[n].call(this,t):e(t)===n.toLowerCase()},t.registerType=function(e,n){return!t(e,"string")||e.length<1?!1:t(n,"function")?(i[e]=n,!0):!1},t.registerType("tag",function(e){var i;return!t(e,"string")||e.length<1?!1:(i=/^[a-z][a-z0-9]*$/,null!==e.match(i)?!0:!1)}),t.registerType("class_name",function(e){var i;return!t(e,"string")||e.length<1?!1:(i=/^-?[_a-zA-Z]+[_a-zA-Z0-9\-]*$/,null!==e.match(i)?!0:!1)}),t.registerType("media_query",function(e){var i,n;return t(e,"object")&&t(e.getMediaQuery,"function")?(i=e.getMediaQuery(),t(i,"object")?!t(i.id,"string")||i.id.length<1?!1:!t(i.type,"string")||i.type.length<1?!1:t(i.attributes,"object")&&t(e.getPreviousState,"function")?(n=e.getPreviousState(),t(n,"null")||t(n,"media_query")?!0:!1):!1:!1):!1}),t.registerType("element",function(e){var i,n,s;return t(e,"object")&&t(e.getElement,"function")?(i=e.getElement(),t(i,"object")?!t(i.id,"string")||i.id.length<1?!1:!t(i.type,"string")||i.type.length<1?!1:!t(i.tag_name,"string")||i.tag_name.length<1?!1:t(i.attributes,"object")&&t(i.children,"array")&&t(e.getSelector,"function")?(n=e.getSelector(),!t(n,"string")||n.length<1?!1:t(e.getPreviousState,"function")?(s=e.getPreviousState(),t(s,"null")||t(s,"element")?!0:!1):!1):!1:!1):!1}),t.registerType("style_declaration",function(e){var i,n;return t(e,"object")&&t(e.getStyleDeclaration,"function")?(i=e.getStyleDeclaration(),t(i,"object")?!t(i.id,"string")||i.id.length<1?!1:!t(i.media_query_id,"string")||i.media_query_id.length<1?!1:!t(i.style_id,"number")||i.style_id<1?!1:!t(i.selector,"string")||i.selector.length<1?!1:t(i.attributes,"object")&&t(e.getPreviousState,"function")?(n=e.getPreviousState(),t(n,"null")||t(n,"style_declaration")?!0:!1):!1:!1):!1}),t}),define("core/utils/cast",["underscore","core/utils/is","core/typecastError"],function(e,t,i){var n=function(s,r){var o,a=arguments[2],l=arguments[3];if(!t(r,"string"))throw new i(101,"cast(value, type) expects type to be a string");switch(r){case"number":case"integer":if(o=parseInt(s,10),!isNaN(o)&&isFinite(o))return o;break;case"float":if(o=parseFloat(s,10),!isNaN(o)&&isFinite(o))return o;break;case"string":if(t(s,"string")||t(s,"number")||t(s,"boolean")||!s)return""+s;break;case"array":if(s&&!t(s.length,"undefined"))return a=n(a,"number"),t(a,"number")||(a=0),l=n(l,"number"),t(l,"number")||(l=void 0),Array.prototype.slice.call(s,a,l);if(t(s,"object"))return e.values(s)}return new i(102,"Unable to cast to "+r)};return n}),define("backbone",["backbone-amd","core/typecastError","core/utils/is","core/utils/cast"],function(e,t,i,n){function s(e){
if(this.config={},i(this.listeners,"object")||(this.listeners={}),i(e,"object")&&(i(e.imc,"object")&&(this.imc=e.imc),i(e.config,"object")&&(this.config=e.config)),i(this.config.namespace,"string")&&this.config.namespace.length>0)this.namespace=this.config.namespace;else if(!i(this.namespace,"string")||this.namespace.length<1)throw new t(101,"Every module must have a unique namespace. None provided.");if(!i(this.imc,"object"))throw new t(101,"["+this.namespace+"] Requires the IMC");this.registerListeners()}var r=function(){s.apply(this,arguments),this.initialize.apply(this,arguments)};return r.prototype.registerListeners=function(){var e=Object.keys(this.listeners);return e.length<1?!0:(e.forEach(function(e){var t=this.namespace+":"+e;"[remote]"===e.substring(0,8)&&(t=e.substring(8)),this.imc.on(t,this[this.listeners[e]],this)},this),!0)},r.prototype.destroy=function(){return i(this.imc,"object")&&this.imc.off(null,null,this),this instanceof e.UIController&&e.View.prototype.remove.call(this),this},r.prototype.log=function(e){var t;return i(e,"string")?(t=n(arguments,"array",1),i(t,"array")?("metric"===e?this.imc.trigger.apply(this.imc,["service:metrics:record"].concat(t)):this.imc.trigger.apply(this.imc,["service:log:"+e,this.namespace].concat(t)),!0):!1):!1},r.prototype.announce=function(e){var t;return i(e,"string")?(t=n(arguments,"array",1),i(t,"array")?(this.imc.trigger.apply(this.imc,[this.namespace+":"+e].concat(t)),!0):!1):!1},r.prototype.initialize=function(){},r.extend=e.View.extend,e.DataController=r,e.UIController=e.View.extend({active_media_query:null,active_element:null,active_style_id:null,listeners:{"[remote]data:state:changed:active-media-query":"_activeMediaQueryChanged","[remote]data:state:changed:active-element":"_activeElementChanged","[remote]data:state:changed:active-style":"_activeStyleChanged"},constructor:function(){i(arguments[0],"object")&&(this.app_el=arguments[0].app_el,this.app_el||(this.app_el=document.createElement("div"))),s.apply(this,arguments),e.View.apply(this,arguments)},registerListeners:r.prototype.registerListeners}),e.UIController.prototype._activeMediaQueryChanged=function(e){var t=this.active_media_query,n=t?t.getMediaQuery().id:null;return n===e?!1:(this.imc.trigger("data:styles:getMediaQueryById",this.active_style_id,e,function(e,n){e&&(n=null),this.active_media_query=n,i(this.onChangeActiveMediaQuery,"function")&&this.onChangeActiveMediaQuery(n,t)},this),!0)},e.UIController.prototype._activeElementChanged=function(e){var t=this.active_element,n=t?t.getElement().id:null;return n===e?!1:(this.imc.trigger("data:elements:getElementById",e,function(e,n){e&&(n=null),this.active_element=n,i(this.onChangeActiveElement,"function")&&this.onChangeActiveElement(n,t)},this),!0)},e.UIController.prototype._activeStyleChanged=function(e){var t=this.active_style_id;return t===e?!1:(i(e,"number")||(e=null),this.active_style_id=e,i(this.onChangeActiveStyle,"function")&&this.onChangeActiveStyle(e,t),!0)},e.UIController.prototype.destroy=r.prototype.destroy,e.UIController.prototype.log=r.prototype.log,e.UIController.prototype.announce=r.prototype.announce,e.Model.prototype.toJSON=function(e){var t,n;if(e=i(e,"object")||i(e,"array")?e:this.attributes,i(e,"object")){if(i(e.toJSON,"function"))return e.toJSON();n={},t=Object.keys(e)}else n=[],t=e;return t.forEach(function(t,s){var r=i(n,"object")?t:s,o=i(e[r],"object")||i(e[r],"array")?this.toJSON(e[r]):e[r];i(n,"array")?n.push(o):n[r]=o},this),n},e}),define("core/imc",["underscore","backbone","core/utils/is"],function(e,t,i){var n="[:space:]";return e.extend({},t.Events,{on:function(){return this._replaceEventNameSpacesAndApplyMethod("on",arguments)},off:function(){return this._replaceEventNameSpacesAndApplyMethod("off",arguments)},trigger:function(){return this._replaceEventNameSpacesAndApplyMethod("trigger",arguments)},_replaceEventNameSpacesAndApplyMethod:function(e,s){return!i(e,"string")||e.length<1?!1:i(t.Events[e],"function")?(s&&i(s[0],"string")&&s[0].length>0&&(s[0]=s[0].replace(/\s+/g,n)),t.Events[e].apply(this,s),this):!1}})}),define("app",["backbone","underscore","core/imc","core/utils/is"],function(e,t,i,n){"use strict";var s=e.DataController.extend({module_definitions:null,modules:null,custom_data:null,config:null,init_data:null,imc:null,el:null,namespace:"app",listeners:{"[remote]service:connection:ready":"onReadyConnectionService"},initialize:function(e){return this.module_definitions={data:[],ui:[],service:[]},this.modules={data:[],ui:[],service:[]},this.custom_data={},this.config={},this.init_data={},n(e.module_definitions,"object")&&(this.module_definitions=e.module_definitions),n(e,"object")&&(n(e.custom,"object")&&(this.custom_data=e.custom),n(e.config,"object")&&(this.config=e.config)),n(this.config.appHolderSelector,"string")&&(this.el=document.querySelector(this.config.appHolderSelector)),this.el||(this.el=document.createElement("div")),this.imc.trigger(this.namespace+":initialize:start"),this.removeDisabledModules(),this.loadServiceModules(this.module_definitions.service),this.loadUIModules(this.module_definitions.ui),!0},onReadyConnectionService:function(){return this.imc.trigger("service:connection:getInitData",{project_id:this.config.modules.data.project.id},this.getInitData,this),!0},getInitData:function(e,i){return e?(this.log("error","Failed to get init data",e),!1):n(i,"object")&&n(i.data,"object")?(this.init_data=i,this.init_data.data.project=t.extend(this.config.modules.data.project,this.init_data.data.project),this.loadDataModules(this.module_definitions.data),this.imc.trigger(this.namespace+":initialize:complete"),!0):!1},removeDisabledModules:function(){return n(this.config,"object")&&n(this.config.disabledModules,"object")?(n(this.config.disabledModules.service,"array")&&this.config.disabledModules.service.length>0&&this.config.disabledModules.service.forEach(function(e){n(this.module_definitions.service[e],"undefined")||delete this.module_definitions.service[e]},this),n(this.config.disabledModules.data,"array")&&this.config.disabledModules.data.length>0&&this.config.disabledModules.data.forEach(function(e){n(this.module_definitions.data[e],"undefined")||delete this.module_definitions.data[e]},this),n(this.config.disabledModules.ui,"array")&&this.config.disabledModules.ui.length>0&&this.config.disabledModules.ui.forEach(function(e){n(this.module_definitions.ui[e],"undefined")||delete this.module_definitions.ui[e]},this),!0):!1},loadModule:function(e,t,i){var s={imc:this.imc,config:{}};return n(i,"function")?(s.config=this.getModuleConfig(e,t),n(s.config,"object")||(s.config={}),s.config=this.mixinGlobalConfig(s.config),"ui"===e&&(s.app_el=this.el),n(this.init_data[e],"object")&&n(this.init_data[e][t],"object")&&(s.initData=this.init_data[e][t]),this.modules[e].push({name:t?t:"Anonymous Module",ref:new i(s),def:i}),!0):!1},getModuleConfig:function(e,t){return n(this.config,"object")&&n(this.config.modules,"object")?!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:n(this.config.modules[e],"object")&&n(this.config.modules[e][t],"object")?this.config.modules[e][t]:!1:!1},mixinGlobalConfig:function(e){return n(this.config,"object")&&n(this.config.global,"object")&&n(e,"object")?t.defaults({},e,this.config.global):e},loadModulesByType:function(e,t){return!n(e,"string")||e.length<1?!1:n(t,"object")?(Object.keys(t).forEach(function(i){this.loadModule(e,i,t[i])},this),this.imc.trigger(this.namespace+":"+e+"-modules:loaded"),!0):!1},loadServiceModules:function(e){return this.loadModulesByType("service",e),!0},loadDataModules:function(e){return this.loadModulesByType("data",e),!0},loadUIModules:function(e){return this.loadModulesByType("ui",e),!0},destroy:function(){var e=t.chain(this.modules).values().flatten().pluck("ref").value();return t.each(e,function(e){n(e.destroy,"function")&&e.destroy()}),s.__super__.destroy.apply(this,arguments),!0}});return s}),define("core/debug",["core/utils/is"],function(e){var t=window&&window.console?window.console:{log:function(){},error:function(){},warn:function(){},trace:function(){}},i=function(t){e(t,"object")&&(e(t.imc,"undefined")?this.imc=!1:this.imc=t.imc,e(t.config,"object")?this.config=t.config:this.config={},e(this.config.namespace,"undefined")?this.imcNamespace="core:debug":this.imcNamespace=this.config.namespace),this.initialize.apply(this,arguments)};return i.prototype.initialize=function(){return this.registerIMCListeners(),!0},i.prototype.registerIMCListeners=function(){return e(this.imc,"object")?(this.imc.on(this.imcNamespace+":log",this.logMessage,this),this.imc.on(this.imcNamespace+":warn",this.warnMessage,this),this.imc.on(this.imcNamespace+":error",this.errorMessage,this),this.imc.on(this.imcNamespace+":trace",this.trace,this),!0):!1},i.prototype.logMessage=function(e){t.log(e)},i.prototype.warnMessage=function(e){t.warn(e)},i.prototype.errorMessage=function(e){t.error(e)},i.prototype.trace=function(){t.trace()},i}),define("core/utils/uuid",[],function(){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"===e?t:3&t|8;return i.toString(16)})}}),define("core/utils/dom",["jquery","underscore","core/utils/is","core/utils/typeof","core/utils/uuid","core/typecastError"],function(e,t,i,n,s,r){return{sample_element_container_selector:"div.sample.element-styles",suffixes:["top","right","bottom","left","top-left","top-right","bottom-right","bottom-left"],suffix_type:{"border-radius":"corner",background:"background"},isTextNode:function(t){var n;return i(t,"string")?(n=e("<div>"+t+"</div>"),i(n,"object")&&1===n.length&&i(n.get(0).childNodes,"NodeList")&&1===n.get(0).childNodes.length&&i(n.get(0).childNodes[0],"text")?!0:!1):!1},getCssPropertyForElement:function(e,t,n,s){var r;return i(e,"string")&&i(t,"string")&&i(n,"string")?("#"===e[0]&&(e=e.substr(1)),r=this.getElementSelector(t,e),this.getCssPropertyForSelector(r,n,s)):!1},getCssPropertyForSelector:function(t,n,s){var o,a,l=["parent"];if(!i(t,"string")||!i(n,"string"))return!1;if(o=e(t),i(s,"string")){if(-1===l.indexOf(s))throw new r(101,"The filter your provided is invalid, please try: "+l.join(", "));o=o[s]()}return!i(o,"object")||o.length<1?!1:(a=this._getCssValue(o,n),a=this._prepareCssValue(n,a))},appendNode:function(n,s,r,o,a){var l,c,u,h,d=[];return i(n,"string")&&i(s,"tag")?(i(r,"array")||(r=[]),i(a,"object")||(a={}),l=e(n),l.length<1?!1:(r.length>0&&(d=r.filter(function(e){return i(e,"class_name")}),a=t.extend({"class":d.join(" ")},a)),"a"===s&&(a=t.extend({href:"javascript"+String.fromCharCode(58)+"void(0)"},a)),u=e("<"+s+">",a),l.append(u),h=s,r.length>0&&(h+="."+d.join(".")),c=l.children(h),i(o,"object")&&c.css(o),c)):!1},getDomNodesForElementTree:function(t,n){var s,r;if(n=i(n,"boolean")?n:!1,i(t,"object")&&i(t.type,"string")){if("element"===t.type&&i(t.tag_name,"string"))return s=e("<"+t.tag_name+">"),r=i(t.attributes,"object")?Object.keys(t.attributes):[],!n&&i(t.id,"string")&&s.attr("data-id",t.id),r.forEach(function(e){if(i(e,"string"))switch(e.toLowerCase()){case"class":s.addClass(t.attributes[e]);break;case"width":s.width(t.attributes[e]);break;case"src":"img"===t.tag_name&&s.attr(e,t.attributes[e])}},this),i(t.children,"array")&&s.append(this.getDomNodesForElementTree(t.children,n)),s.get(0);if("text"===t.type)return t.content}return i(t,"array")?(s=e("<div>"),t.forEach(function(e){s.append(this.getDomNodesForElementTree(e,n))},this),s.get(0).innerHTML):void 0},buildElementTreeFromRootNode:function(e){var i,n;return e instanceof Element?(i=[],n={id:"body"===e.tagName.toLowerCase()?"body":this._getUUID(),type:"element",tag_name:e.tagName.toLowerCase(),children:[],attributes:{},parent_id:null},i.push(n),t.each(e.attributes,function(e){n.attributes[e.name]=e.value}),t.each(e.childNodes,function(e,t){var s;return"#text"===e.nodeName?void n.children.push({type:"text",index:t,content:e.textContent}):(s=this.buildElementTreeFromRootNode(e,n.id),s[0].parent_id=n.id,s[0].index=t,n.children.push({type:"element",element_id:s[0].id,index:t}),void(i=i.concat(s)))},this),i):!1},isElementTree:function(e){var t,n={id:{type:"string",min_length:1},parent_id:{optional:!0,type:"string",min_length:1},type:"string",tag_name:{type:"string",min_length:1},children:{optional:!0,type:"array"}},s=!1;return i(e,"object")?(t=Object.keys(n),t.forEach(function(t){var r=n[t];if(i(r,"string"))return i(e[t],r)?!0:(s=!0,!1);if(i(r,"object")){if(i(e[t],r.type)){if(r.min_length&&"string"===r.type&&e[t].length>=r.min_length)return!0;if(!r.min_length)return!0}else if(r.optional&&(i(e[t],"undefined")||null===e[t]))return!0;return s=!0,!1}}),!s):!1},createSampleElementInContainers:function(t,n,s){var r,o,a;return i(t,"string")?(i(n,"array")||(n=[]),this.appendNode("body","div",["sample","element-styles"],{position:"absolute",left:"-9999px"},s),this._isEveryContainerSelectorValid(n)?(i(n[0],"string")&&"body"===n[0]&&n.splice(0,1),a=this.sample_element_container_selector,n.forEach(function(e){if(e.length>0){var t;if(t=this._getSelectorParts(e),!t)return!1;this.appendNode(a,t.tag_name,t.class_names),a+=" "+e}},this),(r=this._getSelectorParts(t))?o="body"===r.tag_name?e("div.sample.element-styles"):this.appendNode(a,r.tag_name,r.class_names):!1):!1):!1},removeSampleElement:function(t){var n;return i(t,"object")?(t.remove(),n=t.parentsUntil(this.sample_element_container_selector),n.remove(),e(this.sample_element_container_selector).remove(),!0):!1},getCssPropertiesForSampleElement:function(e,n,s){var r,o,a,l,c={};return i(e,"string")&&i(n,"array")?(o=e.split(" "),a=t.last(o),l=o.slice(0,-1),(r=this.createSampleElementInContainers(a,l,s))?(n.forEach(function(e){var t;t=this._getCssValue(r,e),c[e]=this._prepareCssValue(e,t)},this),this.removeSampleElement(r),c):!1):!1},addDataRetainClassesAttribute:function(t){return!i(t,"string")||t.length<1?!1:e("<div>").append(t).find("[class]").filter("[class!=]").attr("data-retain-classes","yes").end().end().html()},getElementSelector:function(e,t){var n,s,r="";return!i(t,"string")||t.length<1?!1:(i(e,"string")&&e.length>0&&(r=this.getMediaQuerySelector(e)),n=r+'[data-id="body"]',s='[data-id="'+t+'"]',"body"===t?n:n+" "+s)},getElement:function(t,i){return e(this.getElementSelector(t,i))},getMediaQuerySelector:function(e){return!i(e,"string")||e.length<1?!1:'[data-media-query-id="'+e+'"]'},_isEveryContainerSelectorValid:function(e){var t=!0;return i(e,"array")?(e.forEach(function(e){this._getSelectorParts(e)||(t=!1)},this),t):!0},_getSelectorParts:function(e){var t,n={};if(!i(e,"string"))return!1;if(t=e.split("."),t[0].length<1){if(!(i(t[1],"string")&&t[1].length>0))return!1;t[0]="div"}return 2===t.length?(n.tag_name=t[0],n.class_names=[t[1]]):1===t.length&&(n.tag_name=t[0],n.class_names=[]),n},_getSuffixedAttributeName:function(e,t){var i;return t&&"all"!==t?(i=e.split("-"),-1!==this.suffixes.indexOf(t)?i.splice(1,0,t):i.push(t),i.join("-")):e},_getCssValue:function(e,n){var s,r,o,a,l,c,u,h,d,p,f=!1;if(!i(e,"object")||e.length<1)return!1;if(!i(n,"string"))return!1;switch(n){case"margin":case"padding":case"border-width":case"border-radius":case"border-color":case"border-style":case"background":break;default:s=e.css(n)}if(i(s,"string")&&s.length>0)return s;switch(n){case"column-break-before":case"column-break-inside":case"column-break-after":s="auto";break;case"font-feature-settings":s="normal"}switch(u=n.split("-").pop(),-1===this.suffixes.indexOf(u)&&("corner"===this.suffix_type[n]?(r=e.css(this._getSuffixedAttributeName(n,"top-left")),o=e.css(this._getSuffixedAttributeName(n,"top-right")),a=e.css(this._getSuffixedAttributeName(n,"bottom-right")),l=e.css(this._getSuffixedAttributeName(n,"bottom-left"))):"background"===this.suffix_type[n]?(r=e.css(this._getSuffixedAttributeName(n,"color")),o=e.css(this._getSuffixedAttributeName(n,"image")),a=e.css(this._getSuffixedAttributeName(n,"repeat")),l=e.css(this._getSuffixedAttributeName(n,"attachment")),c=e.css(this._getSuffixedAttributeName(n,"position"))):(r=e.css(this._getSuffixedAttributeName(n,"top")),o=e.css(this._getSuffixedAttributeName(n,"right")),a=e.css(this._getSuffixedAttributeName(n,"bottom")),l=e.css(this._getSuffixedAttributeName(n,"left"))),f=r===o&&r===a&&r===l),n){case"margin":case"padding":s=f&&i(r,"string")&&r.length>0?r:r+" "+o+" "+a+" "+l;break;case"border":case"border-top":case"border-right":case"border-bottom":case"border-left":f&&i(r,"string")&&r.length>0?s=r:(h=this._getCssValue(e,this._getSuffixedAttributeName(n,"width")),d=this._getCssValue(e,this._getSuffixedAttributeName(n,"style")),p=this._getCssValue(e,this._getSuffixedAttributeName(n,"color")),s=h+" "+d+" "+p);break;case"border-width":case"border-radius":f&&i(r,"string")&&r.length>0?s=r:(s=t.without([r,o,a,l],"0px")[0],(!i(s,"string")||s.length<1)&&(s=t.without([r,o,a,l],"")[0]));break;case"border-color":s=f?r:"transparent";break;case"border-style":s=f?r:t.without([r,o,a,l],"none")[0];break;case"background":s=[r,o,a,l,c].join(" ")}return s},_getUUID:function(){return s()},_prepareCssValue:function(e,t){if(!i(e,"string"))return!1;if(!(i(t,"string")&&t.length>0||i(t,"number")))return!1;if(i(t,"string")&&"font-family"===e){var n=t.split(",");t=n[0],t=t.replace(/[\'\"<>]/g,""),t=t.trim()}return String(t)}}}),function(e,t){Math.precision=function(e,t){return void 0===t&&(t=0),Math.round(e*Math.pow(10,t))/Math.pow(10,t)};var i=function(t,i){var n,s,r=this,o=t.find("img:first"),a=0,l=100,c=100,u=0,h=100,d=100,p=0,f=0,g=new Array,m=function(e){for(var t=0;t<g.length;t++)g[t].call(r,r,e)},v=function(i){var o=t.offset();n={l:0|o.left,t:0|o.top},clearTimeout(s),s=setTimeout(function(){b.call(r,i,t)},0),e(document).bind("mousemove",y).bind("mouseup",_),i.preventDefault()},y=function(e){return clearTimeout(s),s=setTimeout(function(){b.call(r,e,t)},0),e.stopPropagation(),e.preventDefault(),!1},_=function(t){return e(document).unbind("mouseup",_).unbind("mousemove",y),t.stopPropagation(),t.preventDefault(),!1},b=function(e,t){var i=e.pageX-n.l,s=e.pageY-n.t,o=t.w,l=t.h;if(t.hasClass("Bar")){var h=i;i=s,s=h}0>i?i=0:i>o&&(i=o),0>s?s=0:s>l&&(s=l),C.call(r,"xy",{x:i/o*c+a,y:s/l*d+u})},w=function(){var e=0,i=0,n=t.w,s=t.h,r=o.w,a=o.h;setTimeout(function(){c>0&&(e=p==l?n:p/c*n|0),d>0&&(i=f==h?s:f/d*s|0),r>=n?e=(n>>1)-(r>>1):e-=r>>1,a>=s?i=(s>>1)-(a>>1):i-=a>>1,o.css({left:e+"px",top:i+"px"})},0)},C=function(e,t,i){var n=void 0!==t;if(!n)switch((void 0===e||null==e)&&(e="xy"),e.toLowerCase()){case"x":return p;case"y":return f;case"xy":default:return{x:p,y:f}}if(null==i||i!=r){var s,o,c=!1;switch(null==e&&(e="xy"),e.toLowerCase()){case"x":s=t&&(t.x&&0|t.x||0|t)||0;break;case"y":o=t&&(t.y&&0|t.y||0|t)||0;break;case"xy":default:s=t&&t.x&&0|t.x||0,o=t&&t.y&&0|t.y||0}null!=s&&(a>s?s=a:s>l&&(s=l),p!=s&&(p=s,c=!0)),null!=o&&(u>o?o=u:o>h&&(o=h),f!=o&&(f=o,c=!0)),c&&m.call(r,i||r)}},x=function(e,t){var i=void 0!==t;if(!i)switch((void 0===e||null==e)&&(e="all"),e.toLowerCase()){case"minx":return a;case"maxx":return l;case"rangex":return{minX:a,maxX:l,rangeX:c};case"miny":return u;case"maxy":return h;case"rangey":return{minY:u,maxY:h,rangeY:d};case"all":default:return{minX:a,maxX:l,rangeX:c,minY:u,maxY:h,rangeY:d}}var n,s,r,o;switch(null==e&&(e="all"),e.toLowerCase()){case"minx":n=t&&(t.minX&&0|t.minX||0|t)||0;break;case"maxx":s=t&&(t.maxX&&0|t.maxX||0|t)||0;break;case"rangex":n=t&&t.minX&&0|t.minX||0,s=t&&t.maxX&&0|t.maxX||0;break;case"miny":r=t&&(t.minY&&0|t.minY||0|t)||0;break;case"maxy":o=t&&(t.maxY&&0|t.maxY||0|t)||0;break;case"rangey":r=t&&t.minY&&0|t.minY||0,o=t&&t.maxY&&0|t.maxY||0;break;case"all":default:n=t&&t.minX&&0|t.minX||0,s=t&&t.maxX&&0|t.maxX||0,r=t&&t.minY&&0|t.minY||0,o=t&&t.maxY&&0|t.maxY||0}null!=n&&a!=n&&(a=n,c=l-a),null!=s&&l!=s&&(l=s,c=l-a),null!=r&&u!=r&&(u=r,d=h-u),null!=o&&h!=o&&(h=o,d=h-u)},E=function(t){e.isFunction(t)&&g.push(t)},S=function(t){if(e.isFunction(t))for(var i;-1!=(i=e.inArray(t,g));)g.splice(i,1)},A=function(){e(document).unbind("mouseup",_).unbind("mousemove",y),t.unbind("mousedown",v),t=null,o=null,g=null};e.extend(!0,r,{val:C,range:x,bind:E,unbind:S,destroy:A}),o.src=i.arrow&&i.arrow.image,o.w=i.arrow&&i.arrow.width||o.width(),o.h=i.arrow&&i.arrow.height||o.height(),t.w=i.map&&i.map.width||t.width(),t.h=i.map&&i.map.height||t.height(),t.bind("mousedown",v),E.call(r,w)},n=function(t,i,n,s){var r=this,o=t.find("td.Text input"),a=o.eq(3),l=o.eq(4),c=o.eq(5),u=o.length>7?o.eq(6):null,h=o.eq(0),d=o.eq(1),p=o.eq(2),f=o.eq(o.length>7?7:6),g=o.length>7?o.eq(8):null,m=function(e){if(""!=e.target.value||e.target==f.get(0)||(null==n||e.target==n.get(0))&&null!=n){if(!_(e))return e;switch(e.target){case a.get(0):switch(e.keyCode){case 38:return a.val(b.call(r,(a.val()<<0)+1,0,255)),i.val("r",a.val(),e.target),!1;case 40:return a.val(b.call(r,(a.val()<<0)-1,0,255)),i.val("r",a.val(),e.target),!1}break;case l.get(0):switch(e.keyCode){case 38:return l.val(b.call(r,(l.val()<<0)+1,0,255)),i.val("g",l.val(),e.target),!1;case 40:return l.val(b.call(r,(l.val()<<0)-1,0,255)),i.val("g",l.val(),e.target),!1}break;case c.get(0):switch(e.keyCode){case 38:return c.val(b.call(r,(c.val()<<0)+1,0,255)),i.val("b",c.val(),e.target),!1;case 40:return c.val(b.call(r,(c.val()<<0)-1,0,255)),i.val("b",c.val(),e.target),!1}break;case u&&u.get(0):switch(e.keyCode){case 38:return u.val(b.call(r,parseFloat(u.val())+1,0,100)),i.val("a",Math.precision(255*u.val()/100,s),e.target),!1;case 40:return u.val(b.call(r,parseFloat(u.val())-1,0,100)),i.val("a",Math.precision(255*u.val()/100,s),e.target),!1}break;case h.get(0):switch(e.keyCode){case 38:return h.val(b.call(r,(h.val()<<0)+1,0,360)),i.val("h",h.val(),e.target),!1;case 40:return h.val(b.call(r,(h.val()<<0)-1,0,360)),i.val("h",h.val(),e.target),!1}break;case d.get(0):switch(e.keyCode){case 38:return d.val(b.call(r,(d.val()<<0)+1,0,100)),i.val("s",d.val(),e.target),!1;case 40:return d.val(b.call(r,(d.val()<<0)-1,0,100)),i.val("s",d.val(),e.target),!1}break;case p.get(0):switch(e.keyCode){case 38:return p.val(b.call(r,(p.val()<<0)+1,0,100)),i.val("v",p.val(),e.target),!1;case 40:return p.val(b.call(r,(p.val()<<0)-1,0,100)),i.val("v",p.val(),e.target),!1}}}},v=function(e){if(""!=e.target.value||e.target==f.get(0)||(null==n||e.target==n.get(0))&&null!=n){if(!_(e))return e;switch(e.target){case a.get(0):a.val(b.call(r,a.val(),0,255)),i.val("r",a.val(),e.target);break;case l.get(0):l.val(b.call(r,l.val(),0,255)),i.val("g",l.val(),e.target);break;case c.get(0):c.val(b.call(r,c.val(),0,255)),i.val("b",c.val(),e.target);break;case u&&u.get(0):u.val(b.call(r,u.val(),0,100)),i.val("a",Math.precision(255*u.val()/100,s),e.target);break;case h.get(0):h.val(b.call(r,h.val(),0,360)),i.val("h",h.val(),e.target);break;case d.get(0):d.val(b.call(r,d.val(),0,100)),i.val("s",d.val(),e.target);break;case p.get(0):p.val(b.call(r,p.val(),0,100)),i.val("v",p.val(),e.target);break;case f.get(0):f.val(f.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),n&&n.val(f.val()),i.val("hex",""!=f.val()?f.val():null,e.target);break;case n&&n.get(0):n.val(n.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,6)),f.val(n.val()),i.val("hex",""!=n.val()?n.val():null,e.target);break;case g&&g.get(0):g.val(g.val().replace(/[^a-fA-F0-9]/g,"").toLowerCase().substring(0,2)),i.val("a",null!=g.val()?parseInt(g.val(),16):null,e.target)}}},y=function(e){if(null!=i.val())switch(e.target){case a.get(0):a.val(i.val("r"));break;case l.get(0):l.val(i.val("g"));break;case c.get(0):c.val(i.val("b"));break;case u&&u.get(0):u.val(Math.precision(100*i.val("a")/255,s));break;case h.get(0):h.val(i.val("h"));break;case d.get(0):d.val(i.val("s"));break;case p.get(0):p.val(i.val("v"));break;case f.get(0):case n&&n.get(0):f.val(i.val("hex")),n&&n.val(i.val("hex"));break;case g&&g.get(0):g.val(i.val("ahex").substring(6))}},_=function(e){switch(e.keyCode){case 9:case 16:case 29:case 37:case 39:return!1;case"c".charCodeAt():case"v".charCodeAt():if(e.ctrlKey)return!1}return!0},b=function(e,t,i){return""==e||isNaN(e)?t:e>i?i:t>e?t:e},w=function(e,t){var i=e.val("all");t!=a.get(0)&&a.val(null!=i?i.r:""),t!=l.get(0)&&l.val(null!=i?i.g:""),t!=c.get(0)&&c.val(null!=i?i.b:""),u&&t!=u.get(0)&&u.val(null!=i?Math.precision(100*i.a/255,s):""),t!=h.get(0)&&h.val(null!=i?i.h:""),t!=d.get(0)&&d.val(null!=i?i.s:""),t!=p.get(0)&&p.val(null!=i?i.v:""),t!=f.get(0)&&(n&&t!=n.get(0)||!n)&&f.val(null!=i?i.hex:""),n&&t!=n.get(0)&&t!=f.get(0)&&n.val(null!=i?i.hex:""),g&&t!=g.get(0)&&g.val(null!=i?i.ahex.substring(6):"")},C=function(){a.add(l).add(c).add(u).add(h).add(d).add(p).add(f).add(n).add(g).unbind("keyup",v).unbind("blur",y),a.add(l).add(c).add(u).add(h).add(d).add(p).unbind("keydown",m),i.unbind(w),a=null,l=null,c=null,u=null,h=null,d=null,p=null,f=null,g=null};e.extend(!0,r,{destroy:C}),a.add(l).add(c).add(u).add(h).add(d).add(p).add(f).add(n).add(g).bind("keyup",v).bind("blur",y),a.add(l).add(c).add(u).add(h).add(d).add(p).bind("keydown",m),i.bind(w)};e.jPicker={List:[],Color:function(t){var i,n,s,r,a,l,c,u=this,h=new Array,d=function(e){for(var t=0;t<h.length;t++)h[t].call(u,u,e)},p=function(e,t,h){var f=void 0!==t;if(!f){if((void 0===e||null==e||""==e)&&(e="all"),null==i)return null;switch(e.toLowerCase()){case"ahex":return o.rgbaToHex({r:i,g:n,b:s,a:r});case"hex":return p("ahex").substring(0,6);case"all":return{r:i,g:n,b:s,a:r,h:a,s:l,v:c,hex:p.call(u,"hex"),ahex:p.call(u,"ahex")};default:for(var g={},m=0;m<e.length;m++)switch(e.charAt(m)){case"r":1==e.length?g=i:g.r=i;break;case"g":1==e.length?g=n:g.g=n;break;case"b":1==e.length?g=s:g.b=s;break;case"a":1==e.length?g=r:g.a=r;break;case"h":1==e.length?g=a:g.h=a;break;case"s":1==e.length?g=l:g.s=l;break;case"v":1==e.length?g=c:g.v=c}return g=={}?p.call(u,"all"):g}}if(null==h||h!=u){var v=!1;if(null==e&&(e=""),null==t)return null!=i&&(i=null,v=!0),null!=n&&(n=null,v=!0),null!=s&&(s=null,v=!0),null!=r&&(r=null,v=!0),null!=a&&(a=null,v=!0),null!=l&&(l=null,v=!0),null!=c&&(c=null,v=!0),void(v&&d.call(u,h||u));switch(e.toLowerCase()){case"ahex":case"hex":var g=o.hexToRgba(t&&(t.ahex||t.hex)||t||"00000000");p.call(u,"rgba",{r:g.r,g:g.g,b:g.b,a:"ahex"==e?g.a:null!=r?r:255},h);break;default:if(t&&(null!=t.ahex||null!=t.hex))return void p.call(u,"ahex",t.ahex||t.hex||"00000000",h);var y={},_=!1,b=!1;void 0!==t.r&&-1==!e.indexOf("r")&&(e+="r"),void 0!==t.g&&-1==!e.indexOf("g")&&(e+="g"),void 0!==t.b&&-1==!e.indexOf("b")&&(e+="b"),void 0!==t.a&&-1==!e.indexOf("a")&&(e+="a"),void 0!==t.h&&-1==!e.indexOf("h")&&(e+="h"),void 0!==t.s&&-1==!e.indexOf("s")&&(e+="s"),void 0!==t.v&&-1==!e.indexOf("v")&&(e+="v");for(var m=0;m<e.length;m++)switch(e.charAt(m)){case"r":if(b)continue;_=!0,y.r=t&&t.r&&0|t.r||t&&0|t||0,y.r<0?y.r=0:y.r>255&&(y.r=255),i!=y.r&&(i=y.r,v=!0);break;case"g":if(b)continue;_=!0,y.g=t&&t.g&&0|t.g||t&&0|t||0,y.g<0?y.g=0:y.g>255&&(y.g=255),n!=y.g&&(n=y.g,v=!0);break;case"b":if(b)continue;_=!0,y.b=t&&t.b&&0|t.b||t&&0|t||0,y.b<0?y.b=0:y.b>255&&(y.b=255),s!=y.b&&(s=y.b,v=!0);break;case"a":y.a=t&&null!=t.a?0|t.a:null!=t?0|t:255,y.a<0?y.a=0:y.a>255&&(y.a=255),r!=y.a&&(r=y.a,v=!0);break;case"h":if(_)continue;b=!0,y.h=t&&t.h&&0|t.h||t&&0|t||0,y.h<0?y.h=0:y.h>360&&(y.h=360),a!=y.h&&(a=y.h,v=!0);break;case"s":if(_)continue;b=!0,y.s=t&&null!=t.s?0|t.s:null!=t?0|t:100,y.s<0?y.s=0:y.s>100&&(y.s=100),l!=y.s&&(l=y.s,v=!0);break;case"v":if(_)continue;b=!0,y.v=t&&null!=t.v?0|t.v:null!=t?0|t:100,y.v<0?y.v=0:y.v>100&&(y.v=100),c!=y.v&&(c=y.v,v=!0)}if(v){if(_){i=i||0,n=n||0,s=s||0;var g=o.rgbToHsv({r:i,g:n,b:s});a=g.h,l=g.s,c=g.v}else if(b){a=a||0,l=null!=l?l:100,c=null!=c?c:100;var g=o.hsvToRgb({h:a,s:l,v:c});i=g.r,n=g.g,s=g.b}r=null!=r?r:255,d.call(u,h||u)}}}},f=function(t){e.isFunction(t)&&h.push(t)},g=function(t){if(e.isFunction(t))for(var i;-1!=(i=e.inArray(t,h));)h.splice(i,1)},m=function(){h=null};e.extend(!0,u,{val:p,bind:f,unbind:g,destroy:m}),t&&(null!=t.ahex?p("ahex",t):null!=t.hex?p((null!=t.a?"a":"")+"hex",null!=t.a?{ahex:t.hex+o.intToHex(t.a)}:t):null!=t.r&&null!=t.g&&null!=t.b?p("rgb"+(null!=t.a?"a":""),t):null!=t.h&&null!=t.s&&null!=t.v&&p("hsv"+(null!=t.a?"a":""),t))},ColorMethods:{hexToRgba:function(e){if(e=this.validateHex(e),""==e)return{r:null,g:null,b:null,a:null};var t="00",i="00",n="00",s="255";return 6==e.length&&(e+="ff"),e.length>6?(t=e.substring(0,2),i=e.substring(2,4),n=e.substring(4,6),s=e.substring(6,e.length)):(e.length>4&&(t=e.substring(4,e.length),e=e.substring(0,4)),e.length>2&&(i=e.substring(2,e.length),e=e.substring(0,2)),e.length>0&&(n=e.substring(0,e.length))),{r:this.hexToInt(t),g:this.hexToInt(i),b:this.hexToInt(n),a:this.hexToInt(s)}},validateHex:function(e){return e=e.toLowerCase().replace(/[^a-f0-9]/g,""),e.length>8&&(e=e.substring(0,8)),e},rgbaToHex:function(e){return this.intToHex(e.r)+this.intToHex(e.g)+this.intToHex(e.b)+this.intToHex(e.a)},intToHex:function(e){var t=(0|e).toString(16);return 1==t.length&&(t="0"+t),t.toLowerCase()},hexToInt:function(e){return parseInt(e,16)},rgbToHsv:function(e){var t,i=e.r/255,n=e.g/255,s=e.b/255,r={h:0,s:0,v:0},o=0,a=0;return i>=n&&i>=s?(a=i,o=n>s?s:n):n>=s&&n>=i?(a=n,o=i>s?s:i):(a=s,o=n>i?i:n),r.v=a,r.s=a?(a-o)/a:0,r.s?(t=a-o,i==a?r.h=(n-s)/t:n==a?r.h=2+(s-i)/t:r.h=4+(i-n)/t,r.h=parseInt(60*r.h),r.h<0&&(r.h+=360)):r.h=0,r.s=100*r.s|0,r.v=100*r.v|0,r},hsvToRgb:function(e){var t={r:0,g:0,b:0,a:100},i=e.h,n=e.s,s=e.v;if(0==n)0==s?t.r=t.g=t.b=0:t.r=t.g=t.b=255*s/100|0;else{360==i&&(i=0),i/=60,n/=100,s/=100;var r=0|i,o=i-r,a=s*(1-n),l=s*(1-n*o),c=s*(1-n*(1-o));switch(r){case 0:t.r=s,t.g=c,t.b=a;break;case 1:t.r=l,t.g=s,t.b=a;break;case 2:t.r=a,t.g=s,t.b=c;break;case 3:t.r=a,t.g=l,t.b=s;break;case 4:t.r=c,t.g=a,t.b=s;break;case 5:t.r=s,t.g=a,t.b=l}t.r=255*t.r|0,t.g=255*t.g|0,t.b=255*t.b|0}return t}}};var s=e.jPicker.Color,r=e.jPicker.List,o=e.jPicker.ColorMethods;e.fn.jPicker=function(t){var a=arguments;return this.each(function(){var l=this,c=e.extend(!0,{},e.fn.jPicker.defaults,t);"input"==e(l).get(0).nodeName.toLowerCase()&&(e.extend(!0,c,{window:{bindToInput:!0,expandable:!0,input:e(l)}}),""==e(l).val()?(c.color.active=new s({hex:null}),c.color.current=new s({hex:null})):o.validateHex(e(l).val())&&(c.color.active=new s({hex:e(l).val(),a:c.color.active.val("a")}),c.color.current=new s({hex:e(l).val(),a:c.color.active.val("a")}))),c.window.expandable?e(l).after('<span class="jPicker"><span class="Icon"><span class="Color">&nbsp;</span><span class="Alpha">&nbsp;</span><span class="Image" title="Click To Open Color Picker">&nbsp;</span><span class="Container">&nbsp;</span></span></span>'):c.window.liveUpdate=!1;var u=parseFloat(navigator.appVersion.split("MSIE")[1])<7&&document.body.filters,h=null,d=null,p=null,f=null,g=null,m=null,v=null,y=null,_=null,b=null,w=null,C=null,x=null,E=null,S=null,A=null,k=null,F=null,D=null,T=null,$=null,B=null,j=null,M=null,L=null,I=null,P=null,R=null,O=function(e){var t,i,n=_e.active,s=(ve.clientPath,n.val("hex"));switch(c.color.mode=e,e){case"h":if(setTimeout(function(){Q.call(l,d,"transparent"),K.call(l,f,0),Y.call(l,f,100),K.call(l,g,260),Y.call(l,g,100),Q.call(l,p,"transparent"),K.call(l,v,0),Y.call(l,v,100),K.call(l,y,260),Y.call(l,y,100),K.call(l,_,260),Y.call(l,_,100),K.call(l,b,260),Y.call(l,b,100),K.call(l,C,260),Y.call(l,C,100)},0),x.range("all",{minX:0,maxX:100,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:360}),null==n.val("ahex"))break;x.val("xy",{x:n.val("s"),y:100-n.val("v")},x),E.val("y",360-n.val("h"),E);break;case"s":if(setTimeout(function(){Q.call(l,d,"transparent"),K.call(l,f,-260),K.call(l,g,-520),K.call(l,v,-260),K.call(l,y,-520),K.call(l,C,260),Y.call(l,C,100)},0),x.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:100}),null==n.val("ahex"))break;x.val("xy",{x:n.val("h"),y:100-n.val("v")},x),E.val("y",100-n.val("s"),E);break;case"v":if(setTimeout(function(){Q.call(l,d,"000000"),K.call(l,f,-780),K.call(l,g,260),Q.call(l,p,s),K.call(l,v,-520),K.call(l,y,260),Y.call(l,y,100),K.call(l,C,260),Y.call(l,C,100)},0),x.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:100}),null==n.val("ahex"))break;
x.val("xy",{x:n.val("h"),y:100-n.val("s")},x),E.val("y",100-n.val("v"),E);break;case"r":if(t=-1040,i=-780,x.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;x.val("xy",{x:n.val("b"),y:255-n.val("g")},x),E.val("y",255-n.val("r"),E);break;case"g":if(t=-1560,i=-1820,x.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;x.val("xy",{x:n.val("b"),y:255-n.val("r")},x),E.val("y",255-n.val("g"),E);break;case"b":if(t=-2080,i=-2860,x.range("all",{minX:0,maxX:255,minY:0,maxY:255}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;x.val("xy",{x:n.val("r"),y:255-n.val("g")},x),E.val("y",255-n.val("b"),E);break;case"a":if(setTimeout(function(){Q.call(l,d,"transparent"),K.call(l,f,-260),K.call(l,g,-520),K.call(l,v,260),K.call(l,y,260),Y.call(l,y,100),K.call(l,C,0),Y.call(l,C,100)},0),x.range("all",{minX:0,maxX:360,minY:0,maxY:100}),E.range("rangeY",{minY:0,maxY:255}),null==n.val("ahex"))break;x.val("xy",{x:n.val("h"),y:100-n.val("v")},x),E.val("y",255-n.val("a"),E);break;default:throw"Invalid Mode"}switch(e){case"h":break;case"s":case"v":case"a":setTimeout(function(){Y.call(l,f,100),Y.call(l,v,100),K.call(l,_,260),Y.call(l,_,100),K.call(l,b,260),Y.call(l,b,100)},0);break;case"r":case"g":case"b":setTimeout(function(){Q.call(l,d,"transparent"),Q.call(l,p,"transparent"),Y.call(l,v,100),Y.call(l,f,100),K.call(l,f,t),K.call(l,g,t-260),K.call(l,v,i-780),K.call(l,y,i-520),K.call(l,_,i),K.call(l,b,i-260),K.call(l,C,260),Y.call(l,C,100)},0)}null!=n.val("ahex")&&N.call(l,n)},N=function(e,t){(null==t||t!=E&&t!=x)&&H.call(l,e,t),setTimeout(function(){V.call(l,e),W.call(l,e),U.call(l,e)},0)},q=function(e,t){var i=_e.active;if(t==x||null!=i.val()){var n=e.val("all");switch(c.color.mode){case"h":i.val("sv",{s:n.x,v:100-n.y},t);break;case"s":case"a":i.val("hv",{h:n.x,v:100-n.y},t);break;case"v":i.val("hs",{h:n.x,s:100-n.y},t);break;case"r":i.val("gb",{g:255-n.y,b:n.x},t);break;case"g":i.val("rb",{r:255-n.y,b:n.x},t);break;case"b":i.val("rg",{r:n.x,g:255-n.y},t)}}},z=function(e,t){var i=_e.active;if(t==E||null!=i.val())switch(c.color.mode){case"h":i.val("h",{h:360-e.val("y")},t);break;case"s":i.val("s",{s:100-e.val("y")},t);break;case"v":i.val("v",{v:100-e.val("y")},t);break;case"r":i.val("r",{r:255-e.val("y")},t);break;case"g":i.val("g",{g:255-e.val("y")},t);break;case"b":i.val("b",{b:255-e.val("y")},t);break;case"a":i.val("a",255-e.val("y"),t)}},H=function(e,t){if(t!=x)switch(c.color.mode){case"h":var i=e.val("sv");x.val("xy",{x:null!=i?i.s:100,y:100-(null!=i?i.v:100)},t);break;case"s":case"a":var n=e.val("hv");x.val("xy",{x:n&&n.h||0,y:100-(null!=n?n.v:100)},t);break;case"v":var s=e.val("hs");x.val("xy",{x:s&&s.h||0,y:100-(null!=s?s.s:100)},t);break;case"r":var r=e.val("bg");x.val("xy",{x:r&&r.b||0,y:255-(r&&r.g||0)},t);break;case"g":var o=e.val("br");x.val("xy",{x:o&&o.b||0,y:255-(o&&o.r||0)},t);break;case"b":var a=e.val("rg");x.val("xy",{x:a&&a.r||0,y:255-(a&&a.g||0)},t)}if(t!=E)switch(c.color.mode){case"h":E.val("y",360-(e.val("h")||0),t);break;case"s":var l=e.val("s");E.val("y",100-(null!=l?l:100),t);break;case"v":var u=e.val("v");E.val("y",100-(null!=u?u:100),t);break;case"r":E.val("y",255-(e.val("r")||0),t);break;case"g":E.val("y",255-(e.val("g")||0),t);break;case"b":E.val("y",255-(e.val("b")||0),t);break;case"a":var h=e.val("a");E.val("y",255-(null!=h?h:255),t)}},V=function(e){try{var t=e.val("all");T.css({backgroundColor:t&&"#"+t.hex||"transparent"}),Y.call(l,T,t&&Math.precision(100*t.a/255,4)||0)}catch(i){}},W=function(e){switch(c.color.mode){case"h":Q.call(l,d,new s({h:e.val("h")||0,s:100,v:100}).val("hex"));break;case"s":case"a":var t=e.val("s");Y.call(l,g,100-(null!=t?t:100));break;case"v":var i=e.val("v");Y.call(l,f,null!=i?i:100);break;case"r":Y.call(l,g,Math.precision((e.val("r")||0)/255*100,4));break;case"g":Y.call(l,g,Math.precision((e.val("g")||0)/255*100,4));break;case"b":Y.call(l,g,Math.precision((e.val("b")||0)/255*100))}var n=e.val("a");Y.call(l,m,Math.precision(100*(255-(n||0))/255,4))},U=function(e){switch(c.color.mode){case"h":var t=e.val("a");Y.call(l,w,Math.precision(100*(255-(t||0))/255,4));break;case"s":var i=e.val("hva"),n=new s({h:i&&i.h||0,s:100,v:null!=i?i.v:100});Q.call(l,p,n.val("hex")),Y.call(l,y,100-(null!=i?i.v:100)),Y.call(l,w,Math.precision(100*(255-(i&&i.a||0))/255,4));break;case"v":var r=e.val("hsa"),o=new s({h:r&&r.h||0,s:null!=r?r.s:100,v:100});Q.call(l,p,o.val("hex")),Y.call(l,w,Math.precision(100*(255-(r&&r.a||0))/255,4));break;case"r":case"g":case"b":var a=0,u=0,h=e.val("rgba");"r"==c.color.mode?(a=h&&h.b||0,u=h&&h.g||0):"g"==c.color.mode?(a=h&&h.b||0,u=h&&h.r||0):"b"==c.color.mode&&(a=h&&h.r||0,u=h&&h.g||0);var d=u>a?a:u;Y.call(l,y,a>u?Math.precision((a-u)/(255-u)*100,4):0),Y.call(l,_,u>a?Math.precision((u-a)/(255-a)*100,4):0),Y.call(l,b,Math.precision(d/255*100,4)),Y.call(l,w,Math.precision(100*(255-(h&&h.a||0))/255,4));break;case"a":var t=e.val("a");Q.call(l,p,e.val("hex")||"000000"),Y.call(l,w,null!=t?0:100),Y.call(l,C,null!=t?100:0)}},Q=function(e,t){e.css({backgroundColor:t&&6==t.length&&"#"+t||"transparent"})},G=function(e,t){!u||-1==t.indexOf("AlphaBar.png")&&-1==t.indexOf("Bars.png")&&-1==t.indexOf("Maps.png")?e.css({backgroundImage:"url('"+t+"')"}):(e.attr("pngSrc",t),e.css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"', sizingMethod='scale')"}))},K=function(e,t){e.css({top:t+"px"})},Y=function(e,t){if(e.css({visibility:t>0?"visible":"hidden"}),t>0&&100>t)if(u){var i=e.attr("pngSrc");null==i||-1==i.indexOf("AlphaBar.png")&&-1==i.indexOf("Bars.png")&&-1==i.indexOf("Maps.png")?e.css({opacity:Math.precision(t/100,4)}):e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"', sizingMethod='scale') progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")"})}else e.css({opacity:Math.precision(t/100,4)});else if(0==t||100==t)if(u){var i=e.attr("pngSrc");null==i||-1==i.indexOf("AlphaBar.png")&&-1==i.indexOf("Bars.png")&&-1==i.indexOf("Maps.png")?e.css({opacity:""}):e.css({filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+i+"', sizingMethod='scale')"})}else e.css({opacity:""})},X=function(){_e.active.val("ahex",_e.current.val("ahex"))},J=function(){_e.current.val("ahex",_e.active.val("ahex"))},Z=function(t){e(this).parents("tbody:first").find('input:radio[value!="'+t.target.value+'"]').removeAttr("checked"),O.call(l,t.target.value)},ee=function(){X.call(l)},te=function(){X.call(l),c.window.expandable&&fe.call(l),e.isFunction(de)&&de.call(l,_e.active,j)},ie=function(){J.call(l),c.window.expandable&&fe.call(l),e.isFunction(ue)&&ue.call(l,_e.active,B)},ne=function(){pe.call(l)},se=function(e,t){var i=e.val("hex");$.css({backgroundColor:i&&"#"+i||"transparent"}),Y.call(l,$,Math.precision(100*(e.val("a")||0)/255,4))},re=function(e,t){var i=e.val("hex"),n=e.val("va");L.css({backgroundColor:i&&"#"+i||"transparent"}),Y.call(l,I,Math.precision(100*(255-(n&&n.a||0))/255,4)),c.window.bindToInput&&c.window.updateInputColor&&c.window.input.css({backgroundColor:i&&"#"+i||"transparent",color:null==n||n.v>75?"#000000":"#ffffff"})},oe=function(t){c.window.element,c.window.page;A=parseInt(h.css("left")),k=parseInt(h.css("top")),F=t.pageX,D=t.pageY,e(document).bind("mousemove",ae).bind("mouseup",le),t.preventDefault()},ae=function(t){return h.css({left:A-(F-t.pageX)+"px",top:k-(D-t.pageY)+"px"}),c.window.expandable&&!e.support.boxModel&&h.prev().css({left:h.css("left"),top:h.css("top")}),t.stopPropagation(),t.preventDefault(),!1},le=function(t){return e(document).unbind("mousemove",ae).unbind("mouseup",le),t.stopPropagation(),t.preventDefault(),!1},ce=function(t){return t.preventDefault(),t.stopPropagation(),_e.active.val("ahex",e(this).attr("title")||null,t.target),!1},ue=e.isFunction(a[1])&&a[1]||null,he=e.isFunction(a[2])&&a[2]||null,de=e.isFunction(a[3])&&a[3]||null,pe=function(){_e.current.val("ahex",_e.active.val("ahex"));var t=function(){if(c.window.expandable&&!e.support.boxModel){var t=h.find("table:first");h.before("<iframe/>"),h.prev().css({width:t.width(),height:h.height(),opacity:0,position:"absolute",left:h.css("left"),top:h.css("top")})}};switch(c.window.expandable&&(e(document.body).children("div.jPicker.Container").css({zIndex:10}),h.css({zIndex:20})),c.window.effects.type){case"fade":h.fadeIn(c.window.effects.speed.show,t);break;case"slide":h.slideDown(c.window.effects.speed.show,t);break;case"show":default:h.show(c.window.effects.speed.show,t)}},fe=function(){var t=function(){c.window.expandable&&h.css({zIndex:10}),c.window.expandable&&!e.support.boxModel&&h.prev().remove()};switch(c.window.effects.type){case"fade":h.fadeOut(c.window.effects.speed.hide,t);break;case"slide":h.slideUp(c.window.effects.speed.hide,t);break;case"show":default:h.hide(c.window.effects.speed.hide,t)}},ge=function(){var t=c.window,r=t.expandable?e(l).next().find(".Container:first"):null;h=e(t.expandable?"<div/>":l),h.addClass("jPicker Container"),t.expandable&&h.hide(),h.get(0).onselectstart=function(e){return"input"!==e.target.nodeName.toLowerCase()?!1:void 0};var o=_e.active.val("all");t.alphaPrecision<0?t.alphaPrecision=0:t.alphaPrecision>2&&(t.alphaPrecision=2);var a='<table class="jPicker" cellpadding="0" cellspacing="0"><tbody>'+(t.expandable?'<tr><td class="Move" colspan="5">&nbsp;</td></tr>':"")+'<tr><td rowspan="9"><h2 class="Title">'+(t.title||ye.text.title)+'</h2><div class="Map"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><img src="'+ve.clientPath+ve.colorMap.arrow.file+'" class="Arrow"/></div></td><td rowspan="9"><div class="Bar"><span class="Map1">&nbsp;</span><span class="Map2">&nbsp;</span><span class="Map3">&nbsp;</span><span class="Map4">&nbsp;</span><span class="Map5">&nbsp;</span><span class="Map6">&nbsp;</span><img src="'+ve.clientPath+ve.colorBar.arrow.file+'" class="Arrow"/></div></td><td colspan="2" class="Preview">'+ye.text.newColor+'<div><span class="Active" title="'+ye.tooltips.colors.newColor+'">&nbsp;</span><span class="Current" title="'+ye.tooltips.colors.currentColor+'">&nbsp;</span></div>'+ye.text.currentColor+'</td><td rowspan="9" class="Button"><input type="button" class="Ok" value="'+ye.text.ok+'" title="'+ye.tooltips.buttons.ok+'"/><input type="button" class="Cancel" value="'+ye.text.cancel+'" title="'+ye.tooltips.buttons.cancel+'"/><hr/><div class="Grid">&nbsp;</div></td></tr><tr class="Hue"><td class="Radio"><label title="'+ye.tooltips.hue.radio+'"><input type="radio" value="h"'+("h"==c.color.mode?' checked="checked"':"")+'/>H:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.h:"")+'" title="'+ye.tooltips.hue.textbox+'"/>&nbsp;&deg;</td></tr><tr class="Saturation"><td class="Radio"><label title="'+ye.tooltips.saturation.radio+'"><input type="radio" value="s"'+("s"==c.color.mode?' checked="checked"':"")+'/>S:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.s:"")+'" title="'+ye.tooltips.saturation.textbox+'"/>&nbsp;%</td></tr><tr class="Value"><td class="Radio"><label title="'+ye.tooltips.value.radio+'"><input type="radio" value="v"'+("v"==c.color.mode?' checked="checked"':"")+'/>V:</label><br/><br/></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.v:"")+'" title="'+ye.tooltips.value.textbox+'"/>&nbsp;%<br/><br/></td></tr><tr class="Red"><td class="Radio"><label title="'+ye.tooltips.red.radio+'"><input type="radio" value="r"'+("r"==c.color.mode?' checked="checked"':"")+'/>R:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.r:"")+'" title="'+ye.tooltips.red.textbox+'"/></td></tr><tr class="Green"><td class="Radio"><label title="'+ye.tooltips.green.radio+'"><input type="radio" value="g"'+("g"==c.color.mode?' checked="checked"':"")+'/>G:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.g:"")+'" title="'+ye.tooltips.green.textbox+'"/></td></tr><tr class="Blue"><td class="Radio"><label title="'+ye.tooltips.blue.radio+'"><input type="radio" value="b"'+("b"==c.color.mode?' checked="checked"':"")+'/>B:</label></td><td class="Text"><input type="text" maxlength="3" value="'+(null!=o?o.b:"")+'" title="'+ye.tooltips.blue.textbox+'"/></td></tr><tr class="Alpha"><td class="Radio">'+(t.alphaSupport?'<label title="'+ye.tooltips.alpha.radio+'"><input type="radio" value="a"'+("a"==c.color.mode?' checked="checked"':"")+"/>A:</label>":"&nbsp;")+'</td><td class="Text">'+(t.alphaSupport?'<input type="text" maxlength="'+(3+t.alphaPrecision)+'" value="'+(null!=o?Math.precision(100*o.a/255,t.alphaPrecision):"")+'" title="'+ye.tooltips.alpha.textbox+'"/>&nbsp;%':"&nbsp;")+'</td></tr><tr class="Hex"><td colspan="2" class="Text"><label title="'+ye.tooltips.hex.textbox+'">#:<input type="text" maxlength="6" class="Hex" value="'+(null!=o?o.hex:"")+'"/></label>'+(t.alphaSupport?'<input type="text" maxlength="2" class="AHex" value="'+(null!=o?o.ahex.substring(6):"")+'" title="'+ye.tooltips.hex.alpha+'"/></td>':"&nbsp;")+"</tr></tbody></table>";t.expandable?(h.html(a),0==e(document.body).children("div.jPicker.Container").length?e(document.body).prepend(h):e(document.body).children("div.jPicker.Container:last").after(h),h.mousedown(function(){e(document.body).children("div.jPicker.Container").css({zIndex:10}),h.css({zIndex:20})}),h.css({left:"left"==t.position.x?r.offset().left-530-("center"==t.position.y?25:0)+"px":"center"==t.position.x?r.offset().left-260+"px":"right"==t.position.x?r.offset().left-10+("center"==t.position.y?25:0)+"px":"screenCenter"==t.position.x?(e(document).width()>>1)-260+"px":r.offset().left+parseInt(t.position.x)+"px",position:"absolute",top:"top"==t.position.y?r.offset().top-312+"px":"center"==t.position.y?r.offset().top-156+"px":"bottom"==t.position.y?r.offset().top+25+"px":r.offset().top+parseInt(t.position.y)+"px"})):(h=e(l),h.html(a));var u=h.find("tbody:first");d=u.find("div.Map:first"),p=u.find("div.Bar:first");var A=d.find("span"),k=p.find("span");f=A.filter(".Map1:first"),g=A.filter(".Map2:first"),m=A.filter(".Map3:first"),v=k.filter(".Map1:first"),y=k.filter(".Map2:first"),_=k.filter(".Map3:first"),b=k.filter(".Map4:first"),w=k.filter(".Map5:first"),C=k.filter(".Map6:first"),x=new i(d,{map:{width:ve.colorMap.width,height:ve.colorMap.height},arrow:{image:ve.clientPath+ve.colorMap.arrow.file,width:ve.colorMap.arrow.width,height:ve.colorMap.arrow.height}}),x.bind(q),E=new i(p,{map:{width:ve.colorBar.width,height:ve.colorBar.height},arrow:{image:ve.clientPath+ve.colorBar.arrow.file,width:ve.colorBar.arrow.width,height:ve.colorBar.arrow.height}}),E.bind(z),S=new n(u,_e.active,t.expandable&&t.bindToInput?t.input:null,t.alphaPrecision);var F=null!=o?o.hex:null,D=u.find(".Preview"),H=u.find(".Button");if(T=D.find(".Active:first").css({backgroundColor:F&&"#"+F||"transparent"}),$=D.find(".Current:first").css({backgroundColor:F&&"#"+F||"transparent"}).bind("click",ee),Y.call(l,$,Math.precision(100*_e.current.val("a"))/255,4),B=H.find(".Ok:first").bind("click",ie),j=H.find(".Cancel:first").bind("click",te),M=H.find(".Grid:first"),setTimeout(function(){G.call(l,f,ve.clientPath+"Maps.png"),G.call(l,g,ve.clientPath+"Maps.png"),G.call(l,m,ve.clientPath+"map-opacity.png"),G.call(l,v,ve.clientPath+"Bars.png"),G.call(l,y,ve.clientPath+"Bars.png"),G.call(l,_,ve.clientPath+"Bars.png"),G.call(l,b,ve.clientPath+"Bars.png"),G.call(l,w,ve.clientPath+"bar-opacity.png"),G.call(l,C,ve.clientPath+"AlphaBar.png"),G.call(l,D.find("div:first"),ve.clientPath+"preview-opacity.png")},0),u.find("td.Radio input").bind("click",Z),_e.quickList&&_e.quickList.length>0){for(var V="",W=0;W<_e.quickList.length;W++){"string"==(typeof _e.quickList[W]).toString().toLowerCase()&&(_e.quickList[W]=new s({hex:_e.quickList[W]}));var U=_e.quickList[W].val("a"),Q=_e.quickList[W].val("ahex");!t.alphaSupport&&Q&&(Q=Q.substring(0,6)+"ff");var K=_e.quickList[W].val("hex");V+='<span class="QuickColor"'+(Q&&' title="#'+Q+'"'||"")+' style="background-color:'+(K&&"#"+K||"")+";"+(K?"":"background-image:url("+ve.clientPath+"NoColor.png)")+(t.alphaSupport&&U&&255>U?";opacity:"+Math.precision(U/255,4)+";filter:Alpha(opacity="+Math.precision(U/2.55,4)+")":"")+'">&nbsp;</span>'}G.call(l,M,ve.clientPath+"bar-opacity.png"),M.html(V),M.find(".QuickColor").click(ce)}O.call(l,c.color.mode),_e.active.bind(N),e.isFunction(he)&&_e.active.bind(he),_e.current.bind(se),t.expandable?(l.icon=r.parents(".Icon:first"),L=l.icon.find(".Color:first").css({backgroundColor:F&&"#"+F||"transparent"}),I=l.icon.find(".Alpha:first"),G.call(l,I,ve.clientPath+"bar-opacity.png"),Y.call(l,I,Math.precision(100*(255-(null!=o?o.a:0))/255,4)),P=l.icon.find(".Image:first").css({backgroundImage:"url('"+ve.clientPath+ve.picker.file+"')"}).bind("click",ne),t.bindToInput&&t.updateInputColor&&t.input.css({backgroundColor:F&&"#"+F||"transparent",color:null==o||o.v>75?"#000000":"#ffffff"}),R=u.find(".Move:first").bind("mousedown",oe),_e.active.bind(re)):pe.call(l)},me=function(){h.find("td.Radio input").unbind("click",Z),$.unbind("click",ee),j.unbind("click",te),B.unbind("click",ie),c.window.expandable&&(P.unbind("click",ne),R.unbind("mousedown",oe),l.icon=null),h.find(".QuickColor").unbind("click",ce),d=null,p=null,f=null,g=null,m=null,v=null,y=null,_=null,b=null,w=null,C=null,x.destroy(),x=null,E.destroy(),E=null,S.destroy(),S=null,T=null,$=null,B=null,j=null,M=null,ue=null,de=null,he=null,h.html("");for(var e=0;e<r.length;e++)r[e]==l&&r.splice(e,1)},ve=c.images,ye=c.localization,_e={active:new s("string"==(typeof c.color.active).toString().toLowerCase()?{ahex:!c.window.alphaSupport&&c.color.active?c.color.active.substring(0,6)+"ff":c.color.active}:{ahex:!c.window.alphaSupport&&c.color.active.val("ahex")?c.color.active.val("ahex").substring(0,6)+"ff":c.color.active.val("ahex")}),current:new s("string"==(typeof c.color.active).toString().toLowerCase()?{ahex:!c.window.alphaSupport&&c.color.active?c.color.active.substring(0,6)+"ff":c.color.active}:{ahex:!c.window.alphaSupport&&c.color.active.val("ahex")?c.color.active.val("ahex").substring(0,6)+"ff":c.color.active.val("ahex")}),quickList:c.color.quickList};e.extend(!0,l,{commitCallback:ue,liveCallback:he,cancelCallback:de,color:_e,show:pe,hide:fe,destroy:me}),r.push(l),setTimeout(function(){ge.call(l)},0)})},e.fn.jPicker.defaults={window:{title:null,effects:{type:"slide",speed:{show:"slow",hide:"fast"}},position:{x:"screenCenter",y:"top"},expandable:!1,liveUpdate:!0,alphaSupport:!1,alphaPrecision:0,updateInputColor:!0},color:{mode:"h",active:new s({ahex:"#ffcc00ff"}),quickList:[new s({h:360,s:33,v:100}),new s({h:360,s:66,v:100}),new s({h:360,s:100,v:100}),new s({h:360,s:100,v:75}),new s({h:360,s:100,v:50}),new s({h:180,s:0,v:100}),new s({h:30,s:33,v:100}),new s({h:30,s:66,v:100}),new s({h:30,s:100,v:100}),new s({h:30,s:100,v:75}),new s({h:30,s:100,v:50}),new s({h:180,s:0,v:90}),new s({h:60,s:33,v:100}),new s({h:60,s:66,v:100}),new s({h:60,s:100,v:100}),new s({h:60,s:100,v:75}),new s({h:60,s:100,v:50}),new s({h:180,s:0,v:80}),new s({h:90,s:33,v:100}),new s({h:90,s:66,v:100}),new s({h:90,s:100,v:100}),new s({h:90,s:100,v:75}),new s({h:90,s:100,v:50}),new s({h:180,s:0,v:70}),new s({h:120,s:33,v:100}),new s({h:120,s:66,v:100}),new s({h:120,s:100,v:100}),new s({h:120,s:100,v:75}),new s({h:120,s:100,v:50}),new s({h:180,s:0,v:60}),new s({h:150,s:33,v:100}),new s({h:150,s:66,v:100}),new s({h:150,s:100,v:100}),new s({h:150,s:100,v:75}),new s({h:150,s:100,v:50}),new s({h:180,s:0,v:50}),new s({h:180,s:33,v:100}),new s({h:180,s:66,v:100}),new s({h:180,s:100,v:100}),new s({h:180,s:100,v:75}),new s({h:180,s:100,v:50}),new s({h:180,s:0,v:40}),new s({h:210,s:33,v:100}),new s({h:210,s:66,v:100}),new s({h:210,s:100,v:100}),new s({h:210,s:100,v:75}),new s({h:210,s:100,v:50}),new s({h:180,s:0,v:30}),new s({h:240,s:33,v:100}),new s({h:240,s:66,v:100}),new s({h:240,s:100,v:100}),new s({h:240,s:100,v:75}),new s({h:240,s:100,v:50}),new s({h:180,s:0,v:20}),new s({h:270,s:33,v:100}),new s({h:270,s:66,v:100}),new s({h:270,s:100,v:100}),new s({h:270,s:100,v:75}),new s({h:270,s:100,v:50}),new s({h:180,s:0,v:10}),new s({h:300,s:33,v:100}),new s({h:300,s:66,v:100}),new s({h:300,s:100,v:100}),new s({h:300,s:100,v:75}),new s({h:300,s:100,v:50}),new s({h:180,s:0,v:0}),new s({h:330,s:33,v:100}),new s({h:330,s:66,v:100}),new s({h:330,s:100,v:100}),new s({h:330,s:100,v:75}),new s({h:330,s:100,v:50}),new s]},images:{clientPath:"/jPicker/images/",colorMap:{width:256,height:256,arrow:{file:"mappoint.gif",width:15,height:15}},colorBar:{width:20,height:256,arrow:{file:"rangearrows.gif",width:20,height:7}},picker:{file:"picker.gif",width:25,height:24}},localization:{text:{title:"Drag Markers To Pick A Color",newColor:"new",currentColor:"current",ok:"OK",cancel:"Cancel"},tooltips:{colors:{newColor:"New Color - Press &ldquo;OK&rdquo; To Commit",currentColor:"Click To Revert To Original Color"},buttons:{ok:"Commit To This Color Selection",cancel:"Cancel And Revert To Original Color"},hue:{radio:"Set To &ldquo;Hue&rdquo; Color Mode",textbox:"Enter A &ldquo;Hue&rdquo; Value (0-360&deg;)"},saturation:{radio:"Set To &ldquo;Saturation&rdquo; Color Mode",textbox:"Enter A &ldquo;Saturation&rdquo; Value (0-100%)"},value:{radio:"Set To &ldquo;Value&rdquo; Color Mode",textbox:"Enter A &ldquo;Value&rdquo; Value (0-100%)"},red:{radio:"Set To &ldquo;Red&rdquo; Color Mode",textbox:"Enter A &ldquo;Red&rdquo; Value (0-255)"},green:{radio:"Set To &ldquo;Green&rdquo; Color Mode",textbox:"Enter A &ldquo;Green&rdquo; Value (0-255)"},blue:{radio:"Set To &ldquo;Blue&rdquo; Color Mode",textbox:"Enter A &ldquo;Blue&rdquo; Value (0-255)"},alpha:{radio:"Set To &ldquo;Alpha&rdquo; Color Mode",textbox:"Enter A &ldquo;Alpha&rdquo; Value (0-100)"},hex:{textbox:"Enter A &ldquo;Hex&rdquo; Color Value (#000000-#ffffff)",alpha:"Enter A &ldquo;Alpha&rdquo; Value (#00-#ff)"}}}}}(jQuery,"1.1.6"),define("jpicker",["jquery"],function(){}),function(){!Object.defineProperty||Object.prototype.__defineGetter__||Object.prototype.__defineSetter__||(Object.defineProperty(Object.prototype,"__defineGetter__",{value:function(e,t){Object.defineProperty(this,e,{get:t,enumerable:!0,configurable:!0})},enumerable:!1,configurable:!0}),Object.defineProperty(Object.prototype,"__defineSetter__",{value:function(e,t){Object.defineProperty(this,e,{set:t,enumerable:!0,configurable:!0})},enumerable:!1,configurable:!0}))}(),define("poly-get-set",function(){});var CSSOM={};CSSOM.CSSStyleDeclaration=function(){this.length=0,this.parentRule=null,this._importants={}},CSSOM.CSSStyleDeclaration.prototype={constructor:CSSOM.CSSStyleDeclaration,getPropertyValue:function(e){return this[e]||""},setProperty:function(e,t,i){if(this[e]){var n=Array.prototype.indexOf.call(this,e);0>n&&(this[this.length]=e,this.length++)}else this[this.length]=e,this.length++;this[e]=t,this._importants[e]=i},removeProperty:function(e){if(!(e in this))return"";var t=Array.prototype.indexOf.call(this,e);if(0>t)return"";var i=this[e];return this[e]="",Array.prototype.splice.call(this,t,1),i},getPropertyCSSValue:function(){},getPropertyPriority:function(e){return this._importants[e]||""},getPropertyShorthand:function(){},isPropertyImplicit:function(){},get cssText(){for(var e=[],t=0,i=this.length;i>t;++t){var n=this[t],s=this.getPropertyValue(n),r=this.getPropertyPriority(n);r&&(r=" !"+r),e[t]=n+": "+s+r+";"}return e.join(" ")},set cssText(e){var t,i;for(t=this.length;t--;)i=this[t],this[i]="";Array.prototype.splice.call(this,0,this.length),this._importants={};var n=CSSOM.parse("#bogus{"+e+"}").cssRules[0].style,s=n.length;for(t=0;s>t;++t)i=n[t],this.setProperty(n[t],n.getPropertyValue(i),n.getPropertyPriority(i))}},CSSOM.CSSRule=function(){this.parentRule=null,this.parentStyleSheet=null},CSSOM.CSSRule.STYLE_RULE=1,CSSOM.CSSRule.IMPORT_RULE=3,CSSOM.CSSRule.MEDIA_RULE=4,CSSOM.CSSRule.FONT_FACE_RULE=5,CSSOM.CSSRule.PAGE_RULE=6,CSSOM.CSSRule.WEBKIT_KEYFRAMES_RULE=8,CSSOM.CSSRule.WEBKIT_KEYFRAME_RULE=9,CSSOM.CSSRule.prototype={constructor:CSSOM.CSSRule},CSSOM.CSSStyleRule=function(){CSSOM.CSSRule.call(this),this.selectorText="",this.style=new CSSOM.CSSStyleDeclaration,this.style.parentRule=this},CSSOM.CSSStyleRule.prototype=new CSSOM.CSSRule,CSSOM.CSSStyleRule.prototype.constructor=CSSOM.CSSStyleRule,CSSOM.CSSStyleRule.prototype.type=1,CSSOM.CSSStyleRule.prototype.__defineGetter__("cssText",function(){var e;return e=this.selectorText?this.selectorText+" {"+this.style.cssText+"}":""}),CSSOM.CSSStyleRule.prototype.__defineSetter__("cssText",function(e){var t=CSSOM.CSSStyleRule.parse(e);this.style=t.style,this.selectorText=t.selectorText}),CSSOM.CSSStyleRule.parse=function(e){for(var t,i,n,s=0,r="selector",o=s,a="",l={selector:!0,value:!0},c=new CSSOM.CSSStyleRule,u="";n=e.charAt(s);s++)switch(n){case" ":case"	":case"\r":case"\n":case"\f":if(l[r])switch(e.charAt(s-1)){case" ":case"	":case"\r":case"\n":case"\f":break;default:a+=" "}break;case'"':if(o=s+1,t=e.indexOf('"',o)+1,!t)throw'" is missing';a+=e.slice(s,t),s=t-1;break;case"'":if(o=s+1,t=e.indexOf("'",o)+1,!t)throw"' is missing";a+=e.slice(s,t),s=t-1;break;case"/":if("*"===e.charAt(s+1)){if(s+=2,t=e.indexOf("*/",s),-1===t)throw new SyntaxError("Missing */");s=t+1}else a+=n;break;case"{":"selector"===r&&(c.selectorText=a.trim(),a="",r="name");break;case":":"name"===r?(i=a.trim(),a="",r="value"):a+=n;break;case"!":"value"===r&&e.indexOf("!important",s)===s?(u="important",s+="important".length):a+=n;break;case";":"value"===r?(c.style.setProperty(i,a.trim(),u),u="",a="",r="name"):a+=n;break;case"}":if("value"===r)c.style.setProperty(i,a.trim(),u),u="",a="";else{if("name"===r)break;a+=n}r="selector";break;default:a+=n}return c},CSSOM.MediaList=function(){this.length=0},CSSOM.MediaList.prototype={constructor:CSSOM.MediaList,get mediaText(){return Array.prototype.join.call(this,", ")},set mediaText(e){for(var t=e.split(","),i=this.length=t.length,n=0;i>n;n++)this[n]=t[n].trim()},appendMedium:function(e){-1===Array.prototype.indexOf.call(this,e)&&(this[this.length]=e,this.length++)},deleteMedium:function(e){var t=Array.prototype.indexOf.call(this,e);-1!==t&&Array.prototype.splice.call(this,t,1)}},CSSOM.CSSMediaRule=function(){CSSOM.CSSRule.call(this),this.media=new CSSOM.MediaList,this.cssRules=[]},CSSOM.CSSMediaRule.prototype=new CSSOM.CSSRule,CSSOM.CSSMediaRule.prototype.constructor=CSSOM.CSSMediaRule,CSSOM.CSSMediaRule.prototype.type=4,CSSOM.CSSMediaRule.prototype.__defineGetter__("cssText",function(){for(var e=[],t=0,i=this.cssRules.length;i>t;t++)e.push(this.cssRules[t].cssText);return"@media "+this.media.mediaText+" {"+e.join("")+"}"}),CSSOM.CSSImportRule=function(){CSSOM.CSSRule.call(this),this.href="",this.media=new CSSOM.MediaList,this.styleSheet=new CSSOM.CSSStyleSheet},CSSOM.CSSImportRule.prototype=new CSSOM.CSSRule,CSSOM.CSSImportRule.prototype.constructor=CSSOM.CSSImportRule,CSSOM.CSSImportRule.prototype.type=3,CSSOM.CSSImportRule.prototype.__defineGetter__("cssText",function(){var e=this.media.mediaText;return"@import url("+this.href+")"+(e?" "+e:"")+";"}),CSSOM.CSSImportRule.prototype.__defineSetter__("cssText",function(e){for(var t,i,n=0,s="",r="";i=e.charAt(n);n++)switch(i){case" ":case"	":case"\r":case"\n":case"\f":"after-import"===s?s="url":r+=i;break;case"@":s||e.indexOf("@import",n)!==n||(s="after-import",n+="import".length,r="");break;case"u":if("url"===s&&e.indexOf("url(",n)===n){if(t=e.indexOf(")",n+1),-1===t)throw n+': ")" not found';n+="url(".length;var o=e.slice(n,t);o[0]===o[o.length-1]&&('"'===o[0]||"'"===o[0])&&(o=o.slice(1,-1)),this.href=o,n=t,s="media"}break;case'"':if("url"===s){if(t=e.indexOf('"',n+1),!t)throw n+": '\"' not found";this.href=e.slice(n+1,t),n=t,s="media"}break;case"'":if("url"===s){if(t=e.indexOf("'",n+1),!t)throw n+': "\'" not found';this.href=e.slice(n+1,t),n=t,s="media"}break;case";":"media"===s&&r&&(this.media.mediaText=r.trim());break;default:"media"===s&&(r+=i)}}),CSSOM.CSSFontFaceRule=function(){CSSOM.CSSRule.call(this),this.style=new CSSOM.CSSStyleDeclaration,this.style.parentRule=this},CSSOM.CSSFontFaceRule.prototype=new CSSOM.CSSRule,CSSOM.CSSFontFaceRule.prototype.constructor=CSSOM.CSSFontFaceRule,CSSOM.CSSFontFaceRule.prototype.type=5,CSSOM.CSSFontFaceRule.prototype.__defineGetter__("cssText",function(){return"@font-face {"+this.style.cssText+"}"}),CSSOM.StyleSheet=function(){this.parentStyleSheet=null},CSSOM.CSSStyleSheet=function(){CSSOM.StyleSheet.call(this),this.cssRules=[]},CSSOM.CSSStyleSheet.prototype=new CSSOM.StyleSheet,CSSOM.CSSStyleSheet.prototype.constructor=CSSOM.CSSStyleSheet,CSSOM.CSSStyleSheet.prototype.insertRule=function(e,t){if(0>t||t>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var i=CSSOM.parse(e).cssRules[0];return this.cssRules.splice(t,0,i),t},CSSOM.CSSStyleSheet.prototype.deleteRule=function(e){if(0>e||e>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(e,1)},CSSOM.CSSStyleSheet.prototype.toString=function(){for(var e="",t=this.cssRules,i=0;i<t.length;i++)e+=t[i].cssText+"\n";return e},CSSOM.CSSKeyframesRule=function(){CSSOM.CSSRule.call(this),this.name="",this.cssRules=[]},CSSOM.CSSKeyframesRule.prototype=new CSSOM.CSSRule,CSSOM.CSSKeyframesRule.prototype.constructor=CSSOM.CSSKeyframesRule,CSSOM.CSSKeyframesRule.prototype.type=8,CSSOM.CSSKeyframesRule.prototype.__defineGetter__("cssText",function(){for(var e=[],t=0,i=this.cssRules.length;i>t;t++)e.push("  "+this.cssRules[t].cssText);return"@"+(this._vendorPrefix||"")+"keyframes "+this.name+" { \n"+e.join("\n")+"\n}"}),CSSOM.CSSKeyframeRule=function(){CSSOM.CSSRule.call(this),this.keyText="",this.style=new CSSOM.CSSStyleDeclaration,this.style.parentRule=this},CSSOM.CSSKeyframeRule.prototype=new CSSOM.CSSRule,CSSOM.CSSKeyframeRule.prototype.constructor=CSSOM.CSSKeyframeRule,CSSOM.CSSKeyframeRule.prototype.type=9,CSSOM.CSSKeyframeRule.prototype.__defineGetter__("cssText",function(){return this.keyText+" {"+this.style.cssText+"} "}),CSSOM.parse=function(e){for(var t,i,n,s,r,o,a,l,c,u=0,h="before-selector",d="",p={selector:!0,value:!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0},f=new CSSOM.CSSStyleSheet,g=f,m="",v=/@(-(?:\w+-)+)?keyframes/g,y=function(t){var i=e.substring(0,u).split("\n"),n=i.length,s=i.pop().length+1,r=new Error(t+" (line "+n+", char "+s+")");throw r.line=n,r["char"]=s,r.styleSheet=f,r};c=e.charAt(u);u++)switch(c){case" ":case"	":case"\r":case"\n":case"\f":p[h]&&(d+=c);break;case'"':switch(t=e.indexOf('"',u+1)+1,t||y('Unmatched "'),d+=e.slice(u,t),u=t-1,h){case"before-value":h="value";break;case"importRule-begin":h="importRule"}break;case"'":switch(t=e.indexOf("'",u+1)+1,t||y("Unmatched '"),d+=e.slice(u,t),u=t-1,h){case"before-value":h="value";break;case"importRule-begin":h="importRule"}break;case"/":"*"===e.charAt(u+1)?(u+=2,t=e.indexOf("*/",u),-1===t?y("Missing */"):u=t+1):d+=c,"importRule-begin"===h&&(d+=" ",h="importRule");break;case"@":if(e.indexOf("@media",u)===u){h="atBlock",r=new CSSOM.CSSMediaRule,r.__starts=u,u+="media".length,d="";break}if(e.indexOf("@import",u)===u){h="importRule-begin",u+="import".length,d+="@import";break}if(e.indexOf("@font-face",u)===u){h="fontFaceRule-begin",u+="font-face".length,a=new CSSOM.CSSFontFaceRule,a.__starts=u,d="";break}v.lastIndex=u;var _=v.exec(e);if(_&&_.index===u){h="keyframesRule-begin",l=new CSSOM.CSSKeyframesRule,l.__starts=u,l._vendorPrefix=_[1],u+=_[0].length-1,d="";break}"selector"==h&&(h="atRule"),d+=c;break;case"{":"selector"===h||"atRule"===h?(s.selectorText=d.trim(),s.style.__starts=u,d="",h="before-name"):"atBlock"===h?(r.media.mediaText=d.trim(),g=i=r,r.parentStyleSheet=f,d="",h="before-selector"):"fontFaceRule-begin"===h?(i&&(a.parentRule=i),a.parentStyleSheet=f,s=a,d="",h="before-name"):"keyframesRule-begin"===h?(l.name=d.trim(),i&&(l.parentRule=i),l.parentStyleSheet=f,g=i=l,d="",h="keyframeRule-begin"):"keyframeRule-begin"===h&&(s=new CSSOM.CSSKeyframeRule,s.keyText=d.trim(),s.__starts=u,d="",h="before-name");break;case":":"name"===h?(n=d.trim(),
d="",h="before-value"):d+=c;break;case"(":"value"===h?(t=e.indexOf(")",u+1),-1===t&&y('Unmatched "("'),d+=e.slice(u,t+1),u=t):d+=c;break;case"!":"value"===h&&e.indexOf("!important",u)===u?(m="important",u+="important".length):d+=c;break;case";":switch(h){case"value":s.style.setProperty(n,d.trim(),m),m="",d="",h="before-name";break;case"atRule":d="",h="before-selector";break;case"importRule":o=new CSSOM.CSSImportRule,o.parentStyleSheet=o.styleSheet.parentStyleSheet=f,o.cssText=d+c,f.cssRules.push(o),d="",h="before-selector";break;default:d+=c}break;case"}":switch(h){case"value":s.style.setProperty(n,d.trim(),m),m="";case"before-name":case"name":s.__ends=u+1,i&&(s.parentRule=i),s.parentStyleSheet=f,g.cssRules.push(s),d="",h=g.constructor===CSSOM.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":i||y("Unexpected }"),g.__ends=u+1,f.cssRules.push(g),g=f,i=null,d="",h="before-selector"}break;default:switch(h){case"before-selector":h="selector",s=new CSSOM.CSSStyleRule,s.__starts=u;break;case"before-name":h="name";break;case"before-value":h="value";break;case"importRule-begin":h="importRule"}d+=c}return f},CSSOM.clone=function e(t){var i=new CSSOM.CSSStyleSheet,n=t.cssRules;if(!n)return i;for(var s={1:CSSOM.CSSStyleRule,4:CSSOM.CSSMediaRule,8:CSSOM.CSSKeyframesRule,9:CSSOM.CSSKeyframeRule},r=0,o=n.length;o>r;r++){var a=n[r],l=i.cssRules[r]=new s[a.type],c=a.style;if(c){for(var u=l.style=new CSSOM.CSSStyleDeclaration,h=0,d=c.length;d>h;h++){var p=u[h]=c[h];u[p]=c[p],u._importants[p]=c.getPropertyPriority(p)}u.length=c.length}a.hasOwnProperty("keyText")&&(l.keyText=a.keyText),a.hasOwnProperty("selectorText")&&(l.selectorText=a.selectorText),a.hasOwnProperty("mediaText")&&(l.mediaText=a.mediaText),a.hasOwnProperty("cssRules")&&(l.cssRules=e(a).cssRules)}return i},define("cssom",["poly-get-set"],function(e){return function(){var t;return t||e.CSSOM}}(this)),this.CSSOM=CSSOM,define("cssom-global",["cssom"],function(){}),define("core/utils/css",["jquery","underscore","jpicker","core/utils/is","core/utils/uuid","cssom","cssom-global"],function(e,t,i,n,s,r){return{_rgba_regex:/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([0|1]?(\.\d+)?))?\)$/,_hex_regex:/(^#[0-9A-Fa-f]{6}$)|(^#[0-9A-Fa-f]{3}$)/,_hexa_regex:/(^#[0-9A-Fa-f]{8}$)/,buildCssFromStyleDeclarations:function(e,t){var i="",s="",r="{ ",o="} ",a="";if(n(t,"object")&&n(t.css_prefix,"string")&&(s=t.css_prefix+" "),n(t,"object")&&n(t.formatted,"object")&&n(t.formatted.indentation,"number")){r="{\n",o="}\n\n";for(var l=0;l<t.formatted.indentation;l++)a+=" "}return n(e,"array")||(e=[]),e.forEach(function(e){if(n(e,"object")){var l=e.style_declaration,c="",u="";n(l,"object")&&(!n(l.selector,"string")||l.selector.length<1||n(l.attributes,"object")&&(("body"!==l.selector||s.length<1)&&(c=l.selector+" "),Object.keys(l.attributes).forEach(function(e){u+=this._getAttributeStringValue(l.attributes,e,a,t)},this),u.length>0&&(i+=s+c+r+u+o)))}},this),i},buildCssFromMediaQueriesAndStyleDeclarations:function(e){var i="";return n(e,"array")?i=e.reduce(t.bind(function(e,t){var i=this.mediaQueryAttributesToString(t.media_query),s=this.buildCssFromStyleDeclarations(t.style_declarations);return n(i,"string")&&i.length>0&&(s=i+" { "+s+"}"),e+s},this),""):i},buildMediaQueriesAndStyleDeclarationsFromCss:function(e,t){var i,s;return!n(e,"number")||0>e?!1:!n(t,"string")||t.length<1?!1:(i=r.parse(t),s=this._generateMediaQueriesAndStyleDeclarations(i,e),{style_declarations:s.style_declarations,media_queries:s.media_queries})},mediaQueryAttributesToString:function(e){var i;return n(e,"media_query")?(i=e.getMediaQuery(),i.is_default?"":t.reduce(i.attributes,function(e,t,i){return e+" and ("+i+": "+t+")"},"@media only "+i.type)):""},getSelectorForMediaQuery:function(e){return n(e,"object")&&n(e.getMediaQuery,"function")&&n(e.getMediaQuery(),"object")?"[data-styles-mq-"+e.getMediaQuery().id+"]":!1},getColorObject:function(t){var i,s,r;return n(t,"string")?(i=this._rgba_regex.exec(t),n(s,"undefined")&&n(i,"array")&&i.length>=3&&(r=n(i[4],"string")?Math.floor(255*parseFloat(i[4])):255,s=new e.jPicker.Color({r:parseInt(i[1],10),g:parseInt(i[2],10),b:parseInt(i[3],10),a:parseInt(r,10)})),n(s,"undefined")&&this._hexa_regex.test(t)&&(s=new e.jPicker.Color({ahex:t})),n(s,"undefined")&&this._hex_regex.test(t)&&(4===t.length&&(t=this.threeDigitRGBToSixDigitRRGGBB(t)),s=new e.jPicker.Color({hex:t})),s instanceof e.jPicker.Color?s.val():!1):!1},getColorFromValue:function(e){var t,i=function(e){return e.toString().slice(1,-1).replace(/\^|\$/g,"").replace(/\$/,"")},s=new RegExp("("+i(this._rgba_regex)+")"),r=new RegExp("("+i(this._hexa_regex).replace(/\(|\)/g,"")+")"),o=new RegExp("("+i(this._hex_regex).replace(/\(|\)/g,"")+")");return n(e,"string")?(t=s.exec(e))?t[1]:(t=r.exec(e))?t[1]:(t=o.exec(e),t?t[1]:!1):!1},threeDigitRGBToSixDigitRRGGBB:function(e){var t,i,s;return n(e,"string")&&4===e.length?(t=e.charAt(1),i=e.charAt(2),s=e.charAt(3),e.charAt(0)+t+t+i+i+s+s):!1},_getAttributeStringValue:function(e,t,i,s){var r,o="";return r=e[t],n(r,"array")?(r.forEach(function(e){n(e,"array")&&(e=e.join(",")),!n(e,"string")||e.length<1||(o+=n(s,"object")&&n(s.formatted,"object")?i+t+": "+e+";\n":t+": "+e+"; ")},this),o):""},_generateMediaQueriesAndStyleDeclarations:function(e,i,s){var r,o,a,l;return r={media_queries:[],style_declarations:[]},(!n(s,"string")||s.length<1)&&(o={id:this._getMediaQueryUUID(),is_default:!0,style_id:i,type:"all",attributes:{}},s=o.id,r.media_queries.push(o)),e.cssRules.forEach(function(e){n(e.media,"object")?t.each(e.media,function(t){var n,s,o;n={id:this._getMediaQueryUUID(),style_id:i,attributes:{}},s=t.split("and "),s.forEach(function(e){0!==e.indexOf("(")?n.type=e.split(" ").splice(-2,1)[0]:(o=e.match(/\(\s*([^:]+)\s*:\s*([^\)]+)\s*\)/),n.attributes[o[1]]=o[2])}),r.media_queries.push(n),a=this._generateMediaQueriesAndStyleDeclarations(e,i,n.id),r.media_queries=r.media_queries.concat(a.media_queries),r.style_declarations=r.style_declarations.concat(a.style_declarations)},this):(l=this._generateStyleDeclaration(e,i,s),r.style_declarations.push(l))},this),r},_generateStyleDeclaration:function(e,t,i){var n,s,r,o={selector:e.selectorText,id:this._getStyleDeclarationUUID(),attributes:{},style_id:t,media_query_id:i};for(s=0,r=e.style.length;r>s;s++)n=e.style[s],o.attributes[n]=[e.style[n]];return o},_getUUID:function(){return s()},_getMediaQueryUUID:function(){return this._getUUID()},_getStyleDeclarationUUID:function(){return this._getUUID()}}}),define("modules/service/connection/types/connectiontype/index",["backbone","underscore","core/utils/is","core/typecastError"],function(e,t,i,n){var s=function(e){i(e,"object")&&Object.keys(e).forEach(function(t){this[t]=e[t]},this)};return s.prototype.initialize=function(){},s.prototype.connect=function(){throw new n(101,"This function should not be called directly. Extend from this module and override the function.")},s.prototype.disconnect=function(){throw new n(102,"This function should not be called directly. Extend from this module and override the function.")},s.prototype.getInitData=function(){throw new n(103,"This function should not be called directly. Extend from this module and override the function.")},s.prototype.cleanInitData=function(e){return i(e,"object")&&i(e.data,"object")&&i(e.data.elements,"object")&&i(e.data.elements.elements,"array")?(e.data.elements.elements=s.prototype._removeWhitespaceTextNodes(e.data.elements.elements),e):e},s.prototype.update=function(){throw new n(104,"This function should not be called directly. Extend from this module and override the function.")},s.prototype._removeWhitespaceTextNodes=function(e){return t.map(e,function(e){return i(e.children,"array")&&(e.children=t.reject(e.children,function(e){return!/\S/.test(e.content)})),e})},s.extend=e.View.extend,s=s.extend(e.Events),s.prototype.extend=e.View.extend,s}),define("connection_type",["jquery","backbone","underscore","core/utils/is","core/typecastError","core/utils/dom","core/utils/css","modules/service/connection/types/connectiontype/index"],function(e,t,i,n,s,r,o,a){return a.extend({namespace:"ajax",project_id:null,permissions:null,legacy_container_id:null,initialize:function(){this.config=this.config[this.namespace]},connect:function(e,t){e.call(t,null)},getInitData:function(e,t,n){var r=this._getProjectData(e.project_id);r.done(i.bind(function(i){var s={data:{}};this.project_id=e.project_id,this.permissions=i.permissions,this.legacy_container_id=i.containers[0].id,this._addProjectMetaToInitData(i,s),this._addElementTreeToInitData(i,s),this._addStylesToInitData(i,s),this._addFontsToInitData(i,s),t.call(n,null,this.cleanInitData(s))},this)),r.fail(i.bind(function(e){t.call(n,new s(e.code,e.message)),this.trigger("initialization-status",{alert:{id:103,level:"fatal"}})},this))},update:function(e,t,s,r,o){var a,l;return"external:previous-version:change"===t&&n(s,"array")&&n(s[0],"number")?(a=this._revertToRevision(s[0]),a.done(i.bind(function(i){this.trigger("receive",e,t,[i])},this)),!0):"data:project:set"===t?(l=this._saveProject(t,"push",r,o),l.done(i.bind(function(i){this.trigger("receive",e,t,[{},i])},this)),l.fail(i.bind(function(i){this.trigger("receive",e,t,[null,i])},this)),!0):"data:project:forceSave:complete"===t?(l=this._saveProject(t,s[0],r,o),l.done(i.bind(function(i){this.trigger("receive",e,t,[i])},this)),l.fail(i.bind(function(i){this.trigger("receive",e,t,[i])},this)),!0):!1},_addElementTreeToInitData:function(e,t){var i=document.createElement("html");t.data.elements={},i.innerHTML=e.containers[0].content,t.data.elements.elements=r.buildElementTreeFromRootNode(i.childNodes[1])},_addFontsToInitData:function(e,t){t.data.fonts={},t.data.fonts.activeFonts=e.styles[0].active_fonts},_addProjectMetaToInitData:function(e,t){t.data.project={id:e.project_id,title:e.name,type:e.type,lock:e.lock}},_addStylesToInitData:function(e,t){t.data.styles={styles:[],media_queries:[],style_declarations:[]},i.each(e.styles,function(e){var i,n=parseInt(e.id,10);t.data.styles.styles.push({id:n,title:""}),i=o.buildMediaQueriesAndStyleDeclarationsFromCss(n,e.content),t.data.styles.media_queries=t.data.styles.media_queries.concat(i.media_queries),t.data.styles.style_declarations=t.data.styles.style_declarations.concat(i.style_declarations)},this)},_buildProjectDataForSave:function(){var t={project_name:new e.Deferred,containers:new e.Deferred,styles:new e.Deferred,active_fonts_list:new e.Deferred};return this.imc.trigger("data:project:get","title",function(e,i){return e?(t.project_name.reject(e),!1):void t.project_name.resolve(i)},this),this.imc.trigger("data:elements:getElements",function(e,i){var n,s;return e?(t.containers.reject(e),!1):(n=[{id:this.legacy_container_id,name:""}],s=r.getDomNodesForElementTree(i.element,!0),n[0].content=s.outerHTML,void t.containers.resolve(n))},this),this.imc.trigger("data:styles:getStylesWithMediaQueriesAndStyleDeclarations",function(e,n){e&&t.styles.reject(e),n=i.map(n,function(e){return{id:e.style.id,name:"",content:o.buildCssFromMediaQueriesAndStyleDeclarations(e.media_queries)}},this),t.active_fonts_list.done(function(e){n=i.map(n,function(t){return t.active_fonts=e,t},this),t.styles.resolve(n)})},this),this.imc.trigger("data:fonts:getActiveFontsList",function(e,i){return e?(t.active_fonts_list.reject(e),!1):void t.active_fonts_list.resolve(i)}),e.when.apply(e,i.values(t)).then(i.bind(function(e,t,i){return JSON.stringify({project_id:this.project_id,name:e,permissions:this.permissions,containers:t,styles:i})},this)).promise()},_catchSuccessErrorResponse:function(t){var i,s=this._parseAPIResponse(t);return n(s.success,"boolean")&&!s.success?(i=new e.Deferred,i.reject(s),i.promise()):s},_convertGetProjectDataErrorResponseToObject:function(e){var t={code:102,message:"Unable to get project"};return n(e.message,"string")&&e.message.length>0&&(t.code=101,t.message=e.message),t},_getBaseURL:function(){return window.location.protocol+"//"+window.location.hostname},_getFullEndpointURL:function(e,t){return i.each(t,function(t,i){e=e.replace("{{"+i+"}}",t)}),this._getBaseURL()+e},_getProjectData:function(t,s){var r,o=this.config.fetch_url,a={project_id:t};return n(s,"number")&&(o=this.config.fetch_revision_url,a.revision=s),r=e.ajax({method:"GET",url:this._getFullEndpointURL(o,a)}),r=r.then(i.bind(this._catchSuccessErrorResponse,this)),r.then(null,i.bind(this._convertGetProjectDataErrorResponseToObject,this))},_handleSaveFailure:function(e,t,i,r,o){var a=103;return n(e.message,"string")&&0===e.message.indexOf("Error (105)")&&(a=104),this.trigger("change-event-status",{event:"fault",update_name:t,update_sender:i,alert:{id:a,level:"fatal"}}),n(r,"function")&&r.call(o,new s(a,"Unable to save project")),!0},_makeProjectSaveRequest:function(t,n){var s=e.ajax({method:"POST",url:this._getFullEndpointURL(this.config.save_url,{project_id:this.project_id}),data:{project:t,save_type:n}});return s.then(i.bind(this._catchSuccessErrorResponse,this))},_parseAPIResponse:function(e){var t;try{t=JSON.parse(e)}catch(i){t={success:!1}}return t},_revertToRevision:function(e){var t=this._getProjectData(this.project_id,e);return t=t.then(i.bind(function(e){return this._makeProjectSaveRequest(JSON.stringify(e),"push")},this))},_saveProject:function(e,t,s,r){var o,a=this._buildProjectDataForSave();return o=a.then(i.bind(function(e){return this._makeProjectSaveRequest(e,t)},this)),o=o.then(null,function(e){var t={success:!1};return n(e,"object")&&n(e.message,"string")&&(t.message=e.message),t}),o.done(i.bind(function(){n(s,"function")&&s.call(r,null)},this)),o.fail(i.bind(function(t){this._handleSaveFailure(t,e,"service:collaboration",s,r)},this)),o}})}),define("service/connection/index",["backbone","underscore","connection_type","core/typecastError","core/utils/is","core/utils/cast"],function(e,t,i,n,s,r){return e.DataController.extend({namespace:"service:connection",listeners:{getInitData:"getInitData",send:"send"},ConnectionType:i,connection:null,connected:!1,connection_event_mappings:{"connection-status":"_connectionEventConnectionStatus","initialization-status":"_connectionEventInitializationStatus","external-event-status":"_connectionEventExternalEventStatus","system-status":"_connectionEventSystemStatus","change-event-status":"_connectionEventChangeEventStatus",receive:"_receive","imc-proxy":"_proxyToImc"},error_handler_ids:{"initialization-status-101":201,"initialization-status-103":202,"initialization-status-102":203,"system-status-101":204,"system-status-102":205,"connection-status-101":206,"connection-status-102":207,"connection-status-103":208,"connection-status-104":209,"external-event-status-101":210,"external-event-status-102":211,"external-event-status-103":212,"external-event-status-104":213,"change-event-status-101,":214,"change-event-status-102":215,"change-event-status-103":216,"change-event-status-104":217},initialize:function(){if(!s(this.config.types,"object"))throw new n(101,"No connection type config data");return s(this.config.information_message_timeout,"number")||(this.config.information_message_timeout=3e3),this._instantiateConnectionType(),!0},getInitData:function(e,t,i){return t=s(t,"function")?t:!1,this.connected?this.connection.getInitData(e,t,i):(t&&t.call(i,new n(101,"Cannot request initialization data before connected")),!1)},send:function(e,t,i,r,o){return r=s(r,"function")?r:!1,this.connected?this.connection.update(e,t,i,r,o):(r&&r.call(o,new n(101,"Cannot send update before connected")),!1)},_receive:function(){var e=r(arguments,"array");return s(e,"array")?(e=["receive"].concat(e),this.announce.apply(this,e)):!1},_proxyToImc:function(){var e=r(arguments,"array");return s(e,"array")?this.imc.trigger.apply(this.imc,e):!1},_displayMessage:function(e,t,i){var n=i+"-"+e,s=this.error_handler_ids[n],r=this;return this.imc.trigger("ui:error:open",s,t),"info"===t&&setTimeout(function(){r.imc.trigger("ui:error:close")},this.config.information_message_timeout),!0},_dealWithStatusEvent:function(e,t){return s(e,"string")&&""!==e?(s(t,"object")&&s(t.alert,"object")&&this._displayMessage(t.alert.id,t.alert.level,e),this.announce(e,t)):!1},_connectionEventConnectionStatus:function(e){var t="connection-status";return this._dealWithStatusEvent(t,e)},_connectionEventInitializationStatus:function(e){var t="initialization-status";return this._dealWithStatusEvent(t,e)},_connectionEventExternalEventStatus:function(e){var t="external-event-status";return this._dealWithStatusEvent(t,e)},_connectionEventSystemStatus:function(e){var t="system-status";return this._dealWithStatusEvent(t,e)},_connectionEventChangeEventStatus:function(e){var t="change-event-status";return this._dealWithStatusEvent(t,e)},_instantiateConnectionType:function(){var e,i=this;return s(this.ConnectionType,"function")?(e={config:t.defaults(this.config.types,{cache_beater:this.config.cache_beater}),imc:this.imc,log:function(){i.log.apply(i,arguments)}},this.connection=new this.ConnectionType(e),this._bindEventsToConnection(),this.connection.initialize(),setTimeout(function(){i.connection.connect(i._connectionTypeConnected,i)},1),!0):(this.log("error","Connection type not valid"),!1)},_connectionTypeConnected:function(e){var t;return e?(t="Unable to connect",t+=e instanceof n?" -  Error code: "+e.getCode()+", Message: "+e.getMessage():" - "+e,this.log("error",t),!1):(this.connected=!0,this.announce("ready"),!0)},_bindEventsToConnection:function(){var e=Object.keys(this.connection_event_mappings);return e.forEach(function(e){var t=this[this.connection_event_mappings[e]];s(t,"function")&&this.connection.on(e,t,this)},this),!0}})}),function(){var e={error:5,warn:4,info:3,debug:2,log:1},t=function(e){var t=document.createElement("img");t.src=e.url+".gif?PLAINTEXT="+encodeURIComponent(e.data)+"&DT="+encodeURIComponent(Date())},i=function(i){if(!i.url)throw new Error("Please include a Loggly HTTP URL.");i.level?this.level=e[i.level.toLowerCase()]:this.level=e.info;var n=function(n){return function(s){if(e[n]>=this.level){if("string"!=typeof s)try{s=JSON.stringify(s)}catch(r){}i.data=s,t(i)}}};for(name in e)this[name]=n(name)};this.loggly?this.loggly.castor=i:this.loggly={castor:i}}(),define("loggly",function(e){return function(){var t;return t||e.loggly}}(this)),define("service/log/index",["jquery","backbone","underscore","core/utils/is","loggly"],function(e,t,i,n,s){var r={info:3,warn:2,error:1},o=t.DataController.extend({namespace:"service:log",listeners:{info:"info",warn:"warn",error:"error"},castor:null,info:function(){return this.loggingProxy("info",arguments)},warn:function(){return this.loggingProxy("warn",arguments)},error:function(){return this.loggingProxy("error",arguments)},loggingProxy:function(e,t){return n(r[e],"number")&&r[e]<=this.log_level?(this.writeToConsole(e,t),this.writeToCloud(e,t),!0):!1},writeToCloud:function(e,t){return this.cloud_logging_enabled?-1===this.cloud_logging_levels.indexOf(e)?!1:n(this.castor,"object")?(this.castor.log(t),!1):!1:!1},writeToConsole:function(e,t){if(!this.console_logging_enabled)return!1;switch(e){case"info":console.log.apply(console,t);break;case"warn":console.warn.apply(console,t);break;case"error":console.error.apply(console,t)}},initialize:function(){return this.console_logging_enabled=!0,this.cloud_logging_enabled=!0,this.cloud_logging_levels=[],this.log_level=3,n(this.config,"object")?(n(this.config.console_logging_enabled,"boolean")&&(this.console_logging_enabled=this.config.console_logging_enabled),n(this.config.cloud_logging_enabled,"boolean")&&(this.cloud_logging_enabled=this.config.cloud_logging_enabled),n(this.config.cloud_logging_levels,"array")&&(this.cloud_logging_levels=this.config.cloud_logging_levels),n(this.config.log_level,"number")&&(this.log_level=this.config.log_level),!n(this.config.loggly_key,"string")||this.config.loggly_key.length<1?!1:(this.castor=new s.castor({url:"//logs.loggly.com/inputs/"+this.config.loggly_key,level:"log"}),this)):!1}});return o});var Froogaloop=function(){function e(t){return new e.fn.init(t)}function t(e,t,i){if(!i.contentWindow.postMessage)return!1;var n=i.getAttribute("src").split("?")[0],e=JSON.stringify({method:e,value:t});"//"===n.substr(0,2)&&(n=window.location.protocol+n),i.contentWindow.postMessage(e,n)}function i(e){var t,i;try{t=JSON.parse(e.data),i=t.event||t.method}catch(n){}if("ready"==i&&!r&&(r=!0),e.origin!=o)return!1;var e=t.value,a=t.data,l=""===l?null:t.player_id;return t=l?s[l][i]:s[i],i=[],t?(void 0!==e&&i.push(e),a&&i.push(a),l&&i.push(l),0<i.length?t.apply(null,i):t.call()):!1}function n(e,t,i){i?(s[i]||(s[i]={}),s[i][e]=t):s[e]=t}var s={},r=!1,o="";return e.fn=e.prototype={element:null,init:function(e){"string"==typeof e&&(e=document.getElementById(e)),this.element=e,e=this.element.getAttribute("src"),"//"===e.substr(0,2)&&(e=window.location.protocol+e);for(var e=e.split("/"),t="",i=0,n=e.length;n>i&&3>i;i++)t+=e[i],2>i&&(t+="/");return o=t,this},api:function(e,i){if(!this.element||!e)return!1;var s=this.element,r=""!==s.id?s.id:null,o=i&&i.constructor&&i.call&&i.apply?null:i,a=i&&i.constructor&&i.call&&i.apply?i:null;return a&&n(e,a,r),t(e,o,s),this},addEvent:function(e,i){if(!this.element)return!1;var s=this.element,o=""!==s.id?s.id:null;return n(e,i,o),"ready"!=e?t("addEventListener",e,s):"ready"==e&&r&&i.call(null,o),this},removeEvent:function(e){if(!this.element)return!1;var i,n=this.element;e:{if((i=""!==n.id?n.id:null)&&s[i]){if(!s[i][e]){i=!1;break e}s[i][e]=null}else{if(!s[e]){i=!1;break e}s[e]=null}i=!0}"ready"!=e&&i&&t("removeEventListener",e,n)}},e.fn.init.prototype=e.fn,window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent("onmessage",i),window.Froogaloop=window.$f=e}();define("froogaloop",function(e){return function(){var t;return t||e.Froogaloop}}(this)),define("kissmetrics",[],function(){function e(){return"typecast.com"===window.location.host||"www.typecast.com"===window.location.host?i.live:i.dev}function t(e){setTimeout(function(){var t=document,i=t.getElementsByTagName("script")[0],n=t.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,i.parentNode.insertBefore(n,i)},1)}var i={live:"137c85863bbd16f8905effe4d5d9c019bb485101",dev:"c985ff48f44df01caea9a26793d3b193ae939937"};return window._kmq=window._kmq||[],window._kmk=window._kmk||e(),window._kms=t,t("//i.kissmetrics.com/i.js"),t("//doug1izaerwt3.cloudfront.net/"+_kmk+".1.js"),window._kmq}),define("service/metrics/index",["backbone","froogaloop","kissmetrics","core/utils/is"],function(e,t,i,n){"use strict";var s=e.DataController.extend({namespace:"service:metrics",listeners:{record:"record","track-vimeo":"trackVimeo","[remote]app:initialize:complete":"trackOpenEditor"},previous_metric:null,initialize:function(){var e=this.config;return n(e,"object")&&n(e.identify,"string")&&e.identify.length>0&&this.identify(e.identify),this},record:function(e,t){return this.trackMetric(this.prepareMetric("record",e,t))},trackVimeo:function(e,i){if(!e)return!1;i||(i=e);var n=t(e),s=this;return n.addEvent("ready",function(){n.addEvent("play",function(){s.record("Started watching "+i)}),n.addEvent("finish",function(){s.record("Finished watching "+i)})}),!0},trackSignUp:function(){n(this.config,"object")&&n(this.config.first_time,"boolean")&&this.config.first_time&&(this.trackMetric(this.prepareMetric("record","User signup")),this.trackMetric(this.prepareMetric("record","Started first project")))},trackOpenEditor:function(){this.trackSignUp(),this.trackMetric(this.prepareMetric("record","Opened editor"))},trackMetric:function(e){var t=this.previous_metric;return!n(e,"array")||e.length<2?!1:t&&e[0]===t[0]&&e[1]===t[1]?!1:(this.previous_metric=e,window._kmq?(window._kmq.push(e),!0):!1)},identify:function(e,t){return this.trackMetric(this.prepareMetric("identify",e,t))},prepareMetric:function(e,t,i){var s=[];return!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:(s=[e,t],n(i,"object")&&s.push(i),s)}});return s}),define("service/collaboration/index",["jquery","underscore","backbone","core/utils/is","core/utils/cast","core/utils/dom","core/typecastError"],function(e,t,i,n,s,r,o){return i.DataController.extend({namespace:"service:collaboration",listeners:{"[remote]data:project:changed":"updatedProject","[remote]data:project:forceSave":"saveProject","[remote]data:elements:new:element":"newElement","[remote]data:elements:updated:element":"updatedElement","[remote]data:elements:deleted:element":"deletedElement","[remote]data:styles:changed":"changedStyle","[remote]data:styles:deleted:styleDeclaration":"deletedStyleDeclaration","[remote]data:styles:new:mediaQuery":"newMediaQuery","[remote]data:styles:updated:mediaQuery":"updatedMediaQuery","[remote]data:styles:deleted:mediaQuery":"deletedMediaQuery","[remote]data:fonts:changed:active-fonts":"changedActiveFonts","[remote]external:previous-version:changed":"changedToPreviousVersion","[remote]service:connection:receive":"receivedUpdate"},throttle_timer:null,event_queue:null,initialize:function(){if(!n(this.config.event_mappings,"object"))throw this.log("error","The config supplied does not contain event mapping details."),new o(101,"The config supplied does not contain event mapping details.");n(this.config.throttle_interval,"number")||(this.config.throttle_interval=500),this.event_queue=[]},updatedProject:function(e){var t,i="data:project:changed";return n(e,"object")?(this._setSavedState(!1),t=s(arguments,"array"),this._convertEventAndSend.apply(this,[i,e.id.toString()].concat(t))):(this.log("error","Project data provided is not an object"),!1)},saveProject:function(){var e,t="data:project:forceSave";return e=s(arguments,"array"),this._convertEventAndSend.apply(this,[t,(new Date).getTime().toString()].concat(e))},newElement:function(){var e="data:elements:new:element",t=s(arguments,"array");return this._elementStateEvent.apply(this,[e].concat(t))},updatedElement:function(){var e="data:elements:updated:element",t=s(arguments,"array");return this._elementStateEvent.apply(this,[e].concat(t))},deletedElement:function(){var e="data:elements:deleted:element",t=s(arguments,"array");return this._elementStateEvent.apply(this,[e].concat(t))},changedStyle:function(e,t,i,r){var o,a="data:styles:changed";return n(e,"number")?n(i,"string")?n(r,"object")?(o=s(arguments,"array"),this._styleStateEvent.apply(this,[a,r.style_declaration.id].concat(o))):(this.log("error","Style declaration data provided is not an object"),!1):(this.log("error","Selector provided is not a string"),!1):(this.log("error","Style Id provided is not a number"),!1)},deletedStyleDeclaration:function(e,t){var i,r="data:styles:deleted:styleDeclaration";return n(e,"string")?n(t,"object")?(i=s(arguments,"array"),this._styleStateEvent.apply(this,[r,t.id].concat(i))):(this.log("error","Style declaration data provided is not an object"),!1):(this.log("error","Selector provided is not a string"),!1)},newMediaQuery:function(){var e="data:styles:new:mediaQuery",t=s(arguments,"array");return this._mediaQueryStateEvent.apply(this,[e].concat(t))},updatedMediaQuery:function(){var e="data:styles:updated:mediaQuery",t=s(arguments,"array");return this._mediaQueryStateEvent.apply(this,[e].concat(t))},deletedMediaQuery:function(){var e="data:styles:deleted:mediaQuery",t=s(arguments,"array");return this._mediaQueryStateEvent.apply(this,[e].concat(t))},changedActiveFonts:function(e){var t,i="data:fonts:changed:active-fonts";return!n(e,"array")||e.length<1?(this.log("error","Fonts list provided is not an array"),!1):(t=s(arguments,"array"),this._convertEventAndSend.apply(this,[i,i].concat(t)))},changedToPreviousVersion:function(e){var t,i="external:previous-version:changed";return e=s(e,"number"),n(e,"number")?(t=s(arguments,"array"),this._convertEventAndSend.apply(this,[i,i].concat(t))):(this.log("error","Revision number provided is not a number"),!1)},receivedUpdate:function(e,t,i){var s,r;return e!==this.namespace?!1:n(t,"string")&&""!==t?(n(i,"undefined")&&(i=[]),n(i,"array")?(s=i[i.length-1],n(s,"object")?s.remote=!0:i.push({remote:!0}),r="_"+t,n(this[r],"function")?(this[r].apply(this,[t].concat(i)),!0):(this.log("error","Received remote event with no corresponding function"),!1)):!1):!1},"_data:project:set":function(e,t,i){var s;return n(t,"object")?(this._setSavedState(!0),s=Object.keys(t),s.forEach(function(n){this.imc.trigger(e,n,t[n],i)},this),!0):!1},"_data:project:forceSave:complete":function(e,t){return n(t,"object")?(t.success&&this._setSavedState(!0),this.imc.trigger(e,t),!0):!1},"_data:elements:createElement":function(e,t,i){var s,o;return n(t,"object")?(s=t.element,o=r.getDomNodesForElementTree(s),s.content=o.innerHTML,this.imc.trigger(e,s,i),!0):!1},"_data:elements:updateElement":function(e,t,i){var s,o;return n(t,"object")?(s=t.element,o=r.getDomNodesForElementTree(s),s.content=o.innerHTML,this.imc.trigger(e,s.id,s,i),!0):!1},"_data:elements:deleteElement":function(e,t,i){return n(t,"object")?(this.imc.trigger(e,t.element.id,i),!0):!1},"_data:styles:setAttributesForStyleDeclaration":function(e,t,i,s,r,o,a){return n(r,"object")?(this.imc.trigger(e,t,i,s,r.style_declaration.attributes,a),!0):!1},"_data:styles:deleteStyleDeclaration":function(e,t,i,s){return n(i,"object")?(this.imc.trigger(e,i.style_id,i.media_query_id,t,s),!0):!1},"_data:styles:createMediaQuery":function(e,t,i){var s;return n(t,"object")?(s=t.media_query,this.imc.trigger(e,s.style_id,s.type,s.attributes,i),!0):!1},"_data:styles:updateMediaQuery":function(e,t,i){var s,r;return n(t,"object")?(s=t.media_query,r={type:s.type,attributes:s.attributes},this.imc.trigger(e,s.style_id,s.id,r,i),!0):!1},"_data:styles:deleteMediaQuery":function(e,t,i){var s;return n(t,"object")?(s=t.media_query,this.imc.trigger(e,s.style_id,s.id,i),!0):!1},"_data:fonts:set:active-fonts":function(e,t,i){return this.imc.trigger(e,t,i),!0},"_external:previous-version:change":function(e){return this.imc.trigger(e),!0},_elementStateEvent:function(e,t){var i,r;return n(e,"string")&&""!==e?n(t,"object")?(this._setSavedState(!1),r=t.id,n(r,"undefined")&&n(t.element,"object")&&(r=t.element.id),i=s(arguments,"array",1),this._convertEventAndSend.apply(this,[e,r.toString()].concat(i))):(this.log("error","Element data provided is not an object"),!1):(this.log("error","Event name provided is not a string"),!1)},_styleStateEvent:function(e,t){var i;return n(e,"string")&&""!==e?n(t,"string")&&""!==t?(this._setSavedState(!1),i=s(arguments,"array",2),this._convertEventAndSend.apply(this,[e,t].concat(i))):(this.log("error","Style declaration id provided is not a string"),!1):(this.log("error","Event name provided is not a string"),!1)},_mediaQueryStateEvent:function(e,t){var i,r,o;return n(t,"object")?(o=t.getMediaQuery(),n(e,"string")&&""!==e?n(o,"object")?(this._setSavedState(!1),r=o.id,i=s(arguments,"array",1),this._convertEventAndSend.apply(this,[e,r.toString()].concat(i))):(this.log("error","Media query provided is not an object"),!1):(this.log("error","Event name provided is not a string"),!1)):(this.log("error","Media query response data provided is not an object"),!1)},_setSavedState:function(e){return n(e,"boolean")?(this.imc.trigger("data:state:set","saved",e),!0):!1},_convertEventAndSend:function(e,t){var i,r;return n(e,"string")&&""!==e&&n(t,"string")&&""!==t?(i=this._getEventMapping(e),n(i,"object")?(r=s(arguments,"array",2),this._send.apply(this,[i.event_name,e+t].concat(r)),!0):!1):!1},_getEventMapping:function(e){var t;return n(e,"string")&&""!==e?(t=this.config.event_mappings[e],n(t,"object")?t:(this.log("error","Event mapping data is not available for event "+e),!1)):!1},_send:function(e,t){var i,r=s(arguments,"array",2),o=this;return n(e,"string")&&""!==e&&n(t,"string")&&""!==t?(i=this._addToEventQueue(e,t,r),n(this.throttle_timer,"null")&&i&&(this.throttle_timer=setTimeout(function(){o.throttle_timer=null,o._triggerEventQueue()},this.config.throttle_interval)),i):!1},_addToEventQueue:function(e,t,i){var s,r,o;return n(e,"string")&&""!==e&&n(t,"string")&&""!==t&&n(i,"array")?(o=i[i.length-1],
n(o,"object")&&o.remote===!0?!1:(r={name:e,args:i,unique_id:t},s=this._shouldOverwriteLastEvent(e,t),s?this.event_queue[this.event_queue.length-1]=r:this.event_queue.push(r),!0)):!1},_shouldOverwriteLastEvent:function(e,t){var i;return n(e,"string")&&""!==e&&n(t,"string")&&""!==t?this.event_queue.length<1?!1:(i=this.event_queue[this.event_queue.length-1],i.name===e&&i.unique_id===t):!1},_triggerEventQueue:function(){var e,t=this;return e=this.event_queue.splice(0,this.event_queue.length),e.length<1?!0:(e.forEach(function(e){var i=["service:connection:send",t.namespace,e.name,e.args];t.imc.trigger.apply(t.imc,i)}),!0)}})}),define("data/project/models/project",["backbone","core/utils/is"],function(e,t){var i=e.Model.extend({isLockedByOtherUser:function(){var e=this.get("lock");return t(e,"object")&&t(e.status,"string")&&"locked"===e.status?!0:!1}});return i}),define("data/project/index",["jquery","underscore","backbone","core/typecastError","./models/project","core/utils/is"],function(e,t,i,n,s,r){var o=i.DataController.extend({namespace:"data:project",imc:null,model:null,auto_save_interval_id:null,inactivity_timeout_id:null,is_project_saved:null,_has_lock:!1,listeners:{get:"get",set:"set",getProject:"getProject",saveProject:"save","forceSave:complete":"saveComplete","[remote]data:state:changed:saved":"onChangeSavedState"},initialize:function(i){if(i=r(i,"object")?i:{},i.initData=r(i.initData,"object")?i.initData:{},this.model=new s(i.initData),this.imc.trigger(this.namespace+":ready"),!this.config.is_preview){if(this._isProjectLocked())return void this.announce("locked",this._getProjectLockedBy());this._createTabLock(),this._onBeforeUnload=t.bind(this._onBeforeUnload,this),e(window).on("beforeunload",this._onBeforeUnload),this.auto_save_interval_id=setInterval(t.bind(this.save,this,{snapshot:!1}),1e3*this.config.auto_save_interval),this.inactivity_timeout_id=setTimeout(t.bind(this.unlockProject,this,!0),1e3*this.config.inactivity_timeout)}},get:function(e,t,i){var s;return t=r(t,"function")?t:!1,r(e,"string")?(t&&t.call(i,null,this.model.get(e)),this.model.get(e)):(s=new n(101,"Please provide an attribute to return."),t&&t.call(i,s,!1),!0)},set:function(e,t,i,s,o){var a,l=":changed";return i=r(i,"object")?i:{},s=r(s,"function")?s:!1,r(e,"string")?r(t,"undefined")?(a=new n(102,"Please provide a value to set for your attribute."),s&&s.call(o,a,!1),!1):("id"===e&&this._has_lock&&this._updateTabLock(this.model.get("id"),t),this.model.set(e,t),s&&s.call(o,null,this.model.toJSON()),i&&i.silent||this.imc.trigger(this.namespace+l,this.model.toJSON(),i),this.model.toJSON()):(a=new n(101,"Please provide an attribute to set."),s&&s.call(o,a,!1),!1)},getProject:function(e,t){return(e=r(e,"function")?e:!1)?(e&&e.call(t,null,this.model.toJSON()),this.model.toJSON()):!1},save:function(e){var t=":forceSave",i="push";return r(e,"object")||(e={}),this._isProjectLocked()?(this.imc.trigger("ui:error:open",218,"fatal"),!1):(this.imc.trigger("ui:elements:sync-with-dom"),e.snapshot===!1&&(i="auto"),this.imc.trigger(this.namespace+t,i),!0)},saveComplete:function(e){var t,i=":save:success";return r(e,"object")?r(e.success,"undefined")||e.success===!1?!1:(t=null===e.success,this._createTabLock(),this.imc.trigger(this.namespace+i,t),!0):!1},onChangeSavedState:function(e){return e&&this.is_project_saved===e?!1:(clearTimeout(this.inactivity_timeout_id),this.inactivity_timeout_id=setTimeout(t.bind(this.unlockProject,this,!0),1e3*this.config.inactivity_timeout),this.is_project_saved=e,!0)},unlockProject:function(i){var n;return this._has_lock?(this._removeTabLock(),n=e.ajax({async:!1,url:this.config.unlock_project_url,method:"POST",dataType:"json",data:{project_id:this.model.get("id")}}),n.done(t.bind(function(e){r(e,"object")&&e.success&&i&&(clearInterval(this.auto_save_interval_id),this.imc.trigger("ui:error:open",219,"fatal"))},this)),!0):!1},destroy:function(){return clearInterval(this.auto_save_interval_id),clearTimeout(this.inactivity_timeout_id),this.unlockProject(!0),o.__super__.destroy.apply(this,arguments),!0},_onBeforeUnload:function(){this.unlockProject(!1)},_isProjectLocked:function(){return this.model.isLockedByOtherUser()||this._isProjectLockedByOtherTab()},_getProjectLockedBy:function(){return this.model.isLockedByOtherUser()?"user":this._isProjectLockedByOtherTab()?"tab":!1},_isProjectLockedByOtherTab:function(){var e,t;return r(window.localStorage,"Storage")?(e="typecast_locked_"+this.model.get("id"),t=null!==window.localStorage.getItem(e),t&&!this._has_lock):!1},_createTabLock:function(){var e;return this._has_lock?!0:(this._has_lock=!0,r(window.localStorage,"Storage")?(e="typecast_locked_"+this.model.get("id"),window.localStorage.setItem(e,"true"),!0):!1)},_removeTabLock:function(){return this._has_lock=!1,r(window.localStorage,"Storage")?(window.localStorage.removeItem("typecast_locked_"+this.model.get("id")),!0):!1},_updateTabLock:function(e,t){return r(window.localStorage,"Storage")?(window.localStorage.setItem("typecast_locked_"+t,"true"),window.localStorage.removeItem("typecast_locked_"+e),!0):!1}});return o}),define("data/clientState/models/state",["backbone"],function(e){return e.Model}),define("data/clientState/index",["backbone","core/utils/is","core/typecastError","./models/state"],function(e,t,i,n){var s=e.DataController.extend({namespace:"data:state",model:null,listeners:{get:"get",set:"set"},initialize:function(e){var i=":ready";e=t(e,"object")?e:{},e.initData=t(e.initData,"object")?e.initData:{},this.model=new n(e.initData),this.imc.trigger(this.namespace+i)},get:function(e,n,s){var r;return n=t(n,"function")?n:!1,t(e,"string")?(n&&n.call(s,null,this.model.get(e)),!0):(r=new i(101,"Please provide an attribute."),n&&n.call(s,r,!1),!1)},set:function(e,n,s,r,o){var a,l,c=":changed";return r=t(r,"function")?r:!1,s=t(s,"object")?s:{},t(e,"string")?(l=this.model.get(e),this.model.set(e,n),r&&r.call(o,null,e,n,l),s.silent||(this.imc.trigger(this.namespace+c,this.model.toJSON(),e),this.imc.trigger(this.namespace+c+":"+e,n,l,this.model.toJSON())),!0):(a=new i(101,"Please provide an attribute to set."),r&&r.call(o,a,!1),!1)}});return s}),define("data/elements/models/element",["backbone","core/typecastError","core/utils/is","core/utils/uuid"],function(e,t,i,n){var s=e.Model.extend({defaults:function(){return{id:null,parent_id:null,tag_name:null,children:[],attributes:{}}},initialize:function(){i(this.get("id"),"string")||this.set("id",n())},validate:function(e){var n=[];return i(e,"object")?(i(e.tag_name,"string")||n.push(new t(102,"Model has no tag name")),n.length?n:null):(n.push(new t(101,"No attributes provided to instantiate the model")),n)},getSelector:function(){var e=this.get("tag_name"),t=this.get("attributes");return i(t["class"],"string")&&(e+="."+t["class"]),e},isClassSet:function(){var e=this.get("attributes");return!(!i(e["class"],"string")||!e["class"])}});return s}),define("data/elements/collections/elements",["backbone","../models/element","core/utils/is","jquery"],function(e,t,i,n){var s=e.Collection.extend({model:t,supported_inline_elements:["strong","em","b","i","a"],getElementById:function(e){return this.get(e)},getElementTreeById:function(e,t){var n={},s=this,r=this.getElementById(e);if(!i(r,"object"))return!1;n=r.toJSON(),n.children=[],n.type="element",i(t,"string")&&t.length>0&&(n.parent_id=t);var o=r.get("children");return o.forEach(function(e){var t;i(e,"object")&&("element"===e.type&&(t=s.getElementTreeById(e.element_id,n.id),i(t,"object")&&n.children.push(t)),"text"===e.type&&n.children.push(e))}),n},getRootElementByChildId:function(e){var t;return t=this.get(e),i(t,"object")?i(t.get("parent_id"),"null")?t:this.getRootElementByChildId(t.get("parent_id")):!1},getChildrenFromContent:function(e){var t,s,r,o,a,l,c=[],u=0,h=0,d=0;if(!i(e,"string"))return c;if(t=n("<div>"+e+"</div>"),!i(t,"object"))return c;if(s=t.get(0).childNodes,!i(s,"nodelist"))return c;for(h=s.length;h>u;u++){if(r=s[u],o=!1,i(r,"text")&&r.textContent.trim().length>0){if(l=n("<div/>").text(r.textContent).html(),!i(l,"string"))continue;o=this._addContentAsTextNode(l.replace("\n",""),a,d)}else i(n(r).attr("data-id"),"string")&&n(r).attr("data-id").length>0&&this.get(n(r).attr("data-id"))&&(o={type:"element",index:d,element_id:n(r).attr("data-id")});i(o,"object")&&(c.push(o),d++,a=o)}return c},remove:function(e){var t,n;return i(e,"object")?(t=this.get(e.get("parent_id")),i(t,"object")&&i(t.get("children"),"array")&&(n=t.get("children"),n.forEach(function(t,s){i(t,"object")&&t.element_id===e.get("id")&&n.splice(s,1)},this)),void s.__super__.remove.apply(this,arguments)):!1},_addContentAsTextNode:function(e,t,n){return i(t,"object")&&"text"===t.type?(t.content+=e,!1):{type:"text",index:n,content:e}}});return s}),define("data/elements/models/rule",["backbone","core/utils/is","core/typecastError"],function(e,t,i){return e.Model.extend({defaults:function(){return{priority:10,actions:["*"],tag_names:["*"],description:null,operation:null}},initialize:function(){if(!t(this.get("operation"),"function"))throw new i(101,"The rule operation must be a function")},invoke:function(e,i){var n=this.get("operation");return t(e,"object")&&t(i,"object")?(n.call(this,e,i),!0):!1}})}),define("data/elements/collections/rules",["underscore","backbone","../models/rule"],function(e,t,i){var n=t.Collection.extend({comparator:"priority",model:i,match:function(e,t){return this.matchActions(e).matchTags(t)},matchActions:function(e){return this.filterBy("actions",e)},matchTags:function(e){return this.filterBy("tag_names",e)},filterBy:function(t,i){var s=this.filter(function(n){return e.contains(n.get(t),"*")?!0:e.contains(n.get(t),i)});return new n(s)}});return n}),define("data/elements/controllers/rules_manager",["underscore","backbone","core/utils/is","core/utils/cast","../collections/rules"],function(e,t,i,n,s){var r=function(){this.initialize.apply(this,arguments)};return e.extend(r.prototype,t.Events,{elements:null,rules:null,supported_elements:null,initialize:function(e,t,i){this.rules=new s(e),this.elements=t,this.supported_elements=i},run:function(e,t){var n=this.buildRuleApi();return i(e,"string")&&i(t,"object")?(this.rules.match(e,t.get("tag_name")).each(function(e){e.invoke(t,n)},this),!0):!1},buildRuleApi:function(){return{emit:e.bind(this.emit,this),log:e.bind(this.log,this),elements:this.elements,supported_elements:this.supported_elements}},emit:function(){this.trigger.apply(this,arguments)},log:function(){var e=n(arguments,"array");this.trigger.apply(this,["log"].concat(e))}}),r}),define("data/elements/config/rules/ensure_children_in_lists_are_lis",["core/utils/is"],function(e){return{description:"Change any non LI children in a list to LIs",priority:10,actions:["create","update"],tag_names:["ul","ol"],operation:function(t,i){t.get("children").forEach(function(t){var n;return"element"!==t.type?!1:(n=i.elements.get(t.element_id),e(n,"object")?"li"===n.get("tag_name").toLowerCase()?!0:(i.emit("updateElement",n.get("id"),{tag_name:"li"}),!0):!1)})}}}),define("data/elements/config/rules/ensure_nested_lists_are_wrapped_in_li",["core/utils/is","core/utils/dom"],function(e,t){return{description:"Wrap UL, OL and text nodes in an <li>",priority:5,actions:["create","update"],tag_names:["ul","ol"],operation:function(i,n){i.get("children").forEach(function(s){var r,o,a;return"text"===s.type?(a={tag_name:"li",parent_id:i.get("id"),content:s.content},n.emit("createElement",a,null,function(e,t){return e?n.log("error","Error creating element",e):(s.type="element",s.element_id=t.getElement().id,void delete s.content)}),!0):(r=n.elements.get(s.element_id),e(r,"object")?-1===["ul","ol"].indexOf(r.get("tag_name"))?!1:(o=n.elements.getElementTreeById(r.get("id")),a={tag_name:"li",parent_id:i.get("id"),content:t.getDomNodesForElementTree(o).outerHTML},void n.emit("createElement",a,null,function(e,t){var i;return e?n.log("error","Error creating element",e):(i=t.getElement().id,void n.emit("updateElement",r.get("id"),{parent_id:i},null,function(){s.type="element",s.element_id=i,delete s.content}))})):!1)})}}}),define("data/elements/config/rules/dont_allow_lis_outside_of_lists",["jquery","underscore","core/utils/is","core/utils/dom"],function(e,t,i,n){return{description:"Don't allow <li>s outside of lists, convert them to <p> tags.",priority:8,actions:["create","update"],tag_names:["*"],operation:function(s,r){var o,a,l,c=r.supported_elements.child_elements;t.contains(["ul","ol"],s.get("tag_name"))||(l=!t.contains(c,s.get("tag_name")),s.get("children").forEach(function(t){var s;return"element"!==t.type?!1:(s=r.elements.get(t.element_id),i(s,"object")?"li"!==s.get("tag_name").toLowerCase()?!0:(l?r.emit("updateElement",s.get("id"),{tag_name:"p"}):(o=r.elements.getElementTreeById(s.get("id")),a=e(n.getDomNodesForElementTree(o).outerHTML).text(),delete t.element_id,t.type="text",t.content=a,r.emit("deleteElement",s.get("id"))),!0):!1)}))}}}),define("data/elements/config/rules/dont_leave_empty_elements_behind",[],function(){return{description:"Don't allow empty ULs or OLs to be left behind",priority:10,actions:["*"],tag_names:["ul","ol"],operation:function(e,t){e.get("children").length||t.emit("deleteElement",e.get("id"))}}}),define("data/elements/config/rules/combine_text_nodes",["jquery","underscore"],function(e,t){return{description:"Combine text nodes within an element that are sitting beside each other",priority:10,actions:["create","update"],tag_names:["*"],operation:function(e){var i=[],n=0;e.get("children").forEach(function(e){t.last(i)&&"text"===t.last(i).type&&"text"===e.type?t.last(i).content+=e.content:(e.index=n,i.push(e),n++)}),e.set({children:i})}}}),define("data/elements/config/rules",["./rules/ensure_children_in_lists_are_lis","./rules/ensure_nested_lists_are_wrapped_in_li","./rules/dont_allow_lis_outside_of_lists","./rules/dont_leave_empty_elements_behind","./rules/combine_text_nodes"],function(e,t,i,n,s){return[t,e,i,n,s]}),define("data/elements/index",["backbone","jquery","underscore","core/typecastError","./collections/elements","core/utils/is","core/utils/dom","./controllers/rules_manager","./config/rules"],function(e,t,i,n,s,r,o,a,l){var c=e.DataController.extend({namespace:"data:elements",config:null,collections:{elements:null},rules_manager:null,listeners:{getElements:"getElements",getElementById:"getElementById",getElementBreadcrumbs:"getElementBreadcrumbs",createElement:"createElement",updateElement:"updateElement",deleteElement:"deleteElement",getTagNameAndClassCombinations:"getTagNameAndClassCombinations",getIndexByElementId:"getIndexByElementId",getSupportedElements:"getSupportedElements",changeSelectorForElements:"changeSelectorForElements",deleteElementType:"deleteElementType"},initialize:function(e){if(!r(e,"object"))return!1;if(this.collections.elements=new s,this.rules_manager=new a(l,this.collections.elements,this.config.supported_elements),this.rules_manager.on("createElement",this.createElement,this),this.rules_manager.on("updateElement",this.updateElement,this),this.rules_manager.on("deleteElement",this.deleteElement,this),r(e.initData,"object")&&r(e.initData.elements,"array")&&this.collections.elements.add(e.initData.elements,{validate:!0}),!r(e.config,"object"))throw new n(101,"config is required");this.imc.trigger(this.namespace+":ready")},getElements:function(e,t){return r(e,"function")?this.getElementById("body",e,t):!1},getElementById:function(e,t,i){var s,o,a;return r(t,"function")?(o=this.collections.elements.get(e),r(o,"object")?(a=this.getElementReturnObject(o),r(a,"object")?(t.call(i,null,a),a):(s=new n(102,"Could not create a valid return object for this element."),t.call(i,s,!1),!1)):(s=new n(101,"This element does not exist."),t.call(i,s,!1),!1)):!1},getElementBreadcrumbs:function(e,t,i){var s,o,a=[];if(!r(t,"function"))return!1;if(s=this.collections.elements.get(e),!r(s,"object"))return o=new n(101,"This element does not exist."),t.call(i,o,!1),!1;for(a.push(this.getElementReturnObject(s));s=this.collections.elements.get(s.get("parent_id"));)a.push(this.getElementReturnObject(s));return a.reverse(),a.forEach(function(e){var t,i,n;i=e.getElement(),n=i.attributes,t=i.tag_name,r(n["class"],"string")&&n["class"].length>0&&(t+="."+n["class"]),e.breadcrumb=t},this),t.call(i,null,a),a},createElement:function(e,t,i,s){var o,a,l,c="",u="new:element";return t=r(t,"object")?t:{},i=r(i,"function")?i:!1,r(e,"object")?!r(e.tag_name,"string")||r(e.tag_name,"string")&&e.tag_name.length<1?(o=new n(102,"Please provide a valid tag name for the new element."),i&&i.call(s,o,!1),!1):e.id&&!r(e.id,"string")?(o=new n(103,"Please provide a valid ID for the new element."),i&&i.call(s,o,!1),!1):e.parent_id&&r(e.parent_id,"string")&&!this.collections.elements.get(e.parent_id)?(o=new n(104,"Parent ID provided does not exist."),i&&i.call(s,o,!1),!1):e.id&&this.collections.elements.get(e.id)?(o=new n(105,"This element ID already exists."),i&&i.call(s,o,!1),!1):(r(e.content,"string")&&(c=e.content,delete e.content),e.children=this.collections.elements.getChildrenFromContent(c),a=new this.collections.elements.model(e),this.collections.elements.add(a),l=this.getElementReturnObject(a),r(l,"object")?(i&&i.call(s,null,l),t&&t.silent||this.imc.trigger(this.namespace+":"+u,l,t),l):(o=new n(105,"Could not build the response object for this element."),i&&i.call(s,o,!1),!1)):(o=new n(101,"Please provide valid attributes for the new element."),i&&i.call(s,o,!1),!1)},updateElement:function(e,t,s,o,a){var l,c,u,h,d,p="",f="updated:element";return o=r(o,"function")?o:!1,s=r(s,"object")?s:{},r(e,"string")?r(t,"object")?(l=this.collections.elements.get(e),d=this.getElementReturnObject(l),r(l,"object")?(t.id=l.get("id"),t.parent_id&&r(t.parent_id,"string")&&!this.collections.elements.get(t.parent_id)?(c=new n(104,"Parent ID provided does not exist."),o&&o.call(a,c,!1),!1):r(t.tag_name,"undefined")||r(t.tag_name,"string")&&!(t.tag_name.length<1)?(t.children&&delete t.children,r(t.content,"string")&&(p=t.content,delete t.content,t.children=this.collections.elements.getChildrenFromContent(p)),r(t.attributes,"object")||(t.attributes={}),t.attributes=i.extend({},l.get("attributes"),t.attributes),l.set(t),this._ensureParentIdIntegrity(l),h=this.collections.elements.get(l.get("parent_id")),r(h,"object")&&this.rules_manager.run("update",h),this.rules_manager.run("update",l),u=this.getElementReturnObject(l,d),r(u,"object")?(o&&o.call(a,null,u),s&&s.silent||(this.imc.trigger(this.namespace+":"+f,u,s),this.imc.trigger(this.namespace+":"+f+":"+u.getElement().id,u,s)),u):(c=new n(105,"Could not build the response object for this element."),o&&o.call(a,c,!1),!1)):(c=new n(105,"Please provide a valid tag_name for this element update."),o&&o.call(a,c,!1),!1)):(c=new n(103,"The element ID provided does not exist."),o&&o.call(a,c,!1),!1)):(c=new n(102,"Please provide a valid attributes object."),o&&o.call(a,c,!1),!1):(c=new n(101,"Please provide a valid element ID to update."),o&&o.call(a,c,!1),!1)},deleteElement:function(e,t,i,s){var o,a,l,c,u,h,d,p,f="deleted:element",g="updated:element";return i=r(i,"function")?i:!1,t=r(t,"object")?t:{},r(e,"string")?(a=this.collections.elements.get(e),r(a,"object")?(l=this.getElementReturnObject(a),h=a.get("children"),h.forEach(function(e){"element"===e.type&&this.deleteElement(e.element_id,{silent:!0})},this),this.collections.elements.remove(a),c=this.collections.elements.get(a.get("parent_id")),p=this.getElementReturnObject(c),r(c,"object")&&(this.rules_manager.run("delete",c),d=a.get("index"),c.get("children").forEach(function(e){var t,i;"element"===e.type&&(t=this.collections.elements.get(e.element_id),i=t.get("index"),i>d&&t.set("index",i-1))},this)),i&&i.call(s,null,l),t&&t.silent||(this.imc.trigger(this.namespace+":"+f,l,t),r(c,"object")&&(u=this.getElementReturnObject(c,p))&&(this.imc.trigger(this.namespace+":"+g,u,t),this.imc.trigger(this.namespace+":"+g+":"+c.get("id"),u,t))),l):(o=new n(102,"The element ID provided does not exist."),i&&i.call(s,o,!1),!1)):(o=new n(101,"Please provide a valid element ID to update."),i&&i.call(s,o,!1),!1)},getSupportedElements:function(e,t,i){var s;return r(t,"function")?r(e,"string")&&0!==e.length?(s=this._getSupportedElementsByElementId(e),r(s,"array")||t.call(i,new n(110,"Invalid supported elements format."),!1),t.call(i,null,s),!0):(t.call(i,new n(101,"No element_id provided."),!1),!1):!1},getTagNameAndClassCombinations:function(e,t,i){var s,o={},a=[];return r(t,"function")?r(e,"string")&&0!==e.length?(s=this._getSupportedElementsByElementId(e),r(s,"array")||t.call(i,new n(110,"Invalid supported elements format."),!1),this.collections.elements.models.forEach(function(e){var t=e.get("tag_name"),i=e.get("attributes");return-1===s.indexOf(t)?!1:(r(o[t],"undefined")&&(o[t]=[]),r(i["class"],"string")&&i["class"].length>0&&-1===o[t].indexOf(i["class"])&&o[t].push(i["class"]),!0)},this),s.forEach(function(e){a.push({tag_name:e,classes:r(o[e],"array")?o[e]:[]})},this),t.call(i,null,a),!0):(t.call(i,new n(101,"No element_id provided."),!1),!1):!1},getElementReturnObject:function(e,i){var n,s,o={};return r(e,"object")&&r(e.get,"function")?(o.element=this.collections.elements.getElementTreeById(e.get("id")),r(o.element,"object")?(r(e.get("parent_id"),"string")&&(s=this.collections.elements.getElementTreeById(e.get("parent_id")),r(s,"object")&&(o.parent_element=s)),n=this.collections.elements.getRootElementByChildId(e.get("id")),r(n,"object")?(o.selector="",o.selector=o.element.tag_name,n&&r(n.get("attributes"),"object")&&n.isClassSet()&&(o.selector="."+n.get("attributes")["class"]+" "+o.selector),r(o.element.attributes,"object")&&e.isClassSet()&&(o.selector+="."+o.element.attributes["class"]),o._element_previous_state=null,r(i,"element")&&(o._element_previous_state=i),o=t.extend(!0,{},o),o.getContainer=function(){return this.container},o.getElement=function(){return this.element},o.getParentElement=function(){return this.parent_element?this.parent_element:!1},o.getSelector=function(){return this.selector},o.getPreviousState=function(){return this._element_previous_state},o):!1):!1):!1},getIndexWithinParent:function(e,t){var i,n;return r(e,"object")&&r(t,"object")?(i=t.get("children"),n=i.filter(function(t){return t.element_id===e.id}),n.length>0?i.indexOf(n[0]):-1):-1},getIndexReturnObject:function(e,t,i){var n,s;return r(e,"number")&&r(t,"object")&&r(i,"object")?(n=this.getElementReturnObject(t),r(n,"object")?(s=this.getElementReturnObject(i),r(s,"object")?{index:e,parent:s,element:n,getParent:function(){return this.parent},getElement:function(){return this.element},getIndex:function(){return this.index}}:!1):!1):!1},getIndexByElementId:function(e,t,i,s){var o,a,l,c,u,h,d=r(this.config.supported_elements.containers,"array")?this.config.supported_elements.containers:[],p=r(this.config.supported_elements.child_elements,"array")?this.config.supported_elements.child_elements:[],f=d.concat(p),g={block_level:!1};if(!r(i,"function"))return!1;if(!r(e,"string")||e.length<1)return i.call(s,new n(101,"No element_id provided."),!1),!1;r(t,"object")||(t=g),u=e;do{if(o=this.collections.elements.get(u),!r(o,"object"))return i.call(s,new n(102,"Invalid element."),!1),!1;if(c=o.get("parent_id"),!r(c,"string"))return i.call(s,new n(103,"No parent id found."),!1),!1;if(a=this.collections.elements.get(c),!r(a,"object"))return i.call(s,new n(104,"Could not get parent element."),!1),!1;if(!t.block_level)break;if(f.indexOf(a.get("tag_name"))>=0)break;u=a.id}while(!r(a.get("parent_id"),"null"));return l=this.getIndexWithinParent(o,a),0>l?(i.call(s,new n(105,"Could not find the index."),!1),!1):(o=this.collections.elements.get(e),r(o,"object")?(h=this.getIndexReturnObject(l,o,a))?(i.call(s,null,h),!0):!1:(i.call(s,new n(106,"Could not get the element data."),!1),!1))},changeSelectorForElements:function(e,t,i,s,o){var a,l,c=[];return r(e,"string")?r(t,"string")?(r(i,"object")||(i=null),a=t.split("."),l={tag_name:a[0]},2===a.length&&(l.attributes={"class":a[1]}),this.collections.elements.forEach(function(t){var n;t.getSelector()===e&&(n=t.get("id"),c.push(this.updateElement(n,l,i)))},this),r(s,"function")&&s&&s.call(o,null,c),c):(s&&s.call(o,new n(108,"A new selector to change the existing selector to is required"),!1),!1):(s&&s.call(o,new n(107,"A selector to change needs to be provided"),!1),!1)},deleteElementType:function(e,t,i,s){var o,a=[];return r(e,"string")||i&&i.call(s,new n(109,"A selector for the type to delete is required",!1)),r(t,"object")||(t=null),o={attributes:{"class":void 0}},this.collections.elements.forEach(function(i){var n=i.get("id");i.getSelector()===e&&a.push(this.updateElement(n,o,t))},this),r(i,"function")&&i&&i.call(s,null,a),a},destroy:function(){return this.rules_manager.off(null,null,this),c.__super__.destroy.apply(this,arguments)},_ensureParentIdIntegrity:function(e){var t;return r(e,"object")?(t=e.get("children"),r(t,"array")||(t=[]),t.forEach(function(t){var n,s,a,l;"text"!==t.type&&(n=this.collections.elements.get(t.element_id),r(n,"object")&&(s=n.get("parent_id"),s!==e.id&&(this.updateElement(n.get("id"),{parent_id:e.id}),a=this.collections.elements.getElementTreeById(s),r(a.children,"array")&&i.some(a.children,function(e,t){return e.id===n.get("id")?(a.children.splice(t,1),!0):!1}),l=o.getDomNodesForElementTree(a),this.updateElement(s,{content:l.innerHTML}))))},this),!0):!1},_getSupportedElementsByElementId:function(e){var t,n,s,o=r(this.config.supported_elements.containers,"array")?this.config.supported_elements.containers:[],a=r(this.config.supported_elements.inline,"array")?this.config.supported_elements.inline:[],l=r(this.config.supported_elements.child_elements,"array")?this.config.supported_elements.child_elements:[],c=r(this.config.supported_elements.list_elements,"array")?this.config.supported_elements.list_elements:[],u=r(this.config.supported_elements.image_elements,"array")?this.config.supported_elements.image_elements:[];return r(e,"string")&&0!==e.length?(s=this.collections.elements.get(e),t=l,r(s,"object")&&(n=s.get("tag_name"),i.contains(o,n)?t=o:i.contains(a,n)?t=a:i.contains(c,n)?t=c:i.contains(u,n)&&(t=u)),t):!1}});return c}),define("data/styles/models/style",["backbone"],function(e){return e.Model.extend({defaults:{id:null}})}),define("data/styles/collections/styles",["backbone","../models/style"],function(e,t){return e.Collection.extend({model:t})}),define("data/styles/models/style_declaration",["backbone","core/utils/is","core/utils/uuid"],function(e,t,i){return e.Model.extend({defaults:function(){return{id:null,style_id:null,media_query_id:null,attributes:{}}},initialize:function(){t(this.get("id"),"string")||this.set("id",i())}})}),define("data/styles/collections/style_declarations",["backbone","../models/style_declaration"],function(e,t){return e.Collection.extend({model:t})}),define("data/styles/models/media_query",["underscore","backbone","core/utils/is","core/utils/uuid"],function(e,t,i,n){return t.Model.extend({valid_media_query_attrs:["min-width","max-width"],defaults:function(){return{id:null,type:null,attributes:{}}},initialize:function(){return i(this.get("id"),"string")||this.set("id",n()),this},getTypeOfWidth:function(){var t,n=this.get("attributes")||{};return t=e.intersection(this.valid_media_query_attrs,e.keys(n))[0],i(t,"string")?t.replace(/-width/,""):""}})}),define("data/styles/collections/media_queries",["backbone","../models/media_query","core/utils/is"],function(e,t,i){return e.Collection.extend({model:t,comparator:function(e,t){var n=e.get("attributes"),s=t.get("attributes"),r=parseInt(n["max-width"],10)||null,o=parseInt(s["max-width"],10)||null,a=parseInt(n["min-width"],10)||null,l=parseInt(s["min-width"],10)||null,c=parseInt(e.cid.replace(/[^\d]/g,""),10),u=parseInt(t.cid.replace(/[^\d]/g,""),10);return e.get("is_default")?-1:t.get("is_default")?1:i(r,"number")&&i(o,"number")?r>o?-1:o>r?1:u>c?-1:1:i(a,"number")&&i(l,"number")?l>a?-1:a>l?1:u>c?-1:1:0},getMinWidthQueries:function(){return this.filter(function(e){var t=e.get("attributes")["min-width"];return!i(t,"string")||t.length<1?!1:!0})},getMaxWidthQueries:function(){return this.filter(function(e){var t=e.get("attributes")["max-width"];return!i(t,"string")||t.length<1?!1:!0})},getRWDStrategyByStyleId:function(e){var t,n={name:"desktop-first",is_strict:!1};return i(e,"number")?(t=this.where({style_id:e,is_default:!0})[0],"min"===t.getTypeOfWidth()&&(n.name="mobile-first"),this.where({style_id:e}).length>1&&(n.is_strict=!0),n):!1}})}),define("data/styles/index",["jquery","backbone","underscore","core/typecastError","core/utils/is","core/utils/dom","./collections/styles","./collections/style_declarations","./collections/media_queries"],function(e,t,i,n,s,r,o,a,l){var c=t.DataController.extend({namespace:"data:styles",config:null,collections:{styles:null,styleDeclarations:null,media_queries:null},listeners:{getStyleDeclarationsWithMediaQueriesByStyleId:"getStyleDeclarationsWithMediaQueriesByStyleId",getStyleDeclarationsByStyleAndMediaQuery:"getStyleDeclarationsByStyleAndMediaQuery",getStyleDeclarationBySelector:"getStyleDeclarationBySelector",setAttributesForStyleDeclaration:"setAttributesForStyleDeclaration",removeAttributesForStyleDeclaration:"removeAttributesForStyleDeclaration",deleteStyleDeclaration:"deleteStyleDeclaration",setStyleDeclarationToInherit:"setStyleDeclarationToInherit",getStyles:"getStyles",getActiveColours:"getActiveColours",renameStyleDeclaration:"renameStyleDeclaration",copyStyleDeclaration:"copyStyleDeclaration",createMediaQuery:"createMediaQuery",getMediaQueries:"getMediaQueries",getMediaQueryById:"getMediaQueryById",getDefaultMediaQuery:"getDefaultMediaQuery",updateMediaQuery:"updateMediaQuery",deleteMediaQuery:"deleteMediaQuery",getInheritedStylesPrefixForMediaQueryId:"getInheritedStylesPrefixForMediaQueryId",getInheritedStylesPrefixes:"getInheritedStylesPrefixes",getRWDStrategy:"getRWDStrategy",getStylesWithMediaQueriesAndStyleDeclarations:"getStylesWithMediaQueriesAndStyleDeclarations"},initialize:function(e){return s(e,"object")?(this.collections.styles=new o,this.collections.styleDeclarations=new a,this.collections.media_queries=new l,s(e.initData,"object")&&(s(e.initData.styles,"array")&&this.collections.styles.reset(e.initData.styles,{validate:!0}),s(e.initData.style_declarations,"array")&&this.collections.styleDeclarations.reset(e.initData.style_declarations,{validate:!0}),s(e.initData.media_queries,"array")&&(this.collections.media_queries.reset(e.initData.media_queries,{validate:!0}),this._giveDefaultMQMinWidthWhenMobileFirst())),void this.imc.trigger(this.namespace+":ready")):!1},getStyles:function(e,t){var i;return s(e,"function")?(i=this._getStyleReturnObjects(),void e.call(t,null,i)):!1},getStylesWithMediaQueriesAndStyleDeclarations:function(e,t){var n;return s(e,"function")?(n=this._getStyleReturnObjects(),i.each(n,function(e){e.media_queries=[],this.collections.media_queries.each(function(t){var i=this.collections.styleDeclarations.where({style_id:e.style.id,media_query_id:t.get("id")});e.media_queries.push({media_query:this.getMediaQueryReturnObject(t),style_declarations:i.map(function(e){return this.getStyleDeclarationReturnObject(e)},this)})},this)},this),e.call(t,null,n),!0):!1},_getStyleReturnObjects:function(){return this.collections.styles.map(function(e){return this.getStyleReturnObject(e)},this)},getStyleDeclarationsWithMediaQueriesByStyleId:function(e,t,i){var r,o=[];return s(t,"function")?(this.collections.styles.get(e)||(r=new n(101,"Please provide a valid style ID"),t.call(i,r,!1)),this.collections.media_queries.forEach(function(t){var i=this.collections.styleDeclarations.where({style_id:e,media_query_id:t.get("id")});o.push({media_query:this.getMediaQueryReturnObject(t),style_declarations:i.map(function(e){return this.getStyleDeclarationReturnObject(e)},this)})},this),t.call(i,null,o),!0):!1},getStyleDeclarationsByStyleAndMediaQuery:function(e,t,i,r){var o,a,l=[];return s(i,"function")?this.collections.styles.get(e)?this.collections.media_queries.get(t)?(a=this.collections.styleDeclarations.where({
style_id:e,media_query_id:t}),a.forEach(function(e){l.push(this.getStyleDeclarationReturnObject(e))},this),i.call(r,null,l),l):(o=new n(102,"The media query ID provided does not exist"),i.call(r,o,!1),!1):(o=new n(101,"The style ID provided does not exist"),i.call(r,o,!1),!1):!1},getStyleDeclarationBySelector:function(e,t,r,o,a,l){var c,u,h,d,p,f;return s(a,"function")?this._isValidStyleId(e)?this.collections.media_queries.get(t)?(s(o,"object")||(o={}),f=this._isValidOptionsObject(o),f instanceof n?(a.call(l,f,!1),!1):f?(u=this.collections.styleDeclarations.where({style_id:e,media_query_id:t,selector:r}),(!s(u,"array")||u.length<1)&&(d=new this.collections.styleDeclarations.model({style_id:e,media_query_id:t,selector:r}),this.collections.styleDeclarations.add(d),u=[d]),h=this.getStyleDeclarationReturnObject(u[0]),s(h,"object")?(s(o.attributes,"array")&&(p=this._getAttributeValues(u[0],o)),s(p,"object")?(h.style_declaration.attributes=i.extend(h.style_declaration.attributes,p.values),h.inherited=p.inherited):h.inherited=[],h.isInherited=function(e){return s(e,"string")&&i.contains(this.inherited,e)?!0:!1},h.getValue=function(e){var t;return s(e,"string")?(t=this.style_declaration.attributes[e],s(t,"undefined")?!1:t):!1},p===!1?a.call(l,new n(105,"Could not get the inherited values for all of the attributes that were requested"),null):a.call(l,null,h),!0):(c=new n(103,"Could not build the response object for this selector"),a.call(l,c,!1),!1)):!1):(c=new n(102,"The media query ID provided does not exists"),a.call(l,c,!1),!1):(c=new n(101,"The style ID provided does not exist"),a.call(l,c,!1),!1):!1},renameStyleDeclaration:function(e,t,r,o,a,l){var c,u,h;return a=s(a,"function")?a:!1,this._isValidStyleId(e)?this.collections.media_queries.get(t)?s(r,"string")?s(o,"string")?(c=this.collections.styleDeclarations.where({style_id:e,selector:o}),c.length>0?(a&&a.call(l,new n(107,"A style declaration with that selector already exists"),!1),!1):(c=this.collections.styleDeclarations.where({style_id:e,selector:r}),c.length<1?(a&&a.call(l,new n(108,"A style declaration with that selector doesn't exist"),!1),!1):(i.each(c,function(e){e.set("selector",o),t===e.get("media_query_id")&&(u=e)},this),h=this.getStyleDeclarationReturnObject(u),s(h,"object")?void(a&&a.call(l,null,h)):(a&&a.call(l,new n(103,"Could not build the response object for this selector"),!1),!1)))):(a&&a.call(l,new n(110,"You need to provide a new selector for the style declaration"),!1),!1):(a&&a.call(l,new n(109,"You need to provide a selector for the style declaration to change"),!1),!1):(a&&a.call(l,new n(102,"The media query ID provided does not exist"),!1),!1):(a&&a.call(l,new n(101,"The style ID provided does not exist"),!1),!1)},getActiveColours:function(e,t,r){var o,a=[];return s(t,"function")?this.collections.styles.get(e)?(this.collections.styleDeclarations.forEach(function(e){var t=e.get("attributes");["color","background-color"].forEach(function(e){s(t[e],"array")&&t[e].length>0&&(a=a.concat(t[e]))},this)},this),a=i.uniq(a),t.call(r,null,a),a):(o=new n(101,"The style ID provided does not exist"),t.call(r,o,!1),!1):!1},setAttributesForStyleDeclaration:function(e,t,r,o,a,l,c){var u,h,d,p,f,g,m,v=":changed";return l=s(l,"function")?l:!1,a=s(a,"object")?a:{},this.collections.styles.get(e)?this.collections.media_queries.get(t)?!s(r,"string")||r.length<1?(u=new n(103,"Please provide a valid selector."),l&&l.call(c,u,!1),!1):(h=this.collections.styleDeclarations.where({style_id:e,media_query_id:t,selector:r}),(!s(h,"array")||h.length<1)&&(d=new this.collections.styleDeclarations.model({style_id:e,media_query_id:t,selector:r}),this.collections.styleDeclarations.add(d),h=[d]),s(o,"object")?(d=h[0],m=this.getStyleDeclarationReturnObject(d),g=this._getChangedAttributes(d.get("attributes"),o),f=this._getPrefixedAttributes(o),d.set({attributes:i.extend({},d.get("attributes"),f,o)}),p=this.getStyleDeclarationReturnObject(d,m),s(p,"object")?(l&&l.call(c,null,p,g),a.silent||(this.imc.trigger(this.namespace+v,e,t,r,p,g,a),this.imc.trigger(this.namespace+v+":"+r,e,t,r,p,g,a)),!0):(u=new n(105,"Could not generate the response object after setting the attributes for this selector."),l&&l.call(c,u,!1),!1)):(u=new n(104,"Please provide an object containing attributes to set on this selector."),l&&l.call(c,u,!1),!1)):(u=new n(102,"Please provide a valid media query id for this style declaration."),l&&l.call(c,u,!1),!1):(u=new n(101,"Please provide a valid style id for this style declaration."),l&&l.call(c,u,!1),!1)},removeAttributesForStyleDeclaration:function(e,t,r,o,a,l,c){var u,h,d,p,f,g,m,v=":changed";return l=s(l,"function")?l:!1,a=s(a,"object")?a:{},this.collections.styles.get(e)?this.collections.media_queries.get(t)?(h=this.collections.styleDeclarations.where({style_id:e,media_query_id:t,selector:r}),!s(h,"array")||h.length<1?(u=new n(105,"There is no style declarations match this selector."),l&&l.call(c,u,!1),!1):s(o,"array")?(d=h[0],m=this.getStyleDeclarationReturnObject(d),g=i.filter(o,function(e){var t=d.get("attributes");return s(t,"object")?-1!==Object.keys(t).indexOf(e):!1}),f=this._getPrefixedAttributeNames(o),d.set({attributes:i.omit(d.get("attributes"),o,f)}),p=this.getStyleDeclarationReturnObject(d,m),s(p,"object")?(a.silent||(this.imc.trigger(this.namespace+v,e,t,r,p,g,a),this.imc.trigger(this.namespace+v+":"+r,e,t,r,p,g,a)),l&&l.call(c,null,p,g),!0):(u=new n(104,"Could not generate the response object after removing the attributes for this selector."),l&&l.call(c,u,!1),!1)):(u=new n(103,"Please provide an array containing attribute names to remove from this selector."),l&&l.call(c,u,!1),!1)):(u=new n(102,"Please provide a valid media query id for this style declaration."),l&&l.call(c,u,!1),!1):(u=new n(101,"Please provide a valid style id for this style declaration."),l&&l.call(c,u,!1),!1)},deleteStyleDeclaration:function(e,t,i,n){var r,o=":deleted:styleDeclaration";return n=s(n,"object")?n:{},this.collections.styles.get(e)&&this.collections.media_queries.get(t)&&s(i,"string")?(r=this.collections.styleDeclarations.where({style_id:e,media_query_id:t,selector:i}),!s(r,"array")||r.length<1?!1:(this.collections.styleDeclarations.remove(r),n.silent||this.imc.trigger(this.namespace+o,i,r[0].toJSON(),n),!0)):!1},setStyleDeclarationToInherit:function(e,t,i,n){return this.deleteStyleDeclaration(e,t,i,n)},getStyleDeclarationReturnObject:function(e,t){var i={};return s(e,"object")&&e instanceof this.collections.styleDeclarations.model&&this.collections.styles.get(e.get("style_id"))?(i.style_declaration=e.toJSON(),i.style=this.collections.styles.get(e.get("style_id")).toJSON(),i._style_declaration_previous_state=null,s(t,"style_declaration")&&(i._style_declaration_previous_state=t),i.getStyle=function(){return this.style},i.getStyleDeclaration=function(){return this.style_declaration},i.getMediaQueryId=function(){return this.getStyleDeclaration().media_query_id},i.getPreviousState=function(){return this._style_declaration_previous_state},i):!1},getStyleReturnObject:function(e){var t={};return s(e,"object")&&e instanceof this.collections.styles.model?(t.style=e.toJSON(),t.getStyle=function(){return this.style},t):!1},getMediaQueryReturnObject:function(e,t){var i={};return s(e,"object")&&e instanceof this.collections.media_queries.model?(i.media_query=e.toJSON(),i._media_query_previous_state=null,s(t,"media_query")&&(i._media_query_previous_state=t),i.getMediaQuery=function(){return this.media_query},i.getPreviousState=function(){return this._media_query_previous_state},i):!1},copyStyleDeclaration:function(e,t,r,o,a,l){var c,u,h,d;return s(a,"function")?this.collections.styles.get(e)?this.collections.media_queries.get(t)?!s(r,"string")||r.length<1?!1:!s(o,"string")||o.length<1?!1:(u=this.collections.styleDeclarations.where({style_id:e,selector:o}),u.length>0?(c=new n(107,"A style declaration with that selector already exists"),a.call(l,c,!1),!1):(u=this.collections.styleDeclarations.where({style_id:e,selector:r}),u.length<1?(this.getStyleDeclarationBySelector(e,t,o,{},a,l),!0):(i.each(u,function(i){var n,s;s=i.get("media_query_id"),n=new this.collections.styleDeclarations.model({style_id:e,selector:o,media_query_id:s}),this.collections.styleDeclarations.add(n),this.setAttributesForStyleDeclaration(e,s,o,i.get("attributes")),s===t&&(d=n)},this),h=this.getStyleDeclarationReturnObject(d),s(h,"object")?(a.call(l,null,h),!0):(c=new n(103,"Could not build the response object for this selector"),a.call(l,c,!1),!1)))):(c=new n(102,"The media query ID provided doesn't exist"),a.call(l,c,!1),!1):(c=new n(101,"The style ID provided doesn't exist"),a.call(l,c,!1),!1):!1},createMediaQuery:function(e,t,i,r,o,a){var l,c,u,h;return r=s(r,"object")?r:{},o=s(o,"function")?o:!1,this.collections.styles.get(e)?!s(t,"string")||t.length<1?(c=new n(114,'Could not create media query without "type".'),o&&o.call(a,c,!1),!1):s(i,"object")?((r.undo||r.redo)&&(h=i.id,delete i.id),l=new this.collections.media_queries.model({id:h,style_id:e,type:t,attributes:i}),this.collections.media_queries.add(l),u=this.getMediaQueryReturnObject(l),s(u,"object")?(o&&o.call(a,null,u),r.silent||this.announce("new:mediaQuery",u,r),!0):(c=new n(112,"Could not create the return object for this media query."),o&&o.call(a,c,!1),!1)):(c=new n(115,'Could not create media query without "attributes".'),o&&o.call(a,c,!1),!1):(c=new n(113,"Please provide a valid style id."),o&&o.call(a,c,!1),!1)},getMediaQueries:function(e,t,i){var r,o=[];return t=s(t,"function")?t:!1,this.collections.styles.get(e)?(this.collections.media_queries.where({style_id:e}).forEach(function(e){var t=this.getMediaQueryReturnObject(e);return s(t,"object")?void o.push(t):(this.log("error","Couldn't add media query to array of media queries",{media_query:e.toJSON()}),!1)},this),t&&t.call(i,null,o),!0):(r=new n(101,"Please provide a valid style id."),t&&t.call(i,r,!1),!1)},getMediaQueryById:function(e,t,i,r){var o,a,l;return i=s(i,"function")?i:!1,this.collections.styles.get(e)?(o=this.collections.media_queries.get(t),s(o,"object")?(l=this.getMediaQueryReturnObject(o),s(l,"object")?(i&&i.call(r,null,l),!0):(a=new n(112,"Could not create the return object for this media query."),i&&i.call(r,a,!1),!1)):(a=new n(111,"This media query does not exist."),i&&i.call(r,a,!1),!1)):(a=new n(101,"Please provide a valid style id."),i&&i.call(r,a,!1),!1)},getDefaultMediaQuery:function(e,t){var i,r,o;return e=s(e,"function")?e:!1,i=this.collections.media_queries.where({is_default:!0})[0],s(i,"object")?(o=this.getMediaQueryReturnObject(i),s(o,"object")?(e&&e.call(t,null,o),!0):(r=new n(102,"Could not create the return object for this media query."),e&&e.call(t,r,!1),!1)):(r=new n(101,"The default media query does not exist."),e&&e.call(t,r,!1),!1)},updateMediaQuery:function(e,t,i,r,o,a){var l,c,u,h;return r=s(r,"object")?r:{},o=s(o,"function")?o:!1,this.collections.styles.get(e)?(l=this.collections.media_queries.get(t),s(l,"object")?s(i,"object")?(h=this.getMediaQueryReturnObject(l),l.set(i),this.collections.media_queries.sort(),u=this.getMediaQueryReturnObject(l,h),s(u,"object")?(o&&o.call(a,null,u),r.silent||this.announce("updated:mediaQuery",u,r),!0):(c=new n(112,"Could not create the return object for this media query."),o&&o.call(a,c,!1),!1)):(c=new n(113,"No attributes provided in order to update the media query."),o&&o.call(a,c,!1),!1):(c=new n(111,"This media query does not exist."),o&&o.call(a,c,!1),!1)):(c=new n(101,"Please provide a valid style id."),o&&o.call(a,c,!1),!1)},deleteMediaQuery:function(e,t,i,r,o){var a,l,c;return i=s(i,"object")?i:{},r=s(r,"function")?r:!1,this.collections.styles.get(e)?(a=this.collections.media_queries.get(t),s(a,"object")?(c=this.getMediaQueryReturnObject(a),s(c,"object")?(this.collections.media_queries.remove(a),r&&r.call(o,null,c),i.silent||this.announce("deleted:mediaQuery",c,i),!0):(l=new n(112,"Could not create the return object for this media query."),r&&r.call(o,l,!1),!1)):(l=new n(111,"This media query does not exist."),r&&r.call(o,l,!1),!1)):(l=new n(101,"Please provide a valid style id."),r&&r.call(o,l,!1),!1)},getInheritedStylesPrefixes:function(e,t,i){var r,o={};return t=s(t,"function")?t:!1,this.collections.styles.get(e)?(this.collections.media_queries.forEach(function(t){var i;i=this.getInheritedStylesPrefixForMediaQueryId(e,t.get("id")),o[t.get("id")]=i},this),t&&t.call(i,null,o),o):(r=new n(101,"Please provide a valid style id."),t&&t.call(i,r,!1),!1)},getInheritedStylesPrefixForMediaQueryId:function(e,t,r,o){var a,l,c,u,h,d,p,f=[];return r=s(r,"function")?r:!1,this.collections.styles.get(e)?(a=this.collections.media_queries.get(t),s(a,"object")?(d=this.collections.media_queries.getMinWidthQueries(),p=this.collections.media_queries.getMaxWidthQueries(),f=f.concat(this.collections.media_queries.without.apply(this.collections.media_queries,d.concat(p))),u=parseInt(a.get("attributes")["min-width"],10),s(u,"number")&&d.forEach(function(e){return u>=parseInt(e.get("attributes")["min-width"],10)?f.push(e):void 0}),h=parseInt(i.chain(a.get("attributes")).pick("min-width","max-width").compact().value()[0],10),s(h,"number")&&p.forEach(function(e){return h<=parseInt(e.get("attributes")["max-width"],10)?f.push(e):void 0}),f=i.sortBy(f,function(e){return e.id}),c=i.object(f.map(function(e){return["data-styles-mq-"+e.id,""]})),r&&r.call(o,null,c),c):(l=new n(111,"This media query does not exist."),r&&r.call(o,l,!1),!1)):(l=new n(101,"Please provide a valid style id."),r&&r.call(o,l,!1),!1)},getRWDStrategy:function(e,t,i){var r,o;return t=s(t,"function")?t:!1,this.collections.styles.get(e)?(r=this.collections.media_queries.getRWDStrategyByStyleId(e),t&&t.call(i,null,r),r):(o=new n(101,"Please provide a valid style id."),t&&t.call(i,o,!1),!1)},_isValidOptionsObject:function(e){return s(e,"object")?!s(e.attributes,"array")||s(e.element_id,"string")||s(e.selector,"string")?!0:new n(106,"If an attributes option is provided, an element ID or selector must be provided"):!1},_getChangedAttributes:function(e,t){var n,r,o=[];return r=Object.keys(t),r.forEach(function(r){s(t[r],"array")&&(s(e[r],"array")?(n=i.difference(e[r],t[r]),n.length>0&&o.push(r)):o.push(r))}),o},_getAttributeValues:function(e,t){var n,r,o,a,l,c={},u=!0;return e instanceof this.collections.styleDeclarations.model&&s(t,"object")?(r=this._getListExplicitlySetAttributes(e,t.attributes),r.forEach(function(t){a=t,c[a]=e.get("attributes")[a]}),l=e.get("media_query_id"),o=i.difference(t.attributes,r),s(t.element_id,"string")?n=this._getAttributeValuesUsingElementId(t.element_id,l,o):s(t.selector,"string")&&(n=this._getAttributeValuesUsingSelector(t.selector,o,this.getInheritedStylesPrefixForMediaQueryId(e.get("style_id"),l))),c=i.extend(c,n),o.forEach(function(e){s(n[e],"undefined")&&(u=!1)}),u?{values:c,inherited:o}:!1):!1},_getListExplicitlySetAttributes:function(e,t){var i,n,r,o=[];return e instanceof this.collections.styleDeclarations.model&&s(t,"array")?(i=e.get("attributes"),n=Object.keys(i),n.forEach(function(e){r=i[e],s(r,"array")&&"auto"!==r[0]&&o.push(e)}),o):!1},_getAttributeValuesUsingElementId:function(e,t,i){var n,o={};return i.forEach(function(i){n=r.getCssPropertyForElement(e,t,i),s(n,"string")&&(o[i]=[n])}),o},_getAttributeValuesUsingSelector:function(e,t,i){var n;return n=r.getCssPropertiesForSampleElement(e,t,i),s(n,"object")?(t=Object.keys(n),t.forEach(function(e){n[e]=[n[e]]},this),n):!1},_isValidStyleId:function(e){return this.collections.styles.get(e)?!0:!1},_getPrefixedAttributes:function(e){var t={};return s(e,"object")&&s(this.config,"object")&&s(this.config.prefixes,"object")?(i.each(i.intersection(this.config.prefixes.attributes,i.keys(e)),function(n){i.each(this.config.prefixes.prefixes,function(i){t[i+n]=e[n]})},this),t):!1},_getPrefixedAttributeNames:function(e){var t=[];return s(e,"array")&&s(this.config,"object")&&s(this.config.prefixes,"object")?(i.each(i.intersection(this.config.prefixes.attributes,e),function(e){i.each(this.config.prefixes.prefixes,function(i){t.push(i+e)})},this),t):!1},_giveDefaultMQMinWidthWhenMobileFirst:function(){var e,t=this.collections.media_queries.filter(function(e){return i.has(e.get("attributes"),"min-width")});return t.length>0&&(e=this.collections.media_queries.find(function(e){return e.get("is_default")}),e.set("attributes",{"min-width":this.config.default_mq_min_width})),!0}});return c}),define("core/utils/str",["core/utils/is"],function(e){return{capitalize:function(t){var i="";return e(t,"string")?i=t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():i},getColour:function(t){var i,n={colour:"",string:t},s=/(#([0-9A-Fa-f]{3,6})\b)|(aqua)|(black)|(blue)|(fuchsia)|(gray)|(green)|(lime)|(maroon)|(navy)|(olive)|(orange)|(purple)|(red)|(silver)|(teal)|(white)|(yellow)|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\))|(rgba\(\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d{1,3}\s*,\s*\d(\.\d+)?\s*\))/;return e(t,"string")&&(i=t.match(s))?(n.colour=i[0],n.string=t.replace(i[0],""),n):n},stripQuotes:function(t){return e(t,"string")?(t.match(/^["'].*["']$/)&&(t=t.substr(1,t.length-2)),t):t},wrapQuotes:function(t){return e(t,"string")?(t.match(/^["'].*["']$/)||(t='"'+t+'"'),t):t},pluralize:function(e,t,i){return 1===e?t:i}}}),define("data/fonts/models/font-variation",["backbone"],function(e){return e.Model.extend({})}),define("data/fonts/collections/font-variations",["backbone","../models/font-variation"],function(e,t){return e.Collection.extend({model:t})}),define("data/fonts/models/font",["backbone","core/utils/is","core/typecastError","../collections/font-variations"],function(e,t,i,n){return e.Model.extend({defaults:function(){return{variations:new n}},initialize:function(){this.get("variations")instanceof n||this.set("variations",new n(this.get("variations")))},validate:function(e){var n,s=[];return(!t(e.font_family,"string")||e.font_family.length<1)&&(n=new i(101,"'font_family' is required"),s.push(n)),(!t(e.library,"string")||e.library.length<1)&&(n=new i(101,"'library' is required"),s.push(n)),s.length>0?s:null},addVariations:function(e){return t(e,"object")&&(e=[e]),t(e,"array")?(this.get("variations").add(e),!0):!1},getDefaultVariation:function(){var e,i=this.get("default_variation_id"),n=this.get("variations");return t(i,"string")||t(i,"number")?(e=n.get(i),t(e,"object")?e:!1):!1}})}),define("data/fonts/collections/fonts",["backbone","../models/font"],function(e,t){return e.Collection.extend({model:t})}),define("data/fonts/models/font-filters",["backbone"],function(e){return e.Model.extend({defaults:function(){return{providers:[],categories:[],languages:[],designers:[]}}})}),define("data/fonts/controllers/fonts-api",["jquery","underscore","core/utils/is","core/typecastError"],function(e,t,i,n){var s=function(){this.config={},this.cache={},this.initialize.apply(this,arguments)};return s.prototype.initialize=function(e){i(e,"object")&&i(e.config,"object")&&(this.config=e.config),this.referer=e.referer},s.prototype.getXhrTimeout=function(){var e=0;return i(this.config.xhr,"object")&&i(this.config.xhr.timeout,"number")&&(e=this.config.xhr.timeout),e},s.prototype.getFontLibraries=function(t){var s,r;return i(t,"function")?(s=e.ajax({url:"/",data:this._buildFiltersForAPI("fetchFilters",null),timeout:this.getXhrTimeout(),dataType:"json"}).always(function(e,i,s){return"success"!==i?(r=new n(101,"API Error: "+s),void t(r,null)):void t(null,e)}),!0):!1},s.prototype.queryFonts=function(s,r){var o,a,l=this;return i(r,"function")?(o=e.ajax({url:"/",data:this._buildFiltersForAPI("fetch",s),timeout:this.getXhrTimeout(),beforeSend:function(e){i(l.cache[this.url],"object")&&(r(null,l.cache[this.url].response),e.abort())},dataType:"json"}).always(function(e,i,s){if("canceled"!==i){if("success"!==i)return a=new n(101,"API Error: "+s),void r(a,null);l.cache[this.url]={ids:t.pluck(e.fonts,"id"),response:e},r(null,e)}}),!0):!1},s.prototype.getFontByID=function(s,r){var o,a,l=this,c=!1;return i(r,"function")?(c=i(s,"array")?t.every(s,function(e){return i(e,"number")}):i(s,"number"))?(o=e.ajax({url:"/",data:this._buildFiltersForAPI("fetchFontFamilyById",{id:s}),timeout:this.getXhrTimeout(),beforeSend:function(e){i(l.cache[this.url],"object")&&(r(null,l.cache[this.url].response),e.abort())},dataType:"json"}).always(function(e,i,s){if("canceled"!==i){if("success"!==i)return a=new n(103,"API Error: "+s),void r(a,null);if(e.success!==!0)return a=new n(104,e.message||e.reason),void r(a,null);l.cache[this.url]={ids:t.pluck(e.fonts,"id"),response:e},r(null,e)}}),!0):(a=new n(101,"Please provide a valid font ID"),r(a,null),!1):!1},s.prototype.getByFontFamilyAndProvider=function(s,r,o){var a,l,c=this;return i(o,"function")?!i(s,"string")||s.length<1?(l=new n(101,"Please provide a valid CSS font family"),o(l,null),!1):!i(r,"string")||r.length<1?(l=new n(102,"Please provide a valid provider name"),o(l,null),!1):(a=e.ajax({url:"/",data:{ACT:this.config.actionIds.getByCSSFontFamily,"class":"fonts",method:"forFamilyAndProvider",family:s,provider:r,referer:this.referer},timeout:this.getXhrTimeout(),beforeSend:function(e){i(c.cache[this.url],"object")&&(o(null,c.cache[this.url]),e.abort())},dataType:"json"}).always(function(e,i,s){if("canceled"!==i){if("success"!==i)return l=new n(103,"API Error: "+s),void o(l,null);if(e.success!==!0)return l=new n(104,e.message||e.reason),void o(l,null);c.cache[this.url]={ids:t.pluck(e.fonts,"id"),response:e},o(null,e)}}),!0):!1},s.prototype.isFavourited=function(e,t){return i(t,"function")?(i(e,"number")||t(new n(101,"Please provide a valid font ID"),null),void this.getFontByID(e,function(e,n){var s;return e?void t(e,null):(s=n.fonts[0],i(s,"object")&&i(s.is_favourite,"boolean")&&s.is_favourite&&t(null,!0),void t(null,!1))})):!1},s.prototype.addFavourite=function(s,r){var o;return i(r,"function")?(i(s,"number")||r(new n(101,"Please provide a valid font ID"),null),o=e.ajax({url:this._getBaseApiUrl()+"/fonts/favourites",type:"post",data:{id:s},xhrFields:{withCredentials:!0},timeout:this.getXhrTimeout()}),o.success(t.bind(function(e){this._deleteCachedResponsesWithId(s),r(null,e)},this)),o.fail(function(e,t,i){r(new n(104,i.error),null)}),!0):!1},s.prototype.deleteFavourite=function(s,r){var o;return i(r,"function")?(i(s,"number")||r(new n(101,"Please provide a valid font ID"),null),o=e.ajax({url:this._getBaseApiUrl()+"/fonts/favourites/"+s,type:"delete",xhrFields:{withCredentials:!0},timeout:this.getXhrTimeout()}),o.success(t.bind(function(){this._deleteCachedResponsesWithId(s),r(null,!0)},this)),o.fail(function(e,t,i){r(new n(104,i.error),null)}),!0):!1},s.prototype.getFavourites=function(t){var s;return i(t,"function")?(s=e.ajax({url:this._getBaseApiUrl()+"/fonts/favourites",type:"get",xhrFields:{withCredentials:!0},timeout:this.getXhrTimeout()}),s.success(function(e){t(null,e)}),s.fail(function(e,i,s){t(new n(103,"API Error: "+s),null)}),!0):!1},s.prototype.getRecentlyUsed=function(t,s){var r;return i(t,"object")&&i(s,"function")?(i(t.page,"number")||(t.page=1),r=e.ajax({url:this._getBaseApiUrl()+"/fonts/used/without-favourites",type:"get",data:t,xhrFields:{withCredentials:!0},timeout:this.getXhrTimeout()}),r.success(function(e){s(null,e)}),r.fail(function(e,t,i){s(new n(103,"API Error: "+i),null)}),!0):!1},s.prototype._buildFiltersForAPI=function(e,t){var s={},r=this.config.actionIds;if(!i(r,"object")||!i(r[e],"number"))throw new n("data:fonts:fontsAPI-controller - Action IDs are missing in the config file for method: "+e);return s.ACT=r[e],s["class"]="fonts",s.method=e,i(t,"object")?(i(t.id,"number")&&(s.id=t.id),i(t.id,"array")&&(s.id=t.id.join(",")),i(t.library,"string")&&(s.provider=t.library),i(t.classification,"string")&&(s.classification=t.classification),i(t.search_query,"string")&&(s.q=t.search_query),i(t.offset,"number")&&(s.offset=t.offset),i(t.limit,"number")&&(s.limit=t.limit),s.referer=this.referer,s):(s.referer=this.referer,s)},s.prototype._getBaseApiUrl=function(){return"https://api."+window.location.host+"/v1"},s.prototype._deleteCachedResponsesWithId=function(e){this.cache=t.reject(this.cache,function(i){return t.contains(i.ids,e)},this)},s}),define("data/fonts/index",["jquery","underscore","backbone","core/utils/is","core/utils/str","core/utils/cast","core/typecastError","./collections/fonts","./models/font-filters","./controllers/fonts-api"],function(e,t,i,n,s,r,o,a,l,c){var u=i.DataController.extend({namespace:"data:fonts",config:null,collections:null,models:null,active_font_list:null,active_media_query_id:null,active_style_id:null,watched_attributes:["font-family","font-style","font-weight"],listeners:{"[remote]data:state:changed:active-media-query":"setActiveMediaQuery","[remote]data:state:changed:active-style":"setActiveStyle","[remote]data:styles:changed":"onChangedStyleDeclaration",query:"query",getAvailableFilters:"getAvailableFilters",getByCssFontFamily:"getByCssFontFamily",toggleFavourite:"toggleFavourite",getFavourites:"getFavourites",getRecentlyUsed:"getRecentlyUsed",getActiveFontsList:"getActiveFontsList","set:active-fonts":"setActiveFontsList"},initialize:function(e){var t=this;this.collections={},this.models={},this.active_font_list=[],this.fontsApi=new c({config:this.config,referer:this._getReferer()}),this.collections.fonts=new a,this.models.fontFilters=new l,this.fontsApi.getFontLibraries(function(e,i){e||i.success!==!0||(t.models.fontFilters.set(i),t.imc.trigger(t.namespace+":ready"))}),this.imc.trigger("data:state:get","active-style",function(e,t){return e?!1:void(this.active_style_id=t)},this),n(e.initData,"object")&&n(e.initData.activeFonts,"array")&&this.loadActiveFonts(e.initData.activeFonts)},loadActiveFonts:function(e){var i,s;return n(e,"array")?(e.forEach(function(e){var r,o,a=this;if(!n(e,"object"))return!1;if(n(e,"object")&&n(e.id,"number"))this.fontsApi.getFontByID(e.id,function(n,l){n||l.success!==!0||(o=a.addFontToActiveFontsCollection(l),s=o.toJSON(),i=a._removeUneededVariations(s,e),i=a._copyLegacyData(i,e),a.addFontsToActiveFontsList(i),r=t.extend({active_variations:e.variations},s),a.imc.trigger(a.namespace+":active-font-loaded",r))});else{if(!n(e.fontFamily,"string")||0===e.fontFamily.length)return!1;if(!n(e.provider,"string")||0===e.provider.length)return!1;this.fontsApi.getByFontFamilyAndProvider(e.fontFamily,e.provider,function(n,l){n||l.success!==!0||(o=a.addFontToActiveFontsCollection(l),s=o.toJSON(),i=a._getFontIdAndVariationIdsForLegacyValues(e,o),a.addFontsToActiveFontsList(i),r=t.extend({active_variations:i.variations},s),a.imc.trigger(a.namespace+":active-font-loaded",r))})}},this),!0):!1},query:function(e,t,i,s){var a,l=this;return n(i,"function")?(n(t,"object")||(t={}),n(e,"object")?(n(e.id,"string")&&(e.id=r(e.id,"number")),void(n(e.id,"number")||n(e.id,"array")?this.fontsApi.getFontByID(e.id,function(t,r){var a,c;return t||!r.success?(t=new o(103,"Error receiving font from the API"),void i.call(s,t,null)):(n(e.id,"number")?(a=l.addFontToActiveFontsCollection(r),c=a.toJSON()):c=r,void i.call(s,null,c,e))}):this.fontsApi.queryFonts(e,function(t,n){return t||!n.success?(t=new o(104,"Error receiving font from the API"),void i.call(s,t,null)):void i.call(s,null,n,e)}))):(a=new o(101,"Please provide some filters"),i.call(s,a,null),!1)):!1},getByCssFontFamily:function(e,t,i){var s=[];return n(t,"function")?!n(e,"string")||e.length<1?(t.call(i,new o(101,"You must provided a CSS font family")),!1):(e=e.replace(/["']/g,""),this.collections.fonts.forEach(function(t){return t.get("css_font_family")===e?void s.push(t.toJSON()):void t.get("variations").forEach(function(i){return i.get("css_font_family")===e?void s.push(t.toJSON()):void 0},this)},this),s.length<1?(t.call(i,new o(102,"No active font found matching: "+e)),!1):(t.call(i,null,s[0]),!0)):!1},getAvailableFilters:function(e,t){var i;return n(e,"function")?(i=this.models.fontFilters.toJSON(),e.call(t,null,i),!0):!1},addFontToActiveFontsCollection:function(e){var t,i,n;return e===!1||e.success!==!0?!1:(t=this.collections.fonts.where({id:e.fonts[0].id}),t.length?t[0]:(i=e.fonts[0].variations,delete e.fonts[0].variations,n=new this.collections.fonts.model(e.fonts[0]),n.addVariations(i),this.collections.fonts.add(n),n))},addFontsToActiveFontsList:function(e){var i,s=JSON.stringify(this.active_font_list);return n(e,"array")||n(e,"object")?(n(e,"array")||(e=[e]),e.forEach(function(e){var i=t.findWhere(this.active_font_list,{id:e.id}),s=[];n(i,"object")?(s=i.variations.map(function(e){return e.id}),e.variations.forEach(function(e){-1===s.indexOf(e.id)&&i.variations.push(e)})):this.active_font_list.push(e)},this),i=JSON.stringify(this.active_font_list),i!==s&&this.imc.trigger(this.namespace+":changed:active-fonts",this.active_font_list),!0):!1},setActiveFontsList:function(e){var i=[],s={};return n(e,"array")?(this.active_font_list.forEach(function(e){s[e.id]=[],e.variations.forEach(function(t){s[e.id].push(t.id)})}),e.forEach(function(e){var r,o,a,l=s[e.id];n(l,"array")?(r=e.variations.map(function(e){return e.id}),o=t.difference(r,l),o.length>0&&(a=o.map(function(e){return{id:e}}),e=this._removeUneededVariations(e,{variations:a}),i.push(e))):i.push(e)},this),0===i.length?!1:(this.loadActiveFonts(i),this.active_font_list=e,!0)):!1},setActiveMediaQuery:function(e){return this.active_media_query_id=null,!n(e,"string")||e.length<1?!1:(this.active_media_query_id=e,!0)},setActiveStyle:function(e){return this.active_style_id=null,n(e,"number")?(this.active_style_id=e,!0):!1},onChangedStyleDeclaration:function(e,i,s,r,o){var a;return n(o,"array")?(a=t.intersection(o,this.watched_attributes),a.length<1?!1:(this.fetchFontsInActiveStyle(),!0)):!1},fetchFontsInActiveStyle:function(){return n(this.active_style_id,"number")?!n(this.active_media_query_id,"string")||this.active_media_query_id.length<1?!1:(this.imc.trigger("data:styles:getStyleDeclarationsWithMediaQueriesByStyleId",this.active_style_id,function(e,t){var i=[];return e?!1:n(t,"array")?(t.forEach(function(e){return n(e.style_declarations,"array")?void(i=i.concat(e.style_declarations)):!1}),void this._getFontsFromStyleDeclarations(i)):!1},this),!0):!1},toggleFavourite:function(e,t,i,s){return n(i,"function")?(n(e,"number")||i(new o(105,"You must provide a font ID"),null),n(t,"boolean")||i(new o(106,"You must pass true or false depending on if the font is favourited or not"),null),void(t?this.fontsApi.addFavourite(e,function(e){i.call(s,e)}):this.fontsApi.deleteFavourite(e,function(e){i.call(s,e)}))):!1},getFavourites:function(e,t){return n(e,"function")?void this.fontsApi.getFavourites(function(i,n){return i?void e.call(t,i,null):void e.call(t,null,n)}):!1},getRecentlyUsed:function(e,t,i){return n(t,"function")?void this.fontsApi.getRecentlyUsed(e,function(e,n){return e?void t.call(i,e,null):void t.call(i,null,n)}):!1},getActiveFontsList:function(t,i){var s;return n(t,"function")?(s=e.extend(!0,[],this.active_font_list),t.call(i,null,s),!0):!1},_getFontsFromStyleDeclarations:function(e){var t=[],i=[];return n(e,"array")?(e.forEach(function(e){var i;return n(e,"object")&&n(e.getStyleDeclaration,"function")&&n(e.getStyleDeclaration(),"object")?(i=e.getStyleDeclaration().attributes,void(n(i,"object")&&n(i["font-family"],"array")&&t.push({cssFontFamily:s.stripQuotes(i["font-family"][0]),fontWeight:n(i["font-weight"],"array")?i["font-weight"][0]:null,fontStyle:n(i["font-style"],"array")?i["font-style"][0]:null}))):!1},this),t.forEach(function(e){var t,s;t=this._lookupFontByCssFontFamily(e.cssFontFamily),s=this._getFontIdAndVariationIdsForLegacyValues(e,t),n(s,"object")&&i.push(s)},this),this.active_font_list=[],this.addFontsToActiveFontsList(i),!0):!1},_lookupFontByCssFontFamily:function(e){var t=!1;return!n(e,"string")||e.length<1?!1:(this.collections.fonts.some(function(i){return i.get("css_font_family")===e?t=i:i.get("variations").forEach(function(n){
n.get("css_font_family")===e&&(t=i)}),!!t}),t)},_getFontIdAndVariationIdsForLegacyValues:function(e,t){var i,s={},r=!1;return n(e,"object")&&n(t,"object")?(s=t.toJSON(),s.cssFontFamily=e.cssFontFamily,s.fontFamily=t.get("name_clean"),s.variations=[],e.cssFontFamily===s.css_font_family?(e.fontWeight&&e.fontStyle&&t.get("variations").forEach(function(t){Number(e.fontWeight)===Number(t.get("weight"))&&e.fontStyle===t.get("style")&&(r=!0,s.variations.push(t.toJSON()))}),r||(i=t.getDefaultVariation(),n(i,"object")&&s.variations.push(i.toJSON()))):t.get("variations").forEach(function(t){e.cssFontFamily===t.get("css_font_family")&&s.variations.push(t.toJSON())}),s):!1},_copyLegacyData:function(e,t){return n(t.cssFontFamily,"string")&&(e.cssFontFamily=t.cssFontFamily),n(t.fontFamily,"string")&&(e.fontFamily=t.fontFamily),e},_removeUneededVariations:function(e,i){var s,r=e.variations;return e.variations=[],i.variations.forEach(function(i){s=t.findWhere(r,{id:i.id}),n(s,"object")&&e.variations.push(s)}),e},_getReferer:function(){return document.location.href.replace("https://","").replace("http://","")}});return u}),define("data/walkthroughs/models/walkthrough",["backbone"],function(e){return e.Model.extend({initialize:function(){this.set("tooltips",new e.Collection(this.get("tooltips")))}})}),define("data/walkthroughs/collections/walkthroughs",["backbone","../models/walkthrough"],function(e,t){return e.Collection.extend({model:t})}),define("data/walkthroughs/index",["jquery","backbone","core/typecastError","core/utils/is","./collections/walkthroughs","./models/walkthrough"],function(e,t,i,n,s,r){var o=t.DataController.extend({namespace:"data:walkthroughs",config:null,all_walkthroughs_collection:null,listeners:{"get-all":"getAll","get-incomplete":"getIncomplete","get-tooltips":"getTooltips","get-tooltip-at":"getTooltipAt","set-complete":"setComplete","set-incomplete":"setIncomplete",getById:"getById"},initialize:function(e){var t,s=":ready";if(t=n(e.config,"object")&&n(e.config.api,"object")?this._validateConfig(e.config.api):"Config is not an object",n(t,"string"))throw this.imc.trigger("service:log:error",{message:t,code:101}),new i(101,"Walkthrough module's configuration data is invalid: "+t);return this.config=e.config,this.imc.trigger(this.namespace+s),this},getAll:function(e,t){return this._ensureGetAllResponse(e,t,function(e){return new s(e.toJSON())}),!0},getById:function(e,t,s){var o;return n(e,"number")?(this._ensureGetAllResponse(t,s,function(t){var i=t.where({id:e});return i.length>0?new r(i[0].toJSON()):void 0}),!0):(o=new i(102,"Need to provide walkthrough_id as number."),t&&t.call(s,o,!1),!1)},getIncomplete:function(e,t){return this._ensureGetAllResponse(e,t,function(e){var t=e.where({complete:!1});return t.length>0?new s(t):void 0}),!0},getTooltips:function(e,s,r){var o;return n(e,"number")?(this._ensureGetAllResponse(s,r,function(i){var n=i.where({id:e});return n.length>0?new t.Collection(n[0].get("tooltips").toJSON()):void 0}),!0):(o=new i(102,"Need to provide walkthrough_id as number."),s&&s.call(r,o,!1),!1)},getTooltipAt:function(e,s,r,o){var a;return n(e,"number")||(a=new i(103,"Need to provide walkthrough_id as number."),r&&r.call(o,a,!1)),n(s,"number")||(a=new i(104,"Need to provide tooltip_index as number."),r&&r.call(o,a,!1)),this._ensureGetAllResponse(r,o,function(i){var r=i.where({id:e});return r.length>0?(r=r[0].get("tooltips").at(s),n(r,"undefined")?void 0:new t.Model(r.toJSON())):void 0}),!0},setComplete:function(t,s,r,o){var a;return n(t,"number")||(a=new i(105,"Need to provide walkthrough_id as number."),r&&r.call(o,a,!1)),n(s,"number")||(a=new i(106,"Need to provide tooltip_index as number."),r&&r.call(o,a,!1)),e.ajax({url:"/",type:"POST",data:this._buildParams("userCompletedWalkthrough",t,s),success:e.proxy(function(e){e.status||(a=new i(107,"Server returned error with message: "+e.message)),r&&r.call(o,a,!1)},this),error:e.proxy(function(){a=new i(108,"Server returned error."),r&&r.call(o,a,!1)},this)}),!0},setIncomplete:function(t,s,r){var o;return n(t,"number")||(o=new i(109,"Need to provide walkthrough_id as number."),s&&s.call(r,o,!1)),e.ajax({url:"/",type:"POST",data:this._buildParams("userUncompleteWalkthrough",t),success:e.proxy(function(e){e.status||(o=new i(110,"Server returned error with message: "+e.message)),s&&s.call(r,o,!1)},this),error:e.proxy(function(){o=new i(101,"Server returned error."),s&&s.call(r,o,!1)},this)}),!0},_ensureGetAllResponse:function(t,r,o){var a;return n(this.all_walkthroughs_collection,"object")?this._invokeCallbacksAfterManipulation(t,r,o):e.ajax({dataType:"json",url:"/",type:"POST",data:this._buildParams("all"),success:e.proxy(function(e){return n(e,"object")?void(e.status?(this.all_walkthroughs_collection=new s(e.data),this._invokeCallbacksAfterManipulation(t,r,o)):(a=new i(111,"Server returned error with message: "+e.message),t&&t.call(r,a,!1))):(a=new i(114,"Server returned invalid response"),t&&t.call(r,a,!1),!1)},this),error:e.proxy(function(){a=new i(112,"Server returned error."),t&&t.call(r,a,!1)},this)}),!0},_invokeCallbacksAfterManipulation:function(e,t,r){var o;if(n(r,"function")){var a=r(this.all_walkthroughs_collection);n(a,"object")?e&&e.call(t,void 0,r(this.all_walkthroughs_collection)):(o=new i(113,"Not found any data."),e&&e.call(t,o,!1))}else e&&e.call(t,void 0,new s(this.all_walkthroughs_collection.toJSON()));return!0},_validateConfig:function(e){return n(e,"object")?n(e.action_id,"number")&&n(e["class"],"string")?!0:"Config should have all {action_id, class}.":"UrlsConfig should be an object."},_buildParams:function(e,t,i){if(!n(e,"string"))return!1;var s={ACT:this.config.api.action_id,"class":this.config.api["class"],method:e};return void 0===t||n(t,"number")?(-1!==["userCompletedWalkthrough","userUncompleteWalkthrough"].indexOf(e)&&(s.walkthrough_id=t),void 0===i||n(i,"number")?("userCompletedWalkthrough"===e&&(s.walkthrough_closed_at_tooltip_number=i),s):!1):!1}});return o}),define("core/utils/unit",["jquery","underscore","core/utils/dom","core/utils/is","core/typecastError"],function(e,t,i,n,s){function r(e,t,i,n){return n}function o(e,t,i,n){return n.value=Math.round(n.value),n}function a(e,t,i,n){var s=h(e,t,i,"em","px"),r=n.value*s;return{unit:"px",value:r}}function l(e,t,i,n){var s=h(e,t,i,"px","em"),r=d(n.value/s);return{unit:"em",value:r}}function c(e,t,i,n){var s=h(e,t,i,"%","px"),r=n.value*s/100;return{unit:"px",value:r}}function u(e,t,i,n){var s=h(e,t,i,"px","%"),r=d(n.value/s*100);return{unit:"%",value:r}}function h(e,n,s,r,o){var a,l=["border-radius","border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"];return s=s.toLowerCase(),"font-size"===s?a=i.getCssPropertyForElement(e,n,"font-size","parent"):"background-size"===s?(a=parseFloat(i.getCssPropertyForElement(e,n,"width")),a-=parseFloat(i.getCssPropertyForElement(e,n,"padding-left"))/2,a-=parseFloat(i.getCssPropertyForElement(e,n,"padding-right"))/2):t.contains(l,s)&&!t.contains([r,o],"em")?(a=i.getCssPropertyForElement(e,n,"height"),a||(a=i.getCssPropertyForElement(e,n,"font-size"))):a=!s.match(/^(margin|padding)/)&&"width"!==s&&"text-indent"!==s||"%"!==r&&"%"!==o?"height"!==s||"%"!==r&&"%"!==o?i.getCssPropertyForElement(e,n,"font-size"):i.getCssPropertyForElement(e,n,"height","parent"):i.getCssPropertyForElement(e,n,"width","parent"),parseFloat(a)}function d(e){return Number(e.toFixed(3))}var p={px:{to_pixel:r,from_pixel:o},em:{to_pixel:a,from_pixel:l},"%":{to_pixel:c,from_pixel:u}};return{getValueAndUnit:function(e){if(!n(e,"string"))throw new s(101,"unit::getValueAndUnit Value must be of type string");var t=e.match(/^(-?[0-9\.]+)([a-zA-Z%]*)$/i);return n(t,"null")?null:{unit:t[2],value:t[1]}},convert:function(e){var t,r,o,a,l=Object.keys(p);if(!n(e,"object")||!n(e.element_id,"string")||e.element_id.length<1||!n(e.media_query_id,"string")||e.media_query_id.length<1||!n(e.unit_to,"string")||e.unit_to.length<1||!n(e.property,"string")||e.property.length<1||!n(e.value,"string")||e.value.length<1)throw new s(101,"unit::convert args must be an object e.g. { element_id: 'my-div', media_query_id: 'mq-123', unit_to: 'em', property: 'font-size', value: '13px' }");return t=this.getValueAndUnit(e.value),n(t,"null")?null:(t.unit=t.unit.toLowerCase(),t.value=parseFloat(t.value),e.unit_to=e.unit_to.toLowerCase(),-1===l.indexOf(t.unit)||-1===l.indexOf(e.unit_to)?null:t.unit===e.unit_to?String(t.value):(a=i.getElement(e.media_query_id,e.element_id),!n(a,"object")||a.length<1?null:(r=p[t.unit].to_pixel(e.element_id,e.media_query_id,e.property,t),o=p[e.unit_to].from_pixel(e.element_id,e.media_query_id,e.property,r),String(o.value))))}}}),define("data/baseline-grid/models/baselineGrid",["backbone","underscore","core/utils/unit"],function(e,t,i){return e.Model.extend({config:{supportedUnits:["px","em","%"]},defaults:{"line-height":"10px",offset:"0px",strategy:"p-based",visibility:!1},initialize:function(){return this},validAttributes:function(e){var i={};return this.validateOffset(e.offset)&&(i.offset=e.offset),this.validateLineHeight(e["line-height"])&&(i["line-height"]=e["line-height"]),this.validateStrategy(e.strategy)&&(i.strategy=e.strategy),e.hasOwnProperty("visibility")&&(i.visibility=!!e.visibility),t.isEmpty(i)?!1:i},gridAttributesToJSON:function(){var e=this.toJSON();return{"line-height":e["line-height"],offset:e.offset,strategy:e.strategy,visibility:e.visibility}},validateUnit:function(e){return e&&t(this.config.supportedUnits).contains(i.getValueAndUnit(e.toString()).unit)},validateOffset:function(e){return this.validateUnit(e)},validateLineHeight:function(e){return this.validateUnit(e)},validateStrategy:function(e){return t(["fixed","p-based"]).contains(e)}})}),define("data/baseline-grid/index",["backbone","./models/baselineGrid","core/utils/is","core/typecastError","core/utils/unit"],function(e,t,i,n,s){return e.DataController.extend({namespace:"data:baseline-grid",model:null,active_media_query_id:null,active_style_id:null,listeners:{change:"change","get-next-line":"getNextLine","get-settings":"getSettings","[remote]data:state:changed:active-media-query":"setActiveMediaQueryId","[remote]data:state:changed:active-style":"setActiveStyleId"},initialize:function(){return this.model=new t({config:this.config}),this.changedStrategy(this.model,this.model.get("strategy")),this.model.on("change:strategy",this.changedStrategy,this),this.model.on("change",function(){this.imc.trigger(this.namespace+":changed",null,this.model.gridAttributesToJSON())},this),this.imc.trigger(this.namespace+":ready"),!0},changedStrategy:function(e,t){return"p-based"===t?(this.handleStylesChanges(),this.subscribeToStylesChanges(this.handleStylesChanges),!0):"fixed"===t?(this.unsubscribeFromStylesChanges(this.handleStylesChanges),!0):void 0},subscribeToStylesChanges:function(e){return this.imc.on("data:styles:changed",e,this),this.imc.on("data:styles:deleted:styleDeclaration",e,this),!0},unsubscribeFromStylesChanges:function(e){return this.imc.off("data:styles:changed",e,this),this.imc.off("data:styles:deleted:styleDeclaration",e,this),!0},handleStylesChanges:function(){return i(this.active_style_id,"number")?!i(this.active_media_query_id,"string")||this.active_media_query_id.length<1?!1:void this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query_id,"p",{selector:"p",attributes:["line-height"]},this.populateStylesChanges,this):!1},populateStylesChanges:function(e,t){if(e)return!1;var n=t.getValue("line-height"),s=this.model.get("line-height");return i(n,"array")&&(n=n[0]),n===s?!1:this.change({"line-height":n},null,null)},change:function(e,t,s){var r,o,a,l=this.model;return t=i(t,"function")?t:!1,(r=l.validAttributes(e))?(l.set(r),o=l.gridAttributesToJSON(),t&&t.call(s,null,o),!0):(a=new n(101,"Please provide valid grid settings."),t&&t.call(s,a,!1),!1)},getNextLine:function(e,t,r,o){var a,l,c=this.model.gridAttributesToJSON(),u=function(e,t){var n=i(e,"function")?e():e;return n||r&&r.call(o,t,!1),!n},h=function(){var t;return a=s.getValueAndUnit(e),t=a&&"px"===a.unit,t&&(l=parseInt(a.value,10)),t};return u(i(r,"function"))?!1:u(["up","down"].indexOf(t)>-1,new n(101,"Please provide valid direction."))?!1:u(!("fixed"===c.strategy&&"0"===s.getValueAndUnit(c["line-height"]).value),new n(102,"Line height cannot be 0."))?!1:u(h,new n(103,"Invalid Y coordinate: ["+e+"], should be like '25px'."))?!1:("fixed"===c.strategy?r&&r.call(o,null,this._calculateCoordinate(c["line-height"],c.offset,l,t)+"px"):this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query_id,null,"p",function(e,i){r&&r.call(o,null,this._calculateCoordinate(i.style_declaration["line-height"],c.offset,l,t)+"px")},this),!0)},getSettings:function(e,t){return i(e,"function")?void(e&&e.call(t,null,this.model.gridAttributesToJSON())):!1},remove:function(){this.unsubscribeFromStylesChanges(this.handleStylesChanges)},_calculateCoordinate:function(e,t,i,n){var r,o,a;return e=parseInt(s.getValueAndUnit(e).value,10)||0,t=parseInt(s.getValueAndUnit(t).value,10)||0,e?(a=(i-t)/e,r="down"===n?Math.ceil(a):Math.floor(a),o=r*e+t):o=0,o},setActiveMediaQueryId:function(e){return this.active_media_query_id=null,!i(e,"string")||e.length<1?!1:(this.active_media_query_id=e,"fixed"!==this.model.get("strategy")&&this.handleStylesChanges(),!0)},setActiveStyleId:function(e){return this.active_style_id=null,i(e,"number")?(this.active_style_id=e,this.handleStylesChanges(),!0):!1}})}),define("ui/styles/index",["jquery","underscore","backbone","core/utils/cast","core/utils/is","core/utils/css"],function(e,t,i,n,s,r){var o=i.UIController.extend({namespace:"ui:styles",style_element:null,listeners:t.extend({"[remote]data:styles:ready":"updateCssStyles","[remote]data:styles:changed":"updateCssStyles","[remote]data:styles:deleted:styleDeclaration":"updateCssStyles","[remote]data:styles:deleted:mediaQuery":"updateCssStyles","[remote]data:styles:updated:mediaQuery":"updateCssStyles","[remote]data:styles:new:mediaQuery":"updateCssStyles","[remote]app:initialize:complete":"setActiveStyle"},i.UIController.prototype.listeners),initialize:function(){return this.style_element=document.createElement("style"),document.head.appendChild(this.style_element),this.imc.trigger(this.namespace+":ready"),this},setActiveStyle:function(){return this.imc.trigger("data:styles:getStyles",function(e,t){e||!s(t,"Array")||t.length<1||this.imc.trigger("data:state:set","active-style",t[0].getStyle().id)},this),!0},onChangeActiveStyle:function(){return this.updateCssStyles(),!0},updateCssStyles:function(){return this.imc.trigger("data:styles:getStyleDeclarationsWithMediaQueriesByStyleId",this.active_style_id,function(e,t){return e||!s(t,"array")?(this.setCss(""),!1):void this.insertNewStylesToDom(t)},this),!0},insertNewStylesToDom:function(e){var t="";return!s(e,"array")||e.length<1?(this.setCss(""),!1):(t=e.reduce(function(e,t){return e+r.buildCssFromStyleDeclarations(t.style_declarations,{css_prefix:r.getSelectorForMediaQuery(t.media_query)})},""),this.setCss(t))},setCss:function(e){return s(e,"string")?(this.style_element.innerHTML=e,!0):!1},destroy:function(){return this.style_element.parentElement.removeChild(this.style_element),o.__super__.destroy.apply(this,arguments)}});return o}),define("core/utils/when",["core/utils/is"],function(e){function t(t,s,r,o){var a;return e(t,"function")&&e(s,"function")?(r=(new Date).getTime()+(e(r,"number")?r:i),a=setInterval(function(){var e=(new Date).getTime();t()&&(clearInterval(a),s()),e>r&&clearInterval(a)},o||n)):!1}var i=6e4,n=5;return t}),function(){var e={};!function(e,t){e.VERSION="1.0.0-rc.3",e.COMPILER_REVISION=2,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:">= 1.0.0-rc.3"},e.helpers={},e.partials={},e.registerHelper=function(e,t,i){i&&(t.not=i),this.helpers[e]=t},e.registerPartial=function(e,t){this.partials[e]=t},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Could not find property '"+e+"'")});var i=Object.prototype.toString,n="[object Function]";e.registerHelper("blockHelperMissing",function(t,s){var r=s.inverse||function(){},o=s.fn,a=i.call(t);return a===n&&(t=t.call(this)),t===!0?o(this):t===!1||null==t?r(this):"[object Array]"===a?t.length>0?e.helpers.each(t,s):r(this):o(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var i=new e.K;return e.K.prototype=null,i},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,i){if(e.logger.level<=t){var n=e.logger.methodMap[t];"undefined"!=typeof console&&console[n]&&console[n].call(console,i)}}},e.log=function(t,i){e.logger.log(t,i)},e.registerHelper("each",function(t,i){var n,s=i.fn,r=i.inverse,o=0,a="";if(i.data&&(n=e.createFrame(i.data)),t&&"object"==typeof t)if(t instanceof Array)for(var l=t.length;l>o;o++)n&&(n.index=o),a+=s(t[o],{data:n});else for(var c in t)t.hasOwnProperty(c)&&(n&&(n.key=c),a+=s(t[c],{data:n}),o++);return 0===o&&(a=r(this)),a}),e.registerHelper("if",function(t,s){var r=i.call(t);return r===n&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?s.inverse(this):s.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn})}),e.registerHelper("with",function(e,t){return t.fn(e)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)})}(e);var t=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,OPEN_PARTIAL:24,partialName:25,params:26,hash:27,DATA:28,param:29,STRING:30,INTEGER:31,BOOLEAN:32,hashSegments:33,hashSegment:34,ID:35,EQUALS:36,PARTIAL_NAME:37,pathSegments:38,SEP:39,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"OPEN_PARTIAL",28:"DATA",30:"STRING",31:"INTEGER",32:"BOOLEAN",35:"ID",36:"EQUALS",37:"PARTIAL_NAME",39:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[26,2],[26,1],[29,1],[29,1],[29,1],[29,1],[29,1],[27,1],[33,2],[33,1],[34,3],[34,3],[34,3],[34,3],[34,3],[25,1],[21,1],[38,3],[38,1]],performAction:function(e,t,i,n,s,r,o){var a=r.length-1;switch(s){case 1:return r[a-1];case 2:this.$=new n.ProgramNode([],r[a]);break;case 3:this.$=new n.ProgramNode(r[a-2],r[a]);break;case 4:this.$=new n.ProgramNode(r[a-1],[]);break;case 5:this.$=new n.ProgramNode(r[a]);break;case 6:this.$=new n.ProgramNode([],[]);break;case 7:this.$=new n.ProgramNode([]);break;case 8:this.$=[r[a]];break;case 9:r[a-1].push(r[a]),this.$=r[a-1];break;case 10:this.$=new n.BlockNode(r[a-2],r[a-1].inverse,r[a-1],r[a]);break;case 11:this.$=new n.BlockNode(r[a-2],r[a-1],r[a-1].inverse,r[a]);break;case 12:this.$=r[a];break;case 13:this.$=r[a];break;case 14:this.$=new n.ContentNode(r[a]);break;case 15:this.$=new n.CommentNode(r[a]);break;case 16:this.$=new n.MustacheNode(r[a-1][0],r[a-1][1]);break;case 17:this.$=new n.MustacheNode(r[a-1][0],r[a-1][1]);break;case 18:this.$=r[a-1];break;case 19:this.$=new n.MustacheNode(r[a-1][0],r[a-1][1]);break;case 20:this.$=new n.MustacheNode(r[a-1][0],r[a-1][1],!0);break;case 21:this.$=new n.PartialNode(r[a-1]);break;case 22:this.$=new n.PartialNode(r[a-2],r[a-1]);break;case 23:break;case 24:this.$=[[r[a-2]].concat(r[a-1]),r[a]];break;case 25:this.$=[[r[a-1]].concat(r[a]),null];break;case 26:this.$=[[r[a-1]],r[a]];break;case 27:this.$=[[r[a]],null];break;case 28:this.$=[[new n.DataNode(r[a])],null];break;case 29:r[a-1].push(r[a]),this.$=r[a-1];break;case 30:this.$=[r[a]];break;case 31:this.$=r[a];break;case 32:this.$=new n.StringNode(r[a]);break;case 33:this.$=new n.IntegerNode(r[a]);break;case 34:this.$=new n.BooleanNode(r[a]);break;case 35:this.$=new n.DataNode(r[a]);break;case 36:this.$=new n.HashNode(r[a]);break;case 37:r[a-1].push(r[a]),this.$=r[a-1];break;case 38:this.$=[r[a]];break;case 39:this.$=[r[a-2],r[a]];break;case 40:this.$=[r[a-2],new n.StringNode(r[a])];break;case 41:this.$=[r[a-2],new n.IntegerNode(r[a])];break;case 42:this.$=[r[a-2],new n.BooleanNode(r[a])];break;case 43:this.$=[r[a-2],new n.DataNode(r[a])];break;case 44:this.$=new n.PartialNameNode(r[a]);break;case 45:this.$=new n.IdNode(r[a]);break;case 46:r[a-2].push(r[a]),this.$=r[a-2];break;case 47:this.$=[r[a]]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],24:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],24:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],24:[1,16]},{17:23,18:[1,22],21:24,28:[1,25],35:[1,27],38:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],24:[2,8]},{4:28,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],24:[1,16]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],24:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],24:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],24:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],24:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],24:[2,15]},{17:30,21:24,28:[1,25],35:[1,27],38:26},{17:31,21:24,28:[1,25],35:[1,27],38:26},{17:32,21:24,28:[1,25],35:[1,27],38:26},{25:33,37:[1,34]},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],24:[1,16]},{17:23,21:24,28:[1,25],35:[1,27],38:26},{5:[2,4],7:35,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],24:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],24:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],24:[2,23]},{18:[1,36]},{18:[2,27],21:41,26:37,27:38,28:[1,45],29:39,30:[1,42],31:[1,43],32:[1,44],33:40,34:46,35:[1,47],38:26},{18:[2,28]},{18:[2,45],28:[2,45],30:[2,45],31:[2,45],32:[2,45],35:[2,45],39:[1,48]},{18:[2,47],28:[2,47],30:[2,47],31:[2,47],32:[2,47],35:[2,47],39:[2,47]},{10:49,20:[1,50]},{10:51,20:[1,50]},{18:[1,52]},{18:[1,53]},{18:[1,54]},{18:[1,55],21:56,35:[1,27],38:26},{18:[2,44],35:[2,44]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],24:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],24:[2,17]},{18:[2,25],21:41,27:57,28:[1,45],29:58,30:[1,42],31:[1,43],32:[1,44],33:40,34:46,35:[1,47],38:26},{18:[2,26]},{18:[2,30],28:[2,30],30:[2,30],31:[2,30],32:[2,30],35:[2,30]},{18:[2,36],34:59,35:[1,60]},{18:[2,31],28:[2,31],30:[2,31],31:[2,31],32:[2,31],35:[2,31]},{18:[2,32],28:[2,32],30:[2,32],31:[2,32],32:[2,32],35:[2,32]},{18:[2,33],28:[2,33],30:[2,33],31:[2,33],32:[2,33],35:[2,33]},{18:[2,34],28:[2,34],30:[2,34],31:[2,34],32:[2,34],35:[2,34]},{18:[2,35],28:[2,35],30:[2,35],31:[2,35],32:[2,35],35:[2,35]},{18:[2,38],35:[2,38]},{18:[2,47],28:[2,47],30:[2,47],31:[2,47],32:[2,47],35:[2,47],36:[1,61],39:[2,47]},{35:[1,62]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],24:[2,10]},{21:63,35:[1,27],38:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],24:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],24:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],24:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],24:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],24:[2,21]},{18:[1,64]},{18:[2,24]},{18:[2,29],28:[2,29],30:[2,29],31:[2,29],32:[2,29],35:[2,29]},{18:[2,37],35:[2,37]},{36:[1,61]},{21:65,28:[1,69],30:[1,66],31:[1,67],32:[1,68],35:[1,27],38:26},{18:[2,46],28:[2,46],30:[2,46],31:[2,46],32:[2,46],35:[2,46],39:[2,46]},{18:[1,70]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],24:[2,22]},{18:[2,39],35:[2,39]},{18:[2,40],35:[2,40]},{18:[2,41],35:[2,41]},{18:[2,42],35:[2,42]},{18:[2,43],35:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],24:[2,18]}],defaultActions:{17:[2,1],25:[2,28],38:[2,26],57:[2,24]},parseError:function(e,t){throw new Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],s=[null],r=[],o=this.table,a="",l=0,c=0,u=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var h=this.lexer.yylloc;r.push(h);var d=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,g,m,v,y,_,b,w,C={};;){if(g=n[n.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===p||"undefined"==typeof p)&&(p=t()),m=o[g]&&o[g][p]),"undefined"==typeof m||!m.length||!m[0]){var x="";if(!u){w=[];for(y in o[g])this.terminals_[y]&&y>2&&w.push("'"+this.terminals_[y]+"'");x=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:h,expected:w})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+p);switch(m[0]){case 1:n.push(p),s.push(this.lexer.yytext),r.push(this.lexer.yylloc),n.push(m[1]),p=null,f?(p=f,f=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,h=this.lexer.yylloc,u>0&&u--);break;case 2:if(_=this.productions_[m[1]][1],C.$=s[s.length-_],C._$={first_line:r[r.length-(_||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(_||1)].first_column,last_column:r[r.length-1].last_column},d&&(C._$.range=[r[r.length-(_||1)].range[0],r[r.length-1].range[1]]),v=this.performAction.call(C,a,c,l,this.yy,m[1],s,r),"undefined"!=typeof v)return v;_&&(n=n.slice(0,-1*_*2),s=s.slice(0,-1*_),r=r.slice(0,-1*_)),n.push(this.productions_[m[1]][0]),s.push(C.$),r.push(C._$),b=o[n[n.length-2]][n[n.length-1]],n.push(b);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var s=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[s[0],s[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,n,s;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length&&(i=this._input.match(this.rules[r[o]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=o,this.options.flex));o++);return t?(s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,r[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,n){switch(i){case 0:if("\\"!==t.yytext.slice(-1)&&this.begin("mu"),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1),this.begin("emu")),t.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1)),14;case 3:return t.yytext=t.yytext.substr(0,t.yyleng-4),this.popState(),15;case 4:return this.begin("par"),24;case 5:return 16;case 6:return 20;case 7:return 19;case 8:return 19;case 9:return 23;case 10:return 23;case 11:this.popState(),this.begin("com");break;case 12:return t.yytext=t.yytext.substr(3,t.yyleng-5),this.popState(),15;case 13:return 22;case 14:return 36;case 15:return 35;case 16:return 35;case 17:return 39;case 18:break;case 19:return this.popState(),18;case 20:return this.popState(),18;case 21:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),30;case 22:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\'/g,"'"),30;case 23:return t.yytext=t.yytext.substr(1),28;case 24:return 32;case 25:return 32;case 26:return 31;case 27:return 35;case 28:return t.yytext=t.yytext.substr(1,t.yyleng-2),35;case 29:return"INVALID";case 30:break;case 31:return this.popState(),37;case 32:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[} ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@[a-zA-Z]+)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[a-zA-Z0-9_$-]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:\s+)/,/^(?:[a-zA-Z0-9_$-/]+)/,/^(?:$)/],
e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},par:{rules:[30,31],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}();e.Parser=t,e.parse=function(t){return t.constructor===e.AST.ProgramNode?t:(e.Parser.yy=e.AST,e.Parser.parse(t))},function(){e.AST={},e.AST.ProgramNode=function(t,i){this.type="program",this.statements=t,i&&(this.inverse=new e.AST.ProgramNode(i))},e.AST.MustacheNode=function(e,t,i){this.type="mustache",this.escaped=!i,this.hash=t;var n=this.id=e[0],s=this.params=e.slice(1),r=this.eligibleHelper=n.isSimple;this.isHelper=r&&(s.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.partialName=e,this.context=t},e.AST.BlockNode=function(t,i,n,s){var r=function(t,i){if(t.original!==i.original)throw new e.Exception(t.original+" doesn't match "+i.original)};r(t.id,s),this.type="block",this.mustache=t,this.program=i,this.inverse=n,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(t){this.type="ID",this.original=t.join(".");for(var i=[],n=0,s=0,r=t.length;r>s;s++){var o=t[s];if(".."===o||"."===o||"this"===o){if(i.length>0)throw new e.Exception("Invalid path: "+this.original);".."===o?n++:this.isScoped=!0}else i.push(o)}this.parts=i,this.string=i.join("."),this.depth=n,this.isSimple=1===t.length&&!this.isScoped&&0===n,this.stringModeValue=this.string},e.AST.PartialNameNode=function(e){this.type="PARTIAL_NAME",this.name=e},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.string=e,this.stringModeValue=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.integer=e,this.stringModeValue=Number(e)},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},e.AST.CommentNode=function(e){this.type="comment",this.comment=e}}();var i=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(e){for(var t=Error.prototype.constructor.apply(this,arguments),n=0;n<i.length;n++)this[i[n]]=t[i[n]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()},function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,n=/[&<>"'`]/,s=function(e){return t[e]||"&amp;"};e.Utils={escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":n.test(t)?t.replace(i,s):t},isEmpty:function(e){return e||0===e?"[object Array]"===Object.prototype.toString.call(e)&&0===e.length?!0:!1:!0}}}(),e.Compiler=function(){},e.JavaScriptCompiler=function(){},function(t,i){t.prototype={compiler:t,disassemble:function(){for(var e,t,i,n=this.opcodes,s=[],r=0,o=n.length;o>r;r++)if(e=n[r],"DECLARE"===e.opcode)s.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var a=0;a<e.args.length;a++)i=e.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);s.push(e.opcode+" "+t.join(" "))}return s.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var n=this.opcodes[i],s=e.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length)return!1;for(var r=0;r<n.args.length;r++)if(n.args[r]!==s.args[r])return!1}if(t=this.children.length,e.children.length!==t)return!1;for(i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t,i=e.statements;this.opcodes=[];for(var n=0,s=i.length;s>n;n++)t=i[n],this[t.type](t);return this.isSimple=1===s,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var s=0,r=i.depths.list.length;r>s;s++)t=i.depths.list[s],2>t||this.addDepth(t-1);return n},block:function(e){var t=e.mustache,i=e.program,n=e.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var s=this.classifyMustache(t);"helper"===s?this.helperMustache(t,i,n):"simple"===s?(this.simpleMustache(t),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,i,n=e.pairs;this.opcode("pushHash");for(var s=0,r=n.length;r>s;s++)t=n[s],i=t[1],this.options.stringParams?this.opcode("pushStringParam",i.stringModeValue,i.type):this.accept(i),this.opcode("assignToHash",t[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,i=this.classifyMustache(e);"simple"===i?this.simpleMustache(e):"helper"===i?this.helperMustache(e):this.ambiguousMustache(e),e.escaped&&!t.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(e,t,i){var n=e.id,s=n.parts[0],r=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",s,r)},simpleMustache:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",n.length,s);else{if(this.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s);this.opcode("invokeHelper",n.length,s)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,n=e.parts.length;n>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(e){this.options.data=!0,this.opcode("lookupData",e.id)},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,i=e.eligibleHelper,n=this.options;if(i&&!t){var s=e.id.parts[0];n.knownHelpers[s]?t=!0:n.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,i){var n=e.params;return this.pushParams(n),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("emptyHash"),n}};var n=function(e){this.value=e};i.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":i.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,i,n,s){this.environment=t,this.options=i||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,i);var r,o=t.opcodes;for(this.i=0,a=o.length;this.i<a;this.i++)r=o[this.i],"DECLARE"===r.opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args);return this.createFunctionContext(s)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = helpers || "+t+".helpers;";this.environment.usePartial&&(i=i+" partials = partials || "+t+".partials;"),this.options.data&&(i+=" data = data || {};"),e.push(i)}this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var i=this.stackVars.concat(this.registers.list);if(i.length>0&&(this.source[1]=this.source[1]+", "+i.join(", ")),!this.isChild)for(var n in this.context.aliases)this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n];this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var s=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],r=0,o=this.environment.depths.list.length;o>r;r++)s.push("depth"+this.environment.depths.list[r]);var a=this.mergeSource();if(!this.isChild){var l=e.COMPILER_REVISION,c=e.REVISION_CHANGES[l];a="this.compilerInfo = ["+l+",'"+c+"'];\n"+a}if(t)return s.push(a),Function.apply(this,s);var u="function "+(this.name||"")+"("+s.join(",")+") {\n  "+a+"}";return e.log(e.logger.DEBUG,u+"\n\n"),u},mergeSource:function(){for(var e,t="",i=0,n=this.source.length;n>i;i++){var s=this.source[i];s.appendToBuffer?e=e?e+"\n    + "+s.content:s.content:(e&&(t+="buffer += "+e+";\n  ",e=void 0),t+=s+"\n  ")}return t},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){this.flushInline();var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(e){this.push(this.nameLookup("data",e,"data"))},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),"string"==typeof e?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&this.register("hashTypes","{}")},pushHash:function(){this.hash={values:[],types:[]}},popHash:function(){var e=this.hash;this.hash=void 0,this.options.stringParams&&this.register("hashTypes","{"+e.types.join(",")+"}"),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){null!=e?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(e,t,!0);this.push(i.name),this.replaceStack(function(e){return e+" ? "+e+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var i=this.setupHelper(0,e,t),n=this.lastHelper=this.nameLookup("helpers",e,"helper"),s=this.nameLookup("depth"+this.lastContext,e,"context"),r=this.nextStack();this.source.push("if ("+r+" = "+n+") { "+r+" = "+r+".call("+i.callParams+"); }"),this.source.push("else { "+r+" = "+s+"; "+r+" = typeof "+r+" === functionType ? "+r+".apply(depth0) : "+r+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t,i=this.popStack();this.options.stringParams&&(t=this.popStack(),this.popStack());var n=this.hash;t&&n.types.push("'"+e+"': "+t),n.values.push("'"+e+"': ("+i+")")},compiler:i,compileChildren:function(e,t){for(var i,n,s=e.children,r=0,o=s.length;o>r;r++){i=s[r],n=new this.compiler;var a=this.matchExistingProgram(i);null==a?(this.context.programs.push(""),a=this.context.programs.length,i.index=a,i.name="program"+a,this.context.programs[a]=n.compile(i,t,this.context),this.context.environments[a]=i):(i.index=a,i.name="program"+a)}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],n=i.depths.list,s=[i.index,i.name,"data"],r=0,o=n.length;o>r;r++)t=n[r],1===t?s.push("depth0"):s.push("depth"+(t-1));return 0===n.length?"self.program("+s.join(", ")+")":(s.shift(),"self.programWithDepth("+s.join(", ")+")")},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new n(e))},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.source.push(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t,i="",s=this.isInline();if(s){var r=this.popStack(!0);if(r instanceof n)t=r.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();i="("+this.push(o)+" = "+r+"),",t=this.topStack()}}else t=this.topStack();var a=e.call(this,t);return s?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+i+a+")")):(/^stack/.test(t)||(t=this.nextStack()),this.source.push(t+" = ("+i+a+");")),t},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,i=e.length;i>t;t++){var s=e[t];s instanceof n?this.compileStack.push(s):this.pushStack(s)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();return!e&&i instanceof n?i.value:(t||this.stackSlot--,i)},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,i=t[t.length-1];return!e&&i instanceof n?i.value:i},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(e,t,i){var n=[];this.setupParams(e,n,i);var s=this.nameLookup("helpers",t,"helper");return{params:n,name:s,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(t)].concat(n).join(", ")}},setupParams:function(e,t,i){var n,s,r,o=[],a=[],l=[];o.push("hash:"+this.popStack()),s=this.popStack(),r=this.popStack(),(r||s)&&(r||(this.context.aliases.self="this",r="self.noop"),s||(this.context.aliases.self="this",s="self.noop"),o.push("inverse:"+s),o.push("fn:"+r));for(var c=0;e>c;c++)n=this.popStack(),t.push(n),this.options.stringParams&&(l.push(this.popStack()),a.push(this.popStack()));return this.options.stringParams&&(o.push("contexts:["+a.join(",")+"]"),o.push("types:["+l.join(",")+"]"),o.push("hashTypes:hashTypes")),this.options.data&&o.push("data:data"),o="{"+o.join(",")+"}",i?(this.register("options",o),t.push("options")):t.push(o),t.join(", ")}};for(var s="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),r=i.RESERVED_WORDS={},o=0,a=s.length;a>o;o++)r[s[o]]=!0;i.isValidJavaScriptVariableName=function(e){return!i.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},e.precompile=function(n,s){if(!n||"string"!=typeof n&&n.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+n);s=s||{},"data"in s||(s.data=!0);var r=e.parse(n),o=(new t).compile(r,s);return(new i).compile(o,s)},e.compile=function(n,s){function r(){var r=e.parse(n),o=(new t).compile(r,s),a=(new i).compile(o,s,void 0,!0);return e.template(a)}if(!n||"string"!=typeof n&&n.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+n);s=s||{},"data"in s||(s.data=!0);var o;return function(e,t){return o||(o=r()),o.call(this,e,t)}},e.VM={template:function(t){var i={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,i,n){var s=this.programs[t];return n?e.VM.program(i,n):s?s:s=this.programs[t]=e.VM.program(i)},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(n,s){s=s||{};var r=t.call(i,e,n,s.helpers,s.partials,s.data),o=i.compilerInfo||[],a=o[0]||1,l=e.COMPILER_REVISION;if(a!==l){if(l>a){var c=e.REVISION_CHANGES[l],u=e.REVISION_CHANGES[a];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+c+") or downgrade your runtime to an older version ("+u+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+o[1]+")."}return r}},programWithDepth:function(e,t,i){var n=Array.prototype.slice.call(arguments,2);return function(i,s){return s=s||{},e.apply(this,[i,s.data||t].concat(n))}},program:function(e,t){return function(i,n){return n=n||{},e(i,n.data||t)}},noop:function(){return""},invokePartial:function(t,i,n,s,r,o){var a={helpers:s,partials:r,data:o};if(void 0===t)throw new e.Exception("The partial "+i+" could not be found");if(t instanceof Function)return t(n,a);if(e.compile)return r[i]=e.compile(t,{data:void 0!==o}),r[i](n,a);throw new e.Exception("The partial "+i+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(e.Compiler,e.JavaScriptCompiler),define("Handlebars",[],function(){return e})}(),define("hbs/underscore",[],function(){function e(t,i,n){if(t===i)return 0!==t||1/t==1/i;if(null==t||null==i)return t===i;if(t._chain&&(t=t._wrapped),i._chain&&(i=i._wrapped),t.isEqual&&w.isFunction(t.isEqual))return t.isEqual(i);if(i.isEqual&&w.isFunction(i.isEqual))return i.isEqual(t);var s=a.call(t);if(s!=a.call(i))return!1;switch(s){case"[object String]":return t==String(i);case"[object Number]":return t!=+t?i!=+i:0==t?1/t==1/i:t==+i;case"[object Date]":case"[object Boolean]":return+t==+i;case"[object RegExp]":return t.source==i.source&&t.global==i.global&&t.multiline==i.multiline&&t.ignoreCase==i.ignoreCase}if("object"!=typeof t||"object"!=typeof i)return!1;for(var r=n.length;r--;)if(n[r]==t)return!0;n.push(t);var o=0,l=!0;if("[object Array]"==s){if(o=t.length,l=o==i.length)for(;o--&&(l=o in t==o in i&&e(t[o],i[o],n)););}else{if("constructor"in t!="constructor"in i||t.constructor!=i.constructor)return!1;for(var c in t)if(w.has(t,c)&&(o++,!(l=w.has(i,c)&&e(t[c],i[c],n))))break;if(l){for(c in i)if(w.has(i,c)&&!o--)break;l=!o}}return n.pop(),l}var t={},i=Array.prototype,n=Object.prototype,s=Function.prototype,r=i.slice,o=i.unshift,a=n.toString,l=n.hasOwnProperty,c=i.forEach,u=i.map,h=i.reduce,d=i.reduceRight,p=i.filter,f=i.every,g=i.some,m=i.indexOf,v=i.lastIndexOf,y=Array.isArray,_=Object.keys,b=s.bind,w=function(e){return new B(e)};w.VERSION="1.3.3";var C=w.each=w.forEach=function(e,i,n){if(null!=e)if(c&&e.forEach===c)e.forEach(i,n);else if(e.length===+e.length){for(var s=0,r=e.length;r>s;s++)if(s in e&&i.call(n,e[s],s,e)===t)return}else for(var o in e)if(w.has(e,o)&&i.call(n,e[o],o,e)===t)return};w.map=w.collect=function(e,t,i){var n=[];return null==e?n:u&&e.map===u?e.map(t,i):(C(e,function(e,s,r){n[n.length]=t.call(i,e,s,r)}),e.length===+e.length&&(n.length=e.length),n)},w.reduce=w.foldl=w.inject=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),h&&e.reduce===h)return n&&(t=w.bind(t,n)),s?e.reduce(t,i):e.reduce(t);if(C(e,function(e,r,o){s?i=t.call(n,i,e,r,o):(i=e,s=!0)}),!s)throw new TypeError("Reduce of empty array with no initial value");return i},w.reduceRight=w.foldr=function(e,t,i,n){var s=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return n&&(t=w.bind(t,n)),s?e.reduceRight(t,i):e.reduceRight(t);var r=w.toArray(e).reverse();return n&&!s&&(t=w.bind(t,n)),s?w.reduce(r,t,i,n):w.reduce(r,t)},w.find=w.detect=function(e,t,i){var n;return x(e,function(e,s,r){return t.call(i,e,s,r)?(n=e,!0):void 0}),n},w.filter=w.select=function(e,t,i){var n=[];return null==e?n:p&&e.filter===p?e.filter(t,i):(C(e,function(e,s,r){t.call(i,e,s,r)&&(n[n.length]=e)}),n)},w.reject=function(e,t,i){var n=[];return null==e?n:(C(e,function(e,s,r){t.call(i,e,s,r)||(n[n.length]=e)}),n)},w.every=w.all=function(e,i,n){var s=!0;return null==e?s:f&&e.every===f?e.every(i,n):(C(e,function(e,r,o){return(s=s&&i.call(n,e,r,o))?void 0:t}),!!s)};var x=w.some=w.any=function(e,i,n){i||(i=w.identity);var s=!1;return null==e?s:g&&e.some===g?e.some(i,n):(C(e,function(e,r,o){return s||(s=i.call(n,e,r,o))?t:void 0}),!!s)};w.include=w.contains=function(e,t){var i=!1;return null==e?i:m&&e.indexOf===m?-1!=e.indexOf(t):i=x(e,function(e){return e===t})},w.invoke=function(e,t){var i=r.call(arguments,2);return w.map(e,function(e){return(w.isFunction(t)?t||e:e[t]).apply(e,i)})},w.pluck=function(e,t){return w.map(e,function(e){return e[t]})},w.max=function(e,t,i){if(!t&&w.isArray(e)&&e[0]===+e[0])return Math.max.apply(Math,e);if(!t&&w.isEmpty(e))return-(1/0);var n={computed:-(1/0)};return C(e,function(e,s,r){var o=t?t.call(i,e,s,r):e;o>=n.computed&&(n={value:e,computed:o})}),n.value},w.min=function(e,t,i){if(!t&&w.isArray(e)&&e[0]===+e[0])return Math.min.apply(Math,e);if(!t&&w.isEmpty(e))return 1/0;var n={computed:1/0};return C(e,function(e,s,r){var o=t?t.call(i,e,s,r):e;o<n.computed&&(n={value:e,computed:o})}),n.value},w.shuffle=function(e){var t,i=[];return C(e,function(e,n,s){t=Math.floor(Math.random()*(n+1)),i[n]=i[t],i[t]=e}),i},w.sortBy=function(e,t,i){var n=w.isFunction(t)?t:function(e){return e[t]};return w.pluck(w.map(e,function(e,t,s){return{value:e,criteria:n.call(i,e,t,s)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;return void 0===i?1:void 0===n?-1:n>i?-1:i>n?1:0}),"value")},w.groupBy=function(e,t){var i={},n=w.isFunction(t)?t:function(e){return e[t]};return C(e,function(e,t){var s=n(e,t);(i[s]||(i[s]=[])).push(e)}),i},w.sortedIndex=function(e,t,i){i||(i=w.identity);for(var n=0,s=e.length;s>n;){var r=n+s>>1;i(e[r])<i(t)?n=r+1:s=r}return n},w.toArray=function(e){return e?w.isArray(e)?r.call(e):w.isArguments(e)?r.call(e):e.toArray&&w.isFunction(e.toArray)?e.toArray():w.values(e):[]},w.size=function(e){return w.isArray(e)?e.length:w.keys(e).length},w.first=w.head=w.take=function(e,t,i){return null==t||i?e[0]:r.call(e,0,t)},w.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},w.last=function(e,t,i){return null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},w.rest=w.tail=function(e,t,i){return r.call(e,null==t||i?1:t)},w.compact=function(e){return w.filter(e,function(e){return!!e})},w.flatten=function(e,t){return w.reduce(e,function(e,i){return w.isArray(i)?e.concat(t?i:w.flatten(i)):(e[e.length]=i,e)},[])},w.without=function(e){return w.difference(e,r.call(arguments,1))},w.uniq=w.unique=function(e,t,i){var n=i?w.map(e,i):e,s=[];return e.length<3&&(t=!0),w.reduce(n,function(i,n,r){return(t?w.last(i)===n&&i.length:w.include(i,n))||(i.push(n),s.push(e[r])),i},[]),s},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(e){var t=r.call(arguments,1);return w.filter(w.uniq(e),function(e){return w.every(t,function(t){return w.indexOf(t,e)>=0})})},w.difference=function(e){var t=w.flatten(r.call(arguments,1),!0);return w.filter(e,function(e){return!w.include(t,e)})},w.zip=function(){for(var e=r.call(arguments),t=w.max(w.pluck(e,"length")),i=new Array(t),n=0;t>n;n++)i[n]=w.pluck(e,""+n);return i},w.indexOf=function(e,t,i){if(null==e)return-1;var n,s;if(i)return n=w.sortedIndex(e,t),e[n]===t?n:-1;if(m&&e.indexOf===m)return e.indexOf(t);for(n=0,s=e.length;s>n;n++)if(n in e&&e[n]===t)return n;return-1},w.lastIndexOf=function(e,t){if(null==e)return-1;if(v&&e.lastIndexOf===v)return e.lastIndexOf(t);for(var i=e.length;i--;)if(i in e&&e[i]===t)return i;return-1},w.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),s=0,r=new Array(n);n>s;)r[s++]=e,e+=i;return r};var E=function(){};w.bind=function(e,t){var i,n;if(e.bind===b&&b)return b.apply(e,r.call(arguments,1));if(!w.isFunction(e))throw new TypeError;return n=r.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(r.call(arguments)));E.prototype=e.prototype;var s=new E,o=e.apply(s,n.concat(r.call(arguments)));return Object(o)===o?o:s}},w.bindAll=function(e){var t=r.call(arguments,1);return 0==t.length&&(t=w.functions(e)),C(t,function(t){e[t]=w.bind(e[t],e)}),e},w.memoize=function(e,t){var i={};return t||(t=w.identity),function(){var n=t.apply(this,arguments);return w.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},w.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},w.defer=function(e){return w.delay.apply(w,[e,1].concat(r.call(arguments,1)))},w.throttle=function(e,t){var i,n,s,r,o,a,l=w.debounce(function(){o=r=!1},t);return function(){i=this,n=arguments;var c=function(){s=null,o&&e.apply(i,n),l()};return s||(s=setTimeout(c,t)),r?o=!0:a=e.apply(i,n),l(),r=!0,a}},w.debounce=function(e,t,i){var n;return function(){var s=this,r=arguments,o=function(){n=null,i||e.apply(s,r)};i&&!n&&e.apply(s,r),clearTimeout(n),n=setTimeout(o,t)}},w.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments))}},w.wrap=function(e,t){return function(){var i=[e].concat(r.call(arguments,0));return t.apply(this,i)}},w.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},w.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},w.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)w.has(e,i)&&(t[t.length]=i);return t},w.values=function(e){return w.map(e,w.identity)},w.functions=w.methods=function(e){var t=[];for(var i in e)w.isFunction(e[i])&&t.push(i);return t.sort()},w.extend=function(e){return C(r.call(arguments,1),function(t){for(var i in t)e[i]=t[i]}),e},w.pick=function(e){var t={};return C(w.flatten(r.call(arguments,1)),function(i){i in e&&(t[i]=e[i])}),t},w.defaults=function(e){return C(r.call(arguments,1),function(t){for(var i in t)null==e[i]&&(e[i]=t[i])}),e},w.clone=function(e){return w.isObject(e)?w.isArray(e)?e.slice():w.extend({},e):e},w.tap=function(e,t){return t(e),e},w.isEqual=function(t,i){return e(t,i,[])},w.isEmpty=function(e){if(null==e)return!0;if(w.isArray(e)||w.isString(e))return 0===e.length;for(var t in e)if(w.has(e,t))return!1;return!0},w.isElement=function(e){return!(!e||1!=e.nodeType)},w.isArray=y||function(e){return"[object Array]"==a.call(e)},w.isObject=function(e){return e===Object(e)},w.isArguments=function(e){return"[object Arguments]"==a.call(e)},w.isArguments(arguments)||(w.isArguments=function(e){return!(!e||!w.has(e,"callee"))}),w.isFunction=function(e){return"[object Function]"==a.call(e)},w.isString=function(e){return"[object String]"==a.call(e)},w.isNumber=function(e){return"[object Number]"==a.call(e)},w.isFinite=function(e){return w.isNumber(e)&&isFinite(e)},w.isNaN=function(e){return e!==e},w.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==a.call(e)},w.isDate=function(e){return"[object Date]"==a.call(e)},w.isRegExp=function(e){return"[object RegExp]"==a.call(e)},w.isNull=function(e){return null===e},w.isUndefined=function(e){return void 0===e},w.has=function(e,t){return l.call(e,t)},w.noConflict=function(){return root._=previousUnderscore,this},w.identity=function(e){return e},w.times=function(e,t,i){for(var n=0;e>n;n++)t.call(i,n)},w.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(e,t){if(null==e)return null;var i=e[t];return w.isFunction(i)?i.call(e):i},w.mixin=function(e){C(w.functions(e),function(t){M(t,w[t]=e[t])})};var S=0;w.uniqueId=function(e){var t=S++;return e?e+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/.^/,k={"\\":"\\","'":"'",r:"\r",n:"\n",t:"	",u2028:"\u2028",u2029:"\u2029"};for(var F in k)k[k[F]]=F;var D=/\\|'|\r|\n|\t|\u2028|\u2029/g,T=/\\(\\|'|r|n|t|u2028|u2029)/g,$=function(e){return e.replace(T,function(e,t){return k[t]})};w.template=function(e,t,i){i=w.defaults(i||{},w.templateSettings);var n="__p+='"+e.replace(D,function(e){return"\\"+k[e]}).replace(i.escape||A,function(e,t){return"'+\n_.escape("+$(t)+")+\n'"}).replace(i.interpolate||A,function(e,t){return"'+\n("+$(t)+")+\n'"}).replace(i.evaluate||A,function(e,t){return"';\n"+$(t)+"\n;__p+='"})+"';\n";i.variable||(n="with(obj||{}){\n"+n+"}\n"),n="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+n+"return __p;\n";var s=new Function(i.variable||"obj","_",n);if(t)return s(t,w);var r=function(e){return s.call(this,e,w);
};return r.source="function("+(i.variable||"obj")+"){\n"+n+"}",r},w.chain=function(e){return w(e).chain()};var B=function(e){this._wrapped=e};w.prototype=B.prototype;var j=function(e,t){return t?w(e).chain():e},M=function(e,t){B.prototype[e]=function(){var e=r.call(arguments);return o.call(e,this._wrapped),j(t.apply(w,e),this._chain)}};return w.mixin(w),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];B.prototype[e]=function(){var i=this._wrapped;t.apply(i,arguments);var n=i.length;return"shift"!=e&&"splice"!=e||0!==n||delete i[0],j(i,this._chain)}}),C(["concat","join","slice"],function(e){var t=i[e];B.prototype[e]=function(){return j(t.apply(this._wrapped,arguments),this._chain)}}),B.prototype.chain=function(){return this._chain=!0,this},B.prototype.value=function(){return this._wrapped},w}),define("hbs/i18nprecompile",["../Handlebars","./underscore"],function(e,t){function i(n,s,r){return r=r||{},s=s||{},n&&"program"===n.type&&n.statements&&(t(n.statements).forEach(function(t,o){var a="<!-- i18n error -->";if("mustache"===t.type&&t.id&&"$"===t.id.original){if(t.params.length&&t.params[0].string){var l=t.params[0].string;a=s[l]||(r.originalKeyFallback?l:a)}n.statements[o]=new e.AST.ContentNode(a)}else t.program&&(t.program=i(t.program,s,r))}),n.inverse&&i(n.inverse,s,r)),n}return function(t,n,s){s=s||{};var r,o;return r=e.parse(t),n!==!1&&(r=i(r,n,s)),o=(new e.Compiler).compile(r,s),(new e.JavaScriptCompiler).compile(o,s)}}),function(window){var JSON=window.JSON||{};!function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,n,s,r,o,a=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,i=0;r>i;i+=1)o[i]=str(i,l)||"null";return s=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+a+"]":"["+o.join(",")+"]",gap=a,s}if(rep&&"object"==typeof rep)for(r=rep.length,i=0;r>i;i+=1)"string"==typeof rep[i]&&(n=rep[i],s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(s=str(n,l),s&&o.push(quote(n)+(gap?": ":":")+s));return s=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+a+"}":"{"+o.join(",")+"}",gap=a,s}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,i){var n;if(gap="",indent="","number"==typeof i)for(n=0;i>n;n+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var i,n,s=e[t];if(s&&"object"==typeof s)for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n=walk(s,i),void 0!==n?s[i]=n:delete s[i]);return reviver.call(e,t,s)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",["./Handlebars","./hbs/underscore","./hbs/i18nprecompile","./hbs/json2"],function(e,t,i,n){var s,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=function(){throw new Error("Environment unsupported.")},l=[],c="w+",u="hbs",h="@hbs",d="/styles/",p="/demo-build/styles/",f="template/helpers/",g="template/i18n/",m="screen.build.css";e.registerHelper("$",function(){}),"undefined"!=typeof window&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(r=function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(t=0;3>t;t++){i=o[t];try{e=new ActiveXObject(i)}catch(n){}if(e){o=[i];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},a=function(e,t){var i=r();i.open("GET",e,!0),i.onreadystatechange=function(e){4===i.readyState&&t(i.responseText)},i.send(null)}):"undefined"!=typeof process&&process.versions&&process.versions.node?(s=require.nodeRequire("fs"),a=function(e,t){var i=s.readFileSync(e,"utf8")||"";i=i.replace(/^\uFEFF/,""),t(i)}):"undefined"!=typeof java&&"undefined"!=typeof java.io&&(a=function(e,t){for(var i,n=new java.io.File(e),s=new java.io.FileReader(n),r=new java.io.BufferedReader(s),o="";null!==(i=r.readLine());)o+=new String(i)+"\n";r.close(),t(o)});var v={},y=function(e,t){v[e]?t(v[e]):a(e,function(i){v[e]=i,t.call(this,i)})},_=[],b={};return{get:function(){return e},write:function(e,t,i){if(t+h in l){var n=l[t+h];i.asModule(e+"!"+t,n)}},version:"0.4.0",load:function(r,o,v,w){function C(e,i){return t(e).forEach(function(e){e&&e.type&&"partial"===e.type&&i.push(e.partialName.name),e&&e.program&&e.program.statements&&C(e.program.statements,i),e&&e.program&&e.program.inverse&&e.program.inverse.statements&&C(e.program.inverse.statements,i)}),i}function x(e){var i=[];return e&&e.statements&&(i=C(e.statements,[])),t(i).unique()}function E(e){var t,i,s;if(e&&e.statements&&(t=e.statements[0],t&&"comment"===t.type))try{return i=t.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),s=n.parse(i),i}catch(r){return"{}"}return"{}"}function S(e){if(!e)return[];var t,i=[e[0]],n=e[0];for(t=1;t<e.length;++t)e.hasOwnProperty(t)&&(n+="."+e[t],i.push(n));return i}function A(i,n,s,r){s=s?s+".":"";var o="";return t(i).forEach(function(i){var a,l,c;if(i&&i.type&&"mustache"===i.type){if(!i.params||!i.params.length){a=S(i.id.parts);for(l in a)a[l]&&(o=a[l]||o,n.push(s+a[l]));n.push(s+i.id.string)}var u=["this",".","..","./..","../..","../../.."];i.params&&"undefined"==typeof e.helpers[i.id.string]&&t(i.params).forEach(function(l){(t(u).contains(l.original)||l instanceof e.AST.StringNode||l instanceof e.AST.IntegerNode||l instanceof e.AST.BooleanNode)&&r.push(i.id.string),a=S(l.parts);for(var c in a)a[c]&&(o=a[c]||o,r.push(i.id.string),n.push(s+a[c]))})}i&&i.mustache&&A([i.mustache],n,s+o,r),i&&i.program&&i.program.statements&&(c=A([i.mustache],[],"",r)[0]||"",i.program.inverse&&i.program.inverse.statements&&A(i.program.inverse.statements,n,s+o+(c?s+o?"."+c:c:""),r),A(i.program.statements,n,s+o+(c?s+o?"."+c:c:""),r))}),n}function k(e){var i=[],n=[];e&&e.statements&&(i=A(e.statements,[],void 0,n));var s=["helperMissing","blockHelperMissing","each","if","unless","with"];return{vars:t(i).chain().unique().map(function(e){return""===e?".":e.length&&"."===e[e.length-1]?e.substr(0,e.length-1)+"[]":e}).value(),helpers:t(n).chain().unique().map(function(e){return t(s).contains(e)?void 0:e}).compact().value()}}function F(u){a(D,function(a){var h,g,y,C=e.parse(a),S=x(C),A=E(C),F=k(C),B=F.vars,j=F.helpers||[],M=S.join("', 'hbs!").replace(/_/g,"/"),L=w.hbs&&w.hbs.disableHelpers?"":function(){var e,t=[],i=w.hbs&&w.hbs.helperPathCallback?w.hbs.helperPathCallback:function(e){return(w.hbs&&w.hbs.helperDirectory?w.hbs.helperDirectory:f)+e};for(e=0;e<j.length;e++)t[e]="'"+i(j[e],D)+"'";return t}().join(","),I="",P="",R="";if(M&&(M=",'hbs!"+M+"'"),L&&(L=","+L),"{}"!==A)try{h=n.parse(A),h&&h.styles&&(_=t.union(_,h.styles),require.isBrowser&&!w.isBuild?(g=document.head||document.getElementsByTagName("head")[0],t(h.styles).forEach(function(e){b[e]||(y=document.createElement("link"),y.href=w.baseUrl+d+e+".css",y.media="all",y.rel="stylesheet",y.type="text/css",g.appendChild(y),b[e]=y)})):w.isBuild&&!function(){var e=require.nodeRequire("fs"),i=t(h.styles).map(function(e){return b[e]?"":(b[e]=!0,"@import url("+e+".css);\n")}).join("\n");e.open(__dirname+p+m,c,"0666",function(t,n){e.writeSync(n,i,null,encoding="utf8"),e.close(n)}),c="a"}())}catch(O){console.log("error injecting styles")}w.isBuild||w.serverRender||(I="<!-- START - "+r+" -->",P="<!-- END - "+r+" -->",R="t.meta = "+A+";\nt.helpers = "+n.stringify(j)+";\nt.deps = "+n.stringify(S)+";\nt.vars = "+n.stringify(B)+";\n");var N=$?!1:t.extend(u,w.localeMapping),q=w.hbs||{},z=t.extend(q.compileOptions||{},{originalKeyFallback:q.originalKeyFallback}),H=i(a,N,z);a="/* START_TEMPLATE */\ndefine(['hbs','Handlebars'"+M+L+"], function( hbs, Handlebars ){ \nvar t = Handlebars.template("+H+");\nHandlebars.registerPartial('"+r.replace(/\//g,"_")+"', t);\n"+R+"return t;\n});\n/* END_TEMPLATE */\n",w.isBuild&&(l[T]=a),w.isBuild||(a+="\r\n//@ sourceURL="+D);for(var V in S)S.hasOwnProperty(V)&&(S[V]="hbs!"+S[V].replace(/_/g,"/"));w.isBuild?(v.fromText(r,a),o([r],function(e){v(e)})):require(S,function(){v.fromText(a),o([r],function(e){v(e)})}),w.removeCombined&&s.unlinkSync(D)})}var D,T=r+h,$=w.hbs&&w.hbs.disableI18n,B=w.hbs&&w.hbs.templateExtension===!1;if(D=B?o.toUrl(r):o.toUrl(r+"."+(w.hbs&&w.hbs.templateExtension?w.hbs.templateExtension:u)),$)F(!1);else{var j=(w.hbs&&w.hbs.i18nDirectory?w.hbs.i18nDirectory:g)+(w.locale||"en_us")+".json";try{y(o.toUrl(j),function(e){F(n.parse(e))})}catch(M){if(w.hbs)throw M;console.warn("hbs: Error reading "+j+", disabling i18n. Ignore this if you're using jam, otherwise check your i18n configuration.\n"),w.hbs={disableI18n:!0},F(!1)}}}}}),define("hbs!ui/elements/templates/media_query",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="viewport-wrapper">\n    <div class="element-styles" data-id="body" data-media-query-id="',(r=i.id)?r=r.call(t,{hash:{}}):(r=t.id,r=typeof r===a?r.apply(t):r),o+=l(r)+'"></div>\n</div>\n<div class="overflowing-space"></div>\n'});return t.registerPartial("ui_elements_templates_media_query",i),i}),define("ui/elements/index",["jquery","underscore","backbone","core/utils/is","core/utils/when","core/utils/dom","core/utils/cast","hbs!./templates/media_query"],function(e,t,i,n,s,r,o,a){var l=i.UIController.extend({className:"elements",namespace:"ui:elements",media_query_setup_queue:null,aloha_ready:!1,content_event:null,$aloha_jquery:null,aloha_range_object:null,active_media_queries:null,listen_to_data_side_events:!0,data_media_queries_ready:null,data_elements_ready:null,reorder_media_queries_disabled:!1,change_elements_width_disabled:!1,last_active_mq:null,default_media_query:null,listeners:t.extend({},i.UIController.prototype.listeners,{"[remote]data:elements:ready":"onDataElementsReady","[remote]data:styles:new:mediaQuery":"createMediaQuery","[remote]data:styles:updated:mediaQuery":"updateMediaQuery","[remote]data:styles:deleted:mediaQuery":"deleteMediaQuery","[remote]data:styles:changed":"onStylesChanged","[remote]data:elements:updated:element":"updateElement","[remote]data:elements:deleted:element":"deleteElement","[remote]ui:media-queries:resize-start":"mediaQueryResizeStart","[remote]ui:media-queries:resize-left":"mediaQueryResizeLeft","[remote]ui:media-queries:resize-right":"mediaQueryResizeRight","[remote]ui:media-queries:resize-complete":"mediaQueryResizeComplete","[remote]ui:css-editor:dropdown:resized":"cssEditorResized","[remote]ui:css-editor:dropdown:closing":"cssEditorClosing",insertHTML:"insertHTML",selectElementById:"selectElementById",selectMediaQueryById:"selectMediaQueryById",createInlineElement:"createInlineElement",removeInlineElement:"removeInlineElement","select-first-element":"selectFirstElement","sync-with-dom":"_immediatelyUpdateContentEvent"}),events:{"click [data-id='body']":"deselectAllElements"},initialize:function(){var n=this;return this.media_query_setup_queue=[],this.active_media_queries=new i.Collection,this.data_media_queries_ready=e.Deferred(),this.data_elements_ready=e.Deferred(),e.when(this.data_media_queries_ready.promise(),this.data_elements_ready.promise()).then(t.bind(this.onDataMediaQueriesAndElementsReady,this)),this.render(),this.onDOMNodeInserted=t.throttle(this.onDOMNodeInserted,500),t.bindAll(this,"onDOMNodeInserted"),s(function(){return!!window.Aloha&&!!window.Aloha.ContentEvent},function(){n.aloha_ready=!0,n.$aloha_jquery=window.Aloha.jQuery,n.content_event=window.Aloha.ContentEvent.events,n.setupAlohaListeners(),n.setupAllMediaQueriesInQueue(),n.imc.trigger(n.namespace+":ready")}),e(window).resize(t.bind(this.setDefaultMediaQueryPixelWidth,this)),this},setDefaultMediaQueryPixelWidth:function(){var t,i,s;return n(this.default_media_query,"media_query")?(t=e(r.getMediaQuerySelector(this.default_media_query.getMediaQuery().id)),t.length<1?(this.log("error","Default media query is not present in the DOM"),!1):(i=t.parent(),s=this._getMediaQueryWidth(this.default_media_query),n(s,"string")&&s.length>0?i.css("width",s):this._setComputedPixelWidthOnElement(i),!0)):(this.log("error","No default media query"),!1)},onDataMediaQueriesAndElementsReady:function(e,t){return!n(e,"array")||e.length<1?!1:n(t,"element")?(e.forEach(function(e){return n(e,"media_query")?(this.renderMediaQueryWithElements(e,t),void(e.getMediaQuery().is_default&&(this.default_media_query=e))):!1},this),this.setDefaultMediaQueryPixelWidth(),this.announce("loaded"),!0):!1},setupAlohaListeners:function(){return n(this.content_event,"object")&&n(this.content_event.on,"function")?(this.content_event.on("content-event:element-added",this.newElementAdded,this),this.content_event.on("content-event:element-updated",this.elementUpdated,this),this.content_event.on("content-event:element-removed",this.elementRemoved,this),this.content_event.on("content-event:selection",this.selectionOccured,this),this.content_event.on("content-event:changeset-start",this.changesetStart,this),this.content_event.on("content-event:changeset-complete",this.changesetComplete,this),this.content_event.on("content-event:image-selected",this.imageSelected,this),!0):(this.aloha_ready=!1,this.imc.trigger("ui:error-notification:fatal",this.namespace,{code:101,message:"ContentEvent did not load and is not optional."}),!1)},setupAllMediaQueriesInQueue:function(){return n(this.media_query_setup_queue,"array")?this.media_query_setup_queue.length<1?!1:(this.media_query_setup_queue.forEach(function(e){this.setupMediaQueryWithAloha(e)},this),this.media_query_setup_queue=[],!0):!1},render:function(){return this.app_el.appendChild(this.el),this},onDataElementsReady:function(){return this.imc.trigger("data:elements:getElements",function(e,t){return e?(this.log("error","Tried to get elements but could not retrieve them."),this.data_elements_ready.reject("Tried to get elements but could not retrieve them."),!1):n(t,"element")?(this.data_elements_ready.resolve(t),!0):(this.data_elements_ready.reject("Element model is invalid."),!1)},this),!0},renderMediaQueryWithElements:function(e,t){var i,s;return n(e,"media_query")&&n(t,"element")?(s=e.getMediaQuery(),this.$el.append(a(s)),i=r.getDomNodesForElementTree(t.getElement().children),this.$(r.getMediaQuerySelector(s.id)).append(i),this.setupMediaQueryWithAloha(e),this.updateMediaQuery(e),!0):!1},setupMediaQueryWithAloha:function(t){var i;return n(t,"media_query")?this.aloha_ready?(i=r.getMediaQuerySelector(t.getMediaQuery().id),this.$aloha_jquery(i).aloha(),e(i).on("DOMNodeInserted",this.onDOMNodeInserted),this.active_media_queries.add(t),!0):(this.media_query_setup_queue.push(t),!1):!1},cleanupMediaQueryWithAloha:function(t){var i,s,o;return n(t,"media_query")&&this.aloha_ready?(i=t.getMediaQuery().id,s=r.getMediaQuerySelector(i),this.$aloha_jquery(s).mahalo(),e(s).off("DOMNodeInserted",this.onDOMNodeInserted),o=this.active_media_queries.filter(function(e){return e.toJSON().getMediaQuery().id===i}),this.active_media_queries.remove(o),!0):!1},onDOMNodeInserted:function(){return setTimeout(this._immediatelyUpdateContentEvent,0),!0},onChangeActiveStyle:function(){return this._getMediaQueries(),!0},onChangeActiveMediaQuery:function(e,t){return this.last_active_mq=t,!0},onChangeActiveElement:function(e){return this._removeActiveElementType(),n(e,"element")?n(this.active_media_query,"object")?("body"===e.getElement().id?this.deselectAllRanges():this._isElementSelectable(e)&&this.selectElementById(e.getElement().id),this._setActiveElementType(e.getSelector()),!0):(this.imc.trigger("data:state:set","active-element",void 0),!1):(this.deselectAllRanges(),this.imc.trigger("data:state:set","active-media-query",void 0),!1)},destroy:function(){return n(this.content_event,"object")&&n(this.content_event.off,"function")&&this.content_event.off(null,null,this),this.active_media_queries.forEach(function(e){this.cleanupMediaQueryWithAloha(e.toJSON())},this),l.__super__.destroy.apply(this,arguments),!0},changesetStart:function(){return this.listen_to_data_side_events=!1,!0},changesetComplete:function(){return this.listen_to_data_side_events=!0,!0},imageSelected:function(e,t){return!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:(this._selectElementByIdAndMediaQueryId(e,t),!0)},insertHTML:function(t,i,s,r){var o,a,l=this;return!n(t,"string")||t.length<1?!1:!n(s,"string")||s.length<1?!1:(a=this._getElement(t),a.length<1?!1:(o=e("<div>"+s+"</div>").contents(),o.length<1?!1:(o.each(function(){l._applyClassChange(e(this),e(this).attr("class"),!1)}),this._insertElementToParentAtIndex(o,t,i,r),!0)))},selectMediaQueryById:function(e){var t="body";return!n(e,"string")||e.length<1?!1:(n(this.active_element,"element")&&(t=this.active_element.getElement().id),this._selectElementByIdAndMediaQueryId(t,e),this._scrollToMediaQuery(e),!0)},createMediaQuery:function(e){return n(e,"media_query")?(this.imc.trigger("data:elements:getElements",function(t,i){return t?(this.log("error","Tried to get elements but could not retrieve them."),!1):n(i,"element")?(this.renderMediaQueryWithElements(e,i),this.selectMediaQueryById(e.getMediaQuery().id),!0):!1},this),!0):!1},updateMediaQuery:function(i){var s,a,l,c,u;return n(i,"media_query")?(a=i.getMediaQuery(),s=e(r.getMediaQuerySelector(a.id)),s.length<1?!1:(c=s.parent(),c.length<1?!1:(l=this._getMediaQueryWidth(i),u=n(l,"string")&&l.length>0,a.is_default&&(this.default_media_query=i,this.$el.toggleClass("mobile-first",u),this.setDefaultMediaQueryPixelWidth()),u&&c.css("width",l),this.imc.trigger("data:styles:getInheritedStylesPrefixes",this.active_style_id,function(i,s){return i?(this.log("error","Tried to get inherited styles data attributes but could not retrieve them."),!1):n(s,"object")?(t.each(s,function(i,n){var s,a=e(r.getMediaQuerySelector(n));return a.length<1?!1:(s=o(a.get(0).attributes,"array"),t.each(s,function(e){e&&e.name.match(/^data-styles-mq/)&&a.removeAttr(e.name)}),void a.attr(i))}),this.resizeOverflowingSpace(),!0):!1},this),this.reorderMediaQueries(),!0))):!1},mediaQueryResizeStart:function(){return this.disableReorderOfMediaQueries(),!0},mediaQueryResizeLeft:function(){return this.disableChangeElementsWidth(),!0},mediaQueryResizeRight:t.throttle(function(){return this.enableChangeElementsWidth(),this._addElementsPadding(120),this._scrollWindow(60,100),!0},100),mediaQueryResizeComplete:function(e){return this.enableChangeElementsWidth(),this.enableReorderOfMediaQueries(e),this._removeElementsPadding(),!0},cssEditorResized:function(e){return this._addElementsPadding(e),this._scrollWindow(e,200),!0},cssEditorClosing:function(){var i=parseInt(e(".elements").css("padding-right"),10);return this._scrollWindow(-1*i,200,t.bind(function(){this._removeElementsPadding()},this)),!0},disableChangeElementsWidth:function(){return this.change_elements_width_disabled?!1:(this.change_elements_width_disabled=!0,this.$el.css("width",2*this.$el.width()),!0)},enableChangeElementsWidth:function(){return this.change_elements_width_disabled=!1,this.$el.css("width",""),!0},disableReorderOfMediaQueries:function(){return this.reorder_media_queries_disabled=!0,!0},enableReorderOfMediaQueries:function(e){return this.reorder_media_queries_disabled=!1,this.resizeOverflowingSpace(),this.reorderMediaQueries(e),!0},reorderMediaQueries:function(i){return this.reorder_media_queries_disabled?!1:(this.imc.trigger("data:styles:getMediaQueries",this.active_style_id,function(s,o){var a={},l=e(".elements");return s?(this.log("error","reorderMediaQueries(): Tried to get media queries but could not retrieve them."),!1):n(o,"array")?(t.each(o,function(e,t){var i=e.getMediaQuery().id,n=l.find(r.getMediaQuerySelector(i));n.index("[data-media-query-id]")!==t&&(a[i]={index:t,media_query:e})},this),t.each(a,function(e,t){var i,n=l.find(r.getMediaQuerySelector(t)),s=n.parent(),o=l.find("[data-media-query-id]").eq(e.index),a=o.parent(),c="insertBefore",u="after";n.index("[data-media-query-id]")!==e.index&&(this.cleanupMediaQueryWithAloha(e.media_query),n.index("[data-media-query-id]")<e.index&&(c="insertAfter",u="before"),i=s.next(".overflowing-space"),s[c](a),s[u](i),this.setupMediaQueryWithAloha(e.media_query))},this),this._scrollToMediaQuery(i),void this.announce("reorder-media-queries-complete")):!1},this),!0)},resizeOverflowingSpace:function(){return this.reorder_media_queries_disabled?!1:(this.imc.trigger("data:styles:getMediaQueries",this.active_style_id,function(i,s){return i?(this.log("error","resizeOverflowingSpace(): Tried to get media queries but could not retrieve them."),!1):n(s,"array")?void t.each(s,function(i){var s,a,l,c=i.getMediaQuery().id,u=this.$(r.getMediaQuerySelector(c));return s=t.max(t.map(u.find("*"),function(t){var i=e(t),s=i.offset(),r=i.outerWidth(),a=o(i.css("margin-right"),"number");return n(s,"object")?s.left+r+a:!1})),l=u.offset(),n(l,"object")?(a=l.left+u.width(),void u.parent().next(".overflowing-space").width(s-a)):!1}):!1},this),!0)},deleteMediaQuery:function(t){var i,s,o;return n(t,"media_query")?(s=t.getMediaQuery(),i=e(r.getMediaQuerySelector(s.id)),i.length<1?!1:(o=i.parent(),o.length<1?!1:(this.cleanupMediaQueryWithAloha(t),o.next(".overflowing-space").remove(),o.remove(),!0))):!1},updateElement:function(e){var t=!0;return this._updateElementAttributes(e)||(t=!1),this._updateElementChildren(e)||(t=!1),t&&this.imc.trigger("ui:elements:updateElement:complete"),t},deleteElement:function(e){var t;return n(e,"element")?(t=this._getElementsOnAllMediaQueries(e.getElement().id,!this.listen_to_data_side_events),t.length<1?!1:(t.remove(),this._selectNextElement(e),!0)):!1},_selectNextElement:function(e){return this.imc.trigger("data:elements:getElementById",e.getElement().parent_id,function(t,i){var s,r,o;return t?!1:(s=e.getElement(),r=i.getElement(),o=0===r.children.length?r:r.children.length===s.index?r.children[r.children.length-1]:r.children[s.index],n(o,"object")?void this._setActiveElementById(o.id):!1)},this),!0},createInlineElement:function(i){var s,r,o=this.aloha_range_object;return!n(i,"string")||i.length<1?!1:!n(o,"object")||n(o.limitObject,"undefined")?!1:(s=e(i),s.length<1?!1:(o.isCollapsed()&&GENTICS.Utils.Dom.extendToWord(o),GENTICS.Utils.Dom.addMarkup(o,s),r=t.find(window.Aloha.editables,function(e){return e.obj.get(0)===o.limitObject}),window.Aloha.activateEditable(r),o.select(),this._immediatelyUpdateContentEvent(),!0))},removeInlineElement:function(i){var s,r,o,a=this.aloha_range_object;return!n(i,"string")||i.length<1?!1:!n(a,"object")||n(a.limitObject,"undefined")?!1:(s=e(i),s.length<1?!1:(o=a.findMarkup(function(){return this.nodeName.toLowerCase()===s.get(0).nodeName.toLowerCase()}),o&&(a.isCollapsed()?GENTICS.Utils.Dom.removeFromDOM(o,a,!0):GENTICS.Utils.Dom.removeMarkup(a,s)),r=t.find(window.Aloha.editables,function(e){return e.obj.get(0)===a.limitObject}),window.Aloha.activateEditable(r),a.select(),this._immediatelyUpdateContentEvent(),!0))},selectFirstElement:function(){return this.imc.trigger("data:elements:getElements",function(e,t){var i,s;return e?(this.log("error","Tried to get elements but could not retrieve them."),!1):n(t,"element")?(i=t.getElement(),i.children.some(function(e){return"element"!==e.type?!1:(s=e.id,!0)}),!n(s,"string")||s.length<1?!1:(this.imc.trigger("data:state:set","active-element",s),!0)):!1},this),!0},selectElementById:function(e){var t;return!n(e,"string")||e.length<1?!1:(t=this._getElement(e),t.length<1?!1:this.selectElement(t.get(0)))},selectElement:function(i){var s,r,o;if(n(i,"text")&&"#text"===i.nodeName&&i.parentNode instanceof HTMLElement&&(i=i.parentNode),!(i instanceof HTMLElement))return!1;if(s=this.getAlohaEditableByElement(i),!n(s,"object")||!n(s.obj,"object"))return!1;if(this.deselectAllRanges(),i instanceof HTMLImageElement){if(i.complete===!0)return this.selectImageElement(i,s),!0;o=t.bind(function(){this.selectImageElement(i,s)},this),r=e(i),r.one("load",o),r.one("error",o)}else this.selectTextElement(i,s);return!0},getAlohaEditableByElement:function(i){return i instanceof HTMLElement?t.find(window.Aloha.editables,function(t){return e(i).is("[data-id=body]")?t.obj.get(0)===i:e.contains(t.obj.get(0),i)}):!1},selectImageElement:function(t,i){var s;return t instanceof HTMLImageElement&&n(i,"object")&&n(i.obj,"object")?(s=e(t).attr("data-id"),!n(s,"string")||s.length<1?!1:n(this.active_element,"element")&&s===this.active_element.getElement().id?!1:(this._setActiveElementById(s),i.obj.blur(),!0)):!1},selectTextElement:function(e,t){var i;return e instanceof HTMLElement&&n(t,"object")&&n(t.obj,"object")?(i=window.Aloha.createRange(),i.setStart(e,1),i.setEnd(e,1),window.Aloha.activateEditable(t),this.ignore_selection_occured=!0,window.Aloha.getSelection().addRange(i),window.Aloha&&window.Aloha.Selection&&window.Aloha.Selection.updateSelection(!1),this.ignore_selection_occured=!1,!0):!1},deselectAllElements:function(t){return"body"!==e(t.target).attr("data-id")?!1:(this.imc.trigger("data:state:set","active-element",void 0),this.deselectAllRanges(),!0)},deselectAllRanges:function(){return window.Aloha.getSelection().removeAllRanges(),!0},newElementAdded:function(e,t,i,s,r,o,a){var l,c={};return!n(t,"string")||t.length<1?!1:!n(e,"string")||e.length<1?!1:!n(s,"string")||s.length<1?!1:(n(i,"number")||(i=null),n(r,"string")||(r=""),n(o,"object")||(o={}),n(a,"object")||(a={}),c.id=e,c.parent_id=t,c.index=i,c.content=r,c.attributes=o,c.tag_name=s.toLowerCase(),this.imc.trigger("data:elements:createElement",c,a),this.imc.trigger("data:elements:getElementById",c.parent_id,function(e){return e?(this.log("warn","ui:elements:newElementAdded :: Tried to lookup an element with ID: "+c.parent_id+" but could not retrieve it"),!1):(l=this._getElement(c.parent_id).html(),void this.imc.trigger("data:elements:updateElement",c.parent_id,{content:l},a))},this),!0)},elementUpdated:function(e,t,i,s,r,o){var a={};return!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:!n(s,"string")||s.length<1?!1:(n(i,"number")||(i=null),n(r,"string")||(r=""),n(o,"object")||(o={}),a.parent_id=t,a.index=i,a.content=r,a.attributes=o,a.tag_name=s.toLowerCase(),this.imc.trigger("data:elements:updateElement",e,a),!0)},elementRemoved:function(e){return!n(e,"string")||e.length<1?!1:(this.imc.trigger("data:elements:deleteElement",e),!0)},selectionOccured:function(e,t,i,s,r){var o;if(this.ignore_selection_occured)return!1;if(!n(e,"object")||!n(e.start,"number")||!n(e.end,"number"))return!1;if(!n(s,"array"))return!1;if(this.aloha_range_object=i,!n(t,"array")||!n(t[0],"string")||!n(t[1],"string"))return!1;if(!n(r,"string")||0===r.length)return!1;if(n(this.active_media_query,"media_query")&&(o=this.active_media_query.getMediaQuery().id),this.imc.trigger("data:state:set","active-media-query",r),e.end-e.start>0?this.imc.trigger("ui:elements:selection-occurred",t[0],t[1],s):this.imc.trigger("ui:elements:selection-collapsed",t[0]),t[0]===t[1]){if(this.announce("selection-range",e),n(this.active_element,"element")&&t[0]===this.active_element.getElement().id&&n(this.active_media_query,"media_query")&&r===o)return!1;n(this.active_element,"element")&&t[0]===this.active_element.getElement().id&&n(this.active_media_query,"media_query")&&r!==o&&(this.imc.trigger("data:state:set","active-element",void 0),this.imc.trigger("data:state:set","active-media-query",r)),this._setActiveElementById(t[0])}else this.active_element=null;return!0},onStylesChanged:function(e,i,s,r,o){var a=["width","margin","margin-left","margin-right","border-width","border-left-width","border-right-width","padding","padding-left","padding-right"];return n(o,"array")?t.intersection(o,a).length<1?!1:(this.resizeOverflowingSpace(),!0):!1},_setActiveElementById:function(e){return this.imc.trigger("data:elements:getElementById",e,function(e,t){return e?(this.active_element=null,!1):(this._removeActiveElementType(),this.active_element=t,void this._setActiveElementType(t.getSelector()))},this),this.imc.trigger("data:state:set","active-element",e),!0},_scrollWindow:function(t,i,s){var r,o;return n(t,"number")?(n(i,"number")||(i=1e3),r=e(window),o=e("html, body").animate({scrollLeft:r.scrollLeft()+t},i),e.when(o).done(s),!0):!1},_addElementsPadding:function(t){return n(t,"number")?(e(".elements").css("padding-right",t+"px"),!0):!1},_removeElementsPadding:function(){return e(".elements").css("padding-right",""),!0},_getMediaQueries:function(){return this.imc.trigger("data:styles:getMediaQueries",this.active_style_id,function(e,t){return e?(this.log("error","Tried to get media queries array but could not retrieve them."),this.data_media_queries_ready.reject("Tried to get media queries array but could not retrieve them."),!1):!n(t,"array")||t.length<1?(this.data_media_queries_ready.reject("Media queries array is invalid or empty"),!1):(this.data_media_queries_ready.resolve(t),!0)},this),!0},_updateElementAttributes:function(i){var s,r,o,a,l,c,u,h;return n(i,"element")?(s=i.getElement(),r=this._getElementsOnAllMediaQueries(s.id,!this.listen_to_data_side_events),r.length<1?!1:(h=s.attributes,c=this._getAttributesHashFromNodeMap(r.get(0).attributes),u=t.omit(c,Object.keys(h)),l=s.tag_name.toLowerCase(),"body"===l?!1:("img"===l&&n(s.attributes.src,"string")&&s.attributes.src.length>0&&r.attr("src",s.attributes.src),l!==r.prop("tagName").toLowerCase()&&(o=e("<"+l+">"),a=r.html(),o.html(a),o.attr("data-id",s.id),r.replaceWith(o),r=this._getElementsOnAllMediaQueries(s.id,!this.listen_to_data_side_events)),this._removeAttributesFromElement(r,u),this._setOrUpdateAttributesForElement(r,h),!0))):!1},_removeAttributesFromElement:function(e,i){return t.each(i,function(t,i){i.match(/^data-/)||e.removeAttr(i)}),!0},_setOrUpdateAttributesForElement:function(e,i){return t.each(i,function(t,i){return"class"===i?((!n(t,"string")||t.length<1)&&(t=null),void this._applyClassChange(e,t)):"width"===i?((!n(t,"string")||t.length<1)&&(t=""),void e.css("width",t)):void(e.attr(i)!==t&&e.attr(i,t))},this),!0},_updateElementChildren:function(i){var s,o,a,l,c,u,h,d,p;return n(i,"element")?(o=i.getElement(),s=this._getElementsOnAllMediaQueries(o.id,!this.listen_to_data_side_events),s.length<1?!1:(a=r.getDomNodesForElementTree(o))?(l=a.childNodes,h=l.length,t.each(s,function(i){
var n=e(i);if(c=i.childNodes,t.each(l,function(t,i){if(u=c[i],!u)return void n.append(e(t).clone());if("#text"===t.nodeName||"#text"===u.nodeName||e(t).attr("data-id")!==e(u).attr("data-id"))if("#text"===t.nodeName)"#text"===u.nodeName?t.textContent!==u.textContent&&(u.textContent=t.textContent):(e(u).before(e(t).clone()),c=n.get(0).childNodes);else{if(!this._doesDataIdExistInElement(e(t).attr("data-id"),n))return u.nextSibling?e(u.nextSibling).before(e(t).clone()):e(u).parent().append(e(t).clone()),void u.parentNode.removeChild(u);this._getElementsOnAllMediaQueries(e(t).attr("data-id"),!this.listen_to_data_side_events).remove(),e(u).before(e(t).clone()),u.parentNode.removeChild(u)}},this),h<c.length)for(d=h,p=c.length;p>d;d++)u=c[h],u&&u.parentNode&&u.parentNode.removeChild(u)},this),!0):!1):!1},_applyClassChange:function(e,t){return n(e,"object")?(n(t,"string")||(t=""),""!==t&&n(t,"string")||(t=null),e.attr("class",t),!0):!1},_doesDataIdExistInElement:function(t,i){var s;return!n(t,"string")||t.length<1?!1:i instanceof e?(s=i.children("[data-id='"+t+"']"),s.length>0?!0:!1):!1},_isElementSelectable:function(e){var t=e.getElement();return t.children.length<1||!this._hasTextNodes(t)?!1:!0},_hasTextNodes:function(e){var t=!1;return e.children.forEach(function(e){"text"===e.type&&(t=!0)}),t},_insertElementToParentAtIndex:function(i,s,r,o){var a,l,c,u,h,d;return c=this._getElement(s),d=this.getAlohaEditableByElement(c.get(0)),window.Aloha.activateEditable(d),l=c.contents(),a=l.length,0===l.length||1===l.length&&3===l[0].nodeType?n(o,"object")&&n(o.start,"number")&&n(o.end,"number")?(h=c.html(),c.html(h.substr(0,o.end)+e("<div>").append(i.clone()).html()+h.substr(o.end))):c.append(i):0!==r&&(!r||!n(r,"number")||0>r||r>=a)?(r=a-1,e(l[r]).after(i)):e(l[r]).before(i),u=c.find("[data-make-active='yes']"),u.length>0?(u.attr("data-make-active",null),this.selectElement(u.get(0)),u.is("img")?setTimeout(t.bind(this._immediatelyUpdateContentEvent,this),0):this._immediatelyUpdateContentEvent()):(this.selectElement(i[0]),this._immediatelyUpdateContentEvent(),this.deselectAllRanges()),this.imc.trigger("ui:css-animate:element","typecast-element-warmdown",i),!0},_immediatelyUpdateContentEvent:function(){return this.aloha_ready&&window.Aloha.trigger("aloha-smart-content-changed"),!0},_getAttributesHashFromNodeMap:function(e){var t,i,n={};if("object"!=typeof e||0===e.length)return n;for(t=0,i=e.length;i>t;t++)n[e[t].name]=e[t].value;return n},_setActiveElementType:function(t){var i;return!n(t,"string")||t.length<1?!1:(i=e("[data-id='body'] "+t),i.length<1?!1:(i.attr("data-active-element-type","yes"),!0))},_removeActiveElementType:function(){return e('[data-active-element-type="yes"]').attr("data-active-element-type",null),!0},_getElement:function(t){var i;return n(this.last_active_mq,"media_query")&&(i=this.last_active_mq.getMediaQuery().id),n(this.active_media_query,"media_query")&&(i=this.active_media_query.getMediaQuery().id),(!n(i,"string")||i.length<1)&&(i=this.default_media_query.getMediaQuery().id),!n(i,"string")||i.length<1?e():r.getElement(i,t)},_getElementsOnAllMediaQueries:function(e,t){var i;return t=n(t,"boolean")?t:!1,i=r.getElement(null,e),t&&(i=i.not(this._getElement(e))),i},_scrollToMediaQuery:function(t){var i;return!n(t,"string")||t.length<1?!1:(i=e(r.getMediaQuerySelector(t)),this.imc.trigger("ui:css-animate:element","typecast-element-warmdown",i),this.imc.trigger("ui:scroll:to",i),!0)},_getMediaQueryWidth:function(e){return t.chain(e.getMediaQuery().attributes).pick("min-width","max-width").compact().value()[0]},_setComputedPixelWidthOnElement:function(e){return!n(e,"object")||e.length<1?!1:(e.css("width","").css("width",e.width()),!0)},_selectElementByIdAndMediaQueryId:function(e,t){return this.imc.trigger("data:state:set","active-element",void 0),this.imc.trigger("data:state:set","active-media-query",t),this.imc.trigger("data:state:set","active-element",e),!0}});return l}),define("ui/main-dialog/models/element-data",["backbone","underscore","core/utils/dom","core/utils/is"],function(e,t,i,n){return e.Model.extend({defaults:function(){return{watched_attributes:[],updated_attributes:[]}},getValue:function(e){var t,i;return t=this.get("style_declaration"),n(t,"object")&&n(t.getValue,"function")?(i=t.getValue(e),!n(i,"array")||i.length<1?!1:i[0]):!1},getAttribute:function(e){var t;return!n(e,"string")||e.length<1?!1:(t=this.get("attributes"),n(t,"object")?t[e]:!1)},isImageElement:function(){var e=this.get("tag_name");return!n(e,"string")||e.length<1?!1:"img"===e.toLowerCase()},getCssPropertyForElement:function(e){var t,i,s;return!n(e,"string")||e.length<1?!1:(t=this.get("style_declaration"),s=this.getValue(e),s===!1&&(s=null),i={name:e,value:s,inherited:t.isInherited(e)})},setCssPropertyForElement:function(e,t,i){var s=this.get("style_declaration");return!n(e,"string")||!n(t,"string")&&null!==t?!1:(i=i||"ui",this.set("source",i),s.getStyleDeclaration().attributes[e]=[t],this.trigger("css:attribute:changed",this.get("selector"),e,t),this.trigger("css:attribute:changed:"+e,this.get("selector"),t),!0)},removeCssPropertyFromElement:function(e,t,i,n){return this.trigger("css:attribute:remove",this.get("selector"),e,t,i,n),!0},setElementData:function(e){return n(e,"object")&&n(e.id,"string")&&n(e.tag_name,"string")&&n(e.style_declaration,"object")&&n(e.breadcrumbs,"array")?(this.set({}),this.set(e),this.trigger("element:changed"),!0):!1},selectElement:function(e,t){return n(e,"string")?(t||(t=!1),void this.trigger("select:element",e,t)):!1},inherit:function(){this.trigger("inherit:from:parent",this.get("selector"))},addWatchedAttributes:function(e){var i=this.get("watched_attributes");this.set("watched_attributes",t(i.concat(e)).uniq())}})}),define("hbs!ui/main-dialog/templates/controls/breadcrumbs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s,r="";return r+='\n    <li class="selectable',n=i["if"].call(e,e.is_parent,{hash:{},inverse:m.noop,fn:m.program(2,o,t)}),(n||0===n)&&(r+=n),r+='" ',n=i["if"].call(e,e.is_active,{hash:{},inverse:m.program(7,c,t),fn:m.program(4,a,t)}),(n||0===n)&&(r+=n),r+=' data-element-id="'+y((n=e.element,n=null==n||n===!1?n:n.id,typeof n===v?n.apply(e):n))+'">\n        ',s=i["if"].call(e,e.is_active,{hash:{},inverse:m.program(11,h,t),fn:m.program(9,u,t)}),(s||0===s)&&(r+=s),r+="\n    </li>\n"}function o(e,t){return" selectable-parent"}function a(e,t){var n;return n=i.unless.call(e,e.is_body,{hash:{},inverse:m.noop,fn:m.program(5,l,t)}),n||0===n?n:""}function l(e,t){return'data-tooltips-title="Change this element"'}function c(e,t){var i,n="";return n+='data-tooltips-title="Select '+y((i=e.selector,typeof i===v?i.apply(e):i))+'"'}function u(e,t){var i,n="";return n+='\n        <span class="format-selector-'+y((i=e.selector,typeof i===v?i.apply(e):i))+'" id="current-element-type">'+y((i=e.breadcrumb,typeof i===v?i.apply(e):i))+'</span>\n        <span id="show-dialog-format" data-tooltips-title="Choose element"></span>\n        '}function h(e,t){var n,s,r="";return r+='\n        <a href="#">\n            <span class="format-selector-'+y((n=e.selector,typeof n===v?n.apply(e):n))+'">\n                ',s=i["if"].call(e,e.is_parent,{hash:{},inverse:m.program(14,p,t),fn:m.program(12,d,t)}),(s||0===s)&&(r+=s),r+="\n            </span>\n        </a>\n        "}function d(e,t){var i,n="";return n+='\n                    <span class="select-parent" data-tooltips-title="Select '+y((i=e.selector,typeof i===v?i.apply(e):i))+'" ></span>\n                '}function p(e,t){var i,n="";return n+="\n                    "+y((i=e.breadcrumb,typeof i===v?i.apply(e):i))+"\n                "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var f,g="",m=this,v="function",y=this.escapeExpression;return g+='<ul class="element-crumb">\n',f=i.each.call(t,t.breadcrumbs,{hash:{},inverse:m.noop,fn:m.program(1,r,s)}),(f||0===f)&&(g+=f),g+="\n</ul>\n"});return t.registerPartial("ui_main-dialog_templates_controls_breadcrumbs",i),i}),define("ui/main-dialog/views/controls/breadcrumbs",["backbone","jquery","underscore","core/utils/is","core/typecastError","hbs!../../templates/controls/breadcrumbs"],function(e,t,i,n,s,r){return e.View.extend({template:r,className:"breadcrumbs-container selector",id:"format-selector",events:{"click li:not(:last)":"selectBreadcrumb","click li:last:not([data-element-id='body'])":"toggleElementDialog"},initialize:function(){if(!n(this.model,"object"))throw new s(101,"Element Data Model is mandatory.");return this.$el.on("click",this.proxyClickToLastBreadcrumb),this},getData:function(){var e,t;return n(this.model,"object")?(e=this.model.get("breadcrumbs"),n(e,"array")?0===e.length?[]:(e[0].is_body=!0,i.last(e).is_active=!0,e.length<3?e:(t=[i.first(e)].concat(i.last(e,2)),t[1].is_parent=!0,t)):!1):!1},render:function(){var e,t=this.template({breadcrumbs:this.getData()});return this.$el.html(t),e=this.$el.find("li"),1===e.length&&"body"===e.attr("data-element-id")?this.$el.addClass("body-active"):this.$el.removeClass("body-active"),this},toggleElementDialog:function(){return this.trigger("ui:element-dialog",{action:"toggle"}),!1},selectBreadcrumb:function(e){var t;return e.preventDefault(),t=this.$(e.currentTarget).attr("data-element-id"),this.model.selectElement(t),!1},proxyClickToLastBreadcrumb:function(){var e=t(this).find("li:last");return"body"!==e.attr("data-element-id")&&e.trigger("click"),!1}})}),define("hbs!ui/main-dialog/templates/controls/colours",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="controls-colour">\n  <div class="colour-swatch ui-text-colour">\n    <div class="controls-colour-selected">\n      <div class="thumb-preview" title="Change the text color">\n        <div style="background-color: ',(r=i.active_text_colour)?r=r.call(t,{hash:{}}):(r=t.active_text_colour,r=typeof r===a?r.apply(t):r),o+=l(r)+';"></div>\n      </div>\n    </div>\n    <span class="label">Text color</span>\n  </div>\n\n  <div class="colour-swatch ui-background-colour">\n    <div class="controls-colour-selected">\n      <div class="thumb-preview" title="Change the background color">\n        <div style="background-color: ',(r=i.active_background_colour)?r=r.call(t,{hash:{}}):(r=t.active_background_colour,r=typeof r===a?r.apply(t):r),o+=l(r)+';"></div>\n      </div>\n    </div>\n    <span class="label">Background</span>\n  </div>\n\n  <div class="clear"></div>\n</div>\n'});return t.registerPartial("ui_main-dialog_templates_controls_colours",i),i}),define("ui/main-dialog/views/controls/colours",["backbone","core/typecastError","core/utils/is","hbs!../../templates/controls/colours"],function(e,t,i,n){return e.View.extend({watched_attributes:["color","background-color"],template:n,active_text_colour:null,active_background_colour:null,events:{"click .ui-text-colour":"toggleTextColorDialog","click .ui-background-colour":"toggleBackgroundColorDialog"},initialize:function(){if(!i(this.model,"object"))throw new t(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this},render:function(){return this.active_text_colour=this._getColourValueByAttributeName("color"),this.active_background_colour=this._getColourValueByAttributeName("background-color"),this.$el.html(this.template({active_text_colour:this.active_text_colour,active_background_colour:this.active_background_colour})),this},selectActiveColour:function(e){e.preventDefault();var t=this.$(e.currentTarget).data("colour");return this.$(".ui-text-colour").find(".thumb-preview div").css({"background-color":t}),this.model.setCssPropertyForElement("color",t)},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.render(),!0)},toggleBackgroundColorDialog:function(){return this.toggleColorDialog(this.active_background_colour,this._handleBackgroundColorUiChanges)},toggleTextColorDialog:function(){return this.toggleColorDialog(this.active_text_colour,this._handleTextColorUiChanges)},toggleColorDialog:function(e,t){return this.trigger("ui:colour-dialog",{action:"toggle",color:e,callback:t,callback_context:this}),!0},_getColourValueByAttributeName:function(e){var t;return!i(e,"string")||e.length<1?!1:(t=this.model.getCssPropertyForElement(e),i(t,"object")&&i(t.value,"string")?t.inherited&&"rgba(0, 0, 0, 0)"===t.value?!1:t.value:!1)},_handleTextColorUiChanges:function(e){return!i(e,"string")||e.length<1?!1:(this.active_text_colour=e,"inherit"===e?this.model.removeCssPropertyFromElement(["color"]):this.model.setCssPropertyForElement("color",e),this.render(),!0)},_handleBackgroundColorUiChanges:function(e){return!i(e,"string")||e.length<1?!1:(this.active_background_colour=e,"inherit"===e?this.model.removeCssPropertyFromElement(["background-color"]):this.model.setCssPropertyForElement("background-color",e),this.render(),!0)}})}),define("core/utils/retina",["core/utils/is"],function(e){return{isRetinaDisplay:function(){return window.devicePixelRatio>=2?!0:!1},generateImagePath:function(t,i){if(!e(t,"string"))return!1;var n,s,r,o=e(i,"string")?i:"2x";return this.isRetinaDisplay()&&(n=t.split("."),r=n.pop(),s=n.join("."),t=s+o+"."+r),t}}}),define("hbs!ui/main-dialog/templates/controls/font_family",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s,r="";return r+='\n    <div id="font-selector-name" class="selector dark large ',s=i["if"].call(e,(n=e.css,null==n||n===!1?n:n.inherited),{hash:{},inverse:_.noop,fn:_.program(2,o,t)}),(s||0===s)&&(r+=s),r+='" title="Click to edit" style="'+w((n=e.css,n=null==n||n===!1?n:n.font_family_style,typeof n===b?n.apply(e):n))+'">\n        <h3>'+w((n=e.font,n=null==n||n===!1?n:n.name_clean,typeof n===b?n.apply(e):n))+"</h3>\n    </div>\n    "}function o(e,t){return"inherited"}function a(e,t){var n,s,r="";return r+="\n        ",s=i.each.call(e,(n=e.font,null==n||n===!1?n:n.variations),{hash:{},inverse:_.noop,fn:_.programWithDepth(l,t,e)}),(s||0===s)&&(r+=s),r+="\n        "}function l(e,t,n){var s,r,o="";return o+='\n        <option value="'+w((s=e.id,typeof s===b?s.apply(e):s))+'" ',r=i["if"].call(e,(s=n.font,null==s||s===!1?s:s.sprite),{hash:{},inverse:_.noop,fn:_.programWithDepth(c,t,n)}),(r||0===r)&&(o+=r),o+=">\n          "+w((s=e.name_clean,typeof s===b?s.apply(e):s))+"</option>\n        "}function c(e,t,i){var n,s="";return s+='class="font-variation" style="background-image: url('+w((n=i.font,n=null==n||n===!1?n:n.sprite,typeof n===b?n.apply(e):n))+"); background-position: 20px "+w((n=e.image_y_offset,typeof n===b?n.apply(e):n))+"px; width: "+w((n=i.font,n=null==n||n===!1?n:n.sprite_image_width,typeof n===b?n.apply(e):n))+"px; background-size: "+w((n=i.font,n=null==n||n===!1?n:n.sprite_image_width,typeof n===b?n.apply(e):n))+'px auto;"'}function u(e,t){return"s"}function h(e,t){var i,n="";return n+=" <em>from</em> <strong>"+w((i=e.font,i=null==i||i===!1?i:i.provider_display_name,typeof i===b?i.apply(e):i))+"</strong>"}function d(e,t){var n,s="";return s+='\n<div id="opentype-features" class="controls-standard">\n    <h3>Opentype Features</h3>\n    <div class="tooltip-holder">\n        <div class="info-tooltip">\n            <span aria-hidden="true" data-icon="ÓÄí"></span>\n            <span class="screen-reader-text">Info</span>\n            <div class="info">\n                <h4 class="experimental">Experimental Features</h4>\n                <p>Many browsers don\'t fully support Opentype yet.</p>\n            </div>\n        </div>\n    </div>\n    <div class="clear"></div>\n    <ul id="opentype-buttons" class="button-controls">\n        ',n=i.each.call(e,e.opentype_features,{hash:{},inverse:_.noop,fn:_.program(13,p,t)}),(n||0===n)&&(s+=n),s+="\n    </ul>\n</div>\n"}function p(e,t){var n,s="";return s+='\n        <li>\n            <a href="#" class="ot-',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===b?n.apply(e):n),s+=w(n)+" off",n=i["if"].call(e,e.inherited,{hash:{},inverse:_.noop,fn:_.program(14,f,t)}),(n||0===n)&&(s+=n),n=i["if"].call(e,e.selected,{hash:{},inverse:_.noop,fn:_.program(16,g,t)}),(n||0===n)&&(s+=n),s+='" id="opt-',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===b?n.apply(e):n),s+=w(n)+'" data-value="\'',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===b?n.apply(e):n),s+=w(n)+'\' 1" title="',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===b?n.apply(e):n),s+=w(n)+'" data-name="',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===b?n.apply(e):n),s+=w(n)+'">\n                <span>',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===b?n.apply(e):n),s+=w(n)+"</span>\n            </a>\n        </li>\n        "}function f(e,t){return" inherited"}function g(e,t){var n,s="";return s+=" ",(n=i.selected_class)?n=n.call(e,{hash:{}}):(n=e.selected_class,n=typeof n===b?n.apply(e):n),s+=w(n)}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var m,v,y="",_=this,b="function",w=this.escapeExpression;return y+='<div id="font-selector">\n    ',v=i["if"].call(t,(m=t.font,null==m||m===!1?m:m.name),{hash:{},inverse:_.noop,fn:_.program(1,r,s)}),(v||0===v)&&(y+=v),y+='\n</div>\n\n<div id="font-selector-weight" class="selector dark small chzn-inside ',v=i["if"].call(t,t.variation_inherited,{hash:{},inverse:_.noop,fn:_.program(2,o,s)}),(v||0===v)&&(y+=v),y+='" title="Choose font weight" style="'+w((m=t.css,m=null==m||m===!1?m:m.font_variation_style,typeof m===b?m.apply(t):m))+'">\n    <select data-placeholder="Please choose:">\n        ',v=i["if"].call(t,(m=t.font,null==m||m===!1?m:m.variations),{hash:{},inverse:_.noop,fn:_.program(4,a,s)}),(v||0===v)&&(y+=v),y+='\n    </select>\n</div>\n\n<div id="font-weight-info">\n    <span>'+w((m=t.font,m=null==m||m===!1?m:m.variations_count,typeof m===b?m.apply(t):m))+" weight",v=i["if"].call(t,(m=t.font,null==m||m===!1?m:m.has_multiple_variations),{hash:{},inverse:_.noop,fn:_.program(8,u,s)}),(v||0===v)&&(y+=v),y+="</span>",v=i["if"].call(t,(m=t.font,null==m||m===!1?m:m.provider_display_name),{hash:{},inverse:_.noop,fn:_.program(10,h,s)}),(v||0===v)&&(y+=v),y+="\n</div>\n\n",v=i["if"].call(t,(m=t.opentype_features,null==m||m===!1?m:m.length),{hash:{},inverse:_.noop,fn:_.program(12,d,s)}),(v||0===v)&&(y+=v),y+="\n"});return t.registerPartial("ui_main-dialog_templates_controls_font_family",i),i}),function(){var e,t,i,n,s,r={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var n in t)r.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};n=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,n,s,r,o;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),children:0,disabled:e.disabled}),r=e.childNodes,o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(this.add_option(i,t,e.disabled));return o},e.prototype.add_option=function(e,t,i){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e.prototype.escapeExpression=function(e){var t,i;return null==e||e===!1?"":/[\&\<\>\"\'\`]/.test(e)?(t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,e.replace(i,function(e){return t[e]||"&amp;"})):e},e}(),n.select_to_array=function(e){var t,i,s,r,o;for(i=new n,o=e.childNodes,s=0,r=o.length;r>s;s++)t=o[s],i.add_node(t);return i.parsed},t=function(){function e(t,i){this.form_field=t,this.options=null!=i?i:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},e.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(e){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(e){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},e.prototype.results_option_build=function(e){var t,i,n,s,r;for(t="",r=this.results_data,n=0,s=r.length;s>n;n++)i=r[n],t+=i.group?this.result_add_group(i):this.result_add_option(i),(null!=e?e.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(i.text));return t},e.prototype.result_add_option=function(e){var t,i;return e.search_match&&this.include_option_in_results(e)?(t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style.replace(/"/g,"'")+'"':"",'<li class="'+t.join(" ")+'"'+i+' data-option-array-index="'+e.array_index+'">'+e.search_text+"</li>"):""},e.prototype.result_add_group=function(e){return(e.search_match||e.group_match)&&e.active_options>0?'<li class="group-result">'+e.search_text+"</li>":""},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build(),this.results_showing?this.winnow_results():void 0},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.winnow_results=function(){var e,t,i,n,s,r,o,a,l,c,u,h,d;for(this.no_results_clear(),s=0,o=this.get_search_text(),e=o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),n=this.search_contains?"":"^",i=new RegExp(n+e,"i"),c=new RegExp(e,"i"),d=this.results_data,u=0,h=d.length;h>u;u++)t=d[u],t.search_match=!1,r=null,this.include_option_in_results(t)&&(t.group&&(t.group_match=!1,t.active_options=0),null!=t.group_array_index&&this.results_data[t.group_array_index]&&(r=this.results_data[t.group_array_index],0===r.active_options&&r.search_match&&(s+=1),r.active_options+=1),(!t.group||this.group_search)&&(t.search_text=t.group?t.label:t.html,t.search_match=this.search_string_match(t.search_text,i),t.search_match&&!t.group&&(s+=1),t.search_match?(o.length&&(a=t.search_text.search(c),l=t.search_text.substr(0,a+o.length)+"</em>"+t.search_text.substr(a+o.length),t.search_text=l.substr(0,a)+"<em>"+l.substr(a)),null!=r&&(r.group_match=!0)):null!=t.group_array_index&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)));return this.result_clear_highlight(),1>s&&o.length?(this.update_results_content(""),this.no_results(o)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},e.prototype.search_string_match=function(e,t){var i,n,s,r;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||0===e.indexOf("["))&&(n=e.replace(/\[|\]/g,"").split(" "),n.length))for(s=0,r=n.length;r>s;s++)if(i=n[s],t.test(i))return!0},e.prototype.choices_count=function(){var e,t,i,n;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,n=this.form_field.options,t=0,i=n.length;i>t;t++)e=n[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.prototype.include_option_in_results=function(e){return this.is_multiple&&!this.display_selected_options&&e.selected?!1:!this.display_disabled_options&&e.disabled?!1:e.empty?!1:!0},e.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),e=jQuery,e.fn.extend({chosen:function(n){return t.browser_is_supported()?this.each(function(t){var s,r;s=e(this),r=s.data("chosen"),"destroy"===n&&r?r.destroy():r||s.data("chosen",new i(this,n))}):this}}),i=function(t){function i(){return s=i.__super__.constructor.apply(this,arguments)}return o(i,t),i.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},i.prototype.set_up_html=function(){var t,i;return t=["chosen-container"],t.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl"),i={"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(i.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=e("<div />",i),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},i.prototype.register_observers=function(){var e=this;return this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(e){e.preventDefault()})},i.prototype.destroy=function(){return e(document).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},i.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chosen-single").length||(t.preventDefault(),
this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},i.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},i.prototype.search_results_mousewheel=function(e){var t,i,n;return t=-(null!=(i=e.originalEvent)?i.wheelDelta:void 0)||(null!=(n=e.originialEvent)?n.detail:void 0),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},i.prototype.blur_test=function(e){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},i.prototype.close_field=function(){return e(document).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},i.prototype.test_active_click=function(t){return this.container.is(e(t.target).closest(".chosen-container"))?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=n.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},i.prototype.result_do_highlight=function(e){var t,i,n,s,r;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),n=parseInt(this.search_results.css("maxHeight"),10),r=this.search_results.scrollTop(),s=n+r,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=s)return this.search_results.scrollTop(t-n>0?t-n:0);if(r>i)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},i.prototype.update_results_content=function(e){return this.search_results.html(e)},i.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},i.prototype.set_tab_index=function(e){var t;return this.form_field.tabIndex?(t=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=t):void 0},i.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t),this.search_field.focus()):void 0},i.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},i.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},i.prototype.choice_build=function(t){var i,n,s=this;return i=e("<li />",{"class":"search-choice"}).html("<span>"+t.html+"</span>"),t.disabled?i.addClass("search-choice-disabled"):(n=e("<a />",{"class":"search-choice-close","data-option-array-index":t.array_index}),n.bind("click.chosen",function(e){return s.choice_destroy_link_click(e)}),i.append(n)),this.search_container.before(i)},i.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},i.prototype.choice_destroy=function(e){return this.result_deselect(e[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},i.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},i.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},i.prototype.result_select=function(e){var t,i,n;return this.result_highlight?(t=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):(this.result_single_selected&&(this.result_single_selected.removeClass("result-selected"),n=this.result_single_selected[0].getAttribute("data-option-array-index"),this.results_data[n].selected=!1),this.result_single_selected=t),t.addClass("result-selected"),i=this.results_data[t[0].getAttribute("data-option-array-index")],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(i.text),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},i.prototype.single_set_selected_text=function(e){return null==e&&(e=this.default_text),e===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(e)},i.prototype.result_deselect=function(e){var t;return t=this.results_data[e],this.form_field.options[t.options_index].disabled?!1:(t.selected=!1,this.form_field.options[t.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},i.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html()},i.prototype.winnow_results_set_highlight=function(){var e,t;return t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null!=e?this.result_do_highlight(e):void 0},i.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},i.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},i.prototype.search_field_scale=function(){var t,i,n,s,r,o,a,l,c;if(this.is_multiple){for(n=0,a=0,r="position:absolute; left: -1000px; top: -1000px; display:none;",o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,c=o.length;c>l;l++)s=o[l],r+=s+":"+this.search_field.css(s)+";";return t=e("<div />",{style:r}),t.text(this.search_field.val()),e("body").append(t),a=t.width()+25,t.remove(),i=this.container.outerWidth(),a>i-10&&(a=i-10),this.search_field.css({width:a+"px"})}},i}(t)}.call(this),define("chosen",["jquery"],function(){}),define("ui/main-dialog/views/controls/font_family",["jquery","backbone","core/utils/is","core/utils/str","core/utils/retina","core/typecastError","hbs!../../templates/controls/font_family","underscore","chosen"],function(e,t,i,n,s,r,o,a){return t.View.extend({template:o,watched_attributes:["font-family","font-weight","font-style","font-feature-settings"],opentype_features_selected_class:"selected-icon",opentype_features_titles:null,events:{"click #font-selector-name":"toggleFontDialog","click #opentype-buttons a":"toggleOpentypeFeatures","change #font-selector-weight select":"selectFontFamilyWeight"},initialize:function(e){return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this.config=i(e.config,"object")?e.config:{},i(this.config.font_family,"object")&&i(this.config.font_family.opentype,"object")&&i(this.config.font_family.opentype.features,"object")&&(this.opentype_features_titles=this.config.font_family.opentype.features,Object.keys(this.opentype_features_titles).forEach(function(e){var t=e.match(/^([a-z]{2})(\d{2})-\1(\d{2})$/);return t?void(4===t.length&&a.range(Number(t[2]),Number(t[3])+1).forEach(function(i){var n=t[1]+(10>i?"0"+i:i);this.opentype_features_titles[n]=this.opentype_features_titles[e]+" "+i},this)):!1},this)),this},render:function(){var e,t,n,o,l,c,u,h,d,p,f,g,m=this.model.get("font"),v=[];if(i(m,"object")||(m={}),i(m.variations,"array")||(m.variations=[]),p=this.model.getCssPropertyForElement("font-family"),o=p.value,u=this.model.getCssPropertyForElement("font-style").value,c=this.model.getCssPropertyForElement("font-weight").value,f=this.model.getCssPropertyForElement("font-feature-settings"),!o)throw new r(101,"Main Dialog Font-Family Control render() :: Error while trying to read font-family from style declaration, expected string got: "+this.model.getValue("font-family"));return l=this._cleanFontFamilyName(o),m.variations_count=m.variations.length,i(m.opentype,"object")&&i(m.opentype.features,"array")&&m.opentype.features.length>0&&i(this.opentype_features_titles,"object")&&i(f.value,"string")&&m.opentype.features.forEach(function(e){var t=-1!==f.value.indexOf(e);v.push({name:e,title:this.config.font_family.opentype.features[e],inherited:t&&f.inherited,selected:t,selected_class:this.opentype_features_selected_class})},this),d=this._findActiveVariation(m,l,c,u),i(m.sprite_image_url,"string")&&(m.sprite=m.sprite_image_url,s.isRetinaDisplay()&&i(m.retina_sprite_image_url,"string")&&(m.sprite=m.retina_sprite_image_url)),m.has_multiple_variations=1!==m.variations_count,g=l.indexOf(" ")>=0?'"'+l+'"':l,t="font-family: "+g+";",i(u,"string")&&(t+=" font-style: "+u+";"),i(c,"string")&&(t+=" font-weight: "+c+";"),a.some(m.variations,function(t){return m.default_variation_id===t.id?(g=t.css_font_family.indexOf(" ")>=0?'"'+t.css_font_family+'"':t.css_font_family,e="font-family: "+g+";",i(t.style,"string")&&(e+=" font-style: "+t.style+";"),i(t.weight,"string")&&(e+=" font-weight: "+t.weight+";"),!0):!1}),i(e,"undefined")&&(e=t),n=this.template({font:m,variation_inherited:d&&p.inherited,opentype_features:v,css:{inherited:p.inherited,font_family_style:e,font_variation_style:t}}),this.$el.html(n),h=this.$("#font-selector-weight select"),d?(h.find("option[value='"+d.id+"']"),h.val(d.id)):m.default_variation_id&&h.val(m.default_variation_id),h.chosen({disable_search:!0}),this},selectFontFamilyWeight:function(){var t,s,r=parseInt(this.$("#font-selector-weight select").val(),10);return t=a(this.model.get("font").variations).find(function(e){return e.id===r}),i(t,"object")?(t.font_id=this.model.get("font").id,s=function(i){return i?!1:void setTimeout(e.proxy(function(){this.model.setCssPropertyForElement("font-family",n.wrapQuotes(t.css_font_family)),this._setIfDefined("font-weight",t.weight),this._setIfDefined("font-style",t.style)},this),100)},void this.trigger("font:variation-selected",t,s,this)):!1},_setIfDefined:function(e,t){return i(t,"string")?this.model.setCssPropertyForElement(e,t):this.model.removeCssPropertyFromElement([e]),!0},toggleFontDialog:function(){this.trigger("ui:font-dialog",{action:"toggle"})},toggleOpentypeFeatures:function(t){var i,n;return t.preventDefault(),e(t.currentTarget).toggleClass(this.opentype_features_selected_class),n=e(t.currentTarget).closest("ul").find("."+this.opentype_features_selected_class),n.length<1?(this._setIfDefined("font-feature-settings",null),!0):(i=a.map(n,function(t){return e(t).attr("data-value")}).join(", "),this._setIfDefined("font-feature-settings",i),!0)},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.render(),!0)},_cleanFontFamilyName:function(e){return e.replace(/['"]/g,"")},_findActiveVariation:function(e,t,n,s){var r;switch(n){case"normal":n="400";break;case"bold":n="700"}return r=a(e.variations).find(function(e){var i=e.css_font_family,r=e.weight,o=e.style;return i===t&&r===n&&o===s}),i(r,"object")||(r=a(e.variations).find(function(e){return e.css_font_family===t})),r},_getNativeValue:function(e){return!e.inherited&&i(e.value,"string")?e.value:!1}})}),define("hbs!ui/main-dialog/templates/controls/font_size",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div id="sliders-container">\n    <div class="cf">\n      <h3>Text size</h3>\n      <div id="font-size-selector"></div>\n    </div>\n\n    <div class="cf">\n      <h3>Line height</h3>\n      <div id="line-height-selector"></div>\n    </div>\n</div>\n'});return t.registerPartial("ui_main-dialog_templates_controls_font_size",i),i}),define("core/components/unitvalue/models/element-data",["backbone","core/utils/is","core/utils/unit"],function(e,t,i){"use strict";var n=e.Model.extend({defaults:{element_id:null,media_query_id:null,css_property:null,disable_views:null,units:null,step_amount:null,"default":null,value:null,is_inherited:null,precision:2},getDefaultValue:function(){var e=this.get("default");return e.value},getDefaultUnit:function(){var e=this.get("default");return e.unit},getDefaultPropertyValue:function(){return this.getDefaultValue()+this.getDefaultUnit()},getPropertyValue:function(){return this.get("value")||this.getDefaultPropertyValue()},setPropertyValue:function(e,i){var n;return t(e,"string")&&!(e.length<1)||t(e,"undefined")?(t(i,"object")||(i={}),n=this.get("css_property"),!t(n,"string")||n.length<1?!1:(this.set({value:e}),this.hasChanged("value")?(i.silent?this.trigger("render"):this.trigger("css:property:changed",n,e),!0):!1)):!1},resetPropertyValue:function(){return this.set({value:void 0}),!0},setPropertyValueByStyleDeclaration:function(e,i){var n,s,r;return t(e,"object")&&t(e.getValue,"function")?(s=this.get("css_property"),n=e.getValue(s),!t(n,"array")||n.length<1?r=this.getDefaultPropertyValue():(r=n[0],r.match(/^\d+$/)&&(r+=this.getDefaultUnit())),this.set({is_inherited:e.isInherited(s)}),this.setPropertyValue(r,i),!0):(this.resetPropertyValue(),!1)},getValueAndUnit:function(){var e,n=this.getPropertyValue();return!t(n,"string")||n.length<1?!1:(e=i.getValueAndUnit(n)||this.get("default"),t(e,"object")?e:!1)},getValue:function(){var e=this.getValueAndUnit();return t(e,"object")?e.value:!1},setValue:function(e){var i,n,s;return t(e,"string")?""===e?(this.setPropertyValue(),!0):e.match(/^-?\d+(\.\d*)?$/)?(i=this.round(e),s=i,n=this.getUnit(),t(n,"string")&&n.length>0&&(s+=n),this.setPropertyValue(s),!0):!1:!1},getPixelValue:function(){return this.getPixelValueByValueAndUnit(this.getPropertyValue())},getPixelValueByValueAndUnit:function(e){var n;return!t(e,"string")||e.length<1?!1:(n=i.convert({element_id:this.get("element_id"),media_query_id:this.get("media_query_id"),unit_to:"px",property:this.get("css_property"),value:e}),null===n?!1:this.round(n))},setPixelValue:function(e){var n,s,r,o,a;if(!t(e,"string")||e.length<1)return!1;if(!e.match(/^-?\d+(\.\d*)?$/))return!1;if(n=this.round(e),r=this.getUnit(),o=n+"px",!t(r,"string")||r.length<1)s=n,r="px";else if(s=i.convert({element_id:this.get("element_id"),media_query_id:this.get("media_query_id"),unit_to:r,property:this.get("css_property"),value:o}),null===s)return!1;return a=this.round(s)+r,this.setPropertyValue(a),!0},getUnit:function(){var e=this.getValueAndUnit();return t(e,"object")?e.unit:!1},setUnit:function(e){var n,s,r;return-1===this.get("units").indexOf(e)?!1:(n=this.getPropertyValue(),t(n,"string")?(r=i.convert({element_id:this.get("element_id"),media_query_id:this.get("media_query_id"),unit_to:e,property:this.get("css_property"),value:n}),null===r?!1:(s=r+e,this.setPropertyValue(s),!0)):!1)},getStepByUnit:function(e){var i,n=this.get("step_amount"),s="1";return t(n,"object")?(i=n[e],!t(i,"string")||i.length<1?s:i):s},getStep:function(){var e=this.getUnit();return this.getStepByUnit(e)},getPixelStep:function(){return this.getStepByUnit("px")},stepValue:function(e){var i,n,s;return-1===["increase","decrease"].indexOf(e)?!1:(i=this.getValue())?(n=this.getStep(),!t(n,"string")||n.length<1?!1:(s=parseFloat(i)+("increase"===e?+parseFloat(n):-parseFloat(n)),s=this.round(s),this.setValue(s),!0)):!1},setViewName:function(e){return!t(e,"string")||e.length<1?!1:(this.trigger("view:changed",e),!0)},round:function(e,t){return e=parseFloat(e),isNaN(e)?!1:(t=t>0?t:this.get("precision"),String(Math.round(e*Math.pow(10,t))/Math.pow(10,t)))}});return n}),define("hbs!core/components/unitvalue/templates/value",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<input type="text" value="',(r=i.value)?r=r.call(t,{hash:{}}):(r=t.value,r=typeof r===a?r.apply(t):r),o+=l(r)+'" class="value-input-box" title="Click to edit">\n'});return t.registerPartial("core_components_unitvalue_templates_value",i),i}),define("core/components/unitvalue/views/value",["jquery","backbone","hbs!../templates/value"],function(e,t,i){var n=t.View.extend({tagName:"div",className:"value",template:i,model:null,events:{"click input":"onClick","keypress input":"onEnter","change input":"onChange","blur input":"onChange"},render:function(){var e,t=this.getValue();return e=this.template({value:t}),this.$el.html(e),this},onClick:function(t){return e(t.currentTarget).select(),!0},onEnter:function(t){return 13===t.which&&e(t.currentTarget).blur(),!0},onChange:function(t){var i=e(t.currentTarget);return this.setValue(i.val()),!0},getValue:function(){return this.model.getValue()},setValue:function(e){return this.model.setValue(e),this.model.setViewName("value"),!0}});return n}),define("hbs!core/components/unitvalue/templates/unit",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        <option value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===c?n.apply(e):n),s+=u(n)+'"',n=i["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+=">",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===c?n.apply(e):n),s+=u(n)+"</option>\n    "}function o(e,t){return' selected="selected"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<select class="selection-unit-box" title="Click to change units">\n    ',a=i.each.call(t,t.options,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n</select>\n"});return t.registerPartial("core_components_unitvalue_templates_unit",i),i}),define("core/components/unitvalue/views/unit",["jquery","underscore","backbone","hbs!../templates/unit","chosen"],function(e,t,i,n){var s=i.View.extend({tagName:"div",className:"unit",template:n,model:null,events:{"change select":"onChange"},render:function(){var e,t,i;return i=this.getValue(),t=this._generateOptionsArray(i),e=this.template({options:t}),this.$el.html(e),this.$("select").chosen({disable_search:!0}),this},_generateOptionsArray:function(e){return t.map(this.model.get("units"),function(t){return{value:t,text:t,selected:e===t}},this)},onChange:function(t){var i=e(t.currentTarget);return this.setValue(i.val()),!0},getValue:function(){return this.model.getUnit()},setValue:function(e){var t=this.model.setUnit(e);return t?(this.model.setViewName("unit"),!0):!1}});return s}),define("hbs!core/components/unitvalue/templates/stepper",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<a href="#" class="decrease" title="Decrease value" data-icon="ÓÄñ">\n    <span class="decrease">\n        <span class="screen-reader-text">Decrease</span>\n    </span>\n</a>\n<a href="#" class="increase" title="Increase value" data-icon="ÓÄï">\n    <span class="increase">\n        <span class="screen-reader-text">Increase</span>\n    </span>\n</a>\n'});return t.registerPartial("core_components_unitvalue_templates_stepper",i),i}),define("core/components/unitvalue/views/stepper",["jquery","backbone","hbs!../templates/stepper"],function(e,t,i){var n=t.View.extend({tagName:"div",className:"stepper",template:i,model:null,events:{"click a":"onClick"},render:function(){return this.$el.html(this.template()),this},onClick:function(t){t.preventDefault();var i=e(t.currentTarget),n="decrease";return i.hasClass("increase")&&(n="increase"),this.stepValue(n),!0},stepValue:function(e){var t=this.model.stepValue(e);return t?(this.model.setViewName("stepper"),!0):!1}});return n}),define("hbs!core/components/unitvalue/templates/slider",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='max="',(n=i.max)?n=n.call(e,{hash:{}}):(n=e.max,n=typeof n===c?n.apply(e):n),s+=u(n)+'"'}function o(e,t){var n,s="";return s+='min="',(n=i.min)?n=n.call(e,{hash:{}}):(n=e.min,n=typeof n===c?n.apply(e):n),s+=u(n)+'"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<input class="slider" ',a=i["if"].call(t,t.max,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+=" ",a=i["if"].call(t,t.min,{hash:{},inverse:h.noop,fn:h.program(3,o,s)}),(a||0===a)&&(l+=a),l+=' step="',(a=i.step)?a=a.call(t,{hash:{}}):(a=t.step,a=typeof a===c?a.apply(t):a),l+=u(a)+'" type="range" value="',(a=i.value)?a=a.call(t,{hash:{}}):(a=t.value,a=typeof a===c?a.apply(t):a),l+=u(a)+'" title="Click and drag to adjust settings">\n'});return t.registerPartial("core_components_unitvalue_templates_slider",i),i}),define("core/components/unitvalue/views/slider",["jquery","backbone","core/utils/is","core/utils/unit","hbs!../templates/slider"],function(e,t,i,n,s){var r=t.View.extend({tagName:"div",className:"slider",template:s,model:null,events:{"change input":"onChange","input input":"onChange"},render:function(){var e,t=this.getValue(),s=this.model.get("range"),r=this.getStep(),o=this.model.get("default").unit,a=n.getValueAndUnit(String(s.min)),l=n.getValueAndUnit(String(s.max));return(!i(a.unit,"string")||a.unit.length<1)&&(a.unit=o),(!i(l.unit,"string")||l.unit.length<1)&&(l.unit=o),e=this.template({value:t,step:r,min:this.model.getPixelValueByValueAndUnit(a.value+a.unit),max:this.model.getPixelValueByValueAndUnit(l.value+l.unit)}),this.$el.html(e),this},onClick:function(t){return e(t.currentTarget).select(),!0},onChange:function(t){var i=e(t.currentTarget);return this.setValue(i.val()),!0},getStep:function(){return this.model.getPixelStep()},getValue:function(){return this.model.getPixelValue()},setValue:function(e){return this.model.setPixelValue(e),this.model.setViewName("slider"),!0}});return r}),define("core/components/unitvalue/index",["jquery","underscore","backbone","core/utils/is","core/typecastError","./models/element-data","./views/value","./views/unit","./views/stepper","./views/slider"],function(e,t,i,n,s,r,o,a,l,c){var u=i.View.extend({tagName:"div",className:"unit-value",views:null,model:null,css_property:null,disable_views:null,units:["px","em","%"],step_amount:{px:"1",em:"0.1","%":"1"},range:{min:"0",max:"100"},"default":{value:"0",unit:"px"},initialize:function(){var e;return this.views={},this.css_property=this.options.css_property||this.css_property||null,this.disable_views=this.options.disable_views||this.disable_views||[],this.units=this.options.units||this.units||[],this.step_amount=this.options.step_amount||this.step_amount||null,this.range=this.options.range||this.range||null,this["default"]=this.options["default"]||this["default"]||null,this.model=new r,n(this.css_property,"string")&&this.css_property.length&&n(this.disable_views,"array")&&n(this.units,"array")&&n(this.step_amount,"object")&&n(this.range,"object")&&n(this["default"],"object")?(this.model.set({css_property:this.css_property,disable_views:this.disable_views,units:this.units,step_amount:this.step_amount,range:this.range,"default":this["default"]}),e={value:o,unit:a,stepper:l,slider:c},t.each(e,function(e,t){-1===this.disable_views.indexOf(t)&&(this.views[t]=new e({model:this.model}))},this),this):!1},listenToEvents:function(){return this.stopListening(),this.listenTo(this.model,"view:changed",this.onChangeInChildView,this),this.listenTo(this.model,"render",this.render,this),this.listenTo(this.model,"css:property:changed",this.onChange,this),!0},setElementIdAndMediaQueryId:function(e,t){return this.model.set({element_id:void 0,media_query_id:void 0}),n(e,"string")&&e.length&&n(t,"string")&&t.length?(this.model.set({element_id:e,media_query_id:t}),!0):!1},setValueByStyleDeclaration:function(e){return this.model.setPropertyValueByStyleDeclaration(e,{silent:!0})},setValue:function(e){return this.model.set({is_inherited:!1}),this.model.setPropertyValue(e,{silent:!0})},changeUnits:function(e){return n(e,"array")?(this.model.set({units:e}),!0):!1},render:function(e){return this.$el.toggleClass("inherited",!!this.model.get("is_inherited")),t.each(e||this.views,function(t){t.delegateEvents(),e?this.$("."+t.className).replaceWith(t.render().$el):this.$el.append(t.render().$el)},this),this.listenToEvents(),this},onChangeInChildView:function(e){var i;return i=[e],"value"===e&&i.push("unit"),this.render(t.omit(this.views,i)),!0},onChange:function(e,t){return this.trigger("change",e,t),!0},remove:function(){return Object.keys(this.views).forEach(function(e){n(this.views[e].remove,"function")&&this.views[e].remove()},this),u.__super__.remove.apply(this,arguments),this}});return u}),define("ui/main-dialog/views/controls/unitvalue/font_size",["core/components/unitvalue/index"],function(e){return e.extend({css_property:"font-size",disable_views:[],step_amount:{px:"1",em:"0.1","%":"1"},range:{min:"8px",max:"120px"},"default":{value:"1",unit:"em"},precision:1})}),define("ui/main-dialog/views/controls/unitvalue/line_height",["core/components/unitvalue/index"],function(e){return e.extend({css_property:"line-height",disable_views:[],step_amount:{px:"1",em:"0.1","%":"1"},range:{min:"8px",max:"120px"},"default":{value:"1",unit:"em"},precision:1})}),function(){function e(){d.call(document.querySelectorAll("input[type=range]"),i),new MutationObserver(function(e){e.forEach(function(e){e.addedNodes&&d.call(e.addedNodes,function(e){t(e),e.childElementCount&&d.call(e.querySelectorAll("input"),t)})})}).observe(document,{childList:!0,subtree:!0})}function t(e){"input"==e.localName&&"range"!=e.type&&"range"==e.getAttribute("type")&&i(e)}function i(e){function t(e){if(C=!0,setTimeout(function(){C=!1},0),!e.button&&D){var t=parseFloat(getComputedStyle(this,0).width),n=(t-l.width)/D;if(n){var r=e.clientX-this.getBoundingClientRect().left-l.width/2-(T-A)*n;Math.abs(r)>l.radius&&(w=!0,this.value-=-r/n),E=T,S=e.clientX,this.addEventListener("mousemove",i,!0),this.addEventListener("mouseup",s,!0)}}}function i(e){var t=parseFloat(getComputedStyle(this,0).width),i=(t-l.width)/D;i&&(E+=(e.clientX-S)/i,S=e.clientX,w=!0,this.value=E)}function s(){this.removeEventListener("mousemove",i,!0),this.removeEventListener("mouseup",s,!0)}function r(e){e.keyCode>36&&e.keyCode<41&&(d.call(this),w=!0,this.value=T+(38==e.keyCode||39==e.keyCode?F:-F))}function d(){C||(this.style.boxShadow=a?"inset 0 0 20px rgba(0,127,255,.1), 0 0 1px rgba(0,127,255,.4)":"0 0 0 2px #fb0")}function f(){this.style.boxShadow=""}function g(e){return!isNaN(e)&&+e==parseFloat(e)}function m(){A=g(e.min)?+e.min:0,k=g(e.max)?+e.max:100,A>k&&(k=A>100?A:100),F=g(e.step)&&e.step>0?+e.step:1,D=k-A,y(!0)}function v(){_||b||(T=e.getAttribute("value")),g(T)||(T=(A+k)/2),T=Math.round((T-A)/F)*F+A,A>T?T=A:T>k&&(T=A+~~(D/F)*F)}function y(t){if(v(),w&&T!=x&&e.dispatchEvent(p),w=!1,t||T!=x){x=T;var i=D?(T-A)/D*100:0,s="-moz-element(#__sliderthumb__) "+i+"% no-repeat, ";n(e,{background:s+c})}}var _,b,w,C,x,E,S,A,k,F,D,T=e.value;o||(o=document.body.appendChild(document.createElement("hr")),
n(o,{"-moz-appearance":a?"scale-horizontal":"scalethumb-horizontal",display:"block",visibility:"visible",opacity:1,position:"fixed",top:"-999999px"}),document.mozSetImageElement("__sliderthumb__",o));var $=function(){return""+T},B=function j(t){T=""+t,_=!0,y(),delete e.value,e.value=T,e.__defineGetter__("value",$),e.__defineSetter__("value",j)};e.__defineGetter__("value",$),e.__defineSetter__("value",B),e.__defineGetter__("type",function(){return"range"}),["min","max","step"].forEach(function(t){e.hasAttribute(t)&&(b=!0),e.__defineGetter__(t,function(){return this.hasAttribute(t)?this.getAttribute(t):""}),e.__defineSetter__(t,function(e){null===e?this.removeAttribute(t):this.setAttribute(t,e)})}),e.readOnly=!0,n(e,u),m(),new MutationObserver(function(t){t.forEach(function(t){"value"!=t.attributeName?(m(),b=!0):_||(T=e.getAttribute("value"),y())})}).observe(e,h),e.addEventListener("mousedown",t,!0),e.addEventListener("keydown",r,!0),e.addEventListener("focus",d,!0),e.addEventListener("blur",f,!0)}function n(e,t){for(var i in t)e.style.setProperty(i,t[i],"important")}var s=document.createElement("input");try{if(s.type="range","range"==s.type)return}catch(r){return}if(s.style.background="linear-gradient(red, red)",s.style.backgroundImage&&"MozAppearance"in s.style&&document.mozSetImageElement&&this.MutationObserver){var o,a="MacIntel"==navigator.platform,l={radius:a?9:6,width:a?22:12,height:a?16:20},c="linear-gradient(transparent "+(a?"6px, #999 6px, #999 7px, #ccc 8px, #bbb 9px, #bbb 10px, transparent 10px":"9px, #999 9px, #bbb 10px, #fff 11px, transparent 11px")+", transparent)",u={"min-width":l.width+"px","min-height":l.height+"px","max-height":l.height+"px",padding:"0 0 "+(a?"2px":"1px"),border:0,"border-radius":0,cursor:"default","text-indent":"-999999px"},h={attributes:!0,attributeFilter:["min","max","step","value"]},d=Array.prototype.forEach,p=document.createEvent("HTMLEvents");p.initEvent("change",!0,!1),"loading"==document.readyState?document.addEventListener("DOMContentLoaded",e,!0):e()}}(),define("html5slider",function(){}),define("ui/main-dialog/views/controls/font_size",["jquery","backbone","core/typecastError","core/utils/is","core/utils/unit","hbs!../../templates/controls/font_size","./unitvalue/font_size","./unitvalue/line_height","html5slider","chosen"],function(e,t,i,n,s,r,o,a){return t.View.extend({template:r,watched_attributes:["font-size","line-height"],views:{font_size:null,line_height:null},events:{},initialize:function(){if(!n(this.model,"object"))throw new i(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this.initView("font_size",o),this.initView("line_height",a),this},render:function(){return this.updateUiValues(),this.$el.html(this.template()),this.$("#font-size-selector").html(this.views.font_size.render().$el),this.$("#line-height-selector").html(this.views.line_height.render().$el),this},updateUiValues:function(){var e=this.model.get("style_declaration");return this.views.font_size.setValueByStyleDeclaration(e),this.views.line_height.setValueByStyleDeclaration(e),!0},setModelValues:function(e,t){return n(t,"string")&&n(e,"string")||n(t,"undefined")?n(t,"undefined")?this.model.removeCssPropertyFromElement([e]):this.model.setCssPropertyForElement(e,t):!1},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.updateUiValues(),!0)},initView:function(e,t){this.views[e]=new t,this.views[e].setElementIdAndMediaQueryId(this.model.get("id"),this.model.get("style_declaration").getMediaQueryId()),this.listenTo(this.views[e],"change",this._onValueChange,this)},_onValueChange:function(e,t){t?this.model.getCssPropertyForElement(e).value!==t&&this.setModelValues(e,t):this.model.removeCssPropertyFromElement([e],null,this.handleStylesUpdate,this)},remove:function(){return Object.keys(this.views).forEach(function(e){n(this.views[e].remove,"function")&&this.views[e].remove()},this),t.View.prototype.remove.apply(this,arguments),this}})}),define("hbs!ui/main-dialog/templates/controls/transform",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="extra-options cf" id="main-dialog-extra-options">\n    <div id="text-alignment-new" class="controls-standard">\n        <h3>Text Align</h3>\n        <ul class="button-controls"> \n            <li title="Text align left"><label id="align-left" class="text-left" data-value="left" title="Text align left">#</label></li> \n            <li title="Text align centre"><label id="align-center" class="text-centre" data-value="center" title="Text align center">#</label></li> \n            <li title="Text align justify"><label id="align-justify" class="text-justified" data-value="justify" title="Text align justify">#</label></li>\n            <li title="Text align right"><label id="align-right" class="text-right" data-value="right" title="Text align right">#</label></li> \n        </ul>\n    </div>\n\n    <div id="text-transform-new" class="controls-standard">\n        <h3>Text Transform</h3>\n        <ul class="text-alignment button-controls cf">\n            <li><a href="#" id="transform-capitalize" class="transform-capitalize" data-value="capitalize" title="Text transform capitalize"><span>Capitalize</span></a></li>\n            <li><a href="#" id="transform-uppercase" class="transform-uppercase" data-value="uppercase" title="Text transform uppercase"><span>Uppercase</span></a></li>\n            <li><a href="#" id="transform-lowercase" class="transform-lowercase" data-value="lowercase" title="Text transform lowercase"><span>Lowercase</span></a></li>\n            <li><a href="#" id="transform-none" class="transform-none selected-icon" data-value="none" title="Text transform none"><span>None</span></a></li>\n        </ul>\n    </div><!-- /text-transform -->\n</div>'});return t.registerPartial("ui_main-dialog_templates_controls_transform",i),i}),define("ui/main-dialog/views/controls/transform",["backbone","core/typecastError","core/utils/is","hbs!../../templates/controls/transform"],function(e,t,i,n){return e.View.extend({template:n,watched_attributes:["text-align","text-transform"],events:{"click #text-alignment-new label":"changeTextAlignment","click #text-transform-new a":"changeTextTransform"},initialize:function(){if(!i(this.model,"object"))throw new t(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this},render:function(){this.$el.html(this.template());var e=this.model.getCssPropertyForElement("text-align");i(e,"object")&&e.value&&this.changeActiveButton("#text-alignment-new label",this.$("#text-alignment-new label[data-value='"+e.value+"']"));var t=this.model.getCssPropertyForElement("text-transform");return i(t,"object")&&t.value&&this.changeActiveButton("#text-transform-new a",this.$("#text-transform-new a[data-value='"+t.value+"']")),this},changeTextAlignment:function(e){var t,i;e.preventDefault(),t=this.$(e.currentTarget),i=t.data("value"),this.isActiveButton(t)&&(t=null,i=null),this.model.setCssPropertyForElement("text-align",i),this.changeActiveButton("#text-alignment-new label",t)},changeTextTransform:function(e){var t,i;e.preventDefault(),t=this.$(e.currentTarget),i=t.data("value"),this.isActiveButton(t)&&(t=null,i=null),this.model.setCssPropertyForElement("text-transform",i),this.changeActiveButton("#text-transform-new a",t)},changeActiveButton:function(e,t){this.$(e).removeClass("selected-icon"),t&&t.addClass("selected-icon")},isActiveButton:function(e){return e&&i(e.hasClass,"function")&&e.hasClass("selected-icon")?!0:!1},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.render(),!0)}})}),define("core/utils/image",["jquery","core/utils/is","core/typecastError"],function(e,t,i){return{onLoad:function(n,s,r){var o;return n instanceof HTMLImageElement&&t(s,"function")?n.complete?(s.call(r),!0):(o=e(n),o.one("load",function(){s.call(r)}),o.one("error",function(){s.call(r,new i(100,"There was an error when loading the image"))}),!0):!1}}}),define("hbs!ui/main-dialog/templates/controls/image",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+="Image size:\n<strong>",(r=i.scale)?r=r.call(t,{hash:{}}):(r=t.scale,r=typeof r===a?r.apply(t):r),o+=l(r)+"%</strong>\n(of ",(r=i.width)?r=r.call(t,{hash:{}}):(r=t.width,r=typeof r===a?r.apply(t):r),o+=l(r)+" x ",(r=i.height)?r=r.call(t,{hash:{}}):(r=t.height,r=typeof r===a?r.apply(t):r),o+=l(r)+"px)\n"});return t.registerPartial("ui_main-dialog_templates_controls_image",i),i}),define("ui/main-dialog/views/controls/image",["jquery","underscore","backbone","core/utils/is","core/utils/dom","core/utils/image","core/typecastError","hbs!../../templates/controls/image"],function(e,t,i,n,s,r,o,a){"use strict";var l=i.View.extend({template:a,className:"controls-image",watched_attributes:["width","height"],initialize:function(){if(!n(this.model,"object"))throw new o(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.render(),!0)},getImageData:function(){var t,i,r,o,a,l;return t=this.model.get("attributes"),n(t,"object")?!n(t.src,"string")||t.src.length<1?!1:(a=s.getElement(this.model.get("style_declaration").getMediaQueryId(),this.model.get("id")),1!==a.length?!1:(i=e("<img/>",{src:t.src}),r=i.get(0).width,o=i.get(0).height,l=Math.round(a.width()/r*100),{scale:l,width:r,height:o})):!1},render:function(){var e=s.getElement(this.model.get("style_declaration").getMediaQueryId(),this.model.get("id")).get(0);return r.onLoad(e,function(){var e=this.getImageData();return n(e,"object")?void this.$el.html(this.template(e)):!1},this),this}});return l}),define("hbs!ui/main-dialog/templates/controls/background-image",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return"Edit"}function o(e,t){return"Add"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c=this;return l+="<span>",a=i["if"].call(t,t.is_image_set,{hash:{},inverse:c.program(3,o,s),fn:c.program(1,r,s)}),(a||0===a)&&(l+=a),l+=" background image...</span>\n"});return t.registerPartial("ui_main-dialog_templates_controls_background-image",i),i}),define("ui/main-dialog/views/controls/background-image",["jquery","backbone","core/utils/is","core/utils/dom","core/typecastError","hbs!../../templates/controls/background-image"],function(e,t,i,n,s,r){"use strict";var o=t.View.extend({template:r,className:"controls-background-image",watched_attributes:["background","background-image"],events:{click:"onClick"},initialize:function(){if(!i(this.model,"object"))throw new s(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this.handleStylesUpdate,this),this},onClick:function(){return this.model.trigger("background-image:toggle"),!0},handleStylesUpdate:function(e,t){return"styles"!==this.model.get("source")?!1:-1===this.watched_attributes.indexOf(t)?!1:(this.render(),!0)},render:function(){var e="none"!==this.model.get("style_declaration").getValue("background-image")[0];return this.$el.toggleClass("has-image",e),this.$el.html(this.template({is_image_set:e})),this}});return o}),define("hbs!ui/main-dialog/templates/controls/box-model/main",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var i="";return i+='\n    <li data-control="'+c(typeof e===l?e.apply(e):e)+'"><h4>'+c(typeof e===l?e.apply(e):e)+"</h4></li>\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<div class="box-model-switcher">\n  <ul>\n    ',o=i.each.call(t,t.controls,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+='\n  </ul>\n</div>\n\n<div class="box-model-controls-available">\n\n</div>\n'});return t.registerPartial("ui_main-dialog_templates_controls_box-model_main",i),i}),define("hbs!ui/main-dialog/templates/controls/box-model/control",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t,n){var s,r,l="";return l+='\n  <label class="'+p((s=e.id,typeof s===d?s.apply(e):s))+'" data-tooltips-title="Add '+p((s=n.property,typeof s===d?s.apply(e):s))+" "+p((s=e.label,typeof s===d?s.apply(e):s))+'" data-tooltips-side="top">\n    <span class="lock" style="display: ',r=i["if"].call(e,e.show,{hash:{},inverse:f.program(4,a,t),fn:f.program(2,o,t)}),(r||0===r)&&(l+=r),l+=';"></span>\n    <span class="input" style="display: ',r=i["if"].call(e,e.show,{hash:{},inverse:f.program(2,o,t),fn:f.program(4,a,t)}),(r||0===r)&&(l+=r),l+=';">\n      <div id="box-model-'+p((s=n.property,typeof s===d?s.apply(e):s))+"-"+p((s=e.id,typeof s===d?s.apply(e):s))+'-input-editable" class="controls-range">\n        <div class="element-switch">\n        </div>\n      </div>\n    </span>\n  </label>\n  '}function o(e,t){return"none"}function a(e,t){return"inline-block"}function l(e,t){return" active"}function c(e,t){var n,s="";return s+='\n    <div class="image-thumbnail layout-visual" style="background-image: url(',(n=i.image_src)?n=n.call(e,{hash:{}}):(n=e.image_src,n=typeof n===d?n.apply(e):n),s+=p(n)+')" title="Image Thumbnail"></div>\n  '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var u,h="",d="function",p=this.escapeExpression,f=this;return h+='<div class="box-model-controls-',(u=i.property)?u=u.call(t,{hash:{}}):(u=t.property,u=typeof u===d?u.apply(t):u),h+=p(u)+'">\n\n  ',u=i.each.call(t,t.controls,{hash:{},inverse:f.noop,fn:f.programWithDepth(r,s,t)}),(u||0===u)&&(h+=u),h+='\n\n  <div style="',(u=i.border_radius_style)?u=u.call(t,{hash:{}}):(u=t.border_radius_style,u=typeof u===d?u.apply(t):u),h+=p(u)+'" class="margin-border layout-visual ',u=i["if"].call(t,t.is_margin,{hash:{},inverse:f.noop,fn:f.program(6,l,s)}),(u||0===u)&&(h+=u),h+='" title="Margin"></div>\n  <div style="',(u=i.border_radius_style)?u=u.call(t,{hash:{}}):(u=t.border_radius_style,u=typeof u===d?u.apply(t):u),h+=p(u)+'" class="border-width-border layout-visual ',u=i["if"].call(t,t.is_border,{hash:{},inverse:f.noop,fn:f.program(6,l,s)}),(u||0===u)&&(h+=u),h+='" title="Border"></div>\n  <div style="',(u=i.border_radius_style)?u=u.call(t,{hash:{}}):(u=t.border_radius_style,u=typeof u===d?u.apply(t):u),h+=p(u)+'" class="padding-border layout-visual ',u=i["if"].call(t,t.is_padding,{hash:{},inverse:f.noop,fn:f.program(6,l,s)}),(u||0===u)&&(h+=u),h+='" title="Padding"></div>\n  <div style="',(u=i.border_radius_style)?u=u.call(t,{hash:{}}):(u=t.border_radius_style,u=typeof u===d?u.apply(t):u),h+=p(u)+'" class="border-radius-border layout-visual ',u=i["if"].call(t,t.is_border_radius,{hash:{},inverse:f.noop,fn:f.program(6,l,s)}),(u||0===u)&&(h+=u),h+='" title="Radius"></div>\n\n  ',u=i["if"].call(t,t.is_image,{hash:{},inverse:f.noop,fn:f.program(8,c,s)}),(u||0===u)&&(h+=u),h+="\n\n</div>\n"});return t.registerPartial("ui_main-dialog_templates_controls_box-model_control",i),i}),define("ui/main-dialog/models/box-model-control-data",["backbone","underscore"],function(e,t){return e.Model.extend({defaults:function(){return{top:"0px",right:"0px",bottom:"0px",left:"0px",all:"0px",source:"",ordered_properties:["top","right","bottom","left","all"]}},setProperty:function(e,t,i){return t?(this.set("source",i,{silent:!0}),"all"===e&&this.set(this.parseIntoIndividualValues(t)),this.set(e,t),!0):!1},getProperty:function(e){return this.get(e)},getStyle:function(){var e=this.getAttributesAsArray();return e[0]===e[1]&&e[0]===e[2]&&e[0]===e[3]?e[0]:e[0]===e[2]&&e[1]===e[3]?e[0]+" "+e[1]:e.join(" ")},parseIntoIndividualValues:function(e){var t=e.split(" "),i=this.get("ordered_properties"),n={};return n[i[0]]=t[0],n[i[1]]=t[1]||t[0],n[i[2]]=t[2]||t[0],n[i[3]]=t[3]||t[1]||t[0],n},isGeneralValueSet:function(){var e=this.getAttributesAsArray();return e[0]===e[1]&&e[0]===e[2]&&e[0]===e[3]&&parseFloat(e[0])>0},isZeroValue:function(){var e=this.getAttributesAsArray(),i=t(e).map(parseFloat),n=i.reduce(function(e,t){return e+t},0);return 0===n},getAttributesAsArray:function(){return t.map(this.get("ordered_properties").slice(0,-1),function(e){return this.get(e)},this)}})}),define("ui/main-dialog/views/controls/unitvalue/box-model-control",["core/components/unitvalue/index"],function(e){return e.extend({disable_views:["slider","stepper"],step_amount:{px:"1",em:"0.1","%":"1"},range:{min:"0",max:"120"},"default":{value:"0",unit:"px"},precision:1})}),define("ui/main-dialog/models/border-radius-model-control-data",["backbone","underscore","./box-model-control-data"],function(e,t,i){return i.extend({defaults:function(){return{"top-left":"0px","top-right":"0px","bottom-right":"0px","bottom-left":"0px",all:"0px",source:"",ordered_properties:["top-left","top-right","bottom-right","bottom-left","all"]}}})}),define("ui/main-dialog/views/controls/box-model/control",["underscore","backbone","jquery","core/utils/is","core/utils/dom","core/typecastError","hbs!../../../templates/controls/box-model/control","core/utils/unit","../../../models/box-model-control-data","../unitvalue/box-model-control","../../../models/border-radius-model-control-data"],function(e,t,i,n,s,r,o,a,l,c,u){return t.View.extend({template:o,property_name:null,control_model:null,$elements:null,$attributes:null,$aliases:null,$controls:null,max_percent_value:30,events:{"click .lock":"toggleInputStructure","click .layout-visual":"focusCorrespondingInput","mouseenter .all .lock":"showInputStructureChangeHint","mouseleave .all .lock":"hideInputStructureChangeHint"},initialize:function(){if(!n(this.property_name,"string")||this.property_name.length<1)throw new r(102,"property_name is mandatory.");if(!n(this.model,"object"))throw new r(101,"Element Data Model is mandatory.");return this.$elements={},this.$attributes={},this.$controls={},this._initControlModel(),this._setupOrderedProperties(),this.$attributes=this._initAttributesNames(),this.$aliases=this._initAttributesAliases(),this._setupControls(),this._loadCurrentStyles(),this},render:function(){var t,i={all:{label:"on all sides",show:!1}};return t=this.template({property:this.property_name,controls:e.map(this.ordered_properties,function(e){return n(i[e],"undefined")?{id:e,label:e,show:!0}:{id:e,label:i[e].lable,show:i[e].show}}),image_src:this.model.getAttribute("src"),is_image:this.model.isImageElement(),is_margin:"margin"===this.property_name,is_padding:"padding"===this.property_name,is_border:"border-width"===this.property_name,is_border_radius:"border-radius"===this.property_name,border_radius_style:this._getBorderRadiusStyle()}),this.$el.html(t),this._initDomReferences(),this._loadCurrentStyles(),this._initControlsValues(),this.ordered_properties.forEach(function(e){this.$("#box-model-"+this.property_name+"-"+e+"-input-editable .element-switch").html(this.$controls[e].render().$el)},this),this._showControls(),this._addListeners(),this.delegateEvents(),this},showInputStructureChangeHint:function(){return this.$el.parent().addClass("hint"),this},hideInputStructureChangeHint:function(){return this.$el.parent().removeClass("hint"),this},toggleInputStructure:function(e){var t=i(e.currentTarget).parent();return t.hasClass("all")?this._showAllControl():this._showIndividualControls(),this},_showControls:function(){return n(this.control_model,"object")?(this.control_model.isGeneralValueSet()?this._showAllControl():this._showIndividualControls(),!0):!1},_showAllControl:function(){var e=this.$("label.all");this.$(".lock").css("display","inline-block"),e.find(".lock").hide(),this.$(".input").hide(),e.find(".input").show()},_showIndividualControls:function(){this.$(".lock").hide(),this.$(".all .lock").css({display:"inline-block"}),this.$(".input").show(),this.$(".all .input").hide()},focusCorrespondingInput:function(e){var t=i(e.target),n=e.pageX-t.offset().left,s=e.pageY-t.offset().top,r=t.outerWidth(),o=t.outerHeight(),a=.15*r,l=.15*o,c=this._getPositionFromLayoutVisual(n,s,r,o,a,l);return c?this._triggerInputFocus(c):this},remove:function(){return this.hideInputStructureChangeHint(),this._teardownControls(),this.$el.undelegate(),t.View.prototype.remove.apply(this,arguments),this},_initDomReferences:function(){return this.ordered_properties.forEach(function(e){this.$elements[this.$attributes[e]]={input:this.$("label."+e+" input"),select:this.$("label."+e+" select")}},this),this},_getBorderRadiusStyle:function(){var e,t,i=this.model.getCssPropertyForElement("border-radius"),s=new u,r={},o="%",l=this;return n(i,"object")&&n(i.value,"string")&&i.value?(e=s.parseIntoIndividualValues(i.value),t=Object.keys(e),t.forEach(function(t){var i=a.convert({element_id:l.model.get("id"),media_query_id:l.model.get("style_declaration").getMediaQueryId(),unit_to:o,property:"border-radius",value:e[t]});i=i>l.max_percent_value?l.max_percent_value:i,r[t]=i+o}),s.set(r),i.name+":"+s.getStyle()):""},_initControlModel:function(){return this.control_model=new l,this},_setupOrderedProperties:function(){return this.ordered_properties=this.control_model.get("ordered_properties"),!0},_loadCurrentStyles:function(){this._readFromStyleDeclaration()},_readFromStyleDeclaration:function(){var t=this.model.get("style_declaration"),i=Object.keys(t.getStyleDeclaration().attributes);i.forEach(function(i){var n,s=this.model.getValue(i),r=this;this.$aliases&&this.ordered_properties.forEach(function(n){return i!==this.$aliases[n]||t.isInherited(this.$aliases[n])?void 0:(i=this.$attributes[n],s=s.split(" ")[0],t.inherited=e.without(t.inherited,this.$attributes[n]),!1)},this),i===this.$attributes.all?(n=e.uniq(s.split(/\s+/)),1===n.length&&(s=n[0],t.style_declaration.attributes[this.$attributes.all]=[s]),this.control_model.setProperty("all",s,"styles"),t.isInherited(this.$attributes.all)||(t.inherited=e.difference(t.inherited,e.map(this.ordered_properties.slice(0,-1),function(e){return r.$attributes[e]})),this.ordered_properties.forEach(function(e){t.style_declaration.attributes[this.$attributes[e]]=[this.control_model.getProperty(e)]},this))):this.ordered_properties.slice(0,-1).forEach(function(e){return i===this.$attributes[e]?(this._propagateIfNotInherited(e,s,this.model.getCssPropertyForElement(this.$attributes[e]).inherited),!1):void 0},this)},this)},_isStyleDeclarationRuleOverwritten:function(t,i,n){var s=this.$attributes[n],r=this.$aliases[n],o=e.max([i.indexOf(s),i.indexOf(r)]),a=e.max([i.indexOf(this.$attributes.all),i.indexOf(this.$aliases.all)]),l=o>a;return l&&!t.isInherited(i[o])},_propagateIfNotInherited:function(e,t,i){return i?!1:(this.control_model.setProperty(e,t,"styles"),!0)},_addListeners:function(){return this.listenTo(this.control_model,"change",this._onControlModelChange,this),this.ordered_properties.forEach(function(e){this.listenTo(this.model,"css:attribute:changed:"+this.$attributes[e],this._readFromStyleDeclaration,this),this.$aliases&&this.listenTo(this.model,"css:attribute:changed:"+this.$aliases[e],this._readFromStyleDeclaration,this),this._addControlListener(e)},this),this},_getPositionFromLayoutVisual:function(e,t,i,n,s,r){var o=!1;return s>e&&e>-s&&(o="left"),i+s>e&&e>i-s&&(o="right"),r>t&&t>-r&&(o="top"),n+r>t&&t>n-r&&(o="bottom"),o},_onControlModelChange:function(){var t,i=this.control_model.get("source"),n=this.model.get("style_declaration");return"ui"===i&&this.model.removeCssPropertyFromElement(e.map(this.ordered_properties.slice(0,-1),function(e){return this.$attributes[e]},this),{silent:!0},function(){this.model.setCssPropertyForElement(this.$attributes.all,this.control_model.getStyle())},this),"styles"===i&&this.ordered_properties.forEach(function(e){this.control_model.hasChanged(e)&&this.$controls[e].setValueByStyleDeclaration(n)},this),t=this.$el.find("."+this.property_name+"-border"),0===parseFloat(this.control_model.getStyle())?t.removeClass("set"):t.addClass("set"),this._showControls(),!0},_triggerInputFocus:function(e){return this.$elements[this.$attributes[e]].input.focus(),this},_setModelValues:function(e,t){return n(t,"string")&&n(e,"string")?this.model.setCssPropertyForElement(e,t):!1},_getAttributeName:function(e){return s._getSuffixedAttributeName(this.property_name,e)},_initAttributesNames:function(){var e={};return this.ordered_properties.forEach(function(t){e[t]=this._getAttributeName(t)},this),e},_initAttributesAliases:function(){if(!n(this.property_name_css_alias,"string")||this.property_name_css_alias.length<=0)return!1;var e={};return this.ordered_properties.forEach(function(t){e[t]=s._getSuffixedAttributeName(this.property_name_css_alias,t)},this),e},_initControl:function(e,t){return n(this.$controls[e],"object")?this.$controls[e].remove():this.$controls[e]=new t({css_property:this.$attributes[e]}),this.$controls[e].setElementIdAndMediaQueryId(this.model.get("id"),this.model.get("style_declaration").getMediaQueryId()),!0},_addControlListener:function(e){return this.listenTo(this.$controls[e],"change",this._onControlChange(e),this),!0},_onControlChange:function(e){var t=this;return function(i,n){return n?t.control_model.getProperty(e)!==n&&t.control_model.setProperty(e,n,"ui"):(t.model.removeCssPropertyFromElement([i],null,t._readFromStyleDeclaration,t),"all"!==e&&(t.control_model.setProperty(e,"0px","ui"),t.control_model.isZeroValue()&&t.model.removeCssPropertyFromElement([t.$attributes.all],null,t._readFromStyleDeclaration,t))),!0}},_initControlsValues:function(){var e=this.model.get("style_declaration");return this.ordered_properties.forEach(function(t){this.$controls[t].setValueByStyleDeclaration(e)},this),!0},_setupControls:function(){return this.ordered_properties.forEach(function(e){this._initControl(e,c)},this),!0},_teardownControls:function(){return this.ordered_properties.forEach(function(e){this.$controls[e].remove()},this),!0}})}),define("ui/main-dialog/views/controls/box-model/margin",["./control"],function(e){return e.extend({property_name:"margin"})}),define("ui/main-dialog/views/controls/box-model/padding",["./control"],function(e){return e.extend({property_name:"padding"})}),define("ui/main-dialog/views/controls/box-model/border",["./control"],function(e){return e.extend({property_name:"border-width",property_name_css_alias:"border"})}),define("ui/main-dialog/views/controls/box-model/border-radius",["./control","../../../models/border-radius-model-control-data"],function(e,t){return e.extend({property_name:"border-radius",_initControlModel:function(){return this.control_model=new t,this},_getPositionFromLayoutVisual:function(e,t,i,n,s,r){var o=!1;return r>t&&t>-r?o="top":n+r>t&&t>n-r&&(o="bottom"),o?(s>e&&e>-s?o+="-left":i+s>e&&e>i-s&&(o+="-right"),o):!1}})}),define("hbs!ui/main-dialog/templates/controls/box-model/border-color",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<!-- Color picker depends on coming soon colorpicker widget -->\n<div class="colour-swatch" data-ns-tooltip="Border color">\n  <div class="controls-colour-selected">\n    <div class="thumb-preview">\n      <div></div>\n    </div>\n  </div>\n</div>\n'});return t.registerPartial("ui_main-dialog_templates_controls_box-model_border-color",i),i}),define("ui/main-dialog/views/controls/box-model/border-color",["backbone","jquery","core/utils/is","core/typecastError","hbs!../../../templates/controls/box-model/border-color"],function(e,t,i,n,s){return e.View.extend({className:"box-model-controls-border-color",template:s,events:{"click div.colour-swatch":"toggleColorDialog"},value:null,initialize:function(){if(!i(this.model,"object"))throw new n(101,"Element Data Model is mandatory.");return this},render:function(){return this.$el.html(this.template()),this.listenTo(this.model,"css:attribute:changed:border-color",this._handleStylesChanges),this._handleStylesChanges(),this},remove:function(){return this.trigger("ui:colour-dialog",{action:"close"}),this.stopListening(),e.View.prototype.remove.apply(this,arguments)},toggleColorDialog:function(){this.trigger("ui:colour-dialog",{action:"toggle",color:this.value,callback:this._handleUiChanges,callback_context:this})},_handleUiChanges:function(e){return this.value=e,this._updateDomColor(e),this.model.removeCssPropertyFromElement(["border-top-color","border-right-color","border-bottom-color","border-left-color"]),this.model.setCssPropertyForElement("border-color",this.value),!0},_handleStylesChanges:function(){this.value=this._readFromStyleDeclaration(),this._updateDomColor(this.value)},_updateDomColor:function(e){return this.$(".thumb-preview div").css("background-color",e),!0},_readFromStyleDeclaration:function(){var e=this.model.getValue("border-color");return e!==!1?e:"inherit"}})}),define("hbs!ui/main-dialog/templates/controls/box-model/border-style",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var i="";return i+='\n  <li class="btn '+c(typeof e===l?e.apply(e):e)+'" data-style="'+c(typeof e===l?e.apply(e):e)+'" title="Border-style: '+c(typeof e===l?e.apply(e):e)+'"><span>'+c(typeof e===l?e.apply(e):e)+"</span></li>\n  "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<ul class="border-style-options">\n  ',o=i.each.call(t,t.available_styles,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+="\n</ul>\n"});return t.registerPartial("ui_main-dialog_templates_controls_box-model_border-style",i),i}),define("ui/main-dialog/views/controls/box-model/border-style",["backbone","underscore","jquery","core/utils/is","core/typecastError","hbs!../../../templates/controls/box-model/border-style"],function(e,t,i,n,s,r){return e.View.extend({className:"box-model-controls-border-style",classActive:"active",template:r,default_value:"solid",available_styles:["solid","dashed","dotted","none"],events:{"click ul.border-style-options li":"handleUiChanges"},value:"none",initialize:function(){if(!n(this.model,"object"))throw new s(101,"Element Data Model is mandatory.");return this.listenTo(this.model,"css:attribute:changed",this._setDefaultIfNeeded,this),this},render:function(){return this.$el.html(this.template({available_styles:this.available_styles})),this.listenTo(this.model,"css:attribute:changed:border-style",this._handleStylesChanges),this._handleStylesChanges(),this},handleUiChanges:function(e){var t=i(e.currentTarget),n=this._getValidBorderStyleValue(t.data("style"));return t.hasClass(this.classActive)?!1:(this.setActiveValue(n),!0)},setActiveValue:function(e){return this._highlightActiveStyleElement(e),this._populateUiChanges(e),!0},_populateUiChanges:function(e){return this.value=e,this.model.removeCssPropertyFromElement(["border-style-top","border-style-right","border-style-bottom","border-style-left"]),this.model.setCssPropertyForElement("border-style",e),!0},_handleStylesChanges:function(){return this.value=this._readFromStyleDeclaration(),this._highlightActiveStyleElement(this.value),!0},_highlightActiveStyleElement:function(e){this.$("ul.border-style-options li[data-style='"+e+"']").addClass(this.classActive).siblings().removeClass(this.classActive)},_readFromStyleDeclaration:function(){var e=this.model.getValue("border-style");return e!==!1?this._getValidBorderStyleValue(e):"none"},_getValidBorderStyleValue:function(e){return this.available_styles.indexOf(e)>-1?e:"none"},_setDefaultIfNeeded:function(e,t){var i,s,r=["border-width","border-width-top","border-width-right","border-width-bottom","border-width-left"];return-1===r.indexOf(t)?!1:(i=this.model.getCssPropertyForElement(t),!n(i.value,"string")||i.value.length<=0?!1:(s=this._getMaxValue(i.value),(!this.value||"none"===this.value)&&s>0&&this.setActiveValue(this.default_value),
!0))},_getMaxValue:function(e){var i=e.split(" "),n=t(i).map(parseFloat);return t(n).max()}})}),define("ui/main-dialog/views/controls/box-model/border-style-and-color",["backbone","jquery","core/utils/is","core/typecastError","./border-color","./border-style"],function(e,t,i,n,s,r){return e.View.extend({className:"box-model-controls-border-more-settings",views_prototypes:{style:r,color:s},views:{},initialize:function(){if(!i(this.model,"object"))throw new n(101,"Element Data Model is mandatory.");return this},render:function(){return this._renderChildView("style"),this._renderChildView("color"),this._addListeners(),this},hide:function(){return this.trigger("ui:colour-dialog",{action:"close"}),this.$el.hide(),!0},show:function(){return this.$el.show(),!0},remove:function(){return Object.keys(this.views).forEach(function(e){i(this.views[e].remove,"function")&&this.views[e].remove()},this),e.View.prototype.remove.apply(this,arguments)},_renderChildView:function(e){return i(this.views_prototypes[e],"function")?(i(this.views[e],"object")&&(this.views[e].remove(),delete this.views[e]),this.views[e]=new this.views_prototypes[e]({model:this.model}),this.$el.append(this.views[e].render().$el),!0):!1},_addListeners:function(){return this.listenTo(this.views.color,"ui:colour-dialog",this._notifyColourDialog,this),!0},_removeListeners:function(){return this.stopListening(this.views.color),!0},_notifyColourDialog:function(e){return this.trigger("ui:colour-dialog",e),!0}})}),define("ui/main-dialog/views/controls/box-model/main",["backbone","jquery","underscore","core/utils/is","core/typecastError","hbs!../../../templates/controls/box-model/main","./control","./margin","./padding","./border","./border-radius","./border-style-and-color"],function(e,t,i,n,s,r,o,a,l,c,u,h){return e.View.extend({tagName:"div",className:"box-model-controls",template:r,views:{},activeView:"",controls:["margin","border","radius","padding"],watched_attributes:["margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","width","height","border-width","border-top-width","border-right-width","border-bottom-width","border-left-width","border","border-top","border-right","border-bottom","border-left","border-color","border-style","border-radius","border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],views_prototypes:{margin:a,padding:l,border:c,radius:u,"border-style-and-color":h},events:{"click .box-model-switcher li":"onClickBoxModelSwitcher"},initialize:function(){if(!n(this.model,"object"))throw new s(101,"Element Data Model is mandatory.");return this.views.margin=new a({model:this.model}),this.views.padding=new l({model:this.model}),this},render:function(){var e=this.template({controls:this.controls});return this.$el.html(e),this.trigger("get:active-box-model-control",function(e){e=e||"margin",this.setActiveView(e)},this),this},onClickBoxModelSwitcher:function(e){var i,n=t(e.currentTarget);return this._isControlActive(n)?!1:(e&&(i=this._getControlName(n)),this.setActiveView(i),!0)},setActiveView:function(e){var t=this.activeView;if(this._makeControlActive(e),e===t)return!1;if(!n(this.views_prototypes[e],"function"))throw new s(101,"Expected view to be in ['padding', 'margin', 'border', 'radius'] got: '"+e+"'");return this._hideSubView(t),this._showSubView(e),this.activeView=e,this.trigger("set:active-box-model-control",e),this._addSetClasses(),this},remove:function(){var t=Object.keys(this.views);return t.forEach(function(e){this.views[e].remove()},this),this.$el.undelegate(),e.View.prototype.remove.apply(this,arguments),this},_notifyMarginPaddingPreviewer:function(e,t){return"border"!==e?(this.trigger("ui:margin-padding-previewer",e,t),!0):!1},_hideSubView:function(e){return e?(this._doHideChildView(e),this._hideRelatedSubView(e),this._notifyMarginPaddingPreviewer(e,"hide"),!0):!1},_showSubView:function(e){return this._doShowChildView(e),this._showRelatedSubView(e),this._notifyMarginPaddingPreviewer(e,"show"),!0},_doShowChildView:function(e){return this._createChildViewInstance(e),this.views[e].render().$el.appendTo(this.$el.find(".box-model-controls-available")),!0},_createChildViewInstance:function(e){return n(this.views[e],"object")||(this.views[e]=new this.views_prototypes[e]({model:this.model})),!0},_doHideChildView:function(e){return n(this.views[e],"object")?(this.views[e].remove(),!0):!1},_showRelatedSubView:function(e){return"border"!==e?!1:(this._doShowChildView("border-style-and-color"),this.listenTo(this.views["border-style-and-color"],"ui:colour-dialog",this._notifyColourDialog,this),!0)},_hideRelatedSubView:function(e){return"border"!==e?!1:(this._doHideChildView("border-style-and-color"),!0)},_getControlName:function(e){return e.data("control")},_isControlActive:function(e){return e.hasClass("active")},_makeControlActive:function(e){return this.$("li[data-control='"+e+"']").addClass("active").siblings().removeClass("active"),!0},_notifyColourDialog:function(e){return this.trigger("ui:colour-dialog",e),!0},_addSetClasses:function(){var e=i.keys(this.views),t=this.views[this.activeView];e.forEach(function(e){var i=this.views[e];i instanceof o&&!i.control_model.isZeroValue()&&t.$el.find("."+e+"-border").addClass("set")},this)}})}),define("hbs!ui/main-dialog/templates/main",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="main-dialog tpa-main-dialog" id="dialog-main">\n    <div class="drag-handle"></div>\n    <div class="dialog-head" id="main-dialog-head"></div>\n    <div class="dialog-body"></div>\n    <div class="dialog-foot"></div>\n</div>'});return t.registerPartial("ui_main-dialog_templates_main",i),i}),define("ui/main-dialog/views/main",["jquery","backbone","core/utils/is","core/typecastError","./controls/breadcrumbs","./controls/colours","./controls/font_family","./controls/font_size","./controls/transform","./controls/image","./controls/background-image","./controls/box-model/main","hbs!../templates/main"],function(e,t,i,n,s,r,o,a,l,c,u,h,d){return t.View.extend({config:null,template:d,id:"dialog-main-wrapper-new",className:"dialog no-selection closed is-dragged",is_being_dragged:!1,mouse_last_x:0,mouse_last_y:0,active_box_model_control:null,views:null,control_view_definitions:{breadcrumbs:s,colour_swatches:r,font_family:o,font_size:a,image:c,box_model:h,background_image:u},events:{"mousedown .drag-handle":"startDrag",mouseenter:"onMouseenter"},initialize:function(e){if(this.views={},!i(this.model,"object"))throw new n(101,"You must pass in an Element Data Model.");if(!i(e,"object")||!i(e.config,"object"))throw new n(102,"You must pass in a config.");if(!i(e.config.controls,"object")||!i(e.config.controls.defaults,"array"))throw new n(103,"The config must define default control views e.g. 'config.controls.defaults = [\"breadcrumbs\"]'.");return this.config=e.config,this._populateWatchedAttributes(),this},render:function(){var e=this.template();return this.$el.html(e),this},startDrag:function(t){t.preventDefault(),this.is_being_dragged=!0,this.mouse_last_x=parseInt(t.clientX,10),this.mouse_last_y=parseInt(t.clientY,10),e(document).on("mousemove.main-dialog",e.proxy(this,"mouseMovement")),e(document).one("mouseup",e.proxy(this,"stopDrag"))},onMouseenter:function(){return i(window.Aloha,"object")&&window.Aloha.trigger("aloha-smart-content-changed"),!0},stopDrag:function(t){t.preventDefault(),this.is_being_dragged=!1,e(document).off("mousemove.main-dialog")},mouseMovement:function(e){if(!this.is_being_dragged)return!1;var t,i,n=parseInt(e.clientX,10),s=parseInt(e.clientY,10),r=parseInt(this.$el.css("left"),10),o=parseInt(this.$el.css("top"),10),a=0,l=50,c=parseInt(window.innerWidth,10)-parseInt(this.$el.width(),10),u=parseInt(window.innerHeight,10)-150;return t=r+(n-this.mouse_last_x),i=o+(s-this.mouse_last_y),a>t&&(t=a),l>i&&(i=l),t>c&&(t=c),i>u&&(i=u),this.$el.css({top:i,left:t}),this.mouse_last_x=n,this.mouse_last_y=s,this.max_top=u,!0},switchActiveElement:function(){var e,t,n;if(!i(this.model,"object"))return!1;if(e=this.model.get("tag_name"),!i(e,"string")||e.length<1)return!1;if(this.removeChildViews(),t=this.getControlsForTagName(e),this.$(".main-dialog").removeClass("img"),"img"===e.toLowerCase()){if(n=this.model.get("attributes"),!i(n,"object"))return!1;-1!==n.src.indexOf(this.config.placeholders_path)&&t.splice(t.indexOf("image"),1),this.$(".main-dialog").addClass("img")}return t.forEach(function(e){i(this.control_view_definitions[e],"function")&&(this.views[e]=new this.control_view_definitions[e]({model:this.model,config:this.config}),"box_model"===e&&(this.listenTo(this.views.box_model,"ui:margin-padding-previewer",function(e,t){this.trigger("ui:margin-padding-previewer",e,t)}),this.listenTo(this.views.box_model,"set:active-box-model-control",this._setActiveBoxModelControl),this.listenTo(this.views.box_model,"get:active-box-model-control",this._getActiveBoxModelControl),this.listenTo(this.views.box_model,"ui:colour-dialog",function(e){this.trigger("ui:colour-dialog",e)},this)),"font_family"===e&&(this.listenTo(this.views.font_family,"ui:font-dialog",function(e){this.trigger("ui:font-dialog",e)},this),this.listenTo(this.views.font_family,"font:variation-selected",function(e,t,i){this.trigger("font:variation-selected",e,t,i)},this)),"colour_swatches"===e&&this.listenTo(this.views.colour_swatches,"ui:colour-dialog",function(e){this.trigger("ui:colour-dialog",e)},this),"breadcrumbs"===e&&this.listenTo(this.views.breadcrumbs,"ui:element-dialog",function(e){this.trigger("ui:element-dialog",e)},this),this.views[e].render(),-1!==["breadcrumbs","font_family","font_weight"].indexOf(e)?this.$(".dialog-head").append(this.views[e].$el):this.$(".dialog-body").append(this.views[e].$el))},this),this.show(),!0},show:function(){this.$el.addClass("opened").removeClass("closed")},hide:function(){this.$el.addClass("closed").removeClass("opened")},getControlsForTagName:function(e){var t;return t=-1!==Object.keys(this.config.controls).indexOf(e)?this.config.controls[e]:this.config.controls.defaults,t.slice()},removeChildViews:function(){return i(this.views.box_model,"object")&&this.stopListening(this.views.box_model),i(this.views.font_family,"object")&&this.stopListening(this.views.font_family),i(this.views.colour_swatches,"object")&&this.stopListening(this.views.colour_swatches),Object.keys(this.views).forEach(function(e){this.views[e].remove()},this),this.stopListening(),this},remove:function(){return this.removeChildViews(),t.View.prototype.remove.apply(this,arguments)},_setActiveBoxModelControl:function(e){return this.active_box_model_control=e,!0},_getActiveBoxModelControl:function(e,t){return i(e,"function")?(e&&e.call(t,this.active_box_model_control),!0):!1},_populateWatchedAttributes:function(){return Object.keys(this.control_view_definitions).forEach(function(e){var t=this.control_view_definitions[e];if(i(t,"function")){var n=t.prototype.watched_attributes;i(n,"array")&&this.model.addWatchedAttributes(n)}},this),!0}})}),define("ui/main-dialog/index",["jquery","backbone","underscore","./models/element-data","core/utils/is","./views/main"],function(e,t,i,n,s,r){return t.UIController.extend({namespace:"ui:main-dialog",model:null,views:null,listeners:i.extend({},t.UIController.prototype.listeners,{"[remote]data:styles:changed":"handleStyleUpdates","[remote]data:styles:deleted:styleDeclaration":"handleStyleDelete"}),initialize:function(){this.views={},this.model=new n,this.listenTo(this.model,"css:attribute:changed",this.updateStyles),this.listenTo(this.model,"css:attribute:remove",this.removeFromStyles),this.listenTo(this.model,"inherit:from:parent",this.inheritFromParent),this.listenTo(this.model,"select:element",this.selectElement),this.listenTo(this.model,"change:font",this.onChangeFont),this.listenTo(this.model,"background-image:toggle",this.toggleBackgroundImageDialog),this.views.main=new r({model:this.model,config:this.config}),this.listenTo(this.views.main,"ui:margin-padding-previewer",this._notifyMarginPaddingPreviewer,this),this.listenTo(this.views.main,"ui:colour-dialog",this._notifyColourDialog,this),this.listenTo(this.views.main,"ui:font-dialog",this._notifyFontDialog,this),this.listenTo(this.views.main,"font:variation-selected",this._loadFontVariation,this),this.listenTo(this.views.main,"ui:element-dialog",this._notifyElementSelectionDialog,this),this.render(),this.imc.trigger(this.namespace+":ready")},render:function(){this.views.main.render(),e(this.app_el).append(this.views.main.$el)},onChangeActiveElement:function(e,t){return s(t,"element")&&this.stopListening(this.imc,"data:elements:updated:element:"+t.getElement().id),s(e,"element")?(this.listenTo(this.imc,"data:elements:updated:element:"+e.getElement().id,function(e){this.active_element=e,this.fetchElementBreadcrumbs(this.active_element)}),this.fetchElementBreadcrumbs(e),!0):(this.views.main.hide(),!1)},fetchElementBreadcrumbs:function(e){var t;return s(e,"element")?(t=e.getElement().id,this.imc.trigger("data:elements:getElementBreadcrumbs",t,function(i,n){return i?void this.log("error","Main Dialog :: Error fetching element breadcrumbs"+t):void this.fetchStyleDeclarationForElement(e,n)},this),!0):!1},fetchStyleDeclarationForElement:function(e,t){return s(this.active_media_query,"object")?(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,e.getSelector(),{element_id:e.element.id,attributes:this.model.get("watched_attributes")},function(i,n){var s;return i?(this.log("error",{message:"Main Dialog :: Error fetching element style declaration",active_style_id:this.active_style_id,selector:e.getSelector(),element_id:e.element.id,element:e.getElement(),breadcrumbs:t,watched_attributes:this.model.get("watched_attributes"),error:i}),!1):(s=e.getElement(),s.selector=e.getSelector(),s.breadcrumbs=t,s.style_declaration=n,this.model.setElementData(s),void this.getFontDataForActiveElement())},this),!0):!1},getFontDataForActiveElement:function(){var e=this.model.getCssPropertyForElement("font-family");return s(e,"object")||this.log("error","Error reading font-family attribute from styles got: "+e),this._obtainFontData(e.value,this.views.main.switchActiveElement,this.views.main),!0},_obtainFontData:function(e,t,i){var n;if(s(e,"array"))n=e[0];else{if(!s(e,"string"))return!1;n=e}return this.imc.trigger("data:fonts:getByCssFontFamily",n,function(e,s){e&&(this.log("error","Error contacting fonts data module for font: "+n),s={name:n,name_clean:n,css_font_family:n,opentype:null,variations:[{name:"Regular",name_clean:"Regular",css_font_family:n,weight:"400",style:"normal"},{name:"Italic",name_clean:"Italic",css_font_family:n,weight:"400",style:"italic"},{name:"Bold",name_clean:"Bold",css_font_family:n,weight:"700",style:"normal"},{name:"Bold Italic",name_clean:"Bold Italic",css_font_family:n,weight:"700",style:"italic"}]}),this.model.set({font:s}),t&&t.call(i)},this),!0},updateStyles:function(e,t,i){var n={};return s(this.active_media_query,"object")?"styles"===this.model.get("source")?!1:(n[t]=[i],this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,e,n),!0):!1},removeFromStyles:function(e,t,i,n,r){return s(this.active_media_query,"object")?(n=s(n,"function")?n:null,r=r||null,this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,e,t,i,n,r),this.fetchElementBreadcrumbs(this.active_element),!0):!1},inheritFromParent:function(e){return s(this.active_media_query,"object")?(this.imc.trigger("data:styles:deleteStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,e),this.model.set({style_declaration:{}}),this.fetchElementBreadcrumbs(this.active_element),!0):!1},selectElement:function(e){return this.imc.trigger("data:state:set","active-element",e),!0},onChangeFont:function(e){var t,i;return t=e.get("updated_attributes"),!s(t,"array")||t.length<1?!1:-1===t.indexOf("font-family")?!1:(i=e.get("font"),s(i,"object")?s(i.opentype,"object")&&s(i.opentype.features,"array")&&i.opentype.features.length>0?!1:(e.removeCssPropertyFromElement(["font-feature-settings"]),!0):!1)},toggleBackgroundImageDialog:function(){return this.imc.trigger("ui:background-image-dialog:toggle"),!0},remove:function(){return Object.keys(this.views).forEach(function(e){s(this.views[e].remove,"function")&&this.views[e].remove()},this),t.UIController.__super__.remove.apply(this,arguments)},handleStyleUpdates:function(e,t,n,r,o){var a,l;return e!==this.active_style_id?!1:s(this.active_media_query,"object")&&t===this.active_media_query.getMediaQuery().id?(a=this.model.get("watched_attributes"),0===a.length?!1:(l=i.intersection(o,a),0===l.length?!1:(this.model.set({updated_attributes:l}),this.imc.trigger("data:styles:getStyleDeclarationBySelector",e,t,this.active_element.selector,{element_id:this.model.get("id"),attributes:a},this.propagateStyleUpdates,this),!0))):!1},handleStyleDelete:function(){var e=this.model.get("selector"),t=this.model.get("id"),i=this.model.get("watched_attributes");return s(this.active_media_query,"object")?!s(e,"string")||e.length<1?!1:!s(t,"string")||t.length<1?!1:!s(i,"array")||i.length<1?!1:(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,e,{element_id:t,attributes:i},this.propagateStyleUpdates,this),!0):!1},propagateStyleUpdates:function(e,t){return e?(this.log("error","Main Dialog :: Error fetching element style declaration",e),!1):s(t,"object")&&s(t.getStyleDeclaration,"function")&&s(t.getValue,"function")&&s(t.isInherited,"function")?(this.model.set({style_declaration:t}),this.model.get("updated_attributes").forEach(function(e){var t=this.model.getValue(e);"font-family"===e?this._obtainFontData(t,function(){this.model.setCssPropertyForElement(e,t,"styles")},this):this.model.setCssPropertyForElement(e,t,"styles")},this),!0):(this.log("error","Main Dialog :: Invalid style declaration object",t),!1)},_notifyMarginPaddingPreviewer:function(e,t){return this.imc.trigger("ui:margin-padding-previewer:"+t),!0},_notifyColourDialog:function(e){return"close"===e.action?this.imc.trigger("ui:colour-dialog:close"):this.imc.trigger("ui:colour-dialog:"+e.action,e.color,e.callback,e.callback_context),!0},_notifyFontDialog:function(e){return s(e,"object")&&s(e.action,"string")&&e.action.length>0?(this.imc.trigger("ui:font-dialog:"+e.action),!0):!1},_loadFontVariation:function(e,t,i){return s(e,"object")?(this.imc.trigger("ui:font-loader:load",e.font_id,e.id,t,i),!0):!1},_notifyElementSelectionDialog:function(e){return s(e,"object")&&s(e.action,"string")&&e.action.length>0?(this.imc.trigger("ui:element-dialog:"+e.action),!0):!1}})}),define("ui/keyboard-shortcuts/index",["jquery","backbone","underscore","core/utils/is"],function(e,t,i,n){var s=t.UIController.extend({namespace:"ui:keyboard-shortcuts",shortcutBindings:{esc:function(){this.imc.trigger("ui:project:review-mode")},"ctrl+s":function(e){e.preventDefault(),this.imc.trigger("data:project:saveProject")},"ctrl+z":function(e){e.preventDefault()},"ctrl+y":function(e){e.preventDefault()},"ctrl+shift+z":function(e){e.preventDefault()},"meta+s":function(e){e.preventDefault(),this.imc.trigger("data:project:saveProject")},"meta+z":function(e){e.preventDefault()},backspace:function(t){if(this.repeatedKeydown=!1,!e(t.target).is("body"))return!0;var i=confirm("Do you really want to leave application?");n(i,"boolean")&&!i&&t.preventDefault()}},specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"meta",93:"meta",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},decodeKeyEvent:function(e){if(!n(e,"object"))return null;var t,i,s=[],r=!1,o=e.keyCode;return this.specialKeys[o]?(t=this.specialKeys[o],("ctrl"===t||"alt"===t||"meta"===t||"shift"===t)&&(r=!0)):t=String.fromCharCode(o).toLowerCase(),e.ctrlKey&&s.push("ctrl"),e.altKey&&s.push("alt"),e.metaKey&&s.push("meta"),e.shiftKey&&s.push("shift"),r||s.push(t),i=s.join("+")},keyDownHandler:function(e){var t=this.decodeKeyEvent(e);if(t&&n(this.shortcutBindings[t],"function")){if(!this.repeatedKeydown)return this.repeatedKeydown=!0,i.bind(this.shortcutBindings[t],this)(e);e.preventDefault()}},keyUpHandler:function(){this.repeatedKeydown=!1},beforeUnloadHandler:function(){return""},initialize:function(){this.repeatedKeydown=!1,e(document).on("keydown.typecast.shortcuts-ctrl",i.bind(this.keyDownHandler,this)),e(document).on("keyup.typecast.shortcuts-ctrl",i.bind(this.keyUpHandler,this))},destroy:function(){e(document).off("keydown.typecast.shortcuts-ctrl"),e(document).off("keyup.typecast.shortcuts-ctrl")}});return s}),define("ui/font-loader/index",["jquery","underscore","backbone","core/utils/is","core/utils/cast","core/typecastError"],function(e,t,i,n,s,r){return i.UIController.extend({namespace:"ui:font-loader",listeners:{"[remote]data:fonts:active-font-loaded":"loadActiveFont","[remote]ui:font-dialog:font-selected":"loadFontById",load:"loadFontById"},_loaded_fonts:null,_loading_fonts:null,_web_font_loader:null,_typekit_loader:null,_domain:window.location.hostname,initialize:function(){var e=this._getGlobalDependencies();if(!e.web_font_loader)throw this.log("error","The web font loader is a hard dependency."),new r(101,"The web font loader is a hard dependency.");if(!e.typekit_loader)throw this.log("error","The typekit loader is a hard dependency."),new r(102,"The typekit loader is a hard dependency.");if(this._web_font_loader=e.web_font_loader,this._typekit_loader=e.typekit_loader,!n(this.config.providers,"object"))throw this.log("error","The config supplied does not contain loading details for webfont providers."),new r(103,"The config supplied does not contain loading details for webfont providers.");if(!n(this.config.providers.typekit,"object")||!n(this.config.providers.typekit.loader,"object"))throw this.log("error","The config supplied does not contain Typekit loader setup details."),new r(104,"The config supplied does not contain Typekit loader setup details.");n(this.config.font_loading_timeout,"number")||(this.config.font_loading_timeout=1e4),n(this.config.font_data_timeout,"number")||(this.config.font_data_timeout=1e4),this._typekit_loader.setup({auth_id:this.config.providers.typekit.loader.auth_id,auth_token:this.config.providers.typekit.loader.auth_token,default_subset:this.config.providers.typekit.loader.subset}),this._loaded_fonts={},this._loading_fonts={},this.announce("ready")},loadActiveFont:function(e){var t;return n(e,"object")?(this.loadFontById(e.id),n(e.active_variations,"array")?(t=e.active_variations,delete e.active_variations,void t.forEach(function(t){var i;return n(t,"object")?(i=s(t.id,"number"),n(i,"number")?void this.loadFont(e,i):(this.log("error","Variation Id in active variation object is not a number"),!1)):(this.log("error","Variation in active variations array is not an object"),!1)},this)):(delete e.active_variations,this.loadFont(e))):(this.log("error","Font data provided is not an object"),!1)},loadFontById:function(e,t,i,o){var a,l;return i=n(i,"function")?i:!1,e=s(e,"number"),n(e,"number")?(l={id:s(e,"string")},this.imc.trigger("data:fonts:query",l,null,function(a,l){var c,u,h,d;return a?(h="Font data provider has returned an error",h+=a instanceof r?" -  Error code: "+a.getCode()+", Message: "+a.getMessage():" - "+a,d=new r(102,h),i&&i.call(o,d,!1),!1):n(l,"object")?(c=this._generateVariationMapping(l.variations),n(c,"object")?(u=c.get(l.default_variation_id),n(u,"object")?(l.id=s(l.id,"number"),e!==l.id?(d=new r(106,"Requested font id and response data do not match"),i&&i.call(o,d,!1),!1):(this.loadFont(l,t,{},i,o),!0)):(d=new r(105,"Unable to retrieve details for default variation."),i&&i.call(o,d,!1),!1)):(d=new r(104,"Unable to generate variation mapping from font data provided."),i&&i.call(o,d,!1),!1)):(d=new r(103,"Font data provided is not an object."),i&&i.call(o,d,!1),!1)},this),!0):(a=new r(101,"Font id provided is not a number."),i&&i.call(o,a,!1),!1)},loadFont:function(e,t,i,o,a){var l,c,u;return o=n(o,"function")?o:!1,n(e,"object")?(t=s(t||e.default_variation_id,"number"),n(t,"number")?(c=this._generateVariationMapping(e.variations),n(c,"object")?(u=c.get(t),n(u,"object")?(e.id=s(e.id,"number"),e.default_variation_id=s(e.default_variation_id,"number"),u.id=s(u.id,"number"),n(u.weight,"undefined")||n(u.weight,"null")||(u.weight=s(u.weight,"string")),n(e.id,"number")?(u.font_id=e.id,this._isVariationLoaded(u)?this._completeFontLoading(u,i,o,a):(this._load(e,u,i,o,a),!0)):(l=new r(105,"Font data id provided is not a number"),o&&o.call(a,l,!1),!1)):(l=new r(104,"Unable to retrieve details for specified variation."),o&&o.call(a,l,!1),!1)):(l=new r(103,"Unable to generate variation mapping from font data provided."),o&&o.call(a,l,!1),!1)):(l=new r(102,"Unable to determine variation from paramters or font data provided"),o&&o.call(a,l,!1),!1)):(l=new r(101,"Font data provided is not an object"),o&&o.call(a,l,!1),!1)},_getGlobalDependencies:function(){var e={web_font_loader:window.WebFont,typekit_loader:window.TypekitPreview};return e},_load:function(e,t,i,s,o){var a,l,c,u,h,d=this;return"system"===e.provider?(u=this._getVariationCssFontFamily(e,t),this._isSystemFontInstalled(u)&&this._setVariationLoaded(t),this._completeFontLoading(t,i,s,o)):(this._setVariationLoadTimeout(t,function(){d._webFontInactive(e,t,i,s,o)}),c={fontactive:function(n){var r=d._getVariationCssFontFamily(e,t);n=n.split(":")[0],r===n&&d._webFontActive(e,t,i,s,o)}},a=this._generateVariationLoadData(e,t),n(a,"object")?(this._loadExternalCssDependancies(a.external_css_dependencies),l=a.settings,"typekit"===e.provider?this._typekit_loader.load(l.typekit.webFonts,c):(l.fontactive=c.fontactive,l.active=c.active,l.inactive=c.inactive,this._web_font_loader.load(l)),!0):(h=new r(101,"Unable to generate loading data."),s&&s.call(o,h,!1),!1))},_webFontActive:function(e,t,i,n,s){return this._clearVariationLoadTimeout(t),this._setVariationLoaded(t),this._completeFontLoading(t,i,n,s)},_webFontInactive:function(e,t,i,n,s){return this._completeFontLoading(t,i,n,s)},_completeFontLoading:function(e,t,i,s){var o;return this._isVariationLoaded(e)?(i&&i.call(s,null,!0),n(t,"object")&&t.silent===!0||this.announce("font-active",e),!0):(o=new r(101,"Unable to load font."),i&&i.call(s,o,!1),this.announce("font-inactive",e),!1)},_generateVariationLoadData:function(e,t){var i,s,r,o={},a=[];if(!n(e,"object"))return this.log("error","Invalid font_data provided."),!1;if(!n(t,"object"))return this.log("error","Invalid variation_data provided."),!1;if(s=this._getVariationCssFontFamily(e,t),!n(s,"string")||""===s)return this.log("error","Unable to retrieve CSS font-family value for the variation and font data provided."),!1;switch(r=this._minifyStyleWeight(t.style,t.weight),e.provider){case"google":case"fontdeck":case"monotype":case"webtype":case"myfonts":o.custom={families:[],urls:[]},i=this._createCssUrl(e.provider,s,t),n(i,"string")&&i.length>0&&a.push(i),o.custom.families.push(s+(r!==!1?":"+r:""));break;case"typekit":o.typekit={webFonts:[]},o.typekit.webFonts.push({id:e.unique_id,variations:r!==!1?[r]:[],css_name:s,subset:this.config.providers.typekit.loader.subset});break;default:return this.log("error",'Unsupported provider "'+e.provider+'" for font "'+e.font_family+'".'),!1}return{external_css_dependencies:a,settings:o}},_getVariationCssFontFamily:function(e,t){return n(t,"object")&&n(t.css_font_family,"string")&&t.css_font_family.length>0?t.css_font_family:n(e,"object")&&n(e.css_font_family,"string")&&e.css_font_family.length>0?e.css_font_family:!1},_isVariationLoaded:function(e){var t,i;return n(e,"object")?(t=this._loaded_fonts[e.font_id],n(t,"object")?(i=t[e.id],i===!0):!1):!1},_setVariationLoaded:function(e){return n(e,"object")?(n(this._loaded_fonts[e.font_id],"object")||(this._loaded_fonts[e.font_id]={}),this._loaded_fonts[e.font_id][e.id]=!0,!0):!1},_setVariationLoadTimeout:function(e,t){var i;return n(e,"object")&&n(t,"function")?(n(this._loading_fonts[e.font_id],"object")||(this._loading_fonts[e.font_id]={}),i=setTimeout(t,this.config.font_loading_timeout),this._loading_fonts[e.font_id][e.id]=i,!0):!1},_clearVariationLoadTimeout:function(e){var i,s;return n(e,"object")?(i=this._loading_fonts[e.font_id],n(i,"object")?(s=i[e.id],n(s,"undefined")?!1:(clearTimeout(s),delete this._loading_fonts[e.font_id][e.id],t.isEmpty(this._loading_fonts[e.font_id])&&delete this._loading_fonts[e.font_id],!0)):!1):!1},_createCssUrl:function(e,t,i){if(!n(e,"string")||""===e)return!1;if(!n(t,"string")||""===t)return!1;if(!n(i,"object"))return!1;switch(e){case"google":return this._createCssUrlGoogle(t,i);case"fontdeck":return this._createCssUrlFontdeck(t,i);case"monotype":return this._createCssUrlFontscom(t,i);case"webtype":return this._createCssUrlWebtype(t,i);case"myfonts":return this._createCssUrlMyfonts(t,i);default:return!1}},_createCssUrlGoogle:function(e,t){return n(this.config.providers.google,"object")?(e=e.replace(/ /g,"+"),n(t.weight,"string")&&t.weight.length>0&&n(t.style,"string")&&t.style.length>0&&(e+=":"+t.weight+t.style),this.config.providers.google.css_url+e+this.config.providers.google.css_extension):(this.log("error","The config supplied does not contain Google Webfonts CSS loading details."),!1)},_createCssUrlFontdeck:function(e,t){return n(this.config.providers.fontdeck,"object")?n(t.collection_id,"string")&&""!==t.collection_id?this.config.providers.fontdeck.css_url+t.collection_id.split("{domain}").join(this._domain)+this.config.providers.fontdeck.css_extension:(this.log("error","The variation data supplied does not contain a collection Id for loading a Fontdeck font."),!1):(this.log("error","The config supplied does not contain Fontdeck CSS loading details."),!1)},_createCssUrlFontscom:function(e,t){return n(this.config.providers.monotype,"object")?n(t.font_id,"number")?this.config.providers.monotype.css_url+t.font_id+this.config.providers.monotype.css_extension:(this.log("error","The variation data supplied does not contain a font Id for loading a Fonts.com font."),!1):(this.log("error","The config supplied does not contain Fonts.com CSS loading details."),!1)},_createCssUrlWebtype:function(e,t){return n(this.config.providers.webtype,"object")?n(t.collection_id,"string")&&""!==t.collection_id?this.config.providers.webtype.css_url+t.collection_id+this.config.providers.webtype.css_extension:(this.log("error","The variation data supplied does not contain a collection Id for loading a Webtype font."),!1):(this.log("error","The config supplied does not contain Webtype CSS loading details."),!1)},_createCssUrlMyfonts:function(e,t){return n(this.config.providers.myfonts,"object")?n(t.collection_id,"string")&&""!==t.collection_id?this.config.providers.myfonts.css_url+t.collection_id+this.config.providers.myfonts.css_extension:(this.log("error","The variation data supplied does not contain a collection Id for loading a MyFonts font."),!1):(this.log("error","The config supplied does not contain MyFonts CSS loading details."),!1)},_minifyStyleWeight:function(e,t){return n(e,"string")&&""!==e&&n(t,"string")&&""!==t?e.charAt(0).toLowerCase()+t.charAt(0).toLowerCase():!1},_generateVariationMapping:function(e){var t={};return n(e,"array")?(e.forEach(function(e){var i;return n(e,"object")?(i=s(e.id,"number"),n(i,"number")?void(t[i]=e):!1):!1},this),t.get=function(e){return e=s(e,"number"),
n(e,"number")?t[e]:!1},t):!1},_loadExternalCssDependancies:function(t){var i;return n(t,"array")?(i=e("head"),t.forEach(function(e){0===i.children('link[href="'+e+'"]').length&&i.append('<link href="'+e+'" rel="stylesheet" />')},this),!0):!1},_isSystemFontInstalled:function(e){var t,i,s,r,o,a;return n(e,"string")&&""!==e?(e=e.replace(/['"<>]/g,""),-1!==e.indexOf(" ")&&(e="'"+e+"'"),t=document.body,i=document.createElement("div"),s=!1,o="display:inline !important; width:auto !important; font-style:normal !important; font-weight:normal !important; font-size:10px !important; line-height:1 !important; font-family:{{ font_family }},",r='<b style="'+o+' sans-serif !important">ii</b><b style="'+o+' monospace !important">ii</b>',i.innerHTML=r.replace(/\{\{ font_family \}\}/g,e),i.style.cssText="position: absolute; visibility: hidden; display: block !important",t.insertBefore(i,t.firstChild),a=i.getElementsByTagName("b"),s=a[0].offsetWidth===a[1].offsetWidth,t.removeChild(i),s):!1}})}),define("core/utils/cookies",["core/utils/is"],function(e){return{get:function(t){if(!e(t,"string"))return!1;var i=new RegExp(t+"=(.*?)(?:;|$)"),n=document.cookie.match(i);return n?decodeURIComponent(n[1]):void 0},set:function(t,i,n,s,r){if(!e(t,"string"))return!1;if(!e(i,"string")&&!e(i,"object"))return!1;e(i,"object")&&(i=JSON.stringify(i));var o=t+"="+encodeURIComponent(i);return e(n,"date")&&(o+="; expires="+n.toString()),e(s,"string")&&(o+="; domain="+s),e(r,"string")&&(o+="; path="+r),document.cookie=o,this.exists(t)},remove:function(t,i,n){return e(t,"string")?(this.set(t,"",new Date(0),i,n),!this.exists(t)):!1},exists:function(t){return e(t,"string")?!e(this.get(t),"undefined"):!1}}}),define("core/utils/url",["jquery","core/utils/is","core/typecastError"],function(e,t){return{location:window.location,getFull:function(e){return t(e,"string")?this.location.protocol+"//"+this.location.host+"/"+this._getCompanyUrlPart(this.location.pathname)+"/"+e:!1},getPath:function(){return this.location.pathname},_getCompanyUrlPart:function(e){return e.split("/")[1]}}}),define("hbs!ui/publish-project/templates/publish",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<a href="',(r=i.publish_url)?r=r.call(t,{hash:{}}):(r=t.publish_url,r=typeof r===a?r.apply(t):r),o+=l(r)+'" target="',(r=i.target)?r=r.call(t,{hash:{}}):(r=t.target,r=typeof r===a?r.apply(t):r),o+=l(r)+'" title="Publish a \'read only\' version of your project">Preview <span aria-hidden="true" data-icon="ÓÄ´"></span></a>\n'});return t.registerPartial("ui_publish-project_templates_publish",i),i}),define("ui/publish-project/views/publish",["jquery","backbone","core/utils/is","core/typecastError","hbs!../templates/publish"],function(e,t,i,n,s){return t.View.extend({className:"js-publish-project",tagName:"div",events:{click:"publishLinkClicked"},publish_url:null,parent_el:null,initialize:function(){if(!i(this.options.publish_url,"string"))throw new n(101,"publish_url must be specified");this.publish_url=this.options.publish_url,i(this.options.parent_el,"object")?this.parent_el=e(this.options.parent_el):this.parent_el=e("<div/>")},render:function(){return this.$el.html(s({publish_url:this.publish_url,target:window.location.pathname})),this.parent_el.append(this.$el),this},publishLinkClicked:function(e){var t=window.location.pathname;return e.preventDefault(),this.trigger("publish:publish-project",function(){window.open(this.publish_url,t)},this),this.trigger("publish-button"),!0}})}),define("ui/publish-project/index",["jquery","underscore","backbone","core/utils/is","core/utils/cookies","core/utils/url","./views/publish"],function(e,t,i,n,s,r,o){var a=i.UIController.extend({namespace:"ui:publish-project",views:null,listeners:{"[remote]data:project:ready":"onProjectDataReady","[remote]ui:publish-project:publish":"publishProject"},publish_url:null,publish_tab:null,_is_saving:!1,initialize:function(){this.views={},!this.app_el instanceof e&&(this.app_el=e("<div/>")),this.app_el=e(this.app_el),this.tab_target=r.getPath(),this.imc.on("data:project:save:success",function(){this.publish_tab&&this.publish_tab.closed===!1&&this.publish_tab.location.reload(),this.announce("published")},this)},onProjectDataReady:function(){this.imc.trigger("data:project:getProject",function(e,t){return e||!n(t,"object")?void this.imc.trigger("service:log:error","menu-bar controller: failed to get project data"):(this.publish_url=r.getFull("share/"+t.share_url),this.views.publish=new o({publish_url:this.publish_url,parent_el:this.app_el.find(".primary-nav .right .publish-nav")}),this.listenTo(this.views.publish,"publish:publish-project",this.publishProject,this),this.listenTo(this.views.publish,"publish-button",this.recordPublishButton,this),void this.render())},this)},render:function(){t.invoke(this.views,"render")},remove:function(){return t.invoke(this.views,"remove"),a.__super__.remove.apply(this,arguments),!0},publishProject:function(){var i;return this._is_saving?!1:(this._is_saving=!0,i=new e.Deferred,i.done(t.bind(function(){window.open(this.publish_url,this.tab_target)},this)),i.always(t.bind(function(){this._is_saving=!1},this)),this.imc.once("data:project:save:success",i.resolve),setTimeout(i.reject,5e3),this.imc.trigger("data:project:saveProject"),this.publish_tab&&n(this.publish_tab.close,"function")&&(this.publish_tab.close(),this.publish_tab=null),this.publish_tab=window.open("",this.tab_target),!0)},destroy:function(){this.remove(),a.__super__.destroy.apply(this,arguments)},recordPublishButton:function(){this.imc.trigger("service:metrics:record","Grey bar 'Publish'")}});return a}),define("hbs!core/components/dropdown/templates/close",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="&#xe026;"></span><span class="screen-reader-text">Close</span></a>\n'});return t.registerPartial("core_components_dropdown_templates_close",i),i}),define("core/components/dropdown/views/close",["jquery","backbone","hbs!../templates/close"],function(e,t,i){return t.View.extend({tagName:"div",events:{click:"close"},render:function(){return this.delegateEvents(),this.$el.html(i()),this},close:function(e){e.preventDefault(),this.trigger("dropdown:close")}})}),function(e,t){function i(e,t,i){return[parseFloat(e[0])*(p.test(e[0])?t/100:1),parseFloat(e[1])*(p.test(e[1])?i/100:1)]}function n(t,i){return parseInt(e.css(t,i),10)||0}function s(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var r,o=Math.max,a=Math.abs,l=Math.round,c=/left|center|right/,u=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,d=/^\w+/,p=/%$/,f=e.fn.position;e.position={scrollbarWidth:function(){if(r!==t)return r;var i,n,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return e("body").append(s),i=o.offsetWidth,s.css("overflow","scroll"),n=o.offsetWidth,i===n&&(n=s[0].clientWidth),s.remove(),r=i-n},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),n=t.isWindow?"":t.element.css("overflow-y"),s="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth,r="scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight;return{width:r?e.position.scrollbarWidth():0,height:s?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]);return{element:i,isWindow:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return f.apply(this,arguments);t=e.extend({},t);var r,p,g,m,v,y,_=e(t.of),b=e.position.getWithinInfo(t.within),w=e.position.getScrollInfo(b),C=(t.collision||"flip").split(" "),x={};return y=s(_),_[0].preventDefault&&(t.at="left top"),p=y.width,g=y.height,m=y.offset,v=e.extend({},m),e.each(["my","at"],function(){var e,i,n=(t[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):u.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=u.test(n[1])?n[1]:"center",e=h.exec(n[0]),i=h.exec(n[1]),x[this]=[e?e[0]:0,i?i[0]:0],t[this]=[d.exec(n[0])[0],d.exec(n[1])[0]]}),1===C.length&&(C[1]=C[0]),"right"===t.at[0]?v.left+=p:"center"===t.at[0]&&(v.left+=p/2),"bottom"===t.at[1]?v.top+=g:"center"===t.at[1]&&(v.top+=g/2),r=i(x.at,p,g),v.left+=r[0],v.top+=r[1],this.each(function(){var s,c,u=e(this),h=u.outerWidth(),d=u.outerHeight(),f=n(this,"marginLeft"),y=n(this,"marginTop"),E=h+f+n(this,"marginRight")+w.width,S=d+y+n(this,"marginBottom")+w.height,A=e.extend({},v),k=i(x.my,u.outerWidth(),u.outerHeight());"right"===t.my[0]?A.left-=h:"center"===t.my[0]&&(A.left-=h/2),"bottom"===t.my[1]?A.top-=d:"center"===t.my[1]&&(A.top-=d/2),A.left+=k[0],A.top+=k[1],e.support.offsetFractions||(A.left=l(A.left),A.top=l(A.top)),s={marginLeft:f,marginTop:y},e.each(["left","top"],function(i,n){e.ui.position[C[i]]&&e.ui.position[C[i]][n](A,{targetWidth:p,targetHeight:g,elemWidth:h,elemHeight:d,collisionPosition:s,collisionWidth:E,collisionHeight:S,offset:[r[0]+k[0],r[1]+k[1]],my:t.my,at:t.at,within:b,elem:u})}),t.using&&(c=function(e){var i=m.left-A.left,n=i+p-h,s=m.top-A.top,r=s+g-d,l={target:{element:_,left:m.left,top:m.top,width:p,height:g},element:{element:u,left:A.left,top:A.top,width:h,height:d},horizontal:0>n?"left":i>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};h>p&&a(i+n)<p&&(l.horizontal="center"),d>g&&a(s+r)<g&&(l.vertical="middle"),o(a(i),a(n))>o(a(s),a(r))?l.important="horizontal":l.important="vertical",t.using.call(this,e,l)}),u.offset(e.extend(A,{using:c}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollLeft:n.offset.left,r=n.width,a=e.left-t.collisionPosition.marginLeft,l=s-a,c=a+t.collisionWidth-r-s;t.collisionWidth>r?l>0&&0>=c?(i=e.left+l+t.collisionWidth-r-s,e.left+=l-i):c>0&&0>=l?e.left=s:l>c?e.left=s+r-t.collisionWidth:e.left=s:l>0?e.left+=l:c>0?e.left-=c:e.left=o(e.left-a,e.left)},top:function(e,t){var i,n=t.within,s=n.isWindow?n.scrollTop:n.offset.top,r=t.within.height,a=e.top-t.collisionPosition.marginTop,l=s-a,c=a+t.collisionHeight-r-s;t.collisionHeight>r?l>0&&0>=c?(i=e.top+l+t.collisionHeight-r-s,e.top+=l-i):c>0&&0>=l?e.top=s:l>c?e.top=s+r-t.collisionHeight:e.top=s:l>0?e.top+=l:c>0?e.top-=c:e.top=o(e.top-a,e.top)}},flip:{left:function(e,t){var i,n,s=t.within,r=s.offset.left+s.scrollLeft,o=s.width,l=s.isWindow?s.scrollLeft:s.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,h=c+t.collisionWidth-o-l,d="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,p="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];0>u?(i=e.left+d+p+f+t.collisionWidth-o-r,(0>i||i<a(u))&&(e.left+=d+p+f)):h>0&&(n=e.left-t.collisionPosition.marginLeft+d+p+f-l,(n>0||a(n)<h)&&(e.left+=d+p+f))},top:function(e,t){var i,n,s=t.within,r=s.offset.top+s.scrollTop,o=s.height,l=s.isWindow?s.scrollTop:s.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,h=c+t.collisionHeight-o-l,d="top"===t.my[1],p=d?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,g=-2*t.offset[1];0>u?(n=e.top+p+f+g+t.collisionHeight-o-r,e.top+p+f+g>u&&(0>n||n<a(u))&&(e.top+=p+f+g)):h>0&&(i=e.top-t.collisionPosition.marginTop+p+f+g-l,e.top+p+f+g>h&&(i>0||a(i)<h)&&(e.top+=p+f+g))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,s,r,o=document.getElementsByTagName("body")[0],a=document.createElement("div");t=document.createElement(o?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},o&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(r in n)t.style[r]=n[r];t.appendChild(a),i=o||document.documentElement,i.insertBefore(t,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",s=e(a).offset().left,e.support.offsetFractions=s>10&&11>s,t.innerHTML="",i.removeChild(t)}()}(jQuery),define("jquery-ui-position",["jquery"],function(){}),define("core/components/dropdown/index",["jquery","backbone","underscore","core/utils/is","core/typecastError","./views/close","jquery-ui-position"],function(e,t,i,n,s,r){var o=t.UIController.extend({namespace:"ui:dropdown",className:"vanilla-dropdown",tagName:"div",views:null,listeners:{"[remote]ui:dropdowns:close":"close",open:"open",close:"close"},target_el:null,margin:10,close_button_enabled:!0,_is_rendered:!1,parent_el:null,initialize:function(){var e;if(this.views={},!n(this.options.target_el,"object"))throw new s(101,"You must pass in a target_el element.");if(!n(this.options.parent_el,"object"))throw new s(102,"You must pass in a parent_el element to render the dropdown into.");this.target_el=this.options.target_el,this.parent_el=this.options.parent_el,e=this.options.position,n(e,"object")&&n(e.my,"string")&&n(e.at,"string")?this.position=e:this.position={},this.position.of=this.target_el,this.close_button_enabled&&(this.views.close=new r)},open:function(){return this.render(),!0},close:function(){return this.remove(),!0},toggle:function(){return this.isRendered()?this.close():this.open(),!0},render:function(e){var t=[];return this.isRendered()&&this.remove(),n(this.views.close,"object")&&(t=t.concat(this.views.close)),n(e,"array")&&(t=t.concat(e)),t.forEach(function(e){this.$el.append(e.render().$el)},this),this.$el.addClass("typecast-dropdown-base"),this.parent_el.append(this.$el),this.custom_position||this.$el.position(this.position),this.setRendered(!0),n(this.views.close,"object")&&this.listenTo(this.views.close,"dropdown:close",this.close,this),this},remove:function(){var e=Object.keys(this.views);return e.forEach(function(e){var t=this.views[e];n(t.remove,"function")&&t.remove()},this),this.$el.remove(),t.UIController.prototype.remove.apply(this,arguments),this.stopListening(),this.setRendered(!1),!0},isRendered:function(){return!!this._is_rendered},setRendered:function(e){return n(e,"boolean")?(this._is_rendered=e,!0):!1},destroy:function(){this.remove(),o.__super__.destroy.apply(this,arguments)}});return o}),define("hbs!ui/help-menu/templates/walkthrough",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<a href="#">Show <span>',(r=i.walkthroughName)?r=r.call(t,{hash:{}}):(r=t.walkthroughName,r=typeof r===a?r.apply(t):r),o+=l(r)+"</span></a>"});return t.registerPartial("ui_help-menu_templates_walkthrough",i),i}),define("ui/help-menu/views/walkthrough",["jquery","backbone","core/utils/is","core/typecastError","hbs!../templates/walkthrough"],function(e,t,i,n,s){var r=t.View.extend({className:"walkthrough-item",tagName:"li",events:{click:"onClick"},initialize:function(){if(!i(this.options.walkthroughId,"number")&&!i(this.options.walkthroughId,"string"))throw new n(101,"walkthroughId must be specified");if(this.walkthroughId=this.options.walkthroughId,!i(this.options.walkthroughName,"string"))throw new n(101,"walkthroughName must be defined");this.walkthroughName=this.options.walkthroughName},render:function(){return this.$el.html(s({walkthroughName:this.walkthroughName})),this.delegateEvents(),this},onClick:function(t){return!t instanceof e.Event?!1:(t.preventDefault(),this.trigger("help:walkthrough-clicked",this.walkthroughId),!0)}});return r}),define("hbs!ui/help-menu/templates/billing_and_accounts_support_link",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<li><a href="http://support.typecast.com/customer/portal/topics/538268-billing-and-accounts/articles" target="_blank">Billing &amp; invoices</a></li>\n'});return t.registerPartial("ui_help-menu_templates_billing_and_accounts_support_link",i),i}),define("hbs!ui/help-menu/templates/account_link",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<li><a href="/account" target="_blank">Billing &amp; invoices</a></li>\n'});return t.registerPartial("ui_help-menu_templates_account_link",i),i}),define("ui/help-menu/views/billing_and_invoices_link",["jquery","backbone","core/utils/is","hbs!../templates/billing_and_accounts_support_link","hbs!../templates/account_link"],function(e,t,i,n,s){return t.View.extend({template:null,initialize:function(e){this.template=n,i(e,"object")&&i(e.is_admin,"boolean")&&e.is_admin===!0&&(this.template=s)},render:function(){return this.$el=e(this.template()),this}})}),define("hbs!ui/help-menu/templates/dropdown",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="top">\n    <h3>Getting started video tutorial</h3>\n    <h4>Create beautiful, readable content in minutes</h4>\n    <a href="http://support.typecast.com/customer/portal/articles/1337056" target="_blank" class="video-thumb"></a>\n    <p class="narrow">Browse our <a href="http://support.typecast.com" target="_blank">Support Library</a> for more tutorials, tips and FAQ\'s.</p>\n    <p class="or">or</p>\n    <a class="button orange Intercom" href="#" style="visibility: visible;"><span>Get support &amp; give feedback</span></a>\n</div>\n<div class="bottom">\n    <h3>Quick links</h3>\n    <ul class="tours-list">\n        <li><a href="http://typecast.com/blog" target="_blank">Typecast blog</a></li>\n    </ul>\n</div>\n'});return t.registerPartial("ui_help-menu_templates_dropdown",i),i}),define("ui/help-menu/dropdown",["jquery","backbone","underscore","core/utils/is","core/components/dropdown/index","./views/walkthrough","./views/billing_and_invoices_link","hbs!./templates/dropdown"],function(e,t,i,n,s,r,o,a){var l=s.extend({namespace:"ui:help-menu:dropdown",className:"dropdown-panel help-panel",views:null,walkthroughViews:null,initialize:function(){this.views={},this.walkthroughViews=[],l.__super__.initialize.apply(this,arguments),this.imc.trigger("data:walkthroughs:get-all",function(e,t){return e?void this.log("error","HelpDropdown: failed to get data for walkthroughs"):n(t,"object")&&n(t.models,"array")&&0!==t.models.length?void t.models.forEach(function(e){var t=new r({walkthroughId:e.get("id"),walkthroughName:e.get("name")});this.views["walkthrough_"+e.get("id")]=t,this.walkthroughViews.push(t)},this):void this.log("warn","HelpDropdown: no data or invalid data for walkthroughs")},this),this.views.billing_and_invoices_link=new o({is_admin:n(this.config.user,"object")?this.config.user.is_admin:!1})},render:function(){return this.$el.html(a()),l.__super__.render.call(this,[]),this.walkthroughViews.forEach(function(e){this.$el.find(".tours-list").prepend(e.render().$el),this.listenTo(e,"help:walkthrough-clicked",this.onWalkthroughClicked,this)},this),n(window.Intercom,"function")&&(window.Intercom("update"),window.Intercom("reattach_activator")),this.views.billing_and_invoices_link.render(),this.$el.find("ul.tours-list").append(this.views.billing_and_invoices_link.$el),this},onWalkthroughClicked:function(e){return n(e,"number")||n(e,"string")?(this.imc.trigger("ui:walkthroughs:start",e),this.close(),!0):!1},open:function(){l.__super__.open.call(this),this.imc.trigger("service:metrics:record","Grey bar 'Support'")}});return l}),define("ui/help-menu/index",["jquery","backbone","core/utils/is","./dropdown"],function(e,t,i,n){var s=t.UIController.extend({namespace:"ui:help-menu",views:null,is_loaded:!1,listeners:{toggle:"toggleDropdown",close:"closeDropdown"},initialize:function(){this.app_el?this.app_el=e(this.app_el):this.app_el=e("<div/>"),this.views={}},loadHelpDropdown:function(){return this.helpDropdown=new n({imc:this.imc,target_el:this.app_el.find(".main-menu-sidebar .support-library"),parent_el:this.app_el,position:{my:"left+10 bottom",at:"right bottom"},config:this.config}),this.is_loaded=!0,!0},toggleDropdown:function(){this.is_loaded||this.loadHelpDropdown(),this.imc.trigger(this.namespace+":toggled"),this.helpDropdown.toggle()},closeDropdown:function(){return this.is_loaded?void this.helpDropdown.close():!1},remove:function(){return i(this.helpDropdown,"object")&&this.helpDropdown.remove(),s.__super__.remove.apply(this,arguments),!0},destroy:function(){return this.remove(),s.__super__.destroy.apply(this,arguments),!0}});return s}),define("core/utils/scroll",["jquery","underscore","core/utils/is"],function(e,t,i){return{isElementAbleToMakeScroll:function(e,t){var n,s,r,o,a,l,c=!1,u=!1,h=!1;if(!i(e,"object"))return!1;if(!i(t,"object"))return!1;if(s=e.outerHeight(),r=this._getScrollHeight(e),o=e.scrollTop(),a=t.originalEvent.wheelDelta||-40*t.originalEvent.detail,l=Math.abs(a),n=r-(o+s),u=this.isAtStartOfScroll(o),h=this.isAtEndOfScroll(s,r,o),u&&h)return!1;if(c=0>a){if(l>n)return e.scrollTop(r),!1;if(u)return!0;if(h)return!1}else{if(l>o)return e.scrollTop(0),!1;if(u)return!1;if(h)return!0}return!0},preventScrollPropagation:function(t){var i=e(t.currentTarget);t.stopPropagation(),this.isElementAbleToMakeScroll(i,t)||t.preventDefault()},getScrollEventsToStopScrolling:function(e){var n={},s=["mousewheel","DOMMouseScroll"],r=[];return r=i(e,"string")&&e.length>0?t.map(s,function(t){return t+" "+e}):s,r.forEach(function(e){n[e]=t.bind(this.preventScrollPropagation,this)},this),n},isAtStartOfScroll:function(e){return i(e,"number")&&0===e?!0:!1},isAtEndOfScroll:function(e,t,n){return i(e,"number")&&i(t,"number")&&i(n,"number")?e>=t-n:!1},isNearEndOfScroll:function(e,t,n,s){return i(e,"number")&&i(t,"number")&&i(n,"number")?!i(s,"number")&&1>s?!1:s>t-(n+e):!1},isNearStartOfScroll:function(e,t){return i(e,"number")?!i(t,"number")&&1>t?!1:t>e:!1},_getScrollHeight:function(e){var t=e.get(0);return t.scrollHeight}}}),define("hbs!ui/open-save-export/templates/links",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return"CMD+S"}function o(e,t){return"CTRL+S"}function a(e,t){return" disabled "}function l(e,t){return' data-tooltips-title="This functionality is disabled while Typekit fonts are active in your project" data-tooltips-side="right"'}function c(e,t){return'\n                    Hide baseline grid <span data-icon="&#xe043;" class="settings-icon" aria-hidden="true"></span>\n                '}function u(e,t){return"\n                    Show a baseline grid\n                "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var h,d="",p=this;return d+='<div class="sidebar-content">\n    <div class="links sidebar-nav js-this-project js-menu">\n        <ul class="nav-files">\n            <li id="save" class="menu-item" data-item="save">\n                <a href="#"><span data-icon="&#xe022;" aria-hidden="true"></span> Save a version <span class="hint">',h=i["if"].call(t,t.mac_platform,{hash:{},inverse:p.program(3,o,s),fn:p.program(1,r,s)}),(h||0===h)&&(d+=h),d+='</span></a>\n            </li>\n            <li class="menu-item open-previous-versions more" data-item="previous">\n                <a href="#" title="See previous versions"><span data-icon="&#xe04f;" aria-hidden="true"></span> Roll back to a version</a>\n            </li>\n            <li class="menu-item" data-item="styleGuide">\n                <span data-icon="&#xe048;" aria-hidden="true"></span> View your style guide\n            </li>\n            <li class="menu-item" data-item="downloadHtmlCss">\n                <span data-icon="&#xe00f;" aria-hidden="true"></span> Download HTML/CSS\n            </li>\n            <li class="menu-item ',h=i["if"].call(t,t.disabled_png,{hash:{},inverse:p.noop,fn:p.program(5,a,s)}),(h||0===h)&&(d+=h),d+='" data-item="transparentPng" ',h=i["if"].call(t,t.disabled_png,{hash:{},inverse:p.noop,fn:p.program(7,l,s)}),(h||0===h)&&(d+=h),d+='>\n                <span data-icon="&#xe04e;" aria-hidden="true"></span> Generate a transparent PNG\n            </li>\n            <li class="menu-item baseline-grid-button" data-item="baselineGrid">\n                <span data-icon="&#xe04A;" aria-hidden="true"></span>\n                ',h=i["if"].call(t,t.grid_visible,{hash:{},inverse:p.program(11,u,s),fn:p.program(9,c,s)}),(h||0===h)&&(d+=h),d+='\n            </li>\n        </ul>\n        <p class="support-library help-menu-button"><span data-icon="&#xe600;" aria-hidden="true"></span> Get support and learn more</p>\n    </div>\n</div>\n'});return t.registerPartial("ui_open-save-export_templates_links",i),i}),define("hbs!ui/open-save-export/templates/rename-label",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+="<div class='rename-project-label'>",(r=i.projectName)?r=r.call(t,{hash:{}}):(r=t.projectName,r=typeof r===a?r.apply(t):r),o+=l(r)+"</div>\n"});return t.registerPartial("ui_open-save-export_templates_rename-label",i),i}),define("hbs!ui/open-save-export/templates/rename-input",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div>\n    <input type="text" value="',(r=i.projectName)?r=r.call(t,{hash:{}}):(r=t.projectName,r=typeof r===a?r.apply(t):r),o+=l(r)+'" placeholder="',(r=i.projectName)?r=r.call(t,{hash:{}}):(r=t.projectName,r=typeof r===a?r.apply(t):r),o+=l(r)+'" title="Rename the project"\n        class="rename-project-input"></input>\n    <input type="submit" value="Rename" class="rename-project-submit button"></input>\n    <a href="#" class="rename-project-cancel close-cross" title="Cancel">\n        <span aria-hidden="true" data-icon="ÓÄ¶">\n        </span><span class="screen-reader-text">Cancel</span>\n    </a>\n</div>\n'});return t.registerPartial("ui_open-save-export_templates_rename-input",i),i}),define("ui/open-save-export/views/rename-project",["jquery","backbone","core/utils/is","hbs!../templates/rename-label","hbs!../templates/rename-input"],function(e,t,i,n,s){var r=t.View.extend({events:{keypress:"onKeypress","click .rename-project-label":"onClick","click .rename-project-cancel":"onCancel","click .rename-project-submit":"onSubmit"},className:"rename-project",projectName:null,_isEditable:!1,initialize:function(){return i(this.options.projectName,"string")?void(this.projectName=this.options.projectName):!1},onKeypress:function(t){return t instanceof e.Event?(13===t.which&&this.onSubmit(),!0):!1},onClick:function(){var e;return this.setEditable(!0),e=this.$el.find(".rename-project-input"),e.length&&e.is("input")&&e.get(0).select(),!0},onSubmit:function(){var e=this.$el.find(".rename-project-input").val();if(e)return this.setEditable(!1),this.projectName!==e&&this.trigger("rename:rename-project",e),!0},onCancel:function(t){return t instanceof e.Event?(t.preventDefault(),this.setEditable(!1),!0):!1},setEditable:function(e){return i(e,"boolean")?this._isEditable===e?!0:(this._isEditable=e,this.render(),!0):!1},getEditable:function(){return this._isEditable},setProjectName:function(t){return!i(t,"string")||t.length<1?!1:(this.$el.addClass("saved"),setTimeout(e.proxy(function(){this.$el.removeClass("saved")},this),1e3),this.projectName=t,this.getEditable()&&this.$el.find(".rename-project-input").is(":focus")?!0:(this.render(),!0))},render:function(){var e=this.getEditable()?s:n;return this.$el.html(e({projectName:this.projectName})),this.delegateEvents(),this}});return r}),define("ui/open-save-export/views/links",["backbone","jquery","core/utils/is","hbs!./../templates/links","./rename-project"],function(e,t,i,n,s){var r=e.View.extend({template:n,className:"menu-left",views:null,is_png_enabled:!1,grid_visible:!1,events:{"click .menu-item[data-item]":"onMenuItemSelected","click .settings-icon":"toggleSettingsMenu","mouseover .menu-item":"onMenuItemMouseIn","mouseout .menu-item":"onMenuItemMouseOut","click .support-library":"handleSupportLinkClick"},mouseOverTimeout:null,initialize:function(){this.views={},this.on("disable-png",this.disablePNG,this),this.on("enable-png",this.enablePNG,this),this.views.rename_project=new s({projectName:this.options.project_name}),this.listenTo(this.views.rename_project,"rename:rename-project",this.renameProject)},render:function(){return this.views.rename_project.render(),this.$el.html(this.views.rename_project.$el),this.$el.append(this.template({disabled_png:!this.is_png_enabled,grid_visible:this.grid_visible,mac_platform:this._isMac()})),this.delegateEvents(),this.views.rename_project.delegateEvents(),this.$el.find(".menu-item").removeClass("active"),this},renameProject:function(e){return this.trigger("rename:rename-project",e),!0},_isMac:function(){return 0===window.navigator.platform.indexOf("Mac")},setProjectName:function(e){return this.views.rename_project.setProjectName(e),!0},enablePNG:function(){return this.is_png_enabled?!1:(this.is_png_enabled=!0,this.render(),!0)},disablePNG:function(){return this.is_png_enabled?(this.is_png_enabled=!1,this.render(),!0):!1},toggleSettingsMenu:function(e){return e&&e.stopPropagation(),this.trigger("toggle-settings"),!0},onMenuItemSelected:function(e){var i,n;return e instanceof t.Event&&e.target instanceof HTMLElement?(e.preventDefault(),i=t(e.target).closest(".menu-item"),n=i.attr("data-item"),i.hasClass("more")&&i.addClass("active"),this.is_png_enabled||"transparentPng"!==n?("baselineGrid"===n?(this.grid_visible=!this.grid_visible,this.render(),this.trigger("toggle-grid")):this.trigger("menu:item-selected",n),!0):!0):!1},onMenuItemMouseIn:function(e){var i;return e instanceof t.Event?(i=t(e.target).closest(".menu-item"),!0):!1},onMenuItemMouseOut:function(){return window.clearTimeout(this.mouseOverTimeout),this.mouseOverTimeout=null,!0},handleSupportLinkClick:function(){this.trigger("support:click")}});return r}),define("hbs!ui/open-save-export/templates/newMenu",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="new-options file-options">\n\n    <div class="inner">\n\n        <div class="new-project-templates">\n            <!-- project template forms go here -->\n        </div>\n\n        <div class="clear"></div>\n\n    </div>\n\n</div>\n'});return t.registerPartial("ui_open-save-export_templates_newMenu",i),i}),define("ui/open-save-export/views/newMenu",["jquery","backbone","hbs!./../templates/newMenu"],function(e,t,i){var n=t.View.extend({template:i,className:"menu-right",events:{"click .file-custom-templates form":"onProjectTemplateSelected"},$newProjectsTemplate:null,initialize:function(){return this.$newProjectsTemplate=e("body").find("#tpl-new-project-templates"),this.$newProjectsTemplate.length?(this.$el.html(this.template()),void this.$el.find(".new-project-templates").html(this.$newProjectsTemplate.html())):!1},render:function(){return this.delegateEvents(),this},onProjectTemplateSelected:function(t){return t instanceof e.Event?(t.preventDefault(),e(t.target).closest("form").submit(),!0):!1}});return n}),define("hbs!ui/open-save-export/templates/openRecentMenu",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="recent-options file-options">\n    <div class="inner">\n        <div class="recently-opened-projects">\n            <!-- List of recently opened projects goes here. -->\n        </div>\n    </div>\n    <div class="shadow"></div>\n</div>\n';
});return t.registerPartial("ui_open-save-export_templates_openRecentMenu",i),i}),define("ui/open-save-export/views/recentMenu",["jquery","backbone","core/utils/is","hbs!./../templates/openRecentMenu"],function(e,t,i,n){var s=t.View.extend({template:n,className:"menu-right",initialize:function(){var t=e(document.body).find("#tpl-recently-opened-projects");return t.length?(this.$el.html(this.template()),void this.$el.find(".recently-opened-projects").html(t.html())):!1},render:function(){return this.delegateEvents(),this}});return s}),define("hbs!ui/open-save-export/templates/tabs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="sidebar-account dashboard">\n        <p><a href="/dashboard" title="Go back to your dashboard">Back to dashboard</a></p>\n</div>\n\n<section class="sidebar-typecast-heading">\n    <h1></span><span class="screen-reader-text">Typecast&trade; by Monotype</span></h1>\n</section>\n\n<ul>\n    <li data-submenu="this-project" class="active this-project">This project</li>\n    <li data-submenu="new-project" class="menu-item open-new new-project" data-item="new">\n        <span>New project</span>\n    </li>\n    <li data-submenu="open-recent" class="menu-item open-recent" data-item="recent">\n        <span>Open recent</span>\n    </li>\n</ul>\n'});return t.registerPartial("ui_open-save-export_templates_tabs",i),i}),define("ui/open-save-export/views/tabs",["backbone","jquery","core/utils/is","hbs!./../templates/tabs"],function(e,t,i,n){return e.View.extend({className:"tabs sidebar-tabs",tagName:"div",template:n,events:{"click li":"openSubmenu"},openSubmenu:function(e){var i=t(e.currentTarget);this.trigger("open:submenu",i.attr("data-submenu")),this._setActiveClass(i)},render:function(){return this.$el.html(n()),this.delegateEvents(),this},_setActiveClass:function(e){return this.$el.find("li").removeClass("active"),e.addClass("active"),!0}})}),define("hbs!ui/open-save-export/templates/footer",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="footer account-benefits">\n    <a href="/plans" class="button large orange">\n        <em>Upgrade Now</em>\n        <span>(',(r=i.days_to_expire)?r=r.call(t,{hash:{}}):(r=t.days_to_expire,r=typeof r===a?r.apply(t):r),o+=l(r)+" days remaining)</span>\n    </a>\n</div>\n"});return t.registerPartial("ui_open-save-export_templates_footer",i),i}),define("ui/open-save-export/menuDropdown",["backbone","underscore","jquery","core/typecastError","core/utils/is","core/utils/cookies","core/utils/scroll","core/components/dropdown/index","./views/links","./views/newMenu","./views/recentMenu","./views/tabs","hbs!./templates/footer"],function(e,t,i,n,s,r,o,a,l,c,u,h,d){var p=a.extend({namespace:"ui:open-save-export:menu",className:"open-save-export-menu main-menu-sidebar closed",views:null,renderedSubmenu:null,show_footer:null,project_id:null,listeners:t.extend({"[remote]data:project:saveProject":"addAnimationSaveClasses","[remote]data:project:set":"onProjectSet","[remote]data:fonts:changed:active-fonts":"activeFontsChanged"},a.prototype.listeners),events:t.extend({},o.getScrollEventsToStopScrolling(),o.getScrollEventsToStopScrolling(".inner > div"),o.getScrollEventsToStopScrolling(".projects-holder")),initialize:function(e){if(!s(e.project_id,"string")&&!s(e.project_id,"number")||parseInt(e.project_id,10)<=0)throw new n("No project ID was passed");if(!s(e.project_title,"string"))throw new n("Expected project_name to be a string");this.config={},s(e.config,"object")&&(this.config=e.config),this.$app_el=e.$app_el,this.project_id=e.project_id,p.__super__.initialize.apply(this,arguments),this.views.links=new l({project_name:e.project_title}),this.views.newMenu=new c,this.views.openRecentMenu=new u,this.views.tabs=new h,this.listenTo(this.views.links,"toggle-settings",this.toggleBaselineSettings),this.listenTo(this.views.links,"toggle-grid",this.toggleBaselineGrid),this.listenTo(this.views.links,"support:click",this.toggleHelpMenu),this.listenTo(this.views.links,"rename:rename-project",this.renameProject),this.show_footer=!1,s(this.config.user,"object")&&this.config.user.is_trial&&(this.show_footer=!0)},render:function(){var e=[this.views.tabs];return p.__super__.render.call(this,e),this.removeSubmenu(),this.show_footer&&this.$el.append(d({days_to_expire:this.config.user.days_to_expire})),this.listenTo(this.views.tabs,"open:submenu",function(e){var t;"new-project"===e?t=this.views.newMenu:"open-recent"===e?t=this.views.openRecentMenu:(t=this.views.links,this.imc.trigger("ui:open-save-export:links-submenu:rendered")),this.renderSubmenu(t)}),this.listenTo(this.views.links,"menu:item-selected",function(e){var t=this["menuItemSelected_"+e];return s(t,"function")?t.call(this):(this.imc.trigger("service:log:error","Invalid menu item key: "+e),!1)},this),this.$app_el.find(".elements").get(0).addEventListener("click",i.proxy(this.handleAppClick,this),!0),this.delegateEvents(),this},activeFontsChanged:function(e){var i;return s(e,"array")?(i=t.where(e,{provider:"typekit"}),i.length?this.views.links.trigger("disable-png"):this.views.links.trigger("enable-png"),!0):!1},destroy:function(){return this.$app_el.find(".elements").get(0).removeEventListener("click",i.proxy(this.handleAppClick,this),!0),this.imc.off("data:project:save:success"),p.__super__.destroy.apply(this,arguments)},renderSubmenu:function(t){return t instanceof e.View?t===this.renderedSubmenu?!0:(this.removeSubmenu(),t.render(),this.$el.find(".tabs").after(t.$el),this.renderedSubmenu=t,!0):!1},removeSubmenu:function(){return this.renderedSubmenu&&this.renderedSubmenu.remove(),this.renderedSubmenu=null,!0},menuItemSelected_new:function(){return this.renderSubmenu(this.views.newMenu)},menuItemSelected_recent:function(){return this.renderSubmenu(this.views.openRecentMenu)},menuItemSelected_save:function(){return this.imc.trigger("data:project:saveProject"),this.imc.trigger("service:metrics:record","Sidebar 'Save a version'"),!0},menuItemSelected_share:function(){return this.imc.trigger("ui:publish-project:publish"),this.imc.trigger("service:metrics:record","Sidebar 'Share & test a preview'"),!0},menuItemSelected_styleGuide:function(){return this.imc.trigger("ui:style-guide:open"),this.imc.trigger("service:metrics:record","Sidebar 'View your style guide'"),!0},menuItemSelected_png:function(){return this.exportPng(!1),this.imc.trigger("service:metrics:record","Sidebar 'Generate a PNG'"),!0},menuItemSelected_transparentPng:function(){return this.exportPng(!0),this.imc.trigger("service:metrics:record","Sidebar 'Generate a transparent PNG'"),!0},menuItemSelected_previous:function(){return this.imc.trigger("ui:previous-versions:show"),this.imc.trigger("service:metrics:record","Sidebar 'Roll back to a version'"),!0},menuItemSelected_downloadHtmlCss:function(){return this.imc.trigger("ui:export:html-css"),this.imc.trigger("service:metrics:record","Sidebar 'Download HTML/CSS'"),!0},exportPng:function(e){return this.imc.trigger("ui:export:png",e,window.open("")),!0},addHintedClass:function(){this.$el.addClass("hinted")},removeHintedClass:function(){this.$el.removeClass("hinted")},toggle:function(){return this.$el.hasClass("closed")?(this.$el.removeClass("closed"),this.$el.addClass("opened")):this.close(),!0},close:function(){return this.closeHelpMenu(),this.closeBaselineSettings(),this.$el.addClass("closed"),this.$el.removeClass("opened"),!0},handleAppClick:function(e){var t=!!i(e.target).parents(".open-save-export-menu").length;return t||this.close(),!0},addAnimationSaveClasses:function(){var e=this.$el.find(".nav-files");return e.addClass("saving"),this.imc.once("data:project:save:success",function(){e.removeClass("saving"),e.addClass("saved"),setTimeout(function(){e.removeClass("saved")},1e3)},this),!0},renameProject:function(e){return s(e,"string")&&0!==e.length?void this.imc.trigger("data:project:set","title",e):void this.imc.trigger("service:log:error","menu-bar controller: rename: invalid project title")},onProjectSet:function(e,t){return"title"!==e?!1:s(t,"string")?(r.set(this.config.cookie_prefix+"typecast_project_url",{url:window.location.pathname,project_id:this.project_id}),i(document).attr("title",t),void this.views.links.setProjectName(t)):(this.imc.trigger("service:log:error","menu-bar controller: invalid project title received"),!1)},toggleHelpMenu:function(){return this.imc.trigger("ui:help-menu:toggle"),!0},closeHelpMenu:function(){return this.imc.trigger("ui:help-menu:close"),!0},toggleBaselineGrid:function(){return this.imc.trigger("ui:baseline-grid:toggle"),!0},toggleBaselineSettings:function(){return this.imc.trigger("ui:baseline-grid:settings:toggle"),!0},closeBaselineSettings:function(){return this.imc.trigger("ui:baseline-grid:settings:close"),!0},remove:function(){return this.closeHelpMenu(),this.closeBaselineSettings(),p.__super__.remove.apply(this,arguments)}});return p}),define("hbs!ui/open-save-export/templates/menuButton",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<li>\n    <span id="menu-control" class="main-menu" title="Open the menu">Menu</span>\n</li>\n'});return t.registerPartial("ui_open-save-export_templates_menuButton",i),i}),define("ui/open-save-export/views/menuButton",["backbone","jquery","core/utils/is","hbs!./../templates/menuButton"],function(e,t,i,n){var s=e.View.extend({template:n,className:"file-menu navigation-alt",tagName:"ul",events:{click:"onClick",mouseover:"onMouseover",mouseout:"onMouseout"},initialize:function(){i(this.options.parent_el,"object")?this.parent_el=t(this.options.parent_el):this.parent_el=t("<div/>")},render:function(){return this.$el.html(this.template()),this.parent_el.append(this.$el),this},onClick:function(){this.trigger("menuButton:clicked")},onMouseover:function(){return this.$el.find(".main-menu").addClass("hinted"),this.trigger("menu:hint:add"),!0},onMouseout:function(){return this.$el.find(".main-menu").removeClass("hinted"),this.trigger("menu:hint:remove"),!0}});return s}),define("ui/open-save-export/index",["backbone","jquery","underscore","core/utils/is","./menuDropdown","./views/menuButton"],function(e,t,i,n,s,r){var o=e.UIController.extend({namespace:"ui:open-save-export",views:null,listeners:{"[remote]data:project:ready":"_getProjectDetails"},initialize:function(){this.views={},this.app_el?this.app_el=t(this.app_el):this.app_el=t("<div/>")},_getProjectDetails:function(){var e=t.Deferred(),n=t.Deferred();return e.fail(function(){this.log("Could not get the project ID")}),n.fail(function(){this.log("Could not the the project title")}),this.imc.trigger("data:project:get","id",function(t,i){t&&e.rejectWith(this),e.resolve(i)},this),this.imc.trigger("data:project:get","title",function(e,t){e&&n.rejectWith(this),n.resolve(t)},this),t.when(e,n).then(i.bind(this._bootstrapViews,this)),!0},_bootstrapViews:function(e,i){return this.views.menuButton=new r({parent_el:t(this.app_el).find(".primary-nav .left")}),this.menuDropdown=new s({imc:this.imc,target_el:this.views.menuButton.$el,parent_el:this.app_el,project_id:e,project_title:i,position:{my:"left top-8",at:"left top",collision:"fit"},close_button_enabled:!1,$app_el:t(this.app_el),config:this.config}),this.listenTo(this.views.menuButton,"menuButton:clicked",this.menuButtonClicked,this),this.render(),this.menuDropdown.render(),this.menuDropdown.listenTo(this.views.menuButton,"menu:hint:add",this.menuDropdown.addHintedClass),this.menuDropdown.listenTo(this.views.menuButton,"menu:hint:remove",this.menuDropdown.removeHintedClass),this.menuDropdown.renderSubmenu(this.menuDropdown.views.links),this.imc.trigger("ui:open-save-export:rendered"),this.imc.trigger("ui:open-save-export:links-submenu:rendered"),!0},destroy:function(){return this.menuDropdown.destroy(),this.remove(),o.__super__.destroy.apply(this,arguments),!0},menuButtonClicked:function(){var e;return this.menuDropdown.toggle(),e=this.menuDropdown.$el.is(":visible")?"opened":"closed",this.imc.trigger(this.namespace+":menu-"+e),!0},render:function(){Object.keys(this.views).forEach(function(e){n(this.views[e].render,"function")&&this.views[e].render()},this)},remove:function(){var e=Object.keys(this.views);return e.forEach(function(e){n(this.views[e].remove,"function")&&this.views[e].remove()},this),this.menuDropdown.remove(),o.__super__.remove.apply(this,arguments),!0}});return o}),define("ui/margin-padding-previewer/views/spacing_preview",["jquery","underscore","backbone","core/utils/is"],function(e,t,i,n){var s=i.View.extend({className:"margin-preview",positioner:null,initialize:function(e){this.positioner=e.positioner},_updatePositions:function(e){return this._checkDetails(e)===!1?!1:(this._positionContainer(this.$el,e),void this._positionBoxes(this.$top_margin,this.$bottom_margin,this.$right_margin,this.$left_margin,e))},_checkDetails:function(e){return n(e,"undefined")?!1:n(e.x_position,"undefined")?!1:n(e.y_position,"undefined")?!1:n(e.width,"undefined")?!1:n(e.height,"undefined")?!1:n(e.margin,"undefined")?!1:!0},render:function(t){return this._checkDetails(t)?(this.$el.html(""),this.$top_margin=e('<div class="top"></div>'),this.$right_margin=e('<div class="right"></div>'),this.$bottom_margin=e('<div class="bottom"></div>'),this.$left_margin=e('<div class="left"></div>'),this._updatePositions(t),this.$el.append(this.$top_margin),this.$el.append(this.$right_margin),this.$el.append(this.$bottom_margin),this.$el.append(this.$left_margin),!0):!1},_positionContainer:function(e,t){var i;return n(e,"object")&&n(t,"object")&&n(this.positioner,"object")?(i=this._calculateContainerPosition(t),e.css({top:i.top,left:i.left,position:"absolute",width:i.width,height:i.height}),!0):!1},_positionBoxes:function(e,i,s,r,o){var a,l,c,u,h;return n(e,"object")&&n(i,"object")&&n(s,"object")&&n(r,"object")&&n(o,"object")&&n(this.positioner,"object")?(a=this._calculateBoxPositions(o),l={position:"absolute"},t.extend(l,a.top),e.css(l),c={position:"absolute"},t.extend(c,a.bottom),i.css(c),u={position:"absolute"},t.extend(u,a.right),s.css(u),h={position:"absolute"},t.extend(h,a.left),r.css(h),!0):!1},_calculateContainerPosition:function(e){var t={};return this._isValidElementPositionsObject(e)?(t.top=e.y_position,t.left=e.x_position,t.width=this._calculateContainerWidth(e),t.height=this._calculateContainerHeight(e),t):!1},_isValidElementPositionsObject:function(e){return n(e,"object")&&n(e.margin,"object")?!0:!1},_calculateBoxPositions:function(e){var t={};return this._isValidElementPositionsObject(e)?(t.top=this.positioner.calculateTopBoxPosition(e),t.bottom=this.positioner.calculateBottomBoxPosition(e),t.left=this.positioner.calculateLeftBoxPosition(e),t.right=this.positioner.calculateRightBoxPosition(e),t):!1},_calculateContainerWidth:function(e){var t=this._getPixelValue(e.padding.left),i=this._getPixelValue(e.padding.right),n=this._getPixelValue(e.border.left),s=this._getPixelValue(e.border.right);return e.width+t+i+n+s},_calculateContainerHeight:function(e){var t=this._getPixelValue(e.padding.top),i=this._getPixelValue(e.padding.bottom),n=this._getPixelValue(e.border.top),s=this._getPixelValue(e.border.bottom);return e.height+t+i+s+n},_getPixelValue:function(e){return window.parseInt(e,10)}});return s}),define("ui/margin-padding-previewer/margin_preview_positioner",[],function(){var e={calculateTopBoxPosition:function(e){var t={};return t.top=0-this._getPixelValue(e.margin.top),t.left=0-this._getPixelValue(e.margin.left),t.width=this._calculateMarginOuterWidth(e),t.height=this._getPixelValue(e.margin.top),t},calculateBottomBoxPosition:function(e){var t={};return t.top=this._getPixelValue(e.height)+this._getPixelValue(e.padding.top)+this._getPixelValue(e.padding.bottom)+this._getPixelValue(e.border.bottom)+this._getPixelValue(e.border.top),t.left=0-this._getPixelValue(e.margin.left),t.width=this._calculateMarginOuterWidth(e),t.height=this._getPixelValue(e.margin.bottom),t.backgroundPosition="0px -"+(this._getPixelValue(e.height)+this._getPixelValue(e.padding.top)+this._getPixelValue(e.padding.bottom)+this._getPixelValue(e.margin.top))+"px",t},calculateLeftBoxPosition:function(e){var t={};return t.top=0,t.bottom=0,t.left=0-this._getPixelValue(e.margin.left),t.width=this._getPixelValue(e.margin.left),t.backgroundPosition="0px -"+this._getPixelValue(e.margin.top)+"px",t},calculateRightBoxPosition:function(e){var t={};return t.top=0,t.bottom=0,t.left=this._calculateMarginOuterWidth(e)-this._getPixelValue(e.margin.right)-this._getPixelValue(e.margin.left),t.width=this._getPixelValue(e.margin.right),t.backgroundPosition="-"+(this._calculateMarginOuterWidth(e)-this._getPixelValue(e.margin.right))+"px -"+this._getPixelValue(e.margin.top)+"px",t},_getPixelValue:function(e){return window.parseInt(e,10)},_calculateMarginOuterWidth:function(e){var t=this._getPixelValue(e.width),i=this._getPixelValue(e.margin.left),n=this._getPixelValue(e.margin.right),s=this._getPixelValue(e.padding.left),r=this._getPixelValue(e.padding.right),o=this._getPixelValue(e.border.left),a=this._getPixelValue(e.border.right);return t+i+n+s+r+o+a}};return e}),define("ui/margin-padding-previewer/padding_preview_positioner",[],function(){var e={calculateTopBoxPosition:function(e){var t={};return t.top=this._getPixelValue(e.border.top),t.left=this._getPixelValue(e.border.left),t.width=this._calculateContainerWidthWithPadding(e),t.height=this._getPixelValue(e.padding.top),t},calculateBottomBoxPosition:function(e){var t={};return t.top=this._getPixelValue(e.height)+this._getPixelValue(e.padding.top)+this._getPixelValue(e.border.top),t.left=this._getPixelValue(e.border.left),t.width=this._calculateContainerWidthWithPadding(e),t.height=this._getPixelValue(e.padding.bottom),t},calculateLeftBoxPosition:function(e){var t={};return t.top=this._getPixelValue(e.padding.top)+this._getPixelValue(e.border.top),t.left=this._getPixelValue(e.border.left),t.width=this._getPixelValue(e.padding.left),t.height=this._getPixelValue(e.height),t},calculateRightBoxPosition:function(e){var t={};return t.top=this._getPixelValue(e.padding.top)+this._getPixelValue(e.border.top),t.left=this._getPixelValue(e.width)+this._getPixelValue(e.padding.left)+this._getPixelValue(e.border.left),t.width=this._getPixelValue(e.padding.right),t.height=this._getPixelValue(e.height),t},_getPixelValue:function(e){return window.parseInt(e,10)},_calculateContainerWidthWithPadding:function(e){var t=this._getPixelValue(e.width),i=this._getPixelValue(e.padding.left),n=this._getPixelValue(e.padding.right);return t+i+n}};return e}),define("ui/margin-padding-previewer/index",["underscore","jquery","backbone","core/utils/is","core/utils/dom","core/utils/image","core/typecastError","./views/spacing_preview","./margin_preview_positioner","./padding_preview_positioner"],function(e,t,i,n,s,r,o,a,l,c){"use strict";var u=i.UIController.extend({className:"margin-padding-previewer",namespace:"ui:margin-padding-previewer",views:{},listeners:e.extend({},i.UIController.prototype.listeners,{show:"showAllPreviews",hide:"hideAllPreviews","[remote]data:styles:changed":"checkUpdateRequired","[remote]ui:element-overlay:dragStart":"remove","[remote]ui:element-overlay:dragEnd":"render","[remote]data:styles:deleted:styleDeclaration":"render"}),margin_preview_visible:!0,padding_preview_visible:!1,initialize:function(){return this.views.margin_preview=new a({className:"margin-preview",positioner:l}),this.views.padding_preview=new a({className:"padding-preview",positioner:c}),this.imc.trigger(this.namespace+":ready"),!0},onChangeActiveElement:function(e,t){var i;return n(t,"element")&&this.imc.off("data:elements:updated:element:"+t.getElement().id,this.handleActiveElementUpdate,this),this.remove(),n(e,"element")?("body"!==e.getElement().id&&(i=e.getElement().id,this.render(),this.imc.on("data:elements:updated:element:"+i,this.handleActiveElementUpdate,this)),!0):!0},handleActiveElementUpdate:function(){var e,t,i=this.active_media_query.getMediaQuery().id,n=this.active_element.getElement().id;return"img"===this.active_element.getElement().tag_name?(e=s.getElement(i,n),t=e.get(0),r.onLoad(t,this.render,this),!0):(this.render(),!0)},onChangeActiveStyle:function(){return this.render(),!0},checkUpdateRequired:function(e,t){return n(e,"number")?!n(t,"string")||t.length<1?!1:n(this.active_element,"element")?(e===this.active_style_id&&this.render(),!0):!1:!1},_getElementPosition:function(e,t){var i,r,o={};return!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:(i=s.getElement(t,e),!n(i,"object")||i.length<1?!1:(r=i.offset(),o.x_position=r.left,o.y_position=r.top,o.width=i.width(),o.height=i.height(),o.margin={top:i.css("margin-top"),right:i.css("margin-right"),bottom:i.css("margin-bottom"),left:i.css("margin-left")},o.padding={top:i.css("padding-top"),right:i.css("padding-right"),bottom:i.css("padding-bottom"),left:i.css("padding-left")},o.border={top:i.css("border-top-width"),right:i.css("border-right-width"),bottom:i.css("border-bottom-width"),left:i.css("border-left-width")},o))},render:function(){var e;return this.remove(),n(this.active_element,"element")&&n(this.active_media_query,"object")?(e=this._getElementPosition(this.active_element.getElement().id,this.active_media_query.getMediaQuery().id),this.margin_preview_visible&&(this.views.margin_preview.render(e),this.$el.append(this.views.margin_preview.$el)),this.padding_preview_visible&&(this.views.padding_preview.render(e),this.$el.append(this.views.padding_preview.$el)),(this.margin_preview_visible||this.padding_preview_visible)&&t(this.app_el).append(this.$el),!0):!1},showAllPreviews:function(){return this.padding_preview_visible=!0,this.margin_preview_visible=!0,this.render(),!0},hideAllPreviews:function(){return this.margin_preview_visible=!1,this.padding_preview_visible=!1,this.render(),!0},remove:function(){return this.views.margin_preview.remove(),this.views.padding_preview.remove(),u.__super__.remove.apply(this,arguments),!0},destroy:function(){return this.remove(),this.imc.off(null,null,this),!0}});return u}),define("core/components/dialog/views/drag_and_drop",["jquery","backbone","core/utils/is"],function(e,t,i){return t.View.extend({className:"drag-handle",events:{mousedown:"startDrag"},$_namespace:".dialog-drag-handle",initialize:function(e){i(e,"object")&&i(e.$parent_el,"object")&&(this.$parent_el=e.$parent_el)},render:function(){this.delegateEvents()},startDrag:function(t){var n,s,r,o;return i(t,"object")?(t.preventDefault(),r=t.originalEvent&&t.originalEvent.layerX,o=t.originalEvent&&t.originalEvent.layerY,n=i(t.offsetX,"undefined")?r:t.offsetX,s=i(t.offsetY,"undefined")?o:t.offsetY,this.monitorMouseMovements(n,s),e(document).one("mouseup"+this.$_namespace,e.proxy(this,"stopDrag")),!0):!1},stopDrag:function(){return this.unmonitorMouseMovements(),!0},mouseMoved:function(e,t,n){var s,r,o=0,a=50,l=parseInt(window.innerWidth,10)-parseInt(this.$el.width(),10),c=parseInt(window.innerHeight,10)-30;return e=parseInt(e,10),t=parseInt(t,10),isNaN(e)||isNaN(t)?!1:i(n,"object")?(s=parseInt(n.clientX,10),r=parseInt(n.clientY,10),isNaN(s)||isNaN(r)?!1:(s-=e,r-=t,o>s&&a>r?!1:s>l&&a>r?!1:o>s&&r>c?!1:s>l&&r>c?!1:(o>s&&(s=o),a>r&&(r=a),s>l&&(s=l),r>c&&(r=c),this.moveDialog(s,r),!0))):!1},moveDialog:function(e,t){return e=parseInt(e,10),t=parseInt(t,10),isNaN(e)||isNaN(t)?!1:(this.$parent_el.css({left:e,top:t}),!0)},monitorMouseMovements:function(t,i){return t=parseInt(t,10),i=parseInt(i,10),isNaN(t)||isNaN(i)?!1:(e(document).on("mousemove"+this.$_namespace,e.proxy(this,"mouseMoved",t,i)),!0)},unmonitorMouseMovements:function(){return e(document).off("mousemove"+this.$_namespace),!0}})}),define("core/components/dialog/index",["underscore","backbone","jquery","core/utils/is","./views/drag_and_drop"],function(e,t,i,n,s){var r=t.UIController.extend({namespace:"ui:dialog",tagName:"div",className:"vanilla-dialog",defaultClassName:"dialog",activeClassName:"active-dialog",_is_rendered:!1,ignore_next_send_to_back:!1,listeners:e.extend({},t.UIController.prototype.listeners,{open:"open",close:"remove","[remote]ui:dialogs:close":"remove","[remote]ui:dialogs:send-to-back":"sendToBack"}),events:{mousedown:"onMouseDown"},views:null,initialize:function(){this.views={},this.$el.addClass(this.defaultClassName),this.app_el=i(this.app_el),this.views.drag_and_drop=new s({$parent_el:this.$el})},open:function(){return this.render.apply(this,arguments),this.makeActive(),!0},render:function(e){return this.delegateEvents(),this.isRendered()&&this.remove(),n(e,"array")||(e=[]),[this.views.drag_and_drop].concat(e).forEach(function(e){e.render(),this.$el.append(e.$el)},this),this.app_el.append(this.$el),this.setRendered(!0),!0},remove:function(){var e=Object.keys(this.views);return e.length>0&&e.forEach(function(e){n(this.views[e].remove,"function")&&this.views[e].remove()},this),t.UIController.prototype.remove.apply(this,arguments),this.setRendered(!1),!0},sendToBack:function(){return this.isRendered()?this.getIgnoreNextSendToBack()?(this.setIgnoreNextSendToBack(!1),!1):(this.$el.removeClass(this.activeClassName),!0):!1},isRendered:function(){return!!this._is_rendered},setRendered:function(e){return n(e,"boolean")?(this._is_rendered=e,!0):!1},setIgnoreNextSendToBack:function(e){return n(e,"boolean")?(this._ignore_next_send_to_back=e,!0):!1},getIgnoreNextSendToBack:function(){return this._ignore_next_send_to_back},onMouseDown:function(){return this.makeActive(),!0},makeActive:function(){return this.$el.hasClass(this.activeClassName)?!1:(this.$el.addClass(this.activeClassName),this.setIgnoreNextSendToBack(!0),this.imc.trigger("ui:dialogs:send-to-back"),!0)},destroy:function(){r.__super__.destroy.apply(this,arguments)}});return r}),define("hbs!core/components/extended_dialog/templates/title",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<div class="info-tooltip">\n    <span aria-hidden="true" data-icon="ÓÄí"></span>\n    <span class="screen-reader-text">Info</span>\n    <div class="info">\n        <p>',(o=i.info)?o=o.call(t,{hash:{}}):(o=t.info,o=typeof o===l?o.apply(t):o),a+=c(o)+'</p>\n    </div>\n</div>\n<span class="dialog-pin',o=i["if"].call(t,t.is_pinned,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+='" title="Pin this dialog" data-title-pinned="Unpin this dialog" data-title-unpinned="Pin this dialog">Pin Dialog</span>\n<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="ÓÄ¶"></span><span class="screen-reader-text">Close</span></a>\n<h4>',(o=i.title)?o=o.call(t,{hash:{}}):(o=t.title,o=typeof o===l?o.apply(t):o),a+=c(o)+"</h4>\n"});return t.registerPartial("core_components_extended_dialog_templates_title",i),i}),define("core/components/extended_dialog/views/title",["backbone","core/utils/is","hbs!../templates/title"],function(e,t,i){return e.View.extend({template:i,className:"header",_is_pinned:!1,events:{"click .close-cross":"closeDialog","click .dialog-pin":"pinButtonClicked"},initialize:function(e){this.data={title:"Vanilla",info:"A vanilla dialog"},t(e,"object")&&(t(e.title,"string")&&(this.data.title=e.title),t(e.info,"string")&&(this.data.info=e.info))},render:function(){var e=this.template({title:this.data.title,info:this.data.info,is_pinned:this._is_pinned});this.$el.html(e),this.delegateEvents()},getTitle:function(){return this.data.title},setTitle:function(e){return t(e,"string")?(this.data.title=e,!0):!1},getInfo:function(){return this.data.info},setInfo:function(e){return t(e,"string")?(this.data.info=e,!0):!1},closeDialog:function(e){return e.preventDefault(),this.trigger("dialog:close",!0),!0},pinButtonClicked:function(e){e.preventDefault(),this.setPinned(!this._is_pinned),this._is_pinned?this.$(".dialog-pin").addClass("active"):this.$(".dialog-pin").removeClass("active")},setPinned:function(e){return t(e,"boolean")?(this._is_pinned=e,!0):!1},isPinned:function(){return this._is_pinned}})}),define("core/components/extended_dialog/index",["underscore","core/utils/is","core/components/dialog/index","./views/title"],function(e,t,i,n){var s=i.extend({namespace:"ui:extended-dialog",tagName:"div",className:"vanilla-extended-dialog",listeners:e.extend({},i.prototype.listeners,{toggle:"toggle"}),initialize:function(){s.__super__.initialize.apply(this,arguments),this.views.title=new n,this.views.title.on("dialog:close",this.closeDialog,this)},render:function(e){t(e,"array")||(e=[]),e=[this.views.title].concat(e),s.__super__.render.call(this,e)},closeDialog:function(e){return e||!this.views.title.isPinned()?(this.remove(),!0):!1},toggle:function(){return this.isRendered()?this.closeDialog(!0):this.open.apply(this,arguments),!0},destroy:function(){this.views.title.off("dialog:close",this.closeDialog,this),s.__super__.destroy.apply(this,arguments)}});return s}),define("ui/element-dialog/models/element-type",["core/utils/is","core/typecastError","backbone"],function(e,t,i){"use strict";return i.Model.extend({defaults:function(){return{tag:"p",class_name:""}},getSelector:function(){var t=this.get("tag"),i=this.get("class_name");return!e(i,"undefined")&&i.length>0&&(t+="."+i),t},isBase:function(){return this.get("class_name").length>0?!1:!0}})}),define("ui/element-dialog/collections/element-types",["backbone","underscore","core/utils/is","core/typecastError","../models/element-type"],function(e,t,i,n,s){"use strict";var r=e.Collection.extend({possible_base_tags:null,active_element_type:null,createElementType:function(e,t,r,o){var a;return i(e,"string")&&i(t,"tag")&&i(r,"object")?(i(o,"string")||(o=""),this._isValidBaseTag(t)?(a=new s({tag:t}),a.set("attributes",r),a.set("class_name",o),a.set("display_name",a.getSelector()),this._isDuplicate(a.get("display_name"))?new n(108,"The element type already exists"):(a.set("action",e),this.add([a]),a)):new n(107,"The element type must be based on a valid base tag")):!1},copyElementType:function(t,s,r){return t instanceof e.Model?i(s,"string")?i(r,"string")?this._isDuplicate(s+"."+r)?new n(108,"The element type already exists"):void this.trigger("copy:element-type",t,s,r):new n(103,"You must provide a class for the element type"):new n(102,"You must provide a tag name for the element type"):new n(101,"A model must be provided")},renameElementType:function(t,s,r){return t instanceof e.Model?i(s,"string")?i(r,"string")?this._isDuplicate(s+"."+r)?new n(108,"The element type already exists"):void this.trigger("rename:element-type",t,s,r):new n(103,"You must provide a class for the element type"):new n(102,"You must provide a tag name for the element type"):new n(101,"A model must be provided")},comparator:function(e,t){var i=e.get("display_name"),n=t.get("display_name"),s=/^p/;return s.test(i)&&s.test(n)?n>i?-1:1:s.test(i)?-1:s.test(n)?1:n>i?-1:i>n?1:0},setPossibleBaseTags:function(e){return i(e,"array")?(this.possible_base_tags=e,!0):!1},_isDuplicate:function(e){var t=this.where({display_name:e});return t.length>0?!0:!1},_isValidBaseTag:function(e){var n;return i(e,"string")?null===this.possible_base_tags?!0:(n=t.find(this.possible_base_tags,function(t){return e===t}),i(n,"undefined")?!1:!0):!1}});return r}),define("ui/../../core/typecastError",[],function(){var e=function(e,t){Error.call(this,t),this.message=t,this.errorCode=e};return e.prototype=new Error,e.prototype.constructor=e,e.prototype.name="TypecastError",e.prototype.getCode=function(){return this.errorCode},e.prototype.getMessage=function(){return this.message},e}),define("hbs!ui/element-dialog/templates/element-type",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+="\n            <p>",(n=i.display_name)?n=n.call(e,{hash:{}}):(n=e.display_name,
n=typeof n===h?n.apply(e):n),s+=d(n)+'</p>\n            <p><img src="/js/src/images/placeholder-300x200.svg" ',n=i["if"].call(e,e.class_name,{hash:{},inverse:p.noop,fn:p.program(2,o,t)}),(n||0===n)&&(s+=n),s+="/></p>\n        "}function o(e,t){var n,s="";return s+=' class="',(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===h?n.apply(e):n),s+=d(n)+'"'}function a(e,t){var n,s="";return s+="\n            <",(n=i.tag)?n=n.call(e,{hash:{}}):(n=e.tag,n=typeof n===h?n.apply(e):n),s+=d(n)+' class="element-type-style-reset ',n=i["if"].call(e,e.class_name,{hash:{},inverse:p.noop,fn:p.program(5,l,t)}),(n||0===n)&&(s+=n),s+='">',(n=i.display_name)?n=n.call(e,{hash:{}}):(n=e.display_name,n=typeof n===h?n.apply(e):n),s+=d(n)+"</",(n=i.tag)?n=n.call(e,{hash:{}}):(n=e.tag,n=typeof n===h?n.apply(e):n),s+=d(n)+">\n        "}function l(e,t){var n,s="";return s+=" ",(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===h?n.apply(e):n),s+=d(n)+" "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="",h="function",d=this.escapeExpression,p=this;return u+='<div class="element-styles cf">\n    <div class="',(c=i.container_class)?c=c.call(t,{hash:{}}):(c=t.container_class,c=typeof c===h?c.apply(t):c),u+=d(c)+'">\n        ',c=i["if"].call(t,t.is_image,{hash:{},inverse:p.program(4,a,s),fn:p.program(1,r,s)}),(c||0===c)&&(u+=c),u+='\n    </div>\n</div>\n<ul class="actions">\n    <li><button class="copy">Copy</button></li>\n</ul>\n<span class="element-style-details">',(c=i.css_attributes)?c=c.call(t,{hash:{}}):(c=t.css_attributes,c=typeof c===h?c.apply(t):c),u+=d(c)+"</span>\n"});return t.registerPartial("ui_element-dialog_templates_element-type",i),i}),define("hbs!ui/element-dialog/templates/element-type-with-class",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+="\n            <p>",(n=i.display_name)?n=n.call(e,{hash:{}}):(n=e.display_name,n=typeof n===d?n.apply(e):n),s+=p(n)+'</p>\n            <p><img src="/js/src/images/placeholder-300x200.svg" ',n=i["if"].call(e,e.class_name,{hash:{},inverse:f.noop,fn:f.program(2,o,t)}),(n||0===n)&&(s+=n),s+="/></p>\n        "}function o(e,t){var n,s="";return s+=' class="',(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===d?n.apply(e):n),s+=p(n)+'"'}function a(e,t){var n,s="";return s+="\n	        <",(n=i.tag)?n=n.call(e,{hash:{}}):(n=e.tag,n=typeof n===d?n.apply(e):n),s+=p(n)+' class="element-type-style-reset ',n=i["if"].call(e,e.class_name,{hash:{},inverse:f.noop,fn:f.program(5,l,t)}),(n||0===n)&&(s+=n),s+='">',(n=i.display_name)?n=n.call(e,{hash:{}}):(n=e.display_name,n=typeof n===d?n.apply(e):n),s+=p(n)+"</",(n=i.tag)?n=n.call(e,{hash:{}}):(n=e.tag,n=typeof n===d?n.apply(e):n),s+=p(n)+">\n        "}function l(e,t){var n,s="";return s+=" ",(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===d?n.apply(e):n),s+=p(n)+" "}function c(e,t){return'\n    <li><button class="rename">Rename</button></li>\n    <li><button class="delete">Delete</button></li>\n    '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var u,h="",d="function",p=this.escapeExpression,f=this;return h+='<div class="element-styles cf">\n    <div class="',(u=i.container_class)?u=u.call(t,{hash:{}}):(u=t.container_class,u=typeof u===d?u.apply(t):u),h+=p(u)+'">\n        ',u=i["if"].call(t,t.is_image,{hash:{},inverse:f.program(4,a,s),fn:f.program(1,r,s)}),(u||0===u)&&(h+=u),h+='\n    </div>\n</div>\n<ul class="actions">\n    <li><button class="copy">Copy</button></li>\n    ',u=i["if"].call(t,t.container_is_classless,{hash:{},inverse:f.noop,fn:f.program(7,c,s)}),(u||0===u)&&(h+=u),h+='\n</ul>\n<span class="element-style-details">',(u=i.css_attributes)?u=u.call(t,{hash:{}}):(u=t.css_attributes,u=typeof u===d?u.apply(t):u),h+=p(u)+"</span>\n"});return t.registerPartial("ui_element-dialog_templates_element-type-with-class",i),i}),define("ui/element-dialog/views/element-type",["jquery","underscore","backbone","core/utils/is","../../../../core/typecastError","../models/element-type","hbs!../templates/element-type","hbs!../templates/element-type-with-class"],function(e,t,i,n,s,r,o,a){var l=i.View.extend({tagName:"li",className:"element-type",template:null,events:{click:"change","click button.copy":"copy","click button.rename":"rename","click button.delete":"deleteElementType"},initialize:function(e){if(n(e,"undefined")||!(e.model instanceof r))throw new s(101,"You must pass in an ElementTypeModel");if(!(this.collection instanceof i.Collection))throw new s(102,"You need to provide an ElementTypeCollection instance");this.model.isBase()?this.template=o:this.template=a,this.listenTo(this.model,"change:attributes",this.render)},render:function(){var e,i,s,r=!0;return this.remove(),n(this.collection.active_container_element,"object")&&(i=this.collection.active_container_element.getElement(),n(i.attributes["class"],"string")&&i.attributes["class"].length>0?(r=!1,s=i.attributes["class"]):(r=!0,s="")),this.collection.active_element_type_selector===this.model.get("display_name")&&this.$el.addClass("active-type"),e=this.template(t.extend({container_is_classless:r,container_class:s,css_attributes:this._getAttributesString(),is_image:"img"===this.model.get("tag")},this.model.toJSON())),this.$el.html(e),this.delegateEvents(),this},change:function(){this.collection.trigger("change:element-type",this.model)},copy:function(e){n(e,"object")&&e.stopPropagation(),this.collection.trigger("open-for:copy:element-type",this.model)},rename:function(e){n(e,"object")&&e.stopPropagation(),this.collection.trigger("open-for:rename:element-type",this.model)},deleteElementType:function(e){n(e,"object")&&e.stopPropagation(),this.collection.trigger("delete:element-type",this.model)},_getAttributesString:function(){var e=this.model.get("attributes"),t=[],i="";return n(e,"object")?(n(e["font-family"],"array")&&t.push(e["font-family"][0]),n(e["font-weight"],"array")&&t.push(e["font-weight"][0]),n(e["font-size"],"array")&&t.push(e["font-size"][0]),t.forEach(function(e){i+=e,i+=", "}),i.substring(0,i.length-2)):""},remove:function(){this.$el.removeClass("active-type"),l.__super__.remove.apply(this)}});return l}),define("hbs!ui/element-dialog/templates/element-type-list",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r="";return r});return t.registerPartial("ui_element-dialog_templates_element-type-list",i),i}),define("ui/element-dialog/views/element-type-list",["jquery","backbone","core/utils/is","../../../../core/typecastError","../collections/element-types","../views/element-type","../models/element-type","hbs!../templates/element-type-list"],function(e,t,i,n,s,r,o,a){var l=t.View.extend({template:a,tagName:"ul",className:"element-type-list",element_type_views:null,initialize:function(e){if(i(e,"undefined")||!(e.collection instanceof s))throw new n("You must pass in an ElementTypes collection");this.element_type_views=[]},createElementTypeView:function(e){var t;return e instanceof o?(t=new r({model:e,collection:this.collection}),this.element_type_views.push(t),t):!1},render:function(){var e=this.template();return this.$el.html(e),this.stopListening(this.collection,"update:element-types"),this.listenTo(this.collection,"update:element-types",this.render),this.removeElementTypeViews(),this.collection.forEach(function(e){var t=this.createElementTypeView(e);t.render(),this.$el.append(t.$el)},this),this},removeElementTypeViews:function(){this.element_type_views.forEach(function(e){e.remove()}),this.element_type_views=[]}});return l}),define("hbs!ui/element-dialog/templates/filter-input",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<input type="text" placeholder="Search title or property of any style" />\n'});return t.registerPartial("ui_element-dialog_templates_filter-input",i),i}),define("ui/element-dialog/views/filter-input",["jquery","backbone","core/typecastError","hbs!../templates/filter-input"],function(e,t,i,n){return t.View.extend({className:"element-type-filter",template:n,events:{"keyup input":"handleKeyupEvent"},initialize:function(){if(!(this.collection instanceof t.Collection))throw new i(101,"You need to provide an ElementTypeCollection");this.render()},render:function(){var e=this.template();return this.$el.html(e),this.delegateEvents(),this},handleKeyupEvent:function(){this.collection.trigger("filter:list",this._getInputValue())},resetFilter:function(){return this.$el.children("input").val(""),this.collection.trigger("filter:list",this._getInputValue()),!0},_getInputValue:function(){return this.$el.children("input").val()}})}),define("hbs!ui/element-dialog/templates/create-new-class",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<button class="button medium blue">Create a class</button>\n'});return t.registerPartial("ui_element-dialog_templates_create-new-class",i),i}),define("ui/element-dialog/views/create-new-class",["jquery","backbone","core/typecastError","hbs!../templates/create-new-class"],function(e,t,i,n){return t.View.extend({className:"create-new-class",template:n,events:{"click button":"handleClickEvent"},initialize:function(){if(!(this.collection instanceof t.Collection))throw new i("You need to pass in an instance of ElementTypeCollection")},render:function(){var e=this.template();return this.$el.html(e),this.delegateEvents(),this},handleClickEvent:function(){this.collection.trigger("open-for:create:element-type")}})}),define("core/utils/smartCorrector",["underscore","core/utils/typeof"],function(e,t){var i;return i=function(){},i.prototype.setRules=function(n){return t(n,"object")?(this.rules=n,e.some(n,i._isInvalid)?(this.has_invalid_rules=!0,!1):(this.has_invalid_rules=!1,!0)):!1},i.prototype.correct=function(t){var n=t;return this.has_invalid_rules?!1:e.isString(t)?(e(this.rules).forEach(function(e){n=i._applyRule(e,n)}),n):!1},i._isValid=function(t){return e.isObject(t)&&e.isString(t.pattern)&&i._isValidSubstitude(t.substitute)},i._isInvalid=function(e){return!i._isValid(e)},i._isValidSubstitude=function(t){return e.isString(t)||e.isFunction(t)&&i._checkSubstituteReturnsAString(t)},i._checkSubstituteReturnsAString=function(t){try{return e.isFunction(t)&&e.isString(t.call(this,"test"))}catch(i){return!1}},i._applyRule=function(t,n){return i._isValid(t)&&e.isString(n)?n.replace(new RegExp(t.pattern,"g"),t.substitute):n},i}),define("hbs!ui/element-dialog/templates/create-custom-class",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="ÓÄ¶"></span><span class="screen-reader-text">Close</span></a>\n<h1>Create a custom class</h1>\n<p>\n    Create a new class, it will replace your currently selected element and will\n    become available in your elements list\n</p>\n<p class="error"></p>\n<input type="text"  placeholder="e.g. &quot;p.authorbio&quot;, &quot;h2.overview&quot;, &quot;p.fancy-pants&quot;" />\n<button class="button medium blue">Create and apply</button>\n'});return t.registerPartial("ui_element-dialog_templates_create-custom-class",i),i}),define("hbs!ui/element-dialog/templates/rename-custom-class",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="ÓÄ¶"></span><span class="screen-reader-text">Close</span></a>\n<h1>Rename class</h1>\n<p class="error"></p>\n<input type="text" value="',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+".",(r=i.class_name)?r=r.call(t,{hash:{}}):(r=t.class_name,r=typeof r===a?r.apply(t):r),o+=l(r)+'" />\n<div class="element-style-details">e.g. "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.info", "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.overview", "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.fancypants"</div>\n<button class="button medium blue">Create and apply</button>\n'});return t.registerPartial("ui_element-dialog_templates_rename-custom-class",i),i}),define("hbs!ui/element-dialog/templates/copy-custom-class",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="ÓÄ¶"></span><span class="screen-reader-text">Close</span></a>\n<h1>Copy class</h1>\n<p class="error"></p>\n<input type="text" value="',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'." />\n<div class="element-style-details">e.g. "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.info", "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.overview", "',(r=i.tag)?r=r.call(t,{hash:{}}):(r=t.tag,r=typeof r===a?r.apply(t):r),o+=l(r)+'.fancypants"</div>\n<button class="button medium blue">Create and apply</button>\n'});return t.registerPartial("ui_element-dialog_templates_copy-custom-class",i),i}),define("ui/element-dialog/views/custom-class",["jquery","backbone","core/utils/is","core/typecastError","core/utils/smartCorrector","../models/element-type","hbs!../templates/create-custom-class","hbs!../templates/rename-custom-class","hbs!../templates/copy-custom-class"],function(e,t,i,n,s,r,o,a,l){return t.View.extend({className:"custom-class",create_template:o,rename_template:a,copy_template:l,events:{"click button":"handleCreateAndApplyButtonClick","keyup input":"handleKeyPress","click .close-cross":"close"},smart_corrector:null,action:null,initialize:function(){if(!(this.collection instanceof t.Collection))throw new n("You need to pass in an ElementTypeCollection instance");this.smart_corrector=new s,this.smart_corrector.setRules({"convert spaces and underscores to dashes":{pattern:"( |_)+",substitute:"-"},"translate all uppercase characters to lowercase":{pattern:"[A-Z]",substitute:function(e){return e.toLowerCase()}},"remove all invalid characters":{pattern:"[^a-z0-9-]",substitute:""},"remove leading numbers":{pattern:"^[0-9]+",substitute:""},"remove leading dashes":{pattern:"^-+",substitute:""}}),this.listenTo(this.collection,"copy:element-type",this.render,this)},render:function(e,n){var s,r;return i(e,"string")?(this.action=e,n instanceof t.Model?(this.model=n,this.$el.empty(),r=this.model.toJSON(),s="copy"===e?this.copy_template(r):"rename"===e?this.rename_template(r):this.create_template(r),this.$el.append(s),this.delegateEvents(),this):!1):!1},close:function(e){return i(e,"object")?(e.preventDefault(),this.remove(),!0):!1},selectInput:function(){var e,t;return(e=this.$("input").get(0))?(e.focus(),i(e.selectionStart,"number")?e.selectionStart=e.selectionEnd=e.value.length:i(e.createTextRange,"undefined")||(t=e.createTextRange(),t.collapse(!1),t.select()),!0):!1},handleCreateAndApplyButtonClick:function(){var e,t=this.$el.children("input").val(),i=t.split("."),n=i[0];return e=this.smart_corrector.correct(i[1]),"create"===this.action?this.createCustomClass(n,e):"copy"===this.action?this.copyCustomClass(n,e):"rename"===this.action&&this.renameCustomClass(n,e),!0},handleKeyPress:function(e){if(i(e,"object")){if(13===e.keyCode)return this.handleCreateAndApplyButtonClick();if(8===e.keyCode)return!0}return!1},createCustomClass:function(e,t){var s;return i(e,"string")?!i(t,"string")||t.length<1?(this._displayError("You must provide a class for the element type"),!1):(s=this.collection.createElementType("create",e,{},t),s instanceof n?(this._displayError(s.message),!1):(this.trigger("close:custom-class"),!0)):(this._displayError("You must provide a tag name for the element type"),!1)},copyCustomClass:function(e,t){var i=this.collection.copyElementType(this.model,e,t);return i instanceof n?(this._displayError(i.message),!1):(this.trigger("close:custom-class"),!0)},renameCustomClass:function(e,t){var i=this.collection.renameElementType(this.model,e,t);return i instanceof n?(this._displayError(i.message),!1):(this.trigger("close:custom-class"),!0)},_displayError:function(e){return i(e,"string")?void this.$el.children("p.error").text(e):!1}})}),define("ui/element-dialog/index",["jquery","underscore","backbone","core/utils/is","core/utils/cast","core/typecastError","core/components/extended_dialog/index","./collections/element-types","./models/element-type","./views/element-type-list","./views/filter-input","./views/create-new-class","./views/custom-class"],function(e,t,i,n,s,r,o,a,l,c,u,h,d){var p=o.extend({namespace:"ui:element-dialog",id:"dialog-format-wrapper",title_text:"Change to:",title_info:"Switch the current element to a different type and inherit the new type's styles.",app_el:null,collection:null,listeners:t.extend({},i.UIController.prototype.listeners,o.prototype.listeners,{"[remote]data:styles:changed":"_handleStyleDeclarationChange"}),initialize:function(){p.__super__.initialize.apply(this,arguments),this.views.title.setTitle(this.title_text),this.views.title.setInfo(this.title_info),this.collection=new a,this._setupCoreViews(),this._setupListenersOnCollection()},render:function(){var e=[this.create_new_class_view,this.filter_input_view,this.element_type_list_view];return this._updateElementTypeCollection(this.active_style_id),p.__super__.render.call(this,e),this._setupListenersOnCollection(),this},openCustomClassView:function(e,t){return n(e,"string")&&t instanceof l?(this.closeCustomClassView(),this.listenTo(this.custom_class_view,"close:custom-class",this.closeCustomClassView),this.custom_class_view.render(e,t),this.$el.append(this.custom_class_view.$el),void this.custom_class_view.selectInput()):!1},closeCustomClassView:function(){this.custom_class_view.remove()},changeActiveElementType:function(e){var t;return e instanceof i.Model?(t={tag_name:e.get("tag"),attributes:{"class":""}},e.get("class_name").length>0&&(t.attributes["class"]=e.get("class_name")),this.imc.trigger("data:elements:updateElement",this.active_element.getElement().id,t,{}),void this.closeDialog()):!1},createElementType:function(e){return this.changeActiveElementType(e)},copyElementType:function(e,t,s){var r,o;return n(this.active_media_query,"object")&&e instanceof i.Model&&n(t,"string")&&n(s,"string")?(r=this._getSelectorFromTagNameAndClassName(e.get("tag"),e.get("class_name")),o=this._getSelectorFromTagNameAndClassName(t,s),this.imc.trigger("data:styles:copyStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,r,o,function(e){var i;return e?!1:(i=new l({tag:t,class_name:s}),i.set("display_name",i.getSelector()),this.collection.add(i),void this.changeActiveElementType(i))},this),!0):!1},renameElementType:function(e,t,s){var r,o;return n(this.active_media_query,"object")&&e instanceof i.Model&&n(t,"string")&&n(s,"string")?(r=this._getSelectorFromTagNameAndClassName(e.get("tag"),e.get("class_name")),o=this._getSelectorFromTagNameAndClassName(t,s),this.imc.trigger("data:styles:renameStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,r,o,function(){this.imc.trigger("data:elements:changeSelectorForElements",r,o),e.set({tag:t,class_name:s}),e.set("display_name",e.getSelector())},this),this.element_type_list_view.render(),!0):!1},deleteElementType:function(e){var t;return n(this.active_media_query,"object")&&e instanceof i.Model?(t=this._getSelectorFromTagNameAndClassName(e.get("tag"),e.get("class_name")),this.imc.trigger("data:elements:deleteElementType",t),this.imc.trigger("data:styles:deleteStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,t),this._updateElementTypeCollection(this.active_style_id),!0):!1},_getSelectorFromTagNameAndClassName:function(e,t){var i=e;return n(t,"string")&&t.length>0&&(i+="."+t),i},_setupCoreViews:function(){return this.filter_input_view=new u({collection:this.collection}),this.element_type_list_view=new c({collection:this.collection}),this.create_new_class_view=new h({collection:this.collection}),this.custom_class_view=new d({collection:this.collection}),!0},_setupListenersOnCollection:function(){this.stopListening(),this.listenTo(this.collection,"filter:list",function(e){this._updateElementTypeCollection(this.active_style_id,e)},this),this.listenTo(this.collection,"open-for:create:element-type",function(){this.openCustomClassView("create",new l)},this),this.listenTo(this.collection,"open-for:copy:element-type",function(e){this.openCustomClassView("copy",e)},this),this.listenTo(this.collection,"open-for:rename:element-type",function(e){this.openCustomClassView("rename",e)},this),this.listenTo(this.collection,"change:element-type",this.changeActiveElementType,this),this.listenTo(this.collection,"add",function(e){var t=e.get("action");n(t,"string")&&"create"===t&&(this.createElementType(e),this.filter_input_view.resetFilter())},this),this.listenTo(this.collection,"copy:element-type",this.copyElementType,this),this.listenTo(this.collection,"rename:element-type",this.renameElementType,this),this.listenTo(this.collection,"delete:element-type",this.deleteElementType,this)},onChangeActiveStyle:function(e){return n(e,"string")&&(e=parseInt(e,10)),n(e,"number")?(this._updateElementTypeCollection(e),!0):!1},onChangeActiveElement:function(e,t){var i;return n(t,"element")&&this.imc.off("data:elements:updated:element:"+t.getElement().id,null,this),n(e,"element")?(i=e.getElement(),this._handleActiveElementSelectorChange(this._getSelectorFromTagNameAndClassName(i.tag_name,i.attributes["class"])),void this.imc.on("data:elements:updated:element:"+i.id,function(e){var t=e.getElement();this._handleActiveElementSelectorChange(this._getSelectorFromTagNameAndClassName(t.tag_name,t.attributes["class"]))},this)):!1},_handleActiveElementSelectorChange:function(e){return n(e,"string")?(this.imc.off("data:styles:changed:"+this.collection.active_element_type_selector,null,this),this.imc.on("data:styles:changed:"+e,this._handleStylesChanged,this),this.collection.active_element_type_selector=e,this.element_type_list_view.render(),!0):!1},_handleStylesChanged:function(e,i,s,r){return n(e,"number")&&n(r,"array")&&this.active_style_id===e?((t.contains(r,"font-family")||t.contains(r,"font-weight")||t.contains(r,"font-size"))&&this._updateElementTypeCollection(this.active_style_id),!0):!1},_updateElementTypeCollection:function(t,i,s,o){var a,l=new e.Deferred,c=new e.Deferred,u=new e.Deferred,h=this;return n(t,"number")&&n(this.active_element,"element")&&n(this.active_media_query,"object")?(a=this.active_media_query.getMediaQuery().id,n(s,"function")||(s=!1),this.imc.trigger("data:elements:getTagNameAndClassCombinations",this.active_element.getElement().id,l.resolve),this.imc.trigger("data:elements:getSupportedElements",this.active_element.getElement().id,u.resolve),this.imc.trigger("data:styles:getStyleDeclarationsByStyleAndMediaQuery",t,a,c.resolve),this.collection.reset(),e.when(l,c,u).then(function(e,t,a){var l,c,u;l=e[0]instanceof r?[]:e[1],u=t[0]instanceof r?[]:t[1],c=a[0]instanceof r?[]:a[1],(!n(i,"string")||i.length<1)&&(i=void 0),h.collection.setPossibleBaseTags(c),h._mergeCombinationsAndStyleDeclarations(l,u,i),h.collection.trigger("update:element-types"),s&&s.apply(o)}),!0):!1},_mergeCombinationsAndStyleDeclarations:function(e,i,s){return n(e,"array")&&n(i,"array")&&(n(s,"undefined")||n(s,"string"))?(e.forEach(function(e){(n(s,"undefined")||this._isFilterMatch(s,e.tag_name))&&this.collection.createElementType("initialise",e.tag_name,{}),e.classes.forEach(function(t){var i=e.tag_name+"."+t;(n(s,"undefined")||this._isFilterMatch(s,i))&&this.collection.createElementType("initialise",e.tag_name,{},t)},this)},this),i.forEach(function(i){var r,o,a,l,c,u,h;i=i.style_declaration,l=i.selector,(n(s,"undefined")||this._isFilterMatch(s,l))&&(o=this._getTagAndClass(l),n(this.collection.active_container_element,"object")&&(h=this.collection.active_container_element.element.attributes["class"]),c=t.find(e,function(e){return e.tag_name===o.tag?!0:void 0}),r=o.tag,n(o.class_name,"string")&&(r+="."+o.class_name),u=n(i.attributes,"object")?i.attributes:{},a=this.collection.find(function(e){return e.getSelector()===r?(e.set("attributes",u),!0):void 0}),!n(c,"undefined")&&n(a,"undefined")&&this.collection.createElementType("initialise",o.tag,u,o.class_name))},this),!0):!1},_getTagAndClass:function(e){var i,s,r,o;return!n(e,"string")||e.length<1?!1:(i=t.last(e.split(" ")),s=i.split("."),o=2===s.length?s[1]:null,r={tag:s[0],class_name:o})},_isFilterMatch:function(e,t){var i,s=new RegExp(e);return n(e,"string")&&n(t,"string")?(i=t.match(s),n(i,"null")?!1:!0):!1},remove:function(){this.filter_input_view.remove(),this.element_type_list_view.remove(),this.create_new_class_view.remove(),this.custom_class_view.remove(),p.__super__.remove.call(this)}});return p}),function(e){function t(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function i(e,t){for(var i=[];t>0;i[--t]=e);return i.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};n.format=function(e,s){var r,o,a,l,c,u,h,d=1,p=e.length,f="",g=[];for(o=0;p>o;o++)if(f=t(e[o]),"string"===f)g.push(e[o]);else if("array"===f){if(l=e[o],l[2])for(r=s[d],a=0;a<l[2].length;a++){if(!r.hasOwnProperty(l[2][a]))throw n('[sprintf] property "%s" does not exist',l[2][a]);r=r[l[2][a]]}else r=l[1]?s[l[1]]:s[d++];if(/[^s]/.test(l[8])&&"number"!=t(r))throw n("[sprintf] expecting number but found %s",t(r));switch(l[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=l[7]?r.toExponential(l[7]):r.toExponential();break;case"f":r=l[7]?parseFloat(r).toFixed(l[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&l[7]?r.substring(0,l[7]):r;break;case"u":r>>>=0;break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(l[8])&&l[3]&&r>=0?"+"+r:r,u=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",h=l[6]-String(r).length,c=l[6]?i(u,h):"",g.push(l[5]?r+c:c+r)}return g.join("")},n.cache={},n.parse=function(e){for(var t=e,i=[],n=[],s=0;t;){if(null!==(i=/^[^\x25]+/.exec(t)))n.push(i[0]);else if(null!==(i=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(i=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(i[2]){s|=1;var r=[],o=i[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(o)))throw"[sprintf] huh?";for(r.push(a[1]);""!==(o=o.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(o)))r.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(o)))throw"[sprintf] huh?";r.push(a[1])}i[2]=r}else s|=2;if(3===s)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";n.push(i)}t=t.substring(i[0].length)}return n};var s=function(e,t,i){return i=t.slice(0),i.splice(0,0,e),n.apply(null,i)};e.sprintf=n,e.vsprintf=s}("undefined"!=typeof exports?exports:window),define("sprintf",function(e){return function(){var t;return t||e.sprintf}}(this)),define("ui/colour-dialog/utils",["sprintf","core/utils/is"],function(e,t){return{validateColourObject:function(e){var i,n;return t(e,"object")?(n={r:"number",g:"number",b:"number",a:"number",h:"number",s:"number",v:"number",hex:"string",ahex:"string"},i=Object.keys(e),Object.keys(n).length!==i.length?!1:i.every(function(i){return!!n[i]&&t(e[i],n[i])})):!1},colourToRGBAString:function(i,n){var s;return this.validateColourObject(i)?((!t(n,"number")||0>n||n>20)&&(n=2),s=i.a/255,(0===s||1===s)&&(n=0),s=s.toFixed(n),e("rgba(%s, %s, %s, %s)",i.r,i.g,i.b,s)):!1}}}),define("hbs!ui/colour-dialog/templates/display_colour",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="display-colour-background" style="background-image: url(/js/libs/jpicker/images/preview-opacity.png);">\n    <span class="display-colour-preview" title="Chosen colour" style="background-color: ',(r=i.rgba_colour)?r=r.call(t,{hash:{}}):(r=t.rgba_colour,r=typeof r===a?r.apply(t):r),o+=l(r)+';">&nbsp;</span>\n</div>\n'});return t.registerPartial("ui_colour-dialog_templates_display_colour",i),i}),define("ui/colour-dialog/views/display_colour",["jquery","backbone","core/utils/is","../utils","underscore","hbs!../templates/display_colour","jpicker"],function(e,t,i,n,s,r){return t.View.extend({template:r,className:"active-colour",active_colour:null,initialize:function(t){this.active_colour=new e.jPicker.Color({ahex:"ffffffff"}).val("all"),i(t,"object")&&n.validateColourObject(t.active_colour)&&(this.active_colour=s.clone(t.active_colour)),this.on("colour:update",this._updateColour,this)},render:function(){var e=this.template({rgba_colour:n.colourToRGBAString(this.active_colour)});this.$el.html(e),this.delegateEvents()},_updateColour:function(e){return n.validateColourObject(e)?(this.active_colour=s.clone(e),this.$el.find(".display-colour-preview").css("background-color",n.colourToRGBAString(e)),!0):!1}})}),define("hbs!ui/colour-dialog/templates/colour_input",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="Hex">\n    <div class="Text">\n        <div class="input-holder first">\n            <em>#</em>\n            <input type="text" maxlength="7" value="'+l((r=t.active_colour,r=null==r||r===!1?r:r.hex,typeof r===a?r.apply(t):r))+'" class="Hex" title="Enter A ‚ÄúHex‚Äù Color Value (#000000-#ffffff)">\n        </div>\n        <div class="rgba-colour">\n            <label>rgba('+l((r=t.active_colour,r=null==r||r===!1?r:r.r,typeof r===a?r.apply(t):r))+", "+l((r=t.active_colour,r=null==r||r===!1?r:r.g,typeof r===a?r.apply(t):r))+", "+l((r=t.active_colour,r=null==r||r===!1?r:r.b,typeof r===a?r.apply(t):r))+", "+l((r=t.active_colour,r=null==r||r===!1?r:r.a,typeof r===a?r.apply(t):r))+")</label>\n        <div>\n    </div>\n</div>\n"});return t.registerPartial("ui_colour-dialog_templates_colour_input",i),i}),define("ui/colour-dialog/views/colour_input",["jquery","backbone","core/utils/is","../utils","underscore","hbs!../templates/colour_input","jpicker"],function(e,t,i,n,s,r){return t.View.extend({template:r,className:"colour-input cf",active_colour:null,events:{"keydown .Hex":"_checkInput","keyup .Hex":"_changeColour","blur input.Hex":"_onFocusLost"},valid_characters_regex:/[a-fA-F0-9]/,valid_control_character_codes:[8,37,39,46,13],initialize:function(t){this.active_colour=new e.jPicker.Color({ahex:"ffffffff"}).val("all"),i(t,"object")&&i(t.active_colour,"object")&&(this.active_colour=s.clone(t.active_colour)),this.on("colour:update",this._updateColour,this)},render:function(){var t,i;return this.delegateEvents(),t=this.active_colour.a/255,t=0!==t&&1!==t?t.toFixed(2):t.toString(),i=this.template({active_colour:{hex:e.jPicker.ColorMethods.rgbaToHex(this.active_colour).slice(0,-2),r:this.active_colour.r,g:this.active_colour.g,b:this.active_colour.b,a:t}}),this.$el.html(i),this},_checkInput:function(t){var i,n,s,r;return t instanceof e.Event?(t.which>=96&&t.which<=105&&(t.which=t.which-48),n=String.fromCharCode(t.which),s=n.match(this.valid_characters_regex),r=this.valid_control_character_codes.indexOf(t.which)>-1,s||r||t.metaKey?(i=this.$el.find("input.Hex"),i.val()&&i.val().length>=6?r||!!t.metaKey:!0):!1):!1},_changeColour:function(e){var t,i=this._getColorFromInput(),r=this.$el.find("input.Hex"),o=r.val(),a=[8,91,16,88];
return r&&0===o.length&&-1!==a.indexOf(e.which)?!1:null===i?!1:(7===o.length&&"#"===o.charAt(0)&&(o=o.substr(1),r.val(o)),t=s.every(o,function(e){return e.match(this.valid_characters_regex)},this),i===!1||t&&n.validateColourObject(i)?(this.trigger("colour:change",i),!0):!1)},_onFocusLost:function(){return this.render(),!0},_updateColour:function(e){return n.validateColourObject(e)?e.ahex===this.active_colour.ahex?!0:(this.active_colour=s.clone(e),this.render(),!0):!1},_getColorFromInput:function(){var t=this.$el.find("input.Hex");return 0===t.val().length?!1:t.val().length<6?null:new e.jPicker.Color({hex:t.val()}).val("all")}})}),define("hbs!ui/colour-dialog/templates/colour_picker",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,"<div>\n<!-- We want to keep this dummy template because jPicker behaves funny\n     when used directly on view's $el (takes longer to display the colour map). -->\n</div>\n"});return t.registerPartial("ui_colour-dialog_templates_colour_picker",i),i}),define("ui/colour-dialog/views/colour_picker",["jquery","jpicker","backbone","underscore","core/utils/is","../utils","core/utils/when","hbs!../templates/colour_picker"],function(e,t,i,n,s,r,o,a){var l=i.View.extend({template:a,className:"colour-picker",active_colour:null,events:{},jpicker_settings:{images:{clientPath:"/js/libs/jpicker/images/",colorBar:{arrow:{file:"rangearrows-custom.gif"}}},window:{alphaSupport:!0,alphaPrecision:0,title:""}},initialize:function(i){t=e.jPicker,this.jPicker=t,this.active_colour=new this.jPicker.Color({ahex:"ffffffff"}).val("all"),s(i,"object")&&r.validateColourObject(i.active_colour)&&(this.active_colour=n.clone(i.active_colour)),this.on("colour:update",this._updateColour,this)},render:function(){var e;return e=this._createColourPicker(),this.$el.append(e),this.delegateEvents(),this},destroy:function(){return this.remove(),!0},remove:function(){return s(this.jPicker.List,"array")&&this.jPicker.List.length>0&&this.jPicker.List.forEach(function(e){e.destroy()},this),l.__super__.remove.apply(this,arguments),!0},_updateColour:function(e){return r.validateColourObject(e)?(this.active_colour=n.clone(e),s(this.jPicker.List,"array")&&this.jPicker.List.length>0&&this.jPicker.List[0].color.active.val("ahex",e.ahex),!0):!1},_changeColour:function(e){return r.validateColourObject(e)?e.ahex===this.active_colour.ahex?!0:(this.active_colour=n.clone(e),this.trigger("colour:change",e,this),!0):!1},_createColourPicker:function(){var t,i=this.template(),n=this;return this.jpicker_settings.color={active:new e.jPicker.Color({ahex:this.active_colour.ahex})},this.$el.addClass("hidden"),t=e(i).jPicker(this.jpicker_settings),e.jPicker.List[0].color.active.bind(function(e){n._changeColour(e.val("all"))}),setTimeout(function(){var e,i;["h2","tr.Hue","tr.Saturation","tr.Value","tr.Red","tr.Green","tr.Blue","tr.Alpha","tr.Hex","td.Preview","td.Button"].forEach(function(e){t.find(e).css("display","none")}),t.children("table").removeClass("jPicker"),t.removeClass("Container"),t.css({width:"276px"}),e=t.find("div.Map"),e.css({border:"none",margin:"24px 0 0 0"}),i=t.find("div.Bar"),i.css({cursor:"w-resize",border:"none",width:"24px",top:"-134px",left:"-145px"}),i.find(".Map1, .Map2, .Map3, .Map4, .Map5").css({width:"16px","margin-left":"4px"}),i.find(".Arrow").css({left:"0px"}),i.css({"-webkit-transform":"rotate(270deg)","-moz-transform":"rotate(270deg)","-ms-transform":"rotate(270deg)","-o-transform":"rotate(270deg)",transform:"rotate(270deg)"}),n.$el.removeClass("hidden")},0),t}});return l}),define("hbs!ui/colour-dialog/templates/colour_sliders",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<ul>\n    <li>\n        <div class="saturation">\n            <label>Saturation:</label>\n            <input type="range" value="'+l((r=t.active_colour,r=null==r||r===!1?r:r.s_percentage,typeof r===a?r.apply(t):r))+'" min="0" max="100" step="1">\n        </div>\n        <div class="brightness">\n            <label>Brightness:</label>\n            <input type="range" value="'+l((r=t.active_colour,r=null==r||r===!1?r:r.v_percentage,typeof r===a?r.apply(t):r))+'" min="0" max="100" step="1">\n        </div>\n        <div class="alpha">\n            <label>Alpha:</label>\n            <input type="range" value="'+l((r=t.active_colour,r=null==r||r===!1?r:r.a_percentage,typeof r===a?r.apply(t):r))+'" min="0" max="100" step="1">\n        </div>\n    </li>\n</ul>\n'});return t.registerPartial("ui_colour-dialog_templates_colour_sliders",i),i}),define("ui/colour-dialog/views/colour_sliders",["jquery","backbone","core/utils/is","../utils","underscore","hbs!../templates/colour_sliders","jpicker"],function(e,t,i,n,s,r){return t.View.extend({template:r,className:"colour-sliders",active_colour:null,events:{"change input":"_changeColour"},initialize:function(t){this.active_colour=new e.jPicker.Color({ahex:"ffffffff"}).val("all"),i(t,"object")&&n.validateColourObject(t.active_colour)&&(this.active_colour=s.clone(t.active_colour)),this.on("colour:update",this._updateColour,this)},render:function(){var e,t;return e={s_percentage:this.active_colour.s,v_percentage:this.active_colour.v,a_percentage:Math.floor(this.active_colour.a/255*100)},t=this.template({active_colour:e}),this.$el.html(t),this.delegateEvents(),this},_updateColour:function(e){return n.validateColourObject(e)?(this.active_colour=s.clone(e),this.render(),!0):!1},_updateActiveColorFromInput:function(){var t,i,n;return t=this.$el.find(".saturation input").val(),i=this.$el.find(".brightness input").val(),n=this.$el.find(".alpha input").val(),this.active_colour=new e.jPicker.Color({h:this.active_colour.h,s:t,v:i,a:Math.floor(n/100*255)}).val("all"),!0},_changeColour:function(){return this._updateActiveColorFromInput(),this.trigger("colour:change",this.active_colour,this),!0}})}),define("hbs!ui/colour-dialog/templates/reset_colour",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="inherit-colour-selector">\n    <div class="controls-inherit">\n        <div class="tooltip-holder">\n            <div class="grey">\n                <a href="">Remove color</a>\n                <div class="info-tooltip">\n                    <div class="info">\n                        <p>Click this to inherit the color from the parent element. You can always hit CTL+Z to undo.</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'});return t.registerPartial("ui_colour-dialog_templates_reset_colour",i),i}),define("ui/colour-dialog/views/reset_colour",["jquery","backbone","core/utils/is","underscore","hbs!../templates/reset_colour"],function(e,t,i,n,s){return t.View.extend({template:s,className:"reset-colour",events:{"click .controls-inherit a":"_inheritColour"},initialize:function(){this.$el.html(this.template())},render:function(){return this.delegateEvents(),this},_inheritColour:function(t){return t instanceof e.Event?(t.preventDefault(),this.trigger("colour:inherit"),!0):!1}})}),define("ui/colour-dialog/index",["jquery","jpicker","underscore","core/utils/is","core/utils/css","./utils","core/components/extended_dialog/index","./views/display_colour","./views/colour_input","./views/colour_picker","./views/colour_sliders","./views/reset_colour"],function(e,t,i,n,s,r,o,a,l,c,u,h){var d=o.extend({namespace:"ui:colour-dialog",tagName:"div",className:"colour-dialog",_announce_change:null,_announce_change_throttle:250,listeners:i.extend({},o.prototype.listeners,{open:"open",close:"close"}),title_text:"Change color",title_info:"Switch the current color of the chosen element",initialize:function(){var i;t=e.jPicker,this.jPicker=t,this.callback=null,this.callback_context=null,d.__super__.initialize.apply(this,arguments),this.views.title.setTitle(this.title_text),this.views.title.setInfo(this.title_info),this.views.display_colour=new a,this.views.colour_input=new l,this.views.colour_picker=new c,this.views.colour_sliders=new u,this.views.reset_colour=new h,i=Object.keys(this.views),i.forEach(function(e){this.views[e].on("colour:change",this._colourChange,this)},this),this.views.reset_colour.on("colour:inherit",this._colourInherit,this),this.imc.trigger(this.namespace+":ready")},render:function(){var e=[],t=Object.keys(this.views);return t.forEach(function(t){e.push(this.views[t])},this),d.__super__.render.call(this,e),this},open:function(e,t,i){var r;return this.remove(),n(t,"function")?(this.callback=n(t,"function")?t:!1,this.callback_context=i,r=s.getColorObject(e),n(r,"object")&&this._colourSet(r),o.prototype.open.apply(this,arguments),!0):(this.log("warn","colour-dialog open: no callback provided."),!1)},close:function(){return this.callback=!1,this.remove(),!0},destroy:function(){var e=Object.keys(this.views);return e.forEach(function(e){n(this.views[e].destroy,"function")&&this.views[e].destroy(),this.views[e].off("colour:change"),this.views[e].off("colour:update")},this),this.views.reset_colour.off("colour:inherit"),d.__super__.destroy.apply(this,arguments),!0},_colourSet:function(e,t){return r.validateColourObject(e)?(Object.keys(this.views).forEach(function(i){this.views[i]!==t&&this.views[i].trigger("colour:update",e)},this),!0):!1},_colourChange:function(e,t){return e===!1?(this._colourInherit(),!0):r.validateColourObject(e)?(this._colourSet(e,t),this.callback&&this.callback.call(this.callback_context,r.colourToRGBAString(e)),!0):!1},_colourInherit:function(){return this.callback&&this.callback.call(this.callback_context,"inherit"),this.close(),!0}});return d}),define("ui/tooltips/index",["jquery","core/utils/is","backbone","core/utils/when"],function(e,t,i,n){return i.UIController.extend({namespace:"ui:tooltips",ns_tooltip:null,timeout_limit:3e3,initialize:function(){t(this.options.timeout,"number")&&(this.timeout_limit=this.options.timeout),e("body").on("mouseenter.tooltips","*[data-tooltips-title]",e.proxy(this,"showTooltip")).on("mouseleave.tooltips","*[data-tooltips-title]",e.proxy(this,"hideTooltip")).on("mousedown.tooltips","*[data-tooltips-title]",e.proxy(this,"saveMousePosition")).on("mouseup.tooltips","*[data-tooltips-title]",e.proxy(this,"hideTooltip"))},showTooltip:function(t){var i=e(t.currentTarget);this.hideTooltip(),this.createTooltipEl(),this._doShowTooltip(i,!1)},createTooltipEl:function(){this.ns_tooltip=e('<span class="ns-tooltip top">&nbsp</span>'),e("body").append(this.ns_tooltip)},saveMousePosition:function(e){var t=e.clientX,i=e.clientY;this.mouse_position={x:t,y:i}},onChangeActiveElement:function(){var e,i,s=this;return t(this.parent_el,"object")?(n(function(){return e?(clearTimeout(i),!0):(e=!s.parent_el||!document.body.contains(s.parent_el[0]),!1)},function(){s.updateTooltip()},this.timeout_limit),void(i=setTimeout(function(){e?s.updateTooltip():s.hideTooltip()},this.timeout_limit+1))):!1},updateTooltip:function(){var e;return t(this.mouse_position,"object")?(e=this._getElementMouseIsOver(),void(t(this.ns_tooltip,"object")&&e.length>0&&t(e.attr("data-tooltips-title"),"string")?this._doShowTooltip(e):this.hideTooltip())):(this.hideTooltip(),!1)},hideTooltip:function(){return this.ns_tooltip&&e(this.ns_tooltip).remove(),e(".ns-tooltip").remove(),this.ns_tooltip=null,this.mouse_position=null,this.parent_el=null,this},destroy:function(){return e("body").off(".tooltips"),this},_arePositionsClose:function(e,t){var i=30;return i>Math.abs(e.top-t.top)&&i>Math.abs(e.left-t.left)},_doShowTooltip:function(i){var n,s,r,o,a,l,c=["top","left","bottom","right"],u="top",h=0,d=i.attr("data-tooltips-title");return t(i,"object")&&1===i.length?(d=i.attr("data-tooltips-title"),t(d,"string")&&0!==d.length?(t(i.attr("data-tooltips-margin"),"string")&&(h=parseInt(i.attr("data-tooltips-margin"),10)),l=i.attr("title"),t(l,"string")&&l.length>0&&i.attr("title",""),this.ns_tooltip.html(d),this.ns_tooltip.removeClass().addClass("ns-tooltip").addClass(u),n=i.offset(),s=i.outerWidth(),r=i.outerHeight(),o=e(this.ns_tooltip).outerWidth(),a=e(this.ns_tooltip).outerHeight(),c.indexOf(i.attr("data-tooltips-side"))>=0&&(u=i.attr("data-tooltips-side")),e(this.ns_tooltip).css(this._getPosition(n,r,s,a,o,u,h)),this.parent_el=i,this):!1):!1},_getPosition:function(e,i,n,s,r,o,a){var l,c,u,h;return t(e,"object")&&t(i,"number")&&t(n,"number")&&t(s,"number")&&t(r,"number")&&t(o,"string")?(t(a,"number")||(a=0),"right"===o||"left"===o?(l=s/2-i/2,c=e.top-l+a):("bottom"===o||"top"===o)&&(u=r/2-n/2,h=e.left-u),"left"===o?h=e.left-r-8-a:"right"===o?h=e.left+n+8+a:"top"===o?c=e.top-s-8-a:"bottom"===o&&(c=e.top+i+8+a),{top:c,left:h}):!1},_getElementMouseIsOver:function(){return e(document.elementFromPoint(this.mouse_position.x,this.mouse_position.y))}})}),define("ui/error-handler/models/error-message",["backbone","core/utils/is","core/typecastError"],function(e,t,i){"use strict";var n=e.Model.extend({defaults:function(){return{id:null,title:"Hmm. That‚Äôs odd...",message:null,submessage:"",button:{href:"",text:"Reload your project"},alternative:{href:"/",text:"Let us know about this issue"}}},initialize:function(){var e=this.get("id"),n=this.get("message");if(!t(e,"number"))throw new i(101,"id (error code) should be a number");if(!t(n,"string")||n.length<1)throw new i(102,"message should be a string")}});return n}),define("ui/error-handler/collections/error-messages",["backbone","../models/error-message"],function(e,t){"use strict";var i=e.Collection.extend({model:t});return i}),define("ui/error-handler/data/messages",[],function(){return[{id:101,message:"sample error message"},{id:102,message:"another sample error message"},{id:201,message:"Sorry, we have been unable to authenticate you in the application.",submessage:"Please sign out and then sign in again.",button:{href:"/signout",text:"Sign out"}},{id:202,message:"Sorry, we're having trouble communicating with the server correctly to get your project.",submessage:"Please refresh the page to try again."},{id:203,message:"Sorry, you don't have permission to make that change on this project.",submessage:"Your change has not been saved. Please ask the project owner for to allow you the necessary permissions."},{id:204,message:"Sorry, our server has gone offline.",submessage:"You will not be able to use Typecast until it is back online, but all of your changes are saved."},{id:205,message:"Sorry, our server is having some internal difficulties.",submessage:"Your latest changes may not have been saved successfully."},{id:206,message:"Sorry, we're having trouble communicating with the server correctly to get your project.",submessage:"Please refresh the page to try again."},{id:207,message:"Connection interrupted - Reconnecting..."},{id:208,message:"Connection restored - Saving as normal"},{id:209,message:"We have failed to reconnect to the server",submessage:"Please refresh the page to try again."},{id:210,message:"You have signed out on another page.",submessage:"In order to use Typecast you must be signed in. Please sign in again.",button:{href:"/dashboard",text:"Sign in again"}},{id:211,message:"The project you are working on has been deleted by a member of your team.",submessage:"Please go to your dashboard and select a new project to work on.",button:{href:"/dashboard",text:"Go to the Dashboard"}},{id:212,message:"The project you are working on has been reverted by a member of your team.",submessage:"Please refresh the page to see the latest version."},{id:213,message:"The project you are working on has been temporarily locked by a member of your team.",submessage:"Please refresh the page to check if has been unlocked."},{id:214,message:"Sorry, we didn't understand that last change.",submessage:"Your change has not been saved. Please refresh the page and try it again."},{id:215,message:"Sorry, that last change you made looked unsafe.",submessage:"Your change has not been saved. Please refresh you project and try it again."},{id:216,message:"Sorry, we were unable to save your project."},{id:217,message:"Your project is locked by another user right now.",submessage:"Ask them to exit out of the project and reload.",button:{text:"Reload when ready"},alternative:!1},{id:218,message:"Your project is locked in a different tab right now.",submessage:"Close the other tab and reload.",button:{text:"Reload when ready"},alternative:!1},{id:219,message:"Your Typecast project has gone to sleep due to inactivity.",button:{text:"Wake up!"},alternative:!1},{id:220,message:"You saved a new version!"},{id:230,message:"Sorry. We don't support uploading local images yet.",submessage:"You can add an image from the insert menu or by dragging one from another web page",button:{text:"OK. Got it."}}]}),define("ui/error-handler/models/error-code",["backbone","core/utils/is"],function(e){"use strict";var t=e.Model.extend({defaults:{code:null,level:null}});return t}),define("ui/error-handler/views/error",["backbone","core/utils/is"],function(e,t){"use strict";var i=e.View.extend({template:null,error_code:null,collection:null,events:{"click a[href=]":"_reload"},initialize:function(e){return this.error_code=e.error_code,this},render:function(){var e=this.collection.get(this.error_code.get("code"));return t(this.template,"function")&&t(e,"object")?(this.$el.html(this.template(e.toJSON())),this.delegateEvents(),this):!1},_reload:function(e){return e.preventDefault(),window.location.reload(),!0}});return i}),define("hbs!ui/error-handler/templates/info",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="function",a=this.escapeExpression;return(r=i.message)?r=r.call(t,{hash:{}}):(r=t.message,r=typeof r===o?r.apply(t):r),a(r)});return t.registerPartial("ui_error-handler_templates_info",i),i}),define("ui/error-handler/views/info",["./error","hbs!../templates/info"],function(e,t){"use strict";var i=e.extend({className:"info",template:t});return i}),define("ui/error-handler/views/warning",["./info"],function(e){"use strict";var t=e.extend({className:"warning"});return t}),define("hbs!ui/error-handler/templates/fatal",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n            <p class="submessage">',(n=i.submessage)?n=n.call(e,{hash:{}}):(n=e.submessage,n=typeof n===h?n.apply(e):n),s+=d(n)+"</p>\n        "}function o(e,t){var i,n="";return n+='\n            <div class="submit">\n                <span class="button orange">\n                    <a href="'+d((i=e.button,i=null==i||i===!1?i:i.href,typeof i===h?i.apply(e):i))+'">'+d((i=e.button,i=null==i||i===!1?i:i.text,typeof i===h?i.apply(e):i))+"</a>\n                </span>\n                <br />\n            </div>\n        "}function a(e,t){var n,s="";return s+='\n            <div class="forward">\n                <p>\n                ',n=i["if"].call(e,e.button,{hash:{},inverse:p.noop,fn:p.program(6,l,t)}),(n||0===n)&&(s+=n),s+='\n                <em class="link">\n                    <a class="Intercom" href="'+d((n=e.alternative,n=null==n||n===!1?n:n.href,typeof n===h?n.apply(e):n))+'">'+d((n=e.alternative,n=null==n||n===!1?n:n.text,typeof n===h?n.apply(e):n))+"</a>\n                </em>\n                </p>\n            </div>\n        "}function l(e,t){return"\n                    <em>or</em>\n                "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="",h="function",d=this.escapeExpression,p=this;return u+='<div class="error-dialog-',(c=i.id)?c=c.call(t,{hash:{}}):(c=t.id,c=typeof c===h?c.apply(t):c),u+=d(c)+' error-dialog-content">\n    <div class="header">\n        <h4>',(c=i.title)?c=c.call(t,{hash:{}}):(c=t.title,c=typeof c===h?c.apply(t):c),u+=d(c)+'</h4>\n    </div>\n    <div class="body">\n        <p class="message">',(c=i.message)?c=c.call(t,{hash:{}}):(c=t.message,c=typeof c===h?c.apply(t):c),u+=d(c)+"</p>\n        ",c=i["if"].call(t,t.submessage,{hash:{},inverse:p.noop,fn:p.program(1,r,s)}),(c||0===c)&&(u+=c),u+="\n        <br />\n        ",c=i["if"].call(t,t.button,{hash:{},inverse:p.noop,fn:p.program(3,o,s)}),(c||0===c)&&(u+=c),u+="\n        ",c=i["if"].call(t,t.alternative,{hash:{},inverse:p.noop,fn:p.program(5,a,s)}),(c||0===c)&&(u+=c),u+="\n    </div>\n</div>\n"});return t.registerPartial("ui_error-handler_templates_fatal",i),i}),define("ui/error-handler/views/fatal",["./error","hbs!../templates/fatal"],function(e,t){"use strict";var i=e.extend({className:"fatal ui-error-overlay faded-overlay",template:t});return i}),define("hbs!ui/error-handler/templates/block-warning",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n            <p class="submessage">',(n=i.submessage)?n=n.call(e,{hash:{}}):(n=e.submessage,n=typeof n===c?n.apply(e):n),s+=u(n)+"</p>\n        "}function o(e,t){var i,n="";return n+='\n            <div class="submit">\n                <a href="#">'+u((i=e.button,i=null==i||i===!1?i:i.text,typeof i===c?i.apply(e):i))+"</a>\n            </div>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<div class="error-dialog-',(a=i.id)?a=a.call(t,{hash:{}}):(a=t.id,a=typeof a===c?a.apply(t):a),l+=u(a)+' error-dialog-content">\n    <a href="#" class="close"></a>\n    <div class="body">\n        <p class="message">',(a=i.message)?a=a.call(t,{hash:{}}):(a=t.message,a=typeof a===c?a.apply(t):a),l+=u(a)+"</p>\n        ",a=i["if"].call(t,t.submessage,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n        <br />\n        ",a=i["if"].call(t,t.button,{hash:{},inverse:h.noop,fn:h.program(3,o,s)}),(a||0===a)&&(l+=a),l+="\n    </div>\n</div>\n"});return t.registerPartial("ui_error-handler_templates_block-warning",i),i}),define("ui/error-handler/views/block-warning",["./fatal","hbs!../templates/block-warning"],function(e,t){"use strict";var i=e.extend({className:"block-warning ui-error-overlay faded-overlay",template:t,events:{"click a":"onButtonClick"},onButtonClick:function(e){return e.preventDefault(),this.trigger("close"),!0}});return i}),define("ui/error-handler/index",["jquery","backbone","core/utils/is","./collections/error-messages","./data/messages","./models/error-code","./views/info","./views/warning","./views/block-warning","./views/fatal"],function(e,t,i,n,s,r,o,a,l,c){"use strict";var u=t.UIController.extend({namespace:"ui:error",tagName:"div",id:"error-handler",className:"error-handler",_is_rendered:!1,listeners:{open:"open",close:"close"},views:null,error_code:null,collection:null,app_el:null,primary_nav:null,initialize:function(){return this.collection=new n(s),this.error_code=new r,this.views={},this.views.info=new o({error_code:this.error_code,collection:this.collection}),this.views.warning=new a({error_code:this.error_code,collection:this.collection}),this.views["block-warning"]=new l({error_code:this.error_code,collection:this.collection}),this.views.fatal=new c({error_code:this.error_code,collection:this.collection}),this.app_el=e(this.app_el),this.primary_nav=e(this.app_el).find(".primary-nav"),this},open:function(e,t){return"fatal"===this.error_code.get("level")?!1:i(e,"number")?!i(t,"string")||t.length<1||!this.isValidErrorLevel(t)?(this.log("warn",'Error level should be "info", "warning", "block-warning" or "fatal"',t),!1):i(this.collection.get(e),"object")?(this.error_code.set({code:e,level:t}),this.render(),!0):(this.log("warn","Cannot find Error Message by provided Error Code",e),!1):(this.log("warn","Error code should be a number",e),!1)},close:function(){return"fatal"===this.error_code.get("level")?!1:(this.remove(),!0)},isValidErrorLevel:function(e){return-1!==["info","warning","block-warning","fatal"].indexOf(e)},render:function(){var e=this.error_code.get("level");return this.isRendered()&&this.remove(),this.isValidErrorLevel(e)?!this.views[e]instanceof t.View?!1:(this.listenTo(this.views["block-warning"],"close",this.close,this),this.views[e].render(),this.$el.append(this.views[e].$el),this.$el.removeClass("fatal block-warning"),-1!==["fatal","block-warning"].indexOf(e)?(this.$el.addClass(e),this.app_el.append(this.$el)):this.primary_nav.append(this.$el),i(window.Intercom,"function")&&(window.Intercom("update"),window.Intercom("reattach_activator")),this.setRendered(!0),this):!1},isRendered:function(){return!!this._is_rendered},setRendered:function(e){return i(e,"boolean")?(this._is_rendered=e,!0):!1},remove:function(){return Object.keys(this.views).forEach(function(e){this.views[e].remove()},this),u.__super__.remove.apply(this,arguments),this.setRendered(!1),!0}});return u}),define("ui/layout-properties-dialog/models/element-data",["backbone","core/utils/is"],function(e,t){"use strict";var i=e.Model.extend({defaults:{element:null,style_declaration:null},getValue:function(e){var i,n;return i=this.get("style_declaration"),t(i,"object")&&t(i.getValue,"function")?(n=i.getValue(e),!t(n,"array")||n.length<1?!1:n[0]):!1},setValue:function(e,i){return t(e,"string")&&t(i,"string")?(this.trigger("attribute:changed",e,i),!0):!1},removeValue:function(e){return!t(e,"string")||e.length<1?!1:(this.trigger("attribute:removed",e),!0)}});return i}),define("ui/layout-properties-dialog/models/tab",["backbone","underscore"],function(e,t){"use strict";var i=e.Model.extend({defaults:{id:null,title:null,className:null,view:null,active:!1},toJSON:function(){return i.__super__.toJSON.call(this,t.omit(this.attributes,"view"))}});return i}),define("ui/layout-properties-dialog/collections/tabs",["backbone","core/utils/is","../models/tab"],function(e,t,i){"use strict";var n=e.Collection.extend({model:i,getActiveTab:function(){var e,t=this.where({active:!0});return t.length?e=t[0]:!1},setActiveTab:function(e){var i;return!t(e,"string")||e.length<1?!1:(i=this.get(e))?(this.without(i).forEach(function(e){e.set("active",!1)}),i.set("active",!0),!0):!1}});return n}),define("hbs!ui/layout-properties-dialog/templates/tabs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        <li class="',(n=i.className)?n=n.call(e,{hash:{}}):(n=e.className,n=typeof n===c?n.apply(e):n),s+=u(n),n=i["if"].call(e,e.active,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+='" data-id="',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===c?n.apply(e):n),s+=u(n)+'">\n            <a href="#">',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===c?n.apply(e):n),s+=u(n)+"</a>\n        </li>\n    "}function o(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+="<ul>\n    ",a=i.each.call(t,t.tabs,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n</ul>\n"});return t.registerPartial("ui_layout-properties-dialog_templates_tabs",i),i}),define("ui/layout-properties-dialog/views/tabs",["jquery","core/utils/is","backbone","../collections/tabs","hbs!../templates/tabs"],function(e,t,i,n,s){"use strict";var r=i.View.extend({template:s,tagName:"div",className:"tabs",tabs:null,events:{"click li":"onClick"},initialize:function(){return!t(this.options.tabs,"array")||this.options.tabs.length<1?!1:(this.tabs=new n(this.options.tabs),this.tabs.setActiveTab(this.tabs.at(0).get("id")),this)},listenToEvents:function(){return this.stopListening(),this.listenTo(this.tabs,"change:active",this.onChangeActiveTab,this),!0},getActiveTabView:function(){var e;return e=this.tabs.getActiveTab(),e?e.get("view"):!1},onChangeActiveTab:function(e){return e.get("active")?(this.trigger("change"),this.render(),!0):!1},render:function(){return this.delegateEvents(),this.$el.html(this.template({tabs:this.tabs.toJSON()})),this.listenToEvents(),this},onClick:function(t){t.preventDefault(),this.tabs.setActiveTab(e(t.currentTarget).attr("data-id"))}});return r}),define("hbs!ui/layout-properties-dialog/templates/text/one_value_selector",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t,n){var s,r,a="";return a+='\n        <li>\n            <a href="#" data-value="',(s=i.value)?s=s.call(e,{hash:{}}):(s=e.value,s=typeof s===c?s.apply(e):s),a+=u(s)+'" class="',(s=i["class"])?s=s.call(e,{hash:{}}):(s=e["class"],s=typeof s===c?s.apply(e):s),a+=u(s)+" ",s=i["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.programWithDepth(o,t,n)}),(s||0===s)&&(a+=s),a+='" data-ns-tooltip="'+u((s=n.tooltip_prefix,typeof s===c?s.apply(e):s))+" ",(r=i.value)?r=r.call(e,{hash:{}}):(r=e.value,r=typeof r===c?r.apply(e):r),a+=u(r)+'">\n                <span>',(r=i.text)?r=r.call(e,{hash:{}}):(r=e.text,r=typeof r===c?r.apply(e):r),a+=u(r)+"</span>\n            </a>\n        </li>\n    "}function o(e,t,i){var n,s="";return s+=" "+u((n=i.active_class,typeof n===c?n.apply(e):n))}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+="<h3>",(a=i.title)?a=a.call(t,{hash:{}}):(a=t.title,a=typeof a===c?a.apply(t):a),l+=u(a)+'</h3>\n<ul class="',(a=i.changes_attr)?a=a.call(t,{hash:{}}):(a=t.changes_attr,a=typeof a===c?a.apply(t):a),l+=u(a)+' button-controls cf">\n    ',a=i.each.call(t,t.values,{hash:{},inverse:h.noop,fn:h.programWithDepth(r,s,t)}),(a||0===a)&&(l+=a),l+="\n</ul>\n"});return t.registerPartial("ui_layout-properties-dialog_templates_text_one_value_selector",i),i}),define("ui/layout-properties-dialog/views/text/one-value-selector",["jquery","underscore","backbone","core/utils/is","hbs!../../templates/text/one_value_selector"],function(e,t,i,n,s){"use strict";var r=i.View.extend({template:s,tagName:"div",className:"",title:null,changes_attr:null,values:null,active_class:"selected-icon",default_value:"inherit",model:null,events:{"click a":"onClick"},initialize:function(){return this.title=this.options.title,this.tooltip_prefix=this.options.tooltip_prefix,this.changes_attr=this.options.changes_attr,this.values=this.options.values,this},render:function(){var e,t;return this.delegateEvents(),t=this.model.getValue(this.changes_attr)||this.default_value,e=this.template({title:this.title,changes_attr:this.changes_attr,values:this._generateOptionsArray(this.values,t),tooltip_prefix:this.tooltip_prefix,active_class:this.active_class}),this.$el.html(e),this},_generateOption:function(e,i){return t.extend(e,{selected:i===e.value})},_generateOptionsArray:function(e,t){return e.map(function(e){return this._generateOption(e,t)},this)},setValue:function(e){return this.model.setValue(this.changes_attr,e),!0},onClick:function(t){var i,s;return t.preventDefault(),i=e(t.currentTarget),s=i.data("value"),n(t,"object")||n(s,"string")?(e(i).hasClass(this.active_class)&&(s=this.default_value),this.setValue(s),!0):!1}});return r}),define("hbs!ui/layout-properties-dialog/templates/text/shadow_selector",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+=' style="background-color: ',(n=i.colour)?n=n.call(e,{hash:{}}):(n=e.colour,n=typeof n===l?n.apply(e):n),s+=c(n)+';"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+="<h3>",(o=i.title)?o=o.call(t,{hash:{}}):(o=t.title,o=typeof o===l?o.apply(t):o),a+=c(o)+'</h3>\n\n<div class="controls-group">\n    <label for="text-shadow-horizontal-input">Hoz</label>\n    <input type="text" id="text-shadow-horizontal-input" placeholder="---" data-prop="horizontal" value="',(o=i.horizontal)?o=o.call(t,{hash:{}}):(o=t.horizontal,o=typeof o===l?o.apply(t):o),a+=c(o)+'" />\n    <span class="unit">px</span>\n</div>\n\n<div class="controls-group">\n    <label for="text-shadow-vertical-input">Vertical</label>\n    <input type="text" id="text-shadow-vertical-input" placeholder="---" data-prop="vertical" value="',(o=i.vertical)?o=o.call(t,{
hash:{}}):(o=t.vertical,o=typeof o===l?o.apply(t):o),a+=c(o)+'" />\n    <span class="unit">px</span>\n</div>\n\n<div class="controls-group">\n    <label for="text-shadow-blur-input">Blur</label>\n    <input type="text" id="text-shadow-blur-input" placeholder="---" data-prop="blur" value="',(o=i.blur)?o=o.call(t,{hash:{}}):(o=t.blur,o=typeof o===l?o.apply(t):o),a+=c(o)+'" />\n    <span class="unit">px</span>\n</div>\n\n<div class="controls-group colour">\n    <label>Color</label>\n    <div class="colour-swatch">\n        <div class="controls-colour-selected" style="width: 20px; height: 20px;">\n            <div class="thumb-preview" title="Change the text color">\n                <div',o=i["if"].call(t,t.colour,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+='></div>\n            </div>\n        </div>\n        <span class="label" style="display: none;">Text color</span>\n    </div>\n</div>\n'});return t.registerPartial("ui_layout-properties-dialog_templates_text_shadow_selector",i),i}),define("ui/layout-properties-dialog/views/text/shadow-selector",["jquery","backbone","core/utils/is","core/utils/str","hbs!../../templates/text/shadow_selector"],function(e,t,i,n,s){"use strict";var r=t.View.extend({template:s,tagName:"div",className:"controls-range",id:null,title:null,changes_attr:null,horizontal:null,vertical:null,blur:null,colour:null,model:null,events:{"click input":"onClick","keypress input":"onEnter","change input":"onChange","click .thumb-preview":"onClickColourPicker"},initialize:function(){return this.title=this.options.title,this.changes_attr=this.options.changes_attr,this},render:function(){var e,t,i,s;return this.delegateEvents(),t=this.model.getValue(this.changes_attr)||"0px 0px 0px",i=n.getColour(t),this.colour=i.colour,s=i.string.match(/(\d+)/g),this.horizontal=s&&s[0]||0,this.vertical=s&&s[1]||0,this.blur=s&&s[2]||0,e=this.template({title:this.title,horizontal:this.horizontal,vertical:this.vertical,blur:this.blur,colour:this.colour}),this.$el.html(e),this},setValue:function(){this.model.setValue(this.changes_attr,this.getStringValue())},getStringValue:function(){return(!i(this.colour,"string")||this.colour.length<1)&&(this.colour="#000"),"inherit"===this.colour&&(this.colour=""),this.horizontal+"px "+this.vertical+"px "+this.blur+"px"+(this.colour?" "+this.colour:"")},onChange:function(t){var i=e(t.currentTarget),n=i.attr("data-prop");return-1===["horizontal","vertical","blur"].indexOf(n)?!1:(this[n]=i.val(),this.setValue(),!0)},onClick:function(t){return e(t.currentTarget).select(),!0},onClickColourPicker:function(e){return e.preventDefault(),this.model.trigger("open-colour-dialog",this.colour,function(e){return!i(e,"string")||e.length<1?!1:(this.colour=e,void this.setValue())},this),!0},onEnter:function(t){return 13===t.which&&e(t.currentTarget).blur(),!0}});return r}),define("hbs!ui/layout-properties-dialog/templates/text_properties",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="header">\n    <h4>Transform, Spacing &amp; Indent</h4>\n    <div class="info-tooltip">\n        <span aria-hidden="true" data-icon="ÓÄí"></span>\n        <span class="screen-reader-text">Info</span>\n        <div class="info">\n            <section>\n                <p><b>Text Transform</b></p>\n                <p>Force text to display as mixed, upper or lower case.</p>\n            </section>\n\n            <section>\n                <p><b>Spacing</b></p>\n                <p>The letter-spacing property increases or decreases the space between characters.</p>\n            </section>\n\n            <section>\n                <p><b>Indent/Exdent</b></p>\n                <p>The indentation of the first line in a text-block (use a negative value to exdent)</p>\n            </section>\n        </div>\n    </div>\n</div>\n\n\n<section class="text-transform">\n</section>\n\n<section class="letter-spacing half cf">\n    <h3>Spacing</h3>\n</section>\n\n<section class="text-indent half cf">\n    <h3>Indent/Exdent</h3>\n</section>\n<div class="clear"></div>\n\n<div class="header simple">\n    <h4>Shadows</h4>\n    <div class="info-tooltip">\n        <span aria-hidden="true" data-icon="ÓÄí"></span>\n        <span class="screen-reader-text">Info</span>\n        <div class="info">\n            <section>\n                <p><b>Text Shadow</b></p>\n                <p>Apply various shadow and emboss effects to live text.</p>\n            </section>\n\n        </div>\n    </div>\n</div>\n<section class="text-shadow">\n</section>\n'});return t.registerPartial("ui_layout-properties-dialog_templates_text_properties",i),i}),define("ui/layout-properties-dialog/views/text-properties",["jquery","underscore","backbone","core/utils/is","core/utils/unit","./text/one-value-selector","./text/shadow-selector","hbs!../templates/text_properties","core/components/unitvalue/index"],function(e,t,i,n,s,r,o,a,l){"use strict";var c=i.View.extend({template:a,tagName:"div",className:"text-properties dialog-body",views:null,model:null,initialize:function(){return this.views={},this.views.text_transform=new r({id:"transform-selector",title:"Text Transform",tooltip_prefix:"Text-transform:",changes_attr:"text-transform",values:[{text:"Capitalize",value:"capitalize","class":"transform-capitalize"},{text:"Uppercase",value:"uppercase","class":"transform-uppercase"},{text:"Lowercase",value:"lowercase","class":"transform-lowercase"},{text:"None",value:"none","class":"transform-none"}],model:this.model}),this.views.letter_spacing=new l({css_property:"letter-spacing",disable_views:["slider"],units:["px","em"]}),this.views.text_indent=new l({css_property:"text-indent",disable_views:["slider"]}),this.views.text_shadow=new o({id:"shadow-selector",title:"Text Shadow",changes_attr:"text-shadow",model:this.model}),this},listenToEvents:function(){return this.stopListening(),this.onChangeElementId(),this.onChangeStyleDeclaration(),this.listenTo(this.model,"change:element",this.onChangeElementId,this),this.listenTo(this.model,"change:style_declaration",this.onChangeStyleDeclaration,this),this.listenTo(this.views.text_indent,"change",this.onChange,this),this.listenTo(this.views.letter_spacing,"change",this.onChange,this),!0},onChange:function(e,t){return n(t,"undefined")?this.model.removeValue(e):this.model.setValue(e,t),!0},onChangeElementId:function(){var e=this.model.get("element"),t=this.model.get("style_declaration");return n(e,"element")&&n(t,"object")?(this.views.letter_spacing.setElementIdAndMediaQueryId(e.getElement().id,t.getMediaQueryId()),this.views.text_indent.setElementIdAndMediaQueryId(e.getElement().id,t.getMediaQueryId()),!0):!1},onChangeStyleDeclaration:function(){var e=this.model.get("style_declaration");return n(e,"object")?(this.views.letter_spacing.setValueByStyleDeclaration(e),this.views.text_indent.setValueByStyleDeclaration(e),!0):!1},render:function(){return this.listenToEvents(),this.$el.html(this.template()),this.$(".text-transform").html(this.views.text_transform.render().$el),this.$(".letter-spacing").append(this.views.letter_spacing.render().$el),this.$(".text-indent").append(this.views.text_indent.render().$el),this.$(".text-shadow").html(this.views.text_shadow.render().$el),this},remove:function(){return Object.keys(this.views).forEach(function(e){n(this.views[e].remove,"function")&&this.views[e].remove()},this),c.__super__.remove.apply(this,arguments)}});return c}),define("hbs!ui/layout-properties-dialog/templates/columns/spread",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="header simple">\n    <h4>Column Spread</h4>\n    <div class="info-tooltip">\n        <span aria-hidden="true" data-icon="ÓÄí"></span>\n        <span class="screen-reader-text">Info</span>\n        <div class="info">\n            <section>\n                <p><b>Count</b></p>\n                <p>The number of columns you want to apply to the element.</p>\n            </section>\n\n            <section>\n                <p><b>Gap</b></p>\n                <p>The width of the gap between the columns.</p>\n            </section>\n\n            <section>\n                <p><b>Width</b></p>\n                <p>The width of the single column. Widths will combine in a semi-responsive behaviour.</p>\n            </section>\n        </div>\n    </div>\n</div>\n\n\n<section class="count-placeholder third cf">\n    <h5>Count</h5>\n</section>\n\n\n<section class="gap-placeholder third cf">\n    <h5>Gap</h5>\n</section>\n\n\n<section class="width-placeholder third cf">\n    <h5>Width</h5>\n</section>'});return t.registerPartial("ui_layout-properties-dialog_templates_columns_spread",i),i}),define("ui/layout-properties-dialog/views/columns/spread",["backbone","core/utils/is","hbs!../../templates/columns/spread","core/components/unitvalue/index"],function(e,t,i,n){"use strict";var s=e.View.extend({tagName:"div",className:"column-spread cf",template:i,views:null,model:null,initialize:function(){return this.views={},this.views.count=new n({css_property:"column-count",disable_views:["slider","unit"],"default":{value:"0",unit:""}}),this.views.gap=new n({units:["px","em"],css_property:"column-gap",disable_views:["slider","stepper"]}),this.views.width=new n({units:["px","em"],css_property:"column-width",disable_views:["slider","stepper"]}),this},listenToEvents:function(){return this.stopListening(),this.onChangeElementId(),this.onChangeStyleDeclaration(),this.listenTo(this.model,"change:element",this.onChangeElementId,this),this.listenTo(this.model,"change:style_declaration",this.onChangeStyleDeclaration,this),this.listenTo(this.views.count,"change",this.onChange,this),this.listenTo(this.views.gap,"change",this.onChange,this),this.listenTo(this.views.width,"change",this.onChange,this),!0},onChange:function(e,t){return this.model.setValue(e,t),!0},onChangeElementId:function(){var e=this.model.get("element"),i=this.model.get("style_declaration");return t(e,"element")&&t(i,"object")&&t(i.getMediaQueryId,"function")?(this.views.count.setElementIdAndMediaQueryId(e.getElement().id,i.getMediaQueryId()),this.views.gap.setElementIdAndMediaQueryId(e.getElement().id,i.getMediaQueryId()),this.views.width.setElementIdAndMediaQueryId(e.getElement().id,i.getMediaQueryId()),!0):!1},onChangeStyleDeclaration:function(){var e=this.model.get("style_declaration");return t(e,"object")?(this.views.count.setValueByStyleDeclaration(e),this.views.gap.setValueByStyleDeclaration(e),this.views.width.setValueByStyleDeclaration(e),!0):!1},render:function(){return this.listenToEvents(),this.$el.html(this.template()),this.$(".count-placeholder").append(this.views.count.render().$el),this.$(".gap-placeholder").append(this.views.gap.render().$el),this.$(".width-placeholder").append(this.views.width.render().$el),this},remove:function(){return Object.keys(this.views).forEach(function(e){t(this.views[e].remove,"function")&&this.views[e].remove()},this),s.__super__.remove.apply(this,arguments)}});return s}),define("hbs!ui/layout-properties-dialog/templates/columns/rules",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+=' style="background-color: ',(n=i.colour)?n=n.call(e,{hash:{}}):(n=e.colour,n=typeof n===l?n.apply(e):n),s+=c(n)+';"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<div class="header">\n    <h4>Column Rules</h4>\n    <div class="info-tooltip">\n        <span aria-hidden="true" data-icon="ÓÄí"></span>\n        <span class="screen-reader-text">Info</span>\n        <div class="info">\n            <section>\n                <p><b>Width</b></p>\n                <p>The width of the rule between columns</p>\n            </section>\n            <section>\n                <p><b>Style</b></p>\n                <p>The visual style of the rule</p>\n            </section>\n            <section>\n                <p><b>Color</b></p>\n                <p>The color of the rule</p>\n            </section>\n        </div>\n    </div>\n</div>\n\n<section class="width-placeholder cf">\n    <h5>Width</h5>\n</section>\n\n<section class="style-placeholder cf">\n    <h5>Style</h5>\n</section>\n\n<section class="colour-placeholder cf">\n    <h5>Colour</h5>\n    <div class="colour-swatch">\n        <div class="controls-colour-selected" style="width: 20px; height: 20px;">\n            <div class="thumb-preview" title="Change the text colour">\n                <div',o=i["if"].call(t,t.colour,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+='></div>\n            </div>\n        </div>\n        <span class="label" style="display: none;">Column rule colour</span>\n    </div>\n</section>\n'});return t.registerPartial("ui_layout-properties-dialog_templates_columns_rules",i),i}),define("ui/layout-properties-dialog/views/columns/rules",["backbone","core/utils/is","hbs!../../templates/columns/rules","core/components/unitvalue/index","../../views/text/one-value-selector"],function(e,t,i,n,s){"use strict";var r=e.View.extend({tagName:"div",className:"column-rules cf",template:i,column_rule_colour_property:null,events:{"click .thumb-preview":"onClickColourPicker"},views:null,model:null,initialize:function(){return this.views={},this.views.width=new n({units:["px","em"],css_property:"column-rule-width",disable_views:["slider","stepper"],"default":{value:"0",unit:"px"}}),this.views.style=new s({id:"column-rule-style-selector",title:"",tooltip_prefix:"Style:",changes_attr:"column-rule-style",values:[{text:"Solid",value:"solid","class":"solid"},{text:"Dashed",value:"dashed","class":"dashed"},{text:"Dotted",value:"dotted","class":"dotted"},{text:"None",value:"none","class":"none"}],model:this.model}),this.column_rule_colour_property="column-rule-color",this},listenToEvents:function(){return this.stopListening(),this.onChangeElementId(),this.onChangeStyleDeclaration(),this.listenTo(this.model,"change:element",this.onChangeElementId,this),this.listenTo(this.model,"change:style_declaration",this.onChangeStyleDeclaration,this),this.listenTo(this.views.width,"change",this.onChange,this),!0},onClickColourPicker:function(e){return e.preventDefault(),this.model.trigger("open-colour-dialog",this.model.getValue(this.column_rule_colour_property),function(e){this.model.setValue(this.column_rule_colour_property,e)},this),!0},onChange:function(e,t){return this.model.setValue(e,t),!0},onChangeElementId:function(){var e=this.model.get("element"),i=this.model.get("style_declaration");return t(e,"element")&&t(i,"object")?(this.views.width.setElementIdAndMediaQueryId(e.getElement().id,i.getMediaQueryId()),!0):!1},onChangeStyleDeclaration:function(){var e=this.model.get("style_declaration");return t(e,"object")?(this.views.width.setValueByStyleDeclaration(e),!0):!1},render:function(){return this.listenToEvents(),this.delegateEvents(),this.$el.html(this.template({colour:this.model.getValue(this.column_rule_colour_property)})),this.$(".width-placeholder").append(this.views.width.render().$el),this.$(".style-placeholder").append(this.views.style.render().$el),this},remove:function(){return Object.keys(this.views).forEach(function(e){t(this.views[e].remove,"function")&&this.views[e].remove()},this),r.__super__.remove.apply(this,arguments)}});return r}),define("hbs!ui/layout-properties-dialog/templates/columns/break/header",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<h4>Column break</h4>\n<div class="info-tooltip">\n    <span aria-hidden="true" data-icon="ÓÄí"></span>\n    <span class="screen-reader-text">Info</span>\n    <div class="info">\n        <section>\n            <p><b>Column break</b></p>\n            <p>Column breaks helps you control how content gets split across columns.</p>\n        </section>\n        <section>\n            <p><span class="experimental"> Note:<span> these properties are not fully supported in all major browsers</p>\n        </section>\n    </div>\n</div>\n<div class="toggle-icon">\n    <span>Show/Hide section<span>\n</div>\n'});return t.registerPartial("ui_layout-properties-dialog_templates_columns_break_header",i),i}),define("ui/layout-properties-dialog/views/columns/break/header",["backbone","hbs!../../../templates/columns/break/header"],function(e,t){"use strict";var i=e.View.extend({tagName:"div",className:"header",template:t,model:null,_is_collapsed:!0,events:{"click .toggle-icon":"onClick"},initialize:function(){return this},onClick:function(e){return e.preventDefault(),this.toggle(),!0},isCollapsed:function(){return this._is_collapsed},toggle:function(){return this._is_collapsed=!this.isCollapsed(),this.toggleCollapsedClass(),this.trigger("toggle"),!0},toggleCollapsedClass:function(){return this.$el.toggleClass("collapsed",this.isCollapsed()),!0},render:function(){return this.delegateEvents(),this.toggleCollapsedClass(),this.$el.html(this.template()),this}});return i}),define("hbs!ui/layout-properties-dialog/templates/columns/break/body",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<section class="before cf">\n    <h5>Break-before:</h5>\n</section>\n\n<section class="inside cf">\n    <h5>Break-inside:</h5>\n</section>\n\n<section class="after cf">\n    <h5>Break-after:</h5>\n</section>\n\n<section class="bottom">\n    <small><p class="browser-hint">Supported in IE10, FF14 and Chrome 10. <br><a href="http://www.w3.org/TR/css3-multicol/#column-breaks" target="_blank">Read more about column break</a></p></small>\n</section>\n'});return t.registerPartial("ui_layout-properties-dialog_templates_columns_break_body",i),i}),define("hbs!ui/layout-properties-dialog/templates/columns/break/select",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        <option value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===c?n.apply(e):n),s+=u(n)+'"',n=i["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+=">\n            ",(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===c?n.apply(e):n),s+=u(n)+"\n        </option>\n    "}function o(e,t){return" selected"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<select class="',(a=i.css_property)?a=a.call(t,{hash:{}}):(a=t.css_property,a=typeof a===c?a.apply(t):a),l+=u(a)+'">\n    ',a=i.each.call(t,t.values,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n</select>\n"});return t.registerPartial("ui_layout-properties-dialog_templates_columns_break_select",i),i}),define("ui/layout-properties-dialog/views/columns/break/select",["jquery","underscore","backbone","core/utils/is","hbs!../../../templates/columns/break/select","chosen"],function(e,t,i,n,s){"use strict";var r=i.View.extend({template:s,tagName:"div",className:"",css_property:null,values:null,default_value:"inherit",model:null,events:{"change select":"onChange"},initialize:function(){return this.css_property=this.options.css_property,this.values=this.options.values,this},render:function(){var e,t;return this.delegateEvents(),t=this.model.getValue(this.css_property)||this.default_value,e=this.template({css_property:this.css_property,values:this._generateOptionsArray(this.values,t)}),this.$el.html(e),this.$("select").chosen({disable_search:!0}),this},_generateOption:function(e,i){return t.extend(e,{selected:i===e.value})},_generateOptionsArray:function(e,t){return e.map(function(e){return this._generateOption(e,t)},this)},setValue:function(e){return this.model.setValue(this.css_property,e),!0},onChange:function(t){var i,s;return t.preventDefault(),i=e(t.currentTarget),s=i.val(),n(t,"object")||n(s,"string")?(this.setValue(s),!0):!1}});return r}),define("ui/layout-properties-dialog/views/columns/break/body",["backbone","core/utils/is","hbs!../../../templates/columns/break/body","./select"],function(e,t,i,n){"use strict";var s=e.View.extend({tagName:"div",className:"body",template:i,views:null,model:null,initialize:function(){return this.views={},this.views.before=new n({css_property:"column-break-before",values:[{text:"inherit",value:"inherit"},{text:"auto",value:"auto"},{text:"always",value:"always"},{text:"avoid",value:"avoid"},{text:"left",value:"left"},{text:"right",value:"right"},{text:"page",value:"page"},{text:"column",value:"column"},{text:"avoid-page",value:"avoid-page"},{text:"avoid-column",value:"avoid-column"}],model:this.model}),this.views.inside=new n({css_property:"column-break-inside",values:[{text:"inherit",value:"inherit"},{text:"auto",value:"auto"},{text:"avoid",value:"avoid"},{text:"avoid-page",value:"avoid-page"},{text:"avoid-column",value:"avoid-column"}],model:this.model}),this.views.after=new n({css_property:"column-break-after",values:[{text:"inherit",value:"inherit"},{text:"auto",value:"auto"},{text:"always",value:"always"},{text:"avoid",value:"avoid"},{text:"left",value:"left"},{text:"right",value:"right"},{text:"page",value:"page"},{text:"column",value:"column"},{text:"avoid-page",value:"avoid-page"},{text:"avoid-column",value:"avoid-column"}],model:this.model}),this},render:function(){return this.$el.html(this.template()),this.$(".before").append(this.views.before.render().el),this.$(".inside").append(this.views.inside.render().el),this.$(".after").append(this.views.after.render().el),this},remove:function(){return Object.keys(this.views).forEach(function(e){t(this.views[e].remove,"function")&&this.views[e].remove()},this),s.__super__.remove.apply(this,arguments)}});return s}),define("ui/layout-properties-dialog/views/columns/break/index",["jquery","core/utils/is","backbone","./header","./body"],function(e,t,i,n,s){"use strict";var r=i.View.extend({tagName:"div",className:"column-break",views:null,model:null,initialize:function(){return this.views={},this.views.header=new n({model:this.model}),this.views.body=new s({model:this.model}),this},toggleBody:function(){return this.views.header.isCollapsed()?this.views.body.remove():this.$el.append(this.views.body.render().$el),!0},render:function(){return this.listenTo(this.views.header,"toggle",this.toggleBody,this),this.$el.empty(),this.$el.append(this.views.header.render().el),this.toggleBody(),this},remove:function(){return Object.keys(this.views).forEach(function(e){t(this.views[e].remove,"function")&&this.views[e].remove()},this),r.__super__.remove.apply(this,arguments)}});return r}),define("ui/layout-properties-dialog/views/css-columns",["backbone","core/utils/is","./columns/spread","./columns/rules","./columns/break/index"],function(e,t,i,n,s){"use strict";var r=e.View.extend({tagName:"div",className:"css-columns dialog-body",views:null,model:null,initialize:function(){return this.views={},this.views.spread=new i({model:this.model}),this.views.rules=new n({model:this.model}),this.views["break"]=new s({model:this.model}),this},render:function(){return this.$el.empty(),this.$el.append(this.views.spread.render().$el),this.$el.append(this.views.rules.render().$el),this.$el.append(this.views["break"].render().$el),this},remove:function(){return Object.keys(this.views).forEach(function(e){t(this.views[e].remove,"function")&&this.views[e].remove()},this),r.__super__.remove.apply(this,arguments)}});return r}),define("ui/layout-properties-dialog/index",["jquery","underscore","backbone","core/utils/is","core/utils/dom","core/components/extended_dialog/index","./models/element-data","./views/tabs","./views/text-properties","./views/css-columns","jquery-ui-position"],function(e,t,i,n,s,r,o,a,l,c){"use strict";var u=r.extend({namespace:"ui:layout-dialog",tagName:"div",id:"layout-dialog",className:"layout-dialog dialog",listeners:t.extend({"[remote]data:styles:changed":"onChangeStyleDeclaration","[remote]data:elements:updated:element":"onUpdateActiveElement","[remote]data:styles:deleted:styleDeclaration":"getStyleDeclaration"},r.prototype.listeners,i.UIController.prototype.listeners),title_text:"Advanced Properties",title_info:"Advanced Properties",position:null,attributes:null,model:null,views:null,app_el:null,initialize:function(){return u.__super__.initialize.apply(this,arguments),this.views.title.setTitle(this.title_text),this.views.title.setInfo(this.title_info),this.position={my:"left+50 top-50",at:"right top",collision:"flipfit flipfit"},this.attributes=["text-transform","letter-spacing","text-indent","text-shadow","column-count","column-gap","column-width","column-rule-width","column-rule-style","column-rule-color","column-break-before","column-break-inside","column-break-after"],this.model=new o,this.views.text=new l({model:this.model}),this.views.columns=new c({model:this.model}),this.views.tabs=new a({tabs:[{id:"text",title:"Text Effects",className:"text-effects",view:this.views.text},{id:"columns",title:"CSS Columns",className:"css-columns",view:this.views.columns}]}),this},listenToEvents:function(){return this.stopListening(),this.listenTo(this.model,"open-colour-dialog",this.onOpenColourDialog,this),this.listenTo(this.model,"attribute:removed",this.onRemove,this),this.listenTo(this.model,"attribute:changed",this.onChange,this),this.listenTo(this.views.tabs,"change",this.render,this),!0},onOpenColourDialog:function(e,t,i){return n(t,"function")?(this.imc.trigger("ui:colour-dialog:open",e,t,i),!0):!1},onRemove:function(e){var t=[],i=this.model.get("element");return n(i,"element")&&n(this.active_media_query,"media_query")?(t.push(e),this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,i.getSelector(),t),!0):!1},onChange:function(e,t){var i={},s=this.model.get("element");return n(s,"element")&&n(this.active_media_query,"media_query")?(i[e]=[t],this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,s.getSelector(),i),!0):!1},onChangeActiveElement:function(e){return this.model.clear(),n(e,"element")?(this.model.set({element:e}),this.position.of=this._getElement(e.getElement().id),this.getStyleDeclaration(),this.closeDialog(),!0):(this.closeDialog(!0),!1)},getStyleDeclaration:function(){var e=this.model.get("element");return n(e,"element")&&n(this.active_media_query,"media_query")?(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,e.getSelector(),{element_id:e.getElement().id,attributes:this.attributes},this.onGetStyleDeclarationBySelector,this),!0):!1},onGetStyleDeclarationBySelector:function(e,t){return e?(this.log("error","Failed to get style declaration",e),!1):(this.setValueByStyleDeclarations(t),!0)},setValueByStyleDeclarations:function(e){return n(e,"object")&&n(e.getStyleDeclaration,"function")&&n(e.getValue,"function")&&n(e.isInherited,"function")?(this.model.set({style_declaration:e}),(this.views.title.isPinned()||this.isRendered())&&this.render(),!0):!1},onChangeStyleDeclaration:function(e,t,i){var s=this.model.get("element");return n(s,"element")?this.active_style_id!==e||s.getSelector()!==i?!1:(this.getStyleDeclaration(),!0):!1},onUpdateActiveElement:function(e){var t=this.model.get("element");return n(e,"element")&&n(t,"element")?t.getElement().id!==e.getElement().id?!1:(this.model.set({element:e}),this.getStyleDeclaration(),!0):!1},render:function(e){var t,s=this.isRendered(),r=this.model.get("element");return n(r,"element")?(n(e,"array")||(e=[]),t=this.views.tabs.getActiveTabView(),t instanceof i.View&&(e=[t].concat(e)),e=[this.views.tabs].concat(e),u.__super__.render.call(this,e),s||this.$el.position(this.position),this.listenToEvents(),this):!1},_getElement:function(e){return n(this.active_media_query,"object")?s.getElement(this.active_media_query.getMediaQuery().id,e):!1}});return u}),define("ui/baseline-grid/views/grid",["backbone","jquery","core/utils/is","core/utils/dom"],function(e,t,i,n){var s=e.View.extend({id:"baseline-grid",tagName:"div",$media_query:null,events:{click:"onClick"},initialize:function(){this.model.get("visibility")&&this.insertElement(),t(window).resize(t.proxy(this.updateWidthAndHeight,this)),this.addEvents()},setMediaQueryById:function(e){return!i(e,"string")||e.length<1?!1:(this.$media_query=t(".elements").find(n.getMediaQuerySelector(e)),!0)},render:function(){var e=this.model.getOffsetWithPadding();return this.$el.css({"background-size":"100% "+this.model.get("line-height"),top:e}),this.updateWidthAndHeight(),this},onClick:function(e){return e.preventDefault(),e.target!==e.currentTarget?!1:(this.trigger("grid:clicked"),!0)},insertElement:function(){return this.$el.appendTo(this.options.$root),this.updateWidthAndHeight(),!0},addEvents:function(){return this.model.on("change:offset change:line-height change:strategy",this.render,this),this.model.on("change:visibility",this.toggle,this),!0},toggle:function(e,t){return t?(this.insertElement(),this.delegateEvents()):(this.undelegateEvents(),this.remove()),this.trigger("grid:visibility-changed",t),!0},updateWidthAndHeight:function(){var e,t,n,s;return!i(this.$media_query,"object")||this.$media_query.length<1?!1:(e=this.$media_query.outerWidth(),t=this.$media_query.outerHeight(!0),n=this.model.getOffsetWithPadding(),s=this.$media_query.offset().left,n=parseInt(n,10),isNaN(n)?n=void 0:t-=n-45,this.$el.css({height:t,width:e,left:s}),!0)},remove:function(){return delete this.$media_query,s.__super__.remove.apply(this,arguments),!0}});return s}),define("hbs!ui/baseline-grid/templates/gridToggleControls",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return'\n<span class="baseline-options-icon"\n    data-icon="ÓÅÉ"\n    aria-hidden="true"\n    data-ns-tooltip="Baseline options"\n    data-ns-side="bottom"\n    data-ns-decrement-y="8">\n</span>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l=this;return a+='<a href="#" title="Toggle the baseline grid" class="baseline-toggle">Baseline Grid</a>\n',o=i["if"].call(t,t.isVisible,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a});return t.registerPartial("ui_baseline-grid_templates_gridToggleControls",i),i}),define("ui/baseline-grid/views/gridToggleControls",["jquery","backbone","hbs!../templates/gridToggleControls"],function(e,t,i){var n=t.View.extend({el:"div.baseline-grid-nav",events:{"click .baseline-toggle":"onToggleClick","click .baseline-options-icon":"onIconClick"},initialize:function(){this.insertElement(),this.addEvents()},render:function(){return this.$el.html(i({tag:this.tagName,isVisible:this.model.get("visibility")})),this},insertElement:function(){return this.$el.prependTo(this.options.$root)},addEvents:function(){return this.model.on("change:visibility",this.render,this),!0},onToggleClick:function(e){return e.preventDefault(),this.trigger("menu:toggle-button-clicked"),!0},onIconClick:function(e){return e.preventDefault(),this.trigger("menu:options-icon-clicked"),!0},remove:function(){return n.__super__.remove.apply(this,arguments),!0}});return n}),define("hbs!ui/baseline-grid/templates/gridDropdownOptions",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return"checked"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l=this,c="function",u=this.escapeExpression;return a+='<div id="dialog-baseline">\n  <div class="body">\n    <div class="baseline-repetition-selection">\n        <p>\n          <input id="baseline-paragraph" type="radio" name="grid-space" value="p-based"\n             ',o=i["if"].call(t,t.isPbased,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+='>\n          <label for="baseline-paragraph">Based on &lt;p&gt; line-height</label>\n        </p>\n        <p><em>or</em></p>\n        <p>\n          <input id="baseline-custom" type="radio" name="grid-space" value="fixed"\n             ',
o=i["if"].call(t,t.isFixed,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+='>\n          <label for="baseline-custom">Every</label>\n          <input class="every" type="text" value="',(o=i.every)?o=o.call(t,{hash:{}}):(o=t.every,o=typeof o===c?o.apply(t):o),a+=u(o)+'"> px\n        </p>\n        <div id="baseline-repetition"></div>\n    </div>\n    <div class="extra-options">\n      <p>Start grid at</p>\n      <div class="holder" id="baseline-starting-position">\n        <p><input class="start-at" type="text" value="',(o=i.startAt)?o=o.call(t,{hash:{}}):(o=t.startAt,o=typeof o===c?o.apply(t):o),a+=u(o)+'"> px</p>\n        <div id="baseline-start"></div>\n      </div>\n    </div>\n    <div class="clear"></div>\n  </div>\n</div>\n'});return t.registerPartial("ui_baseline-grid_templates_gridDropdownOptions",i),i}),define("ui/baseline-grid/views/gridDropdownOptions",["jquery","backbone","core/components/dropdown/index","hbs!../templates/gridDropdownOptions"],function(e,t,i,n){var s=i.extend({className:"dropdown-panel baseline-settings-panel",events:{"click #baseline-paragraph, #baseline-custom":"onStrategyIsChanged","keyup .every, .start-at":"onOptionsAreChanged","click .every":"onCustomBaselineInputClick"},initialize:function(){s.__super__.initialize.apply(this,arguments)},bindUI:function(){return this.ui={baseline_paragraph_radio:this.$el.find("#baseline-paragraph"),baseline_custom_radio:this.$el.find("#baseline-custom"),baseline_custom_input:this.$el.find(".every"),start_at_input:this.$el.find(".start-at")},!0},render:function(){return this.$el.html(n(this.model.getFormattedData())),this.delegateEvents(),this.bindUI(),s.__super__.render.call(this,[]),this},onCustomBaselineInputClick:function(){return this.ui.baseline_custom_radio.prop("checked",!0),this.onStrategyIsChanged(),!0},onStrategyIsChanged:function(){return this.ui.baseline_custom_radio.is(":checked")&&this.ui.baseline_custom_input.focus(),this.onOptionsAreChanged(),!0},onOptionsAreChanged:function(){return this.trigger("options:changed",this.getUIData()),!0},getStartAtValue:function(){return(this.ui.start_at_input.val()||"0")+"px"},getEveryLineValue:function(){return(this.ui.baseline_custom_input.val()||"0")+"px"},getStrategyValue:function(){return this.$el.find("input[name=grid-space]:checked").val()},getUIData:function(){return{offset:this.getStartAtValue(),"line-height":this.getEveryLineValue(),strategy:this.getStrategyValue()}}});return s}),define("ui/baseline-grid/models/grid",["underscore","backbone"],function(e,t){return t.Model.extend({defaults:{offset:"0","line-height":"14px",strategy:"p-based",visibility:!1,"padding-top":"99px"},setGridData:function(e){return e?(this.set({offset:e.offset,"line-height":e["line-height"],strategy:e.strategy,visibility:e.visibility}),!0):!1},getFormattedData:function(){var e=/[^0-9\.]+/g;return{isFixed:"fixed"===this.get("strategy"),isPbased:"p-based"===this.get("strategy"),every:this.get("line-height").replace(e,""),startAt:this.get("offset").replace(e,"")}},cloneAttributes:function(){return e.clone(this.attributes)},getOffsetWithPadding:function(){return parseInt(this.get("offset"),10)+parseInt(this.get("padding-top"),10)+"px"}})}),define("ui/baseline-grid/index",["jquery","underscore","backbone","core/utils/is","./views/grid","./views/gridToggleControls","./views/gridDropdownOptions","./models/grid"],function(e,t,i,n,s,r,o,a){return i.UIController.extend({namespace:"ui:baseline-grid",dataNamespace:"data:baseline-grid",views:null,listeners:t.extend({toggle:"toggleGrid","settings:close":"closeGridSettings","settings:toggle":"optionsToggle","[remote]data:baseline-grid:changed":"onChanged","[remote]ui:containers:render-container:complete":"updateGridSize","[remote]ui:containers:delete:container:complete":"updateGridSize","[remote]data:elements:updated:element":"updateGridSize","[remote]data:styles:changed":"updateGridSize","[remote]ui:elements:loaded":"onElementsLoaded"},i.UIController.prototype.listeners),initialize:function(){this.app_el=e(this.app_el),this.views={},this.gridModel=new a,this.views.gridView=new s({$root:this.app_el,model:this.gridModel}),this.addEvents()},onElementsLoaded:function(){return this.imc.trigger("data:styles:getDefaultMediaQuery",function(e,t){return e?(this.log("Failed to get default media query."),!1):n(t,"media_query")?(this.views.gridView.setMediaQueryById(t.getMediaQuery().id),void this.views.gridView.render()):!1},this),!0},onChangeActiveMediaQuery:function(e,t){var i;return n(t,"media_query")&&(i=t.getMediaQuery().id),n(e,"media_query")&&(i=e.getMediaQuery().id),this.views.gridView.setMediaQueryById(i),this.updateGridSize(),!0},addEvents:function(){return this.listenTo(this.views.gridView,"grid:visibility-changed",this.gridVisibilityIsChanged,this),this.listenTo(this.views.gridView,"grid:clicked",this.gridClicked,this),!0},prepareDropdownSettings:function(){return this.views.gridDropdownOptionsView=new o({imc:this.imc,model:this.gridModel,target_el:this.app_el.find(".main-menu-sidebar .baseline-grid-button"),parent_el:this.app_el,position:{my:"left-10 bottom",at:"right bottom"}}),this.listenTo(this.views.gridDropdownOptionsView,"options:changed",this.optionsAreChanged,this),!0},onChanged:function(e,t){return e?!1:(this.gridModel.setGridData(t),!0)},closeGridSettings:function(){return n(this.views.gridDropdownOptionsView,"object")?(this.views.gridDropdownOptionsView.close(),!0):!1},toggleGrid:function(){var e=this.gridModel.cloneAttributes();return e.visibility=!e.visibility,this.imc.trigger(this.dataNamespace+":change",e),e.visibility&&this.imc.trigger("service:metrics:record","Grey bar 'Baseline grid'"),!0},gridClicked:function(){return this.imc.trigger("ui:project:review-mode"),!0},gridVisibilityIsChanged:function(e){return e?this.imc.trigger(this.namespace+":shown"):(this.imc.trigger(this.namespace+":removed"),n(this.views.gridDropdownOptionsView,"object")&&this.views.gridDropdownOptionsView.close()),!0},optionsToggle:function(){var e=this.app_el.find(".main-menu-sidebar .baseline-grid-button");return n(this.views.gridDropdownOptionsView,"object")?(this.views.gridDropdownOptionsView.target_el=e,this.views.gridDropdownOptionsView.position.of=e):this.prepareDropdownSettings(),this.views.gridDropdownOptionsView.toggle(),!0},optionsAreChanged:function(e){return e?(this.imc.trigger(this.dataNamespace+":change",t.extend(this.gridModel.cloneAttributes(),e)),!0):!1},updateGridSize:function(){var i;return n(this.throttleGridSizeUpdate,"function")||(i=e.proxy(this.views.gridView.updateWidthAndHeight,this.views.gridView),this.throttleGridSizeUpdate=t.throttle(i,100,!0)),this.throttleGridSizeUpdate(),!0}})}),define("ui/font-dialog/models/filter",["backbone","underscore","core/utils/is"],function(e,t,i){var n=e.Model.extend({defaults:{top_level_filter:null,search_query:"",library:null,classification:null,offset:0,limit:40},toFilterObject:function(){var e=t.omit(this.attributes,"top_level_filter"),n=this.get("library"),s=this.get("top_level_filter");return i(s,"string")&&(e.library=s,e.library+=i(n,"string")?","+n:""),e},setTopLevelFilter:function(e){this.set({library:null,classification:null,top_level_filter:e,offset:0}),this.trigger("top_level_selected")}});return n}),define("ui/font-dialog/models/filter-result",["underscore","backbone","core/utils/is"],function(e,t,i){var n=t.Model.extend({default_alphabet:null,defaults:{success:!0,total_results:0,alphabet:[],fonts:[],new_result_set:!1},initialize:function(){this.set=e.wrap(this.set,e.bind(function(t,i,n){e.has(i,"headers")||(i.headers=this.useAlphabetAsHeaders(i.alphabet)),t.apply(this,[i,n])},this)),this.default_alphabet=e.range(65,91,1).map(function(e){return String.fromCharCode(e)}),this.default_alphabet.push("0-9")},getFullAlphabet:function(){var t=[],n=this.get("alphabet");return i(n,"array")||(n=[]),n=n.map(function(e){return i(e,"object")&&i(e.letter,"string")?e.letter.toUpperCase():void 0}),n=e.compact(n),this.default_alphabet.forEach(function(e){t.push({letter:e,active:-1!==n.indexOf(e)?!0:!1})},this),t},useAlphabetAsHeaders:function(t){return i(t,"array")?e.map(t,function(e){return{text:e.letter,offset:e.offset}}):!1}});return n}),define("hbs!ui/font-dialog/templates/filter",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+="<small>",(r=i.fontCount)?r=r.call(t,{hash:{}}):(r=t.fontCount,r=typeof r===a?r.apply(t):r),o+=l(r)+'</small>\n<input type="text" value="',(r=i.value)?r=r.call(t,{hash:{}}):(r=t.value,r=typeof r===a?r.apply(t):r),o+=l(r)+'" class="font-search-query" placeholder="',(r=i.placeholder)?r=r.call(t,{hash:{}}):(r=t.placeholder,r=typeof r===a?r.apply(t):r),o+=l(r)+'">\n<button>&#xe020;</button>\n'});return t.registerPartial("ui_font-dialog_templates_filter",i),i}),define("ui/font-dialog/views/filter",["jquery","underscore","backbone","core/utils/is","core/utils/str","hbs!./../templates/filter"],function(e,t,i,n,s,r){var o=i.View.extend({className:"filter",template:r,filter_result:{},events:{"keyup input":"onKeyUp","click .clear-search-results":"clearSearchField"},initialize:function(e){this.filter_result=e.filter_result,this.top_level_filters=e.top_level_filters,this.filter_query=e.model,this.render(),this.filter_result.on("change",this.updateView,this),this.filter_query.on("change:top_level_filter",this._hide,this)},render:function(){return this.$el.html(this.template({value:this.model.get("search_query"),fontCount:this.getFontCountLabel(),placeholder:this.getPlaceholderLabel()})),this.delegateEvents(),this.$search_field=this.$("input"),this._toggleSearchInputClearButton(this.$search_field.val()),this},updateView:function(){this.$("small").html(this.getFontCountLabel()),this.$search_field.attr("placeholder",this.getPlaceholderLabel())},getFontCountLabel:function(){var e=this.filter_result.get("total_results");return n(e,"number")||(e=0),e+" font "+s.pluralize(e,"family","families")},getPlaceholderLabel:function(){var e,i=this.model.get("top_level_filter");if(t.isEmpty(i))e="A-Z";else{var n=t.findWhere(this.top_level_filters,{id:i});e=t.isEmpty(n)?this.top_level_filters[0].label:n.label}return'Search "'+e+'"'},focus:function(){return!this.$search_field||this.$search_field.length<1?!1:(this.$search_field.focus(),!0)},onKeyUp:function(){var e=this.$search_field.val();return this._toggleSearchInputClearButton(e),(!n(e,"string")||e.length<2)&&(e=""),this._updateModelWithSearchQuery(e),!0},clearSearchField:function(e){return e&&e.preventDefault(),this.$search_field.val(""),this.hideSearchInputClearButton(),this._updateModelWithSearchQuery(""),this.focus(),!0},hideSearchInputClearButton:function(){return this.$el.find("button").removeClass("clear-search-results").removeAttr("title"),!0},showSearchInputClearButton:function(){return this.$el.find("button").addClass("clear-search-results").attr("title","Clear search"),!0},_toggleSearchInputClearButton:function(e){return!n(e,"string")||e.length<1?this.hideSearchInputClearButton():this.showSearchInputClearButton()},_updateModelWithSearchQuery:function(e){this.model.set({search_query:e,offset:0})},_hide:function(e,t){"favs"===t?this.$el.addClass("hidden"):this.$el.removeClass("hidden")}});return o}),define("ui/font-dialog/models/font",["backbone"],function(e){return e.Model.extend({})}),define("ui/font-dialog/models/fonts",["backbone","./font"],function(e,t){return e.Collection.extend({model:t})}),define("ui/font-dialog/views/infinite-scroll",["jquery","backbone","underscore","core/utils/is","core/typecastError"],function(e,t,i,n,s){var r=t.View.extend({events:{scroll:"watchScroll",mousewheel:"preventScrollPropagation"},default_config:{scroll_offset:50,scroll_timeout_ms:25,max_items:150},className:"vanilla-infinite-scroll",tagName:"ul",collection:null,last_visible_offset:null,initialize:function(){if(n(this.options.config,"object")?this.config=i.defaults(this.options.config,this.default_config):this.config=i.clone(this.default_config),!(this.collection instanceof t.Collection))throw new s(101,"Subclasss must define a collection.");this.views={},this.views.items=[],this.inScrollZone={top:!1,bottom:!1},this.scroll_timeout=null},checkScrollZone:function(e){var t,i,n;return e?(i=this.$el.find("li:first"),t="top"):(i=this.$el.find("li:last"),t="bottom"),0===i.length?!1:(n=e?this.$el.offset()[t]-i.offset()[t]:i.offset().top+i.outerHeight()-(this.$el.offset().top+this.$el.outerHeight()),n<=this.config.scroll_offset?this.inScrollZone[t]?void 0:(this.inScrollZone[t]=!0,!0):(this.inScrollZone[t]=!1,!1))},watchScroll:function(){var t=i.bind(function(){var t=this.$el.offset().top;return this.scroll_timeout=null,this.checkScrollZone(!1)?(this.addChunk(!1),!0):this.checkScrollZone(!0)?(this.addChunk(!0),!0):void i.some(this.$("li:visible"),function(i){var n=e(i),s=n.offset();return s.top>=t?(this.last_visible_offset=n.find("div").first().attr("data-offset"),!0):!1},this)},this);return this.scroll_timeout=this.scroll_timeout||window.setTimeout(t,this.config.scroll_timeout_ms),!0},preventScrollPropagation:function(e){var t=e.originalEvent.wheelDelta||-e.originalEvent.detail,i=this.$el.get(0),n=this.$el.height(),s=i.scrollHeight,r=i.scrollTop;(r>s-n-5&&0>t||0===r&&t>0)&&e.preventDefault()},render:function(){var e=parseInt(this.last_visible_offset,10)||null,t=this;return this.views.items.forEach(function(e){e.remove()},this),this.views.items=this.renderItems(this.collection),this.$el.append(i.pluck(this.views.items,"$el")),this.inScrollZone={top:!1,bottom:!1},window.clearTimeout(this.scroll_timeout),this.scroll_timeout=null,n(e,"number")&&e?setTimeout(function(){t.goTo(e)},0):this.$el.scrollTop(0),this.delegateEvents(),this},renderChunk:function(e,s){var r,o,a;if(!(e instanceof t.Collection&&n(s,"boolean")))return!1;if(a=this.renderItems(e),r=this.$el.scrollTop(),s){o=i.pluck(a,"$el"),this.views.items=a.concat(this.views.items),this.$el.prepend(o);var l=i.reduce(o,function(e,t){return e+t.outerHeight()},0);this.$el.scrollTop(r+l)}else this.views.items=this.views.items.concat(a),this.$el.append(i.pluck(a,"$el"));return this.collection.length>this.config.max_items?(this.removeChunk(this.collection.length-this.config.max_items,s),!0):!0},removeChunk:function(e,t){var s,r,o,a;return!n(e,"number")||0>e||!n(t,"boolean")?!1:(a=this.$el.scrollTop(),t?(s=this.collection.last(e),r=this.views.items.splice(-e,e)):(s=this.collection.first(e),r=this.views.items.splice(0,e)),this.collection.remove(s),o=i.reduce(r,function(e,t){return e+t.$el.outerHeight()},0),r.forEach(function(e){e.remove()}),t||this.$el.scrollTop(Math.max(a-o,0)),!0)},remove:function(){window.clearTimeout(this.scroll_timeout),this.scroll_timeout=null,r.__super__.remove.apply(this,arguments)},renderItems:function(){throw new s(101,"renderItems must be overloaded by the child class")},addChunk:function(){throw new s(101,"addChunk must be overloaded by the child class")}});return r}),define("hbs!ui/font-dialog/templates/font-list-item",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return"header "}function o(e,t){var n,s="";return s+='<div class="heading">',(n=i.header)?n=n.call(e,{hash:{}}):(n=e.header,n=typeof n===c?n.apply(e):n),s+=u(n)+"</div>"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<div class="',a=i["if"].call(t,t.header,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+='" data-offset=',(a=i.offset)?a=a.call(t,{hash:{}}):(a=t.offset,a=typeof a===c?a.apply(t):a),l+=u(a)+">\n    ",a=i["if"].call(t,t.header,{hash:{},inverse:h.noop,fn:h.program(3,o,s)}),(a||0===a)&&(l+=a),l+='\n    <div class="name"><img src="',(a=i.font_image)?a=a.call(t,{hash:{}}):(a=t.font_image,a=typeof a===c?a.apply(t):a),l+=u(a)+'" alt="',(a=i.name)?a=a.call(t,{hash:{}}):(a=t.name,a=typeof a===c?a.apply(t):a),l+=u(a)+'"></div>\n</div>\n'});return t.registerPartial("ui_font-dialog_templates_font-list-item",i),i}),define("hbs!ui/font-dialog/templates/font-list-preview",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s,r="";return r+='\n        <span class="weight">'+c((n=e.variations,n=null==n||n===!1?n:n.length,typeof n===l?n.apply(e):n))+" ",(s=i.weights_text)?s=s.call(e,{hash:{}}):(s=e.weights_text,s=typeof s===l?s.apply(e):s),r+=c(s)+"</span>\n        "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<div class="lrg-preview-holder">\n    <img src="',(o=i.font_preview_image)?o=o.call(t,{hash:{}}):(o=t.font_preview_image,o=typeof o===l?o.apply(t):o),a+=c(o)+'" alt="',(o=i.name_clean)?o=o.call(t,{hash:{}}):(o=t.name_clean,o=typeof o===l?o.apply(t):o),a+=c(o)+'" />\n    <p>\n        <span class="font-family ',(o=i.provider)?o=o.call(t,{hash:{}}):(o=t.provider,o=typeof o===l?o.apply(t):o),a+=c(o)+'">',(o=i.provider)?o=o.call(t,{hash:{}}):(o=t.provider,o=typeof o===l?o.apply(t):o),a+=c(o)+"</span>\n        ",(o=i.name_clean)?o=o.call(t,{hash:{}}):(o=t.name_clean,o=typeof o===l?o.apply(t):o),a+=c(o)+"\n        ",o=i["if"].call(t,t.variations,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+="\n    </p>\n</div>\n"});return t.registerPartial("ui_font-dialog_templates_font-list-preview",i),i}),define("ui/font-dialog/views/font-list-preview",["jquery","underscore","backbone","core/utils/is","hbs!./../templates/font-list-preview","core/utils/retina"],function(e,t,i,n,s,r){var o=i.View.extend({template:s,className:"font-item-preview",model:null,position:null,default_extension:".png",initialize:function(){this.position=this.options.position,this.$el.css({top:this.position.top,left:this.position.left})},render:function(){var e,i;return e=t.extend({},this.model.toJSON()),n(e.variations,"array")&&(e.weights_text=1===e.variations.length?"weight":"weights"),n(e.preview_image_url,"string")&&(e.font_preview_image=e.preview_image_url,r.isRetinaDisplay()&&n(e.retina_preview_image_url,"string")&&(e.font_preview_image=e.retina_preview_image_url)),i=this.template(e),this.$el.html(i),this}});return o}),define("hbs!core/components/favourite-button/templates/favourite-button",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<p class="fav-this">\n    <a href="#0">\n        <span class="screen-reader-text">Fav this</span>\n    </a>\n</p>\n'});return t.registerPartial("core_components_favourite-button_templates_favourite-button",i),i}),define("core/components/favourite-button/views/FavouriteButton",["jquery","backbone","core/utils/is","hbs!../templates/favourite-button"],function(e,t,i,n){return t.View.extend({template:n,events:{"click a":"_onButtonClick"},id:null,is_favourite:null,show_tooltips:null,initialize:function(e){(i(e,"object")&&!i(e.id,"undefined")||null!==e.id)&&(this.id=e.id),this.is_favourite=!1,i(e,"object")&&i(e.is_favourite,"boolean")&&(this.is_favourite=e.is_favourite),this.show_tooltips=!1,i(e,"object")&&i(e.show_tooltips,"boolean")&&(this.show_tooltips=e.show_tooltips)},render:function(){return this.$el=e(this.template()),this.is_favourite&&this._addFavouriteClass(),this.show_tooltips&&this._updateTooltip(),this.delegateEvents(),this},setIsFavouriteState:function(e){return i(e,"boolean")?(this.is_favourite=e,this.is_favourite?this._addFavouriteClass():this._removeFavouriteClass(),this.show_tooltips&&this._updateTooltip(),!0):!1},_addFavouriteClass:function(){this.$el.find("a").addClass("favd")},_removeFavouriteClass:function(){this.$el.find("a").removeClass("favd")},_onButtonClick:function(e){e.preventDefault(),e.stopPropagation(),this.is_favourite?(this.setIsFavouriteState(!1),this.trigger("toggle:is_favourite",this.id,this.is_favourite)):(this.setIsFavouriteState(!0),this.trigger("toggle:is_favourite",this.id,this.is_favourite))},_updateTooltip:function(){this.is_favourite?this.$el.attr("data-tooltips-title","Remove from Favs"):this.$el.attr("data-tooltips-title","Add to Favs")}})}),define("ui/font-dialog/views/font-list-item",["jquery","underscore","backbone","core/utils/is","core/typecastError","hbs!./../templates/font-list-item","./font-list-preview","core/utils/retina","core/components/favourite-button/views/FavouriteButton"],function(e,t,i,n,s,r,o,a,l){var c=i.View.extend({template:r,className:"font-item",tagName:"li",model:null,preview_view:null,$preview_el:null,events:{click:"onItemSelected",mouseover:"onMouseOver",mouseout:"onMouseOut"},views:null,is_preview:null,initialize:function(e){if(!n(this.model,"object"))throw new s(101,"model must be specified");return this.is_preview=!1,n(e,"object")&&e.is_preview&&(this.is_preview=!0),this.views={},this.$preview_el=this.options.$preview_el,this.is_preview||(this.views.favourite_button=new l({id:this.model.get("id"),is_favourite:this.model.get("is_favourite"),show_tooltips:!0}),this.views.favourite_button.on("toggle:is_favourite",function(e,t){this.model.set("is_favourite",t),this._updateFavouriteClassOnContainer()},this),this.model.on("change:is_favourite",this._updateFavouriteButtonState,this)),this},render:function(){var e;return e=t.extend({},this.model.toJSON()),n(e.image_url,"string")&&(e.font_image=e.image_url,a.isRetinaDisplay()&&n(e.retina_image_url,"string")&&(e.font_image=e.retina_image_url)),this.$el.html(this.template(e)),this.is_preview||(this._renderFavouriteButton(),this._updateFavouriteClassOnContainer()),this.delegateEvents(),this},loaded:function(){return this.cancelLoading(),this.$el.addClass("active"),!0},deselect:function(){return this.$el.removeClass("active"),!0},loadingFailed:function(){return this.cancelLoading(),this.$el.addClass("failed"),!0},cancelLoading:function(){return this.$el.removeClass("loading"),!0},onMouseOver:function(){var e;return n(this.preview_view,"object")?!1:(e=this._getListItemPosition(),this.preview_view=new o({model:this.model,position:e}),this.preview_view.render(),this.$preview_el.html(this.preview_view.$el),!0)},onMouseOut:function(){return n(this.preview_view,"object")?(this.preview_view.remove(),this.preview_view=null,!0):!1},onItemSelected:function(){return this.$el.addClass("loading"),this.$el.removeClass("failed active"),this.trigger("font:selected",this.model.get("id"),this),!0},remove:function(){this.is_preview||this.views.favourite_button.remove(),c.__super__.remove.apply(this)},_getListItemPosition:function(){var e=this.$el.position(),t=this.$el.parent().position();return n(t,"object")&&(e.top+=t.top),e.left+=this.$el.width(),e},_renderFavouriteButton:function(){this.views.favourite_button.render(),this.$el.find("> div").prepend(this.views.favourite_button.$el)},_updateFavouriteButtonState:function(e,t){this.views.favourite_button.setIsFavouriteState(t)},_updateFavouriteClassOnContainer:function(){this.model.get("is_favourite")?(this.$el.removeClass("unfavd"),this.$el.addClass("favd")):(this.$el.removeClass("favd"),t.has(this.model.changedAttributes(),"is_favourite")&&this.$el.addClass("unfavd"))}});return c}),define("hbs!ui/font-dialog/templates/spinner",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="spinner">\n    <img src="/js/src/images/ajax-loader.gif" />\n</div>\n'});return t.registerPartial("ui_font-dialog_templates_spinner",i),i}),define("hbs!ui/font-dialog/templates/no-favs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="no-favs">\n    <h4>You have no favs</h4>\n    <p>You can add to your favs by clicking the <span class="star"><span class="screen-reader-text">star</span></span> when browsing fonts</p>\n</div>\n'});return t.registerPartial("ui_font-dialog_templates_no-favs",i),i}),define("ui/font-dialog/views/font-list",["jquery","backbone","underscore","core/utils/is","core/typecastError","./../models/fonts","./../models/font","./infinite-scroll","./font-list-item","hbs!./../templates/spinner","hbs!./../templates/no-favs"],function(e,t,i,n,s,r,o,a,l,c,u){var h=a.extend({className:"font-list",collection:null,max_items:200,default_goto_offset:15,$preview_el:null,last_visible_offset:null,active_font_id:null,is_preview:null,active_tab:null,initialize:function(e){if(!n(this.options.filter_query,"object"))throw new s(101,"`filter_query` is a mandatory parameter.");if(!n(this.options.filter_result,"object"))throw new s(101,"`filter_result` is a mandatory parameter.");this.$preview_el=this.options.$preview_el,this.is_preview=!1,n(e,"object")&&e.is_preview&&(this.is_preview=!0),this.collection=new r,this.collection.on("change:is_favourite",this.onFontIsFavouriteChange,this),h.__super__.initialize.apply(this,arguments),n(this.options.config,"object")?this.config.goto_offset=this.options.config.goto_offset:this.config.goto_offset=this.default_goto_offset,this.models={filter_query:this.options.filter_query,filter_result:this.options.filter_result},this.models.filter_result.on("change:fonts",this.onFilterResultChanged,this),this.models.filter_query.on("change",this.onFilterQueryChanged,this),this.models.filter_query.on("change:top_level_filter",this._setActiveTab,this),this.models.filter_query.on("request_state",this._onRequestStatusChange,this)},goTo:function(e){var t,i;if(!n(e,"number"))return!1;var s=this.$el.find('[data-offset="'+e+'"]');return s.length?(this.$el.scrollTop(s.offset().top-this.$el.offset().top+this.$el.scrollTop()),!0):(t=this.config.goto_offset>this.models.filter_query.get("limit")?0:this.config.goto_offset,i=e-t,0>i&&(i=0),this.models.filter_query.set("offset",i),this.models.filter_result.once("change:fonts",function(){this.models.filter_result.get("success")&&this.goTo(e)},this),!0)},preprocessNewItems:function(e){var t,s,a,l,c,u;return n(e,"array")?(a=this.models.filter_result.get("headers"),n(a,"array")?(t=this.models.filter_result.get("headers").reduce(function(e,t){return e[t.offset]=t.text,e},{},this),s=this.models.filter_result.get("offset"),n(s,"number")?(l=i.map(e,function(e,i){return c=new o(e),u=s+i,c.set({offset:u,header:t[u]||null}),c}),new r(l)):!1):!1):!1},renderItems:function(e){return e instanceof r?e.map(function(e){var t,s=e.get("variations"),r=new l({model:e,$preview_el:this.$preview_el,is_preview:this.is_preview});return r.render(),n(s,"array")&&(t=i.pluck(s,"id"),i.contains(t,this.active_font_default_variation_id)&&r.$el.addClass("active")),this.listenTo(r,"font:selected",function(e,t){var s;this.trigger("font:selected",e,t),s=n(this.active_font_default_variation_id,"number")?i.reject(this.views.items,function(e){return e.model.get("default_variation_id")===this.active_font_default_variation_id},this):this.views.items,s.forEach(function(e){e.deselect()})},this),r},this):!1},addChunk:function(e){var t;return n(e,"boolean")?this.collection.isEmpty()?(this.models.filter_query.set("offset",0),!0):e&&0===this.collection.head().get("offset")?!0:!e&&this.collection.last().get("offset")>=this.models.filter_result.get("total_results")-1?!0:(e?(t=this.collection.head().get("offset")-this.models.filter_query.get("limit"),t=Math.max(t,0)):t=this.collection.last().get("offset")+1,this.models.filter_query.set("offset",t),!0):!1},isJoinSeamless:function(e){var t,i;return e instanceof r?this.collection.isEmpty()||0===e.length?!0:(t=this.collection.first().get("offset"),i=this.collection.last().get("offset"),e.head().get("offset")<t&&e.last().get("offset")>=t-1||e.head().get("offset")<=i+1&&e.last().get("offset")>t):!1},onFilterQueryChanged:function(){this.last_visible_offset=null,0===this.$el.find(".spinner").length&&this.$el.append(c()),this.$el.find(".no-favs").remove(),this._willQueryProduceContinuousAppendOrPrepend()||this._removeItemViews()},onFilterResultChanged:function(){var e,t;return this.models.filter_result.get("new_result_set")&&this.collection.reset(),t=this.preprocessNewItems(this.models.filter_result.get("fonts")),this.isJoinSeamless(t)||this.collection.reset(),e=this.collection.isEmpty()?!1:this.collection.head().get("offset")>this.models.filter_result.get("offset"),this.collection.isEmpty()?(t.models&&this.collection.add(t.models),this.render()):(this.collection.add(t.models,{at:e?0:this.collection.length}),this.renderChunk(t,e)),!0},handleActiveFontChange:function(e){var t=this.models.filter_query.get("top_level_filter");return this.active_font_default_variation_id=null,n(e,"number")&&(this.active_font_default_variation_id=e),"favs"===t&&(this._removeItemViews(),i.defer(i.bind(function(){this.models.filter_query.trigger("change",this.models.filter_query)},this))),this.render(),!0},onFontIsFavouriteChange:function(e,t){this.trigger("change:is_favourite",e.get("id"),t)},_setActiveTab:function(e,t){this.active_tab=t,this.$el.attr("data-active-tab",t)},_removeExistingItems:function(e){var t=["top_level_filter","library","classification","search_query"];return i.intersection(i.keys(e),t).length>0},_onRequestStatusChange:function(e){"complete"===e?(this.$el.find(".spinner").remove(),this.collection.isEmpty()||0!==this.views.items.length||this.render()):"no_results"===e&&(this.$el.find(".spinner").remove(),this.$el.append(u()))},_willQueryProduceContinuousAppendOrPrepend:function(){var e,t,s,r,o,a=i.keys(this.models.filter_query.changed),l=this.collection.last(),c=this.collection.first(),u=!1,h=!1,d=this.models.filter_query.get("limit");return n(l,"object")&&n(c,"object")&&1===a.length&&i.contains(a,"offset")?(e=this.models.filter_query.get("offset"),t=i.every([e,l.get("offset"),c.get("offset"),d],function(e){return n(e,"number")}),t?(h=l.get("offset")+1===e,s=e+d>c.get("offset"),r=0,o=c.get("offset"),s&&(r=d-o),u=o-d+r===e,h||u):!1):!1},_removeItemViews:function(){return this.views.items.forEach(function(e){e.remove()}),this.views.items=[],!0}});return h}),define("hbs!ui/font-dialog/templates/shortcuts",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n    <li data-id="',(n=i.letter)?n=n.call(e,{hash:{}}):(n=e.letter,n=typeof n===c?n.apply(e):n),s+=u(n)+'" ',n=i["if"].call(e,e.active,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+=">",(n=i.letter)?n=n.call(e,{hash:{}}):(n=e.letter,n=typeof n===c?n.apply(e):n),s+=u(n)+"</li>\n"}function o(e,t){return'class="active"'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return a=i.each.call(t,t.alphabet,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n"});return t.registerPartial("ui_font-dialog_templates_shortcuts",i),i}),define("ui/font-dialog/views/shortcuts",["jquery","underscore","backbone","core/typecastError","core/utils/is","hbs!./../templates/shortcuts"],function(e,t,i,n,s,r){var o=i.View.extend({template:r,tagName:"ul",className:"shortcuts",minimum_results:100,events:{"click li.active":"onShortcutSelected"},initialize:function(e){this.model.on("change:alphabet",this.render,this),this.filter_query_model=e.filter_query_model,this.filter_query_model.on("change:top_level_filter",this._hide,this)},render:function(){return this.model.get("total_results")<this.minimum_results?(this.$el.html(""),!1):(this.$el.html(this.template({alphabet:this.model.getFullAlphabet()})),this.delegateEvents(),this)},onShortcutSelected:function(i){var n,s;return i instanceof e.Event?(i.preventDefault(),(n=e(i.target).data("id"))&&(s=t.findWhere(this.model.get("alphabet"),{letter:n}))?(this.trigger("shortcuts:goto",s.offset),!0):!1):!1},_hide:function(e,t){"favs"===t?this.$el.addClass("hidden"):this.$el.removeClass("hidden")}});return o}),define("ui/font-dialog/models/tab",["backbone"],function(e){"use strict";var t=e.Model.extend({defaults:{id:null,title:null,"class":null,active:!1}});return t}),define("ui/font-dialog/collections/tabs",["backbone","core/utils/is","../models/tab"],function(e,t,i){"use strict";var n=e.Collection.extend({
model:i,getActiveTab:function(){var e;return e=this.where({active:!0}),e.length?e[0]:!1},setActiveTab:function(e){var i=this.get(e);return this.forEach(function(e){e.set("active",!1)}),t(i,"object")&&i.set("active",!0),!0}});return n}),define("hbs!ui/font-dialog/templates/tabs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        <li class="',(n=i["class"])?n=n.call(e,{hash:{}}):(n=e["class"],n=typeof n===c?n.apply(e):n),s+=u(n),n=i["if"].call(e,e.active,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+='" data-id="',(n=i.short_name)?n=n.call(e,{hash:{}}):(n=e.short_name,n=typeof n===c?n.apply(e):n),s+=u(n)+'">\n            <a href="#">',(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===c?n.apply(e):n),s+=u(n)+"</a>\n        </li>\n    "}function o(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+="<ul>\n    ",a=i.each.call(t,t.tabs,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n</ul>\n"});return t.registerPartial("ui_font-dialog_templates_tabs",i),i}),define("ui/font-dialog/views/tabs",["jquery","underscore","core/utils/is","backbone","hbs!../templates/tabs"],function(e,t,i,n,s){"use strict";var r=n.View.extend({template:s,tagName:"div",className:"tabs cf",default_tab:"text",collection:null,events:{"click li":"onClick"},initialize:function(){return i(this.options.default_tab,"string")&&-1!==this.collection.pluck("id").indexOf(this.options.default_tab)&&(this.default_tab=this.options.default_tab||this.default_tab),this.collection.setActiveTab(this.default_tab),this},getActiveTab:function(){var e=this.collection.getActiveTab();return e?e.get("id"):!1},render:function(){var e=this.template({tabs:this.collection.toJSON()});return this.$el.html(e),this.delegateEvents(),!0},onClick:function(t){t.preventDefault();var i=e(t.currentTarget),n=i.data("id");this.collection.setActiveTab(n)},addAnimationClassToTab:function(e,n){var s;return i(e,"string")&&i(n,"string")?(s=this.$el.find("[data-id='"+e+"']"),s.addClass(n),void s.one("webkitAnimationEnd",t.bind(function(){s.removeClass(n)},this))):!1}});return r}),define("ui/font-dialog/views/library-filter",["jquery","backbone","core/utils/is","./../collections/tabs","./tabs"],function(e,t,i,n,s){"use strict";var r=s.extend({model:null,tabs:null,default_tab:null,collection:null,initialize:function(){this.collection=this.tabs,r.__super__.initialize.apply(this,arguments),this.tabs.on("change:active",this.onChangeActiveTab,this)},render:function(){return i(this.tabs.getActiveTab(),"object")&&this.model.get("top_level_filter")!==this.tabs.getActiveTab().get("id")&&this.setFilter(this.tabs.getActiveTab().get("id")),r.__super__.render.apply(this,arguments)},onChangeActiveTab:function(){return this.render(),!0},setFilter:function(e){return i(e,"string")?this.model.get("library")===e?!1:(this.model.setTopLevelFilter(e),!0):!1}});return r}),define("ui/font-dialog/views/main-category-filter",["jquery","underscore","backbone","core/utils/is","./../collections/tabs","./library-filter"],function(e,t,i,n,s,r){"use strict";var o=r.extend({className:"filter-groups tabs cf",default_tab:"all",initialize:function(){var e,i=this.options.filters;return e=t.map(i,function(e){return e.id=e.short_name,e}),this.tabs=new s(e),!t.isEmpty(i)&&i.length>0&&(this.default_tab=i[0].id),o.__super__.initialize.apply(this,arguments),o.__super__}});return o}),define("ui/font-dialog/models/multiselect-value",["backbone"],function(e){"use strict";return e.Model.extend({defaults:{id:null,title:null,"class":null,active:!1}})}),define("ui/font-dialog/collections/multiselect-values",["backbone","underscore","core/utils/is","../models/multiselect-value"],function(e,t,i,n){"use strict";var s=e.Collection.extend({model:n,font_filter_config:{classifications:{filter_properties:{id:"meta_data_id",title:"title","class":"css_title"}},providers:{filter_properties:{id:"short_name",title:"name","class":"short_name"}}},initialize:function(e,t){var n,s,r,o=this.font_filter_config[t.type];i(o,"object")&&(n=o.filter_properties.id,s=o.filter_properties.title,r=o.filter_properties["class"],e.forEach(function(e){var t=e[n],i=e[s],o=e[r];delete e[n],delete e[s],delete e[r],e.id=t,e.title=i,e["class"]=o}))},getActive:function(){return this.where({active:!0})},toggleActive:function(e){var t=this.get(e);return i(t,"object")&&t.set("active",!t.get("active")),!0},resetActive:function(){return this.forEach(function(e){e.set("active",!1)})},toQueryString:function(){var e=t.map(this.getActive(),function(e){return e.id});return e.join(",")}});return s}),define("hbs!ui/font-dialog/templates/multiselect",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n      <li class="',(n=i["class"])?n=n.call(e,{hash:{}}):(n=e["class"],n=typeof n===c?n.apply(e):n),s+=u(n),n=i["if"].call(e,e.active,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+='" data-id="',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===c?n.apply(e):n),s+=u(n)+'" data-tooltips-title="',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===c?n.apply(e):n),s+=u(n)+'">\n        <a href="#">',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===c?n.apply(e):n),s+=u(n)+"</a>\n      </li>\n      "}function o(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<div class="multiselect">\n\n  <div class="multiselect-closed">\n    <div class="multiselect-active-value">\n        ',(a=i.label)?a=a.call(t,{hash:{}}):(a=t.label,a=typeof a===c?a.apply(t):a),l+=u(a)+'\n    </div>\n  </div>\n\n  <div class="multiselect-opened">\n    <div class="multiselect-active-value">\n        ',(a=i.label)?a=a.call(t,{hash:{}}):(a=t.label,a=typeof a===c?a.apply(t):a),l+=u(a)+'\n    </div>\n\n    <ul class="multiselect-values">\n      <!-- List of available values -->\n      ',a=i.each.call(t,t.values,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+='\n      <li class="multiselect-filter multiselect-filter-any',a=i.unless.call(t,t.is_active,{hash:{},inverse:h.noop,fn:h.program(2,o,s)}),(a||0===a)&&(l+=a),l+='" data-id="any">\n        <a href="#">All</a>\n      </li>\n    </ul>\n  </div>\n\n</div>\n'});return t.registerPartial("ui_font-dialog_templates_multiselect",i),i}),define("ui/font-dialog/views/multiselect",["jquery","underscore","core/utils/is","backbone","./../collections/multiselect-values","hbs!../templates/multiselect"],function(e,t,i,n,s,r){"use strict";var o=n.View.extend({template:r,className:"filter-item",values:null,is_open:!1,events:{"click .multiselect-closed":"showValues","click .multiselect-opened .multiselect-active-value":"hideValues","click .multiselect-values li":"onValueClick"},initialize:function(e){this.view_name=e.view_name,this.label_template=e.label_template,this.model_attribute=e.model_attribute,this.$el.addClass(e.css_class),this.values=new s(e.filters,{type:e.view_name}),this.model.on("open",this.multiselectOpenedEvent,this),this.model.on("top_level_selected",this.topLevelSelected,this),this.model.on("request_state",this.requestStateChange,this)},render:function(){var e=this.template({label:this.label_template({has_values:!1}),values:this.values.toJSON(),is_active:this.values.getActive().length>0});return this.$el.html(e),this.updateActiveValues(),this.delegateEvents(),this},topLevelSelected:function(){this.values.resetActive(),this.$("li").removeClass("active"),this.updateActiveValues()},multiselectOpenedEvent:function(e){this.view_name!==e&&this.is_open&&this.hideValues()},showValues:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.toggle(),this.model.trigger("open",this.view_name)},hideValues:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.toggle()},toggle:function(){this.$(".multiselect-opened, .multiselect-closed").toggle(),this.is_open=!this.is_open},onValueClick:function(t){t.preventDefault();var n=e(t.currentTarget),s=n.data("id");n.hasClass("multiselect-filter-any")?(this.$("li").removeClass("active"),this.values.resetActive()):(i(s,"string")||i(s,"number"))&&(this.$(".multiselect-filter-any").removeClass("active"),this.values.toggleActive(s)),n.toggleClass("active"),this.updateActiveValues(),this.hideValues(),this.updateFilter(this.values)},updateFilter:function(e){this.model.set(this.model_attribute,e.toQueryString()),this.model.set("offset",0)},updateActiveValues:function(){var e,i=this.values.getActive(),n=i.length,s=n>0,r=n>1,o=this.$(".multiselect"),a=this.$(".multiselect-active-value"),l=s?i[0].toJSON():{};o.attr("class","multiselect"),e=this.label_template(t.extend({has_values:s,has_multiple_values:r,count:n},l)),r?o.addClass("multiple"):s&&o.addClass(i[0].get("class")),a.html(e)},requestStateChange:function(e,t){if("pending"===e&&i(t,"array")&&t.indexOf(this.model_attribute)<0)return this.removeLoadingClass(),!1;switch(e){case"pending":this.addLoadingClass();break;default:this.removeLoadingClass()}return!0},addLoadingClass:function(){return this.$el.addClass("loading"),!0},removeLoadingClass:function(){return this.$el.removeClass("loading"),!0}});return o}),define("hbs!ui/font-dialog/templates/classifications_labels",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+="\n    ",n=i["if"].call(e,e.has_multiple_values,{hash:{},inverse:d.program(4,a,t),fn:d.program(2,o,t)}),(n||0===n)&&(s+=n),s+="\n"}function o(e,t){var n,s="";return s+="\n        <span>",(n=i.count)?n=n.call(e,{hash:{}}):(n=e.count,n=typeof n===u?n.apply(e):n),s+=h(n)+"</span> styles\n    "}function a(e,t){var n,s="";return s+="\n        ",(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===u?n.apply(e):n),s+=h(n)+"\n    "}function l(e,t){return"\n    Choose a style\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="function",h=this.escapeExpression,d=this;return c=i["if"].call(t,t.has_values,{hash:{},inverse:d.program(6,l,s),fn:d.program(1,r,s)}),c||0===c?c:""});return t.registerPartial("ui_font-dialog_templates_classifications_labels",i),i}),define("hbs!ui/font-dialog/templates/providers_labels",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+="\n    ",n=i["if"].call(e,e.has_multiple_values,{hash:{},inverse:d.program(4,a,t),fn:d.program(2,o,t)}),(n||0===n)&&(s+=n),s+="\n"}function o(e,t){var n,s="";return s+="\n        <span>",(n=i.count)?n=n.call(e,{hash:{}}):(n=e.count,n=typeof n===u?n.apply(e):n),s+=h(n)+"</span> providers\n    "}function a(e,t){var n,s="";return s+="\n        ",(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===u?n.apply(e):n),s+=h(n)+"\n    "}function l(e,t){return"\n    Choose a provider\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="function",h=this.escapeExpression,d=this;return c=i["if"].call(t,t.has_values,{hash:{},inverse:d.program(6,l,s),fn:d.program(1,r,s)}),c||0===c?c:""});return t.registerPartial("ui_font-dialog_templates_providers_labels",i),i}),define("ui/font-dialog/views/filters-container",["jquery","underscore","core/utils/is","backbone","./multiselect","hbs!./../templates/classifications_labels","hbs!./../templates/providers_labels"],function(e,t,i,n,s,r,o){"use strict";var a=n.View.extend({className:"filter-container",views:null,font_filter_view_config:{classifications:{model_attribute:"classification",label_template:r,css_class:"style-filter",filter_properties:{id:"meta_data_id"}},providers:{model_attribute:"library",label_template:o,css_class:"provider-filter",filter_properties:{id:"short_name"}}},initialize:function(n){return this.views={},t.each(n.available_filters,function(t,n){var r=this._getConfigForFilter(t,n);return i(r,"object")?1===t.length?this.setFilterAsActive(r.model_attribute,t[0][r.filter_properties.id]):void(this.views[n]=new s(e.extend({view_name:n,filters:t,model:this.model},r))):!1},this),this.model.on("change:top_level_filter",this._hide,this),this},setFilterAsActive:function(e,t){return i(t,"undefined")||!i(t.toString,"function")?!1:(this.model.set(e,t.toString()),!0)},_getConfigForFilter:function(e,t){return i(e,"array")?e.length<1?!1:this.font_filter_view_config[t]:!1},render:function(){return t.each(this.views,function(e){this.$el.append(e.render().$el)},this),this},remove:function(){return t.each(this.views,function(e){e.remove()},this),a.__super__.remove.apply(this,arguments)},_hide:function(e,t){"favs"===t?this.$el.addClass("hidden"):this.$el.removeClass("hidden")}});return a}),define("ui/font-dialog/index",["jquery","backbone","underscore","core/utils/is","core/utils/str","core/components/extended_dialog/index","./models/filter","./models/filter-result","./views/filter","./views/font-list","./views/shortcuts","./views/main-category-filter","./views/filters-container"],function(e,t,i,n,s,r,o,a,l,c,u,h,d){var p=r.extend({namespace:"ui:font-dialog",className:"font-dialog",views:null,models:null,title_text:"Change to:",title_info:"Select from a range of fonts below or start typing to search our full range of fonts. Use the filter options to only show fonts by specific font-providers",available_filters:null,active_selector:null,expected_font_item:null,data_fonts_ready:!1,data_fonts_ready_deferred:null,last_search_filter_object:null,listeners:i.extend({},r.prototype.listeners,t.UIController.prototype.listeners,{"[remote]data:fonts:ready":"dataFontsReady","[remote]ui:font-loader:font-active":"onFontLoadSuccess","[remote]ui:font-loader:font-inactive":"onFontLoadFailure",toggle:"onToggle"}),initialize:function(){p.__super__.initialize.apply(this,arguments),this.views.title.setTitle(this.title_text),this.views.title.setInfo(this.title_info),this.models={},this.models.filter_query=new o,this.models.filter_result=new a,this.$el.append(e('<div class="font-preivews-block">')),this.data_fonts_ready_deferred=new e.Deferred},onToggle:function(){this.isRendered()||this.$el.find(".font-preivews-block").empty(),p.__super__.toggle.apply(this,arguments)},dataFontsReady:function(){this.imc.trigger("data:fonts:getAvailableFilters",function(e,t){return e?(this.imc.trigger("service:log:warn","ui:font-dialog ‚Äì error fetching available font filters"),!1):(this.available_filters=t,this.initializeChildViews(),this.models.filter_query.on("change",this.onFilterChanged,this),this.data_fonts_ready=!0,void this.data_fonts_ready_deferred.resolveWith(this))},this)},initializeChildViews:function(){var e=this.available_filters.top_level_filters;return n(e,"array")&&e.length&&(this.views.main_category_filter=new h({filters:e,model:this.models.filter_query}),this.views.filter=new l({model:this.models.filter_query,top_level_filters:e,filter_result:this.models.filter_result})),this.views.filters_container=new d({available_filters:this.available_filters,model:this.models.filter_query}),this.views.font_list=new c({filter_query:this.models.filter_query,filter_result:this.models.filter_result,$preview_el:this.$(".font-preivews-block"),is_preview:this.config.is_preview}),this.views.shortcuts=new u({model:this.models.filter_result,filter_query_model:this.models.filter_query}),!0},render:function(){var e=[];return this.data_fonts_ready?(this.views.main_category_filter&&e.push(this.views.main_category_filter),e=e.concat([this.views.filters_container,this.views.filter,this.views.shortcuts,this.views.font_list]),p.__super__.render.call(this,e),this.views.filter.focus(),this.listenTo(this.views.shortcuts,"shortcuts:goto",this.onShortcutSelected,this),this.listenTo(this.views.font_list,"font:selected",this.onFontSelected,this),this.listenTo(this.views.font_list,"change:is_favourite",this.onChangeIsFavourite,this),this.delegateEvents(),this):(this.imc.trigger("service:log:warn","ui:font-dialog:open - Cannot open as data:fonts:ready never happened."),!1)},onFontSelected:function(e,t){return n(this.expected_font_item,"object")&&this.expected_font_item.cancelLoading(),this.expected_font_item=t,this.imc.trigger(this.namespace+":font-selected",e),!0},onFontLoadSuccess:function(e){var t,i=[];return n(this.active_media_query,"object")&&n(this.expected_font_item,"object")&&n(e,"object")?this.expected_font_item.model.get("id")!==e.font_id?!1:(this.expected_font_item.loaded(),t={"font-family":[this._ensureFontNameIsSafe(e.css_font_family)]},this._checkValue(e.weight)?t["font-weight"]=[e.weight]:i.push("font-weight"),this._checkValue(e.style)?t["font-style"]=[e.style]:i.push("font-style"),this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_selector,t),i.length>0&&this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_selector,i),this.closeDialog(),!0):!1},_checkValue:function(e){return n(e,"string")&&e.length>0},onFontLoadFailure:function(e){return n(this.expected_font_item,"object")&&n(e,"object")?this.expected_font_item.model.get("id")!==String(e.font_id)?!1:(this.expected_font_item.loadingFailed(),!0):!1},onShortcutSelected:function(e){return this.views.font_list.goTo(e),!0},onFilterChanged:function(s){var r,o,a=this._isNewResultSet(),l=this.models.filter_query.toFilterObject(),c=new e.Deferred,u=new e.Deferred;return this.last_search_filter_object=l,r={},s instanceof t.Model&&(o=s.changedAttributes(),n(o,"object")&&(r=o)),this.models.filter_query.trigger("request_state","pending",r),"favs"===this.models.filter_query.get("top_level_filter")?(this.imc.trigger("data:fonts:getFavourites",function(e,t){var n;return e?(c.resolve(!1),this.log("error",e),!1):(n=i.pluck(t,"id"),void this._getDetailsForFontsWithIds(n,c))},this),this.imc.trigger("data:fonts:getRecentlyUsed",{page:1},function(e,t){var n;return e?(u.resolve(!1),this.log("error",e),!1):(n=i.pluck(t.data,"id"),void this._getDetailsForFontsWithIds(n,u))},this),e.when(c,u).done(i.bind(function(e,t){var i=[],s=[];return e||t?(n(e,"array")&&e.length>0&&(s.push({text:"Your favs",offset:0}),i=i.concat(e)),n(t,"array")&&t.length>0&&(s.push({text:"Recently used web fonts",offset:i.length}),i=i.concat(t)),0===i.length?(this.models.filter_query.trigger("request_state","no_results"),!0):(this.models.filter_result.set({headers:s,fonts:i,success:!0,new_result_set:!0,total_results:i.length,offset:0}),this.models.filter_query.trigger("request_state","complete"),void this.views.filter.focus())):(this.models.filter_result.set("success",!1),this.models.filter_query.trigger("request_state","error"),!1)},this))):this.imc.trigger("data:fonts:query",l,{},function(e,t,n){return e||!t.success?(this.models.filter_result.set("success",!1),this.models.filter_query.trigger("request_state","error"),!1):i.isEqual(this.last_search_filter_object,n)?(this.models.filter_result.set({success:!0,total_results:t.total_results,alphabet:t.alphabet,fonts:t.fonts,offset:n.offset,new_result_set:a}),this.models.filter_query.trigger("request_state","complete"),void this.views.filter.focus()):(this.models.filter_result.set("success",!1),this.models.filter_query.trigger("request_state","error"),!1)},this),!0},onChangeActiveElement:function(e,t){var s;return n(t,"element")&&this.imc.off("data:elements:updated:element:"+t.getElement().id,null,this),n(e,"element")&&n(this.active_media_query,"object")?(this.active_element=e,this.imc.on("data:elements:updated:element:"+e.getElement().id,function(e){this.onChangeActiveElement(e,this.active_element)},this),this.imc.off("data:styles:changed:"+this.active_selector,null,this),this.active_selector=e.getSelector(),this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_selector,s,function(e,t){return e?(this.log("error","`data:styles:getStyleDeclarationBySelector` was unable to get a style declaration",e),!1):(this._changeActiveFont(t),void this.imc.on("data:styles:changed:"+this.active_selector,function(e,t,n,s,r){return i.contains(r,"font-family")?void this._changeActiveFont(s):!1},this))},this),!0):(this.active_selector=null,this.closeDialog(!0),!1)},onChangeActiveStyle:function(e){return n(e,"string")&&!(e.length<1)||n(e,"number")?(this.active_style_id=e,!0):(this.active_style_id=null,!1)},onChangeIsFavourite:function(e,t){var i;return this.imc.trigger("data:fonts:toggleFavourite",e,t,function(n){var s=this.views.font_list.collection.get(e);return n?void s.set("is_favourite",s.previous("is_favourite")):(i=t?"Favourited a font":"Unfavourited a font",this.log("metric",i,{location:"font dialog",name:s.get("name_clean"),provider:s.get("provider"),unique_id:s.get("unique_id")}),void this.views.main_category_filter.addAnimationClassToTab("favs","favpulse animated"))},this),!0},destroy:function(){return this.remove(),p.__super__.destroy.apply(this,arguments),this.models.filter_result.off(),this.models.filter_query.off(),!0},_changeActiveFont:function(e){var t;return n(e,"object")?n(this.active_media_query,"media_query")&&n(this.active_element,"element")?(t={attributes:["font-family"],element_id:this.active_element.getElement().id},this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_selector,t,function(e,t){if(e)return this.log("error","A style declaration was not found for the selector",e),!1;var i,s;i=t.getValue("font-family"),s=i[0],this.imc.trigger("data:fonts:getByCssFontFamily",s,function(e,t){return e?(this.log("error","Couldn't get details for the font",e),!1):n(t.default_variation_id,"number")?n(this.views.font_list,"object")?void(this.data_fonts_ready?this.views.font_list.handleActiveFontChange(t.default_variation_id):this.data_fonts_ready_deferred.done(function(){this.views.font_list.handleActiveFontChange(t.default_variation_id)},this)):!1:(this.log("error","Couldn't get a valid ID for the font"),!1)},this)},this),!0):!1:(this.log("error","A valid style declaration response object was not passed in by 'data:styles:getStyleDeclarationBySelector'"),!1)},_isNewResultSet:function(){return i.any(["search_query","library","classification","top_level_filter"],function(e){return this.models.filter_query.hasChanged(e)},this)},_ensureFontNameIsSafe:function(e){return n(e,"string")?(-1!==e.indexOf(" ")&&(e=s.wrapQuotes(e)),e):!1},_getDetailsForFontsWithIds:function(e,t){var i;return n(e,"array")&&0!==e.length?(i={id:e},this.imc.trigger("data:fonts:query",i,{},function(i,n){return i?(this.log("error","Unable to get details for fonts with IDs",e),t.resolve(!1),!1):void t.resolve(n.fonts)},this),!0):(t.resolve([]),!1)}});return p}),function(e,t,i){function n(i,n,s){var r=t.createElement(i);return n&&(r.id=ee+n),s&&(r.style.cssText=s),e(r)}function s(){return i.innerHeight?i.innerHeight:e(i).height()}function r(e){var t=S.length,i=(H+e)%t;return 0>i?t+i:i}function o(e,t){return Math.round((/%/.test(e)?("x"===t?A.width():s())/100:1)*parseInt(e,10))}function a(e,t){return e.photo||e.photoRegex.test(t)}function l(e,t){return e.retinaUrl&&i.devicePixelRatio>1?t.replace(e.photoRegex,e.retinaSuffix):t}function c(e){"contains"in y[0]&&!y[0].contains(e.target)&&(e.stopPropagation(),y.focus())}function u(){var t,i=e.data(z,Z);null==i?(P=e.extend({},J),console&&console.log&&console.log("Error: cboxElement missing settings object")):P=e.extend({},i);for(t in P)e.isFunction(P[t])&&"on"!==t.slice(0,2)&&(P[t]=P[t].call(z));P.rel=P.rel||z.rel||e(z).data("rel")||"nofollow",P.href=P.href||e(z).attr("href"),P.title=P.title||z.title,"string"==typeof P.href&&(P.href=e.trim(P.href))}function h(i,n){e(t).trigger(i),le.trigger(i),e.isFunction(n)&&n.call(z)}function d(){var e,t,i,n,s,r=ee+"Slideshow_",o="click."+ee;P.slideshow&&S[1]?(t=function(){clearTimeout(e)},i=function(){(P.loop||S[H+1])&&(e=setTimeout(K.next,P.slideshowSpeed))},n=function(){B.html(P.slideshowStop).unbind(o).one(o,s),le.bind(se,i).bind(ne,t).bind(re,s),y.removeClass(r+"off").addClass(r+"on")},s=function(){t(),le.unbind(se,i).unbind(ne,t).unbind(re,s),B.html(P.slideshowStart).unbind(o).one(o,function(){K.next(),n()}),y.removeClass(r+"on").addClass(r+"off")},P.slideshowAuto?n():s()):y.removeClass(r+"off "+r+"on")}function p(i){Q||(z=i,u(),S=e(z),H=0,"nofollow"!==P.rel&&(S=e("."+te).filter(function(){var t,i=e.data(this,Z);return i&&(t=e(this).data("rel")||i.rel||this.rel),t===P.rel}),H=S.index(z),-1===H&&(S=S.add(z),H=S.length-1)),v.css({opacity:parseFloat(P.opacity),cursor:P.overlayClose?"pointer":"auto",visibility:"visible"}).show(),Y&&y.add(v).removeClass(Y),P.className&&y.add(v).addClass(P.className),Y=P.className,P.closeButton?L.html(P.close).appendTo(b):L.appendTo("<div/>"),W||(W=U=!0,y.css({visibility:"hidden",display:"block"}),k=n(ce,"LoadedContent","width:0; height:0; overflow:hidden").appendTo(b),R=w.height()+E.height()+b.outerHeight(!0)-b.height(),O=C.width()+x.width()+b.outerWidth(!0)-b.width(),N=k.outerHeight(!0),q=k.outerWidth(!0),P.w=o(P.initialWidth,"x"),P.h=o(P.initialHeight,"y"),K.position(),d(),h(ie,P.onOpen),I.add(T).hide(),y.focus(),P.trapFocus&&t.addEventListener&&(t.addEventListener("focus",c,!0),le.one(oe,function(){t.removeEventListener("focus",c,!0)})),P.returnFocus&&le.one(oe,function(){e(z).focus()})),m())}function f(){!y&&t.body&&(X=!1,A=e(i),y=n(ce).attr({id:Z,"class":e.support.opacity===!1?ee+"IE":"",role:"dialog",tabindex:"-1"}).hide(),v=n(ce,"Overlay").hide(),D=e([n(ce,"LoadingOverlay")[0],n(ce,"LoadingGraphic")[0]]),_=n(ce,"Wrapper"),b=n(ce,"Content").append(T=n(ce,"Title"),$=n(ce,"Current"),M=e('<button type="button"/>').attr({id:ee+"Previous"}),j=e('<button type="button"/>').attr({id:ee+"Next"}),B=n("button","Slideshow"),D),L=e('<button type="button"/>').attr({id:ee+"Close"}),_.append(n(ce).append(n(ce,"TopLeft"),w=n(ce,"TopCenter"),n(ce,"TopRight")),n(ce,!1,"clear:left").append(C=n(ce,"MiddleLeft"),b,x=n(ce,"MiddleRight")),n(ce,!1,"clear:left").append(n(ce,"BottomLeft"),E=n(ce,"BottomCenter"),n(ce,"BottomRight"))).find("div div").css({"float":"left"}),F=n(ce,!1,"position:absolute; width:9999px; visibility:hidden; display:none"),I=j.add(M).add($).add(B),e(t.body).append(v,y.append(_,F)))}function g(){function i(e){e.which>1||e.shiftKey||e.altKey||e.metaKey||e.ctrlKey||(e.preventDefault(),p(this))}return y?(X||(X=!0,j.click(function(){K.next()}),M.click(function(){K.prev()}),L.click(function(){K.close()}),v.click(function(){P.overlayClose&&K.close()}),e(t).bind("keydown."+ee,function(e){var t=e.keyCode;W&&P.escKey&&27===t&&(e.preventDefault(),K.close()),W&&P.arrowKey&&S[1]&&!e.altKey&&(37===t?(e.preventDefault(),M.click()):39===t&&(e.preventDefault(),j.click()))}),e.isFunction(e.fn.on)?e(t).on("click."+ee,"."+te,i):e("."+te).live("click."+ee,i)),!0):!1}function m(){var s,r,c,d=K.prep,p=++ue;U=!0,V=!1,z=S[H],u(),h(ae),h(ne,P.onLoad),P.h=P.height?o(P.height,"y")-N-R:P.innerHeight&&o(P.innerHeight,"y"),P.w=P.width?o(P.width,"x")-q-O:P.innerWidth&&o(P.innerWidth,"x"),P.mw=P.w,P.mh=P.h,P.maxWidth&&(P.mw=o(P.maxWidth,"x")-q-O,P.mw=P.w&&P.w<P.mw?P.w:P.mw),P.maxHeight&&(P.mh=o(P.maxHeight,"y")-N-R,P.mh=P.h&&P.h<P.mh?P.h:P.mh),s=P.href,G=setTimeout(function(){D.show()},100),P.inline?(c=n(ce).hide().insertBefore(e(s)[0]),le.one(ae,function(){c.replaceWith(k.children())}),d(e(s))):P.iframe?d(" "):P.html?d(P.html):a(P,s)?(s=l(P,s),V=t.createElement("img"),e(V).addClass(ee+"Photo").bind("error",function(){P.title=!1,d(n(ce,"Error").html(P.imgError))}).one("load",function(){var t;p===ue&&(V.alt=e(z).attr("alt")||e(z).attr("data-alt")||"",P.retinaImage&&i.devicePixelRatio>1&&(V.height=V.height/i.devicePixelRatio,V.width=V.width/i.devicePixelRatio),P.scalePhotos&&(r=function(){V.height-=V.height*t,V.width-=V.width*t},P.mw&&V.width>P.mw&&(t=(V.width-P.mw)/V.width,r()),P.mh&&V.height>P.mh&&(t=(V.height-P.mh)/V.height,r())),P.h&&(V.style.marginTop=Math.max(P.mh-V.height,0)/2+"px"),S[1]&&(P.loop||S[H+1])&&(V.style.cursor="pointer",V.onclick=function(){K.next()}),V.style.width=V.width+"px",V.style.height=V.height+"px",setTimeout(function(){d(V)},1))}),setTimeout(function(){V.src=s},1)):s&&F.load(s,P.data,function(t,i){p===ue&&d("error"===i?n(ce,"Error").html(P.xhrError):e(this).contents())})}var v,y,_,b,w,C,x,E,S,A,k,F,D,T,$,B,j,M,L,I,P,R,O,N,q,z,H,V,W,U,Q,G,K,Y,X,J={transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,inline:!1,html:!1,iframe:!1,fastIframe:!0,photo:!1,href:!1,title:!1,rel:!1,opacity:.9,preloading:!0,className:!1,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",open:!1,returnFocus:!0,trapFocus:!0,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp)((#|\?).*)?$/i,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0},Z="colorbox",ee="cbox",te=ee+"Element",ie=ee+"_open",ne=ee+"_load",se=ee+"_complete",re=ee+"_cleanup",oe=ee+"_closed",ae=ee+"_purge",le=e("<a/>"),ce="div",ue=0,he={};e.colorbox||(e(f),K=e.fn[Z]=e[Z]=function(t,i){var n=this;if(t=t||{},f(),g()){if(e.isFunction(n))n=e("<a/>"),t.open=!0;else if(!n[0])return n;i&&(t.onComplete=i),n.each(function(){e.data(this,Z,e.extend({},e.data(this,Z)||J,t))}).addClass(te),(e.isFunction(t.open)&&t.open.call(n)||t.open)&&p(n[0])}return n},K.position=function(t,i){function n(){w[0].style.width=E[0].style.width=b[0].style.width=parseInt(y[0].style.width,10)-O+"px",b[0].style.height=C[0].style.height=x[0].style.height=parseInt(y[0].style.height,10)-R+"px"}var r,a,l,c=0,u=0,h=y.offset();if(A.unbind("resize."+ee),y.css({top:-9e4,left:-9e4}),a=A.scrollTop(),l=A.scrollLeft(),P.fixed?(h.top-=a,h.left-=l,y.css({position:"fixed"})):(c=a,u=l,y.css({position:"absolute"})),u+=P.right!==!1?Math.max(A.width()-P.w-q-O-o(P.right,"x"),0):P.left!==!1?o(P.left,"x"):Math.round(Math.max(A.width()-P.w-q-O,0)/2),c+=P.bottom!==!1?Math.max(s()-P.h-N-R-o(P.bottom,"y"),0):P.top!==!1?o(P.top,"y"):Math.round(Math.max(s()-P.h-N-R,0)/2),y.css({top:h.top,left:h.left,visibility:"visible"}),_[0].style.width=_[0].style.height="9999px",r={width:P.w+q+O,height:P.h+N+R,top:c,left:u},t){var d=0;e.each(r,function(e){return r[e]!==he[e]?void(d=t):void 0}),t=d}he=r,t||y.css(r),y.dequeue().animate(r,{duration:t||0,complete:function(){n(),U=!1,_[0].style.width=P.w+q+O+"px",_[0].style.height=P.h+N+R+"px",P.reposition&&setTimeout(function(){A.bind("resize."+ee,K.position)},1),i&&i()},step:n})},K.resize=function(e){var t;W&&(e=e||{},e.width&&(P.w=o(e.width,"x")-q-O),e.innerWidth&&(P.w=o(e.innerWidth,"x")),k.css({width:P.w}),e.height&&(P.h=o(e.height,"y")-N-R),e.innerHeight&&(P.h=o(e.innerHeight,"y")),e.innerHeight||e.height||(t=k.scrollTop(),k.css({height:"auto"}),P.h=k.height()),k.css({height:P.h}),t&&k.scrollTop(t),K.position("none"===P.transition?0:P.speed))},K.prep=function(i){function s(){return P.w=P.w||k.width(),P.w=P.mw&&P.mw<P.w?P.mw:P.w,P.w}function o(){return P.h=P.h||k.height(),P.h=P.mh&&P.mh<P.h?P.mh:P.h,P.h}if(W){var c,u="none"===P.transition?0:P.speed;k.empty().remove(),k=n(ce,"LoadedContent").append(i),k.hide().appendTo(F.show()).css({width:s(),overflow:P.scrolling?"auto":"hidden"}).css({height:o()}).prependTo(b),F.hide(),e(V).css({"float":"none"}),c=function(){function i(){e.support.opacity===!1&&y[0].style.removeAttribute("filter")}var s,o,c=S.length,d="frameBorder",p="allowTransparency";W&&(o=function(){clearTimeout(G),D.hide(),h(se,P.onComplete)},T.html(P.title).add(k).show(),c>1?("string"==typeof P.current&&$.html(P.current.replace("{current}",H+1).replace("{total}",c)).show(),j[P.loop||c-1>H?"show":"hide"]().html(P.next),
M[P.loop||H?"show":"hide"]().html(P.previous),P.slideshow&&B.show(),P.preloading&&e.each([r(-1),r(1)],function(){var i,n,s=S[this],r=e.data(s,Z);r&&r.href?(i=r.href,e.isFunction(i)&&(i=i.call(s))):i=e(s).attr("href"),i&&a(r,i)&&(i=l(r,i),n=t.createElement("img"),n.src=i)})):I.hide(),P.iframe?(s=n("iframe")[0],d in s&&(s[d]=0),p in s&&(s[p]="true"),P.scrolling||(s.scrolling="no"),e(s).attr({src:P.href,name:(new Date).getTime(),"class":ee+"Iframe",allowFullScreen:!0,webkitAllowFullScreen:!0,mozallowfullscreen:!0}).one("load",o).appendTo(k),le.one(ae,function(){s.src="//about:blank"}),P.fastIframe&&e(s).trigger("load")):o(),"fade"===P.transition?y.fadeTo(u,1,i):i())},"fade"===P.transition?y.fadeTo(u,0,function(){K.position(0,c)}):K.position(u,c)}},K.next=function(){!U&&S[1]&&(P.loop||S[H+1])&&(H=r(1),p(S[H]))},K.prev=function(){!U&&S[1]&&(P.loop||H)&&(H=r(-1),p(S[H]))},K.close=function(){W&&!Q&&(Q=!0,W=!1,h(re,P.onCleanup),A.unbind("."+ee),v.fadeTo(P.fadeOut||0,0),y.stop().fadeTo(P.fadeOut||0,0,function(){y.add(v).css({opacity:1,cursor:"auto"}).hide(),h(ae),k.empty().remove(),setTimeout(function(){Q=!1,h(oe,P.onClosed)},1)}))},K.remove=function(){y&&(y.stop(),e.colorbox.close(),y.stop().remove(),v.remove(),Q=!1,y=null,e("."+te).removeData(Z).removeClass(te),e(t).unbind("click."+ee))},K.element=function(){return e(z)},K.settings=J)}(jQuery,document,window),define("colorbox",["jquery"],function(){}),define("core/utils/colorbox",["jquery","core/utils/is","core/typecastError","colorbox"],function(e,t,i){return{open:function(n){if(!t(n,"object"))throw new i(101,"Expected options to be an object, got: "+n);return e(document).on("cbox_open",function(){var t=e("body");t.css({overflow:"hidden"})}).on("cbox_closed",function(){var t=e("body");t.css({overflow:"auto"})}),e.colorbox(n),!0},close:function(){return e.colorbox.close(),e(document).off("cbox_open").off("cbox_closed"),!0}}}),define("ui/previous-versions/index",["backbone","core/utils/is","Handlebars","core/utils/colorbox"],function(e,t,i,n){"use strict";var s=e.UIController.extend({namespace:"ui:previous-versions",tagName:"div",id:"previous-versions",className:"previous-versions",project_id:null,version_number:null,url_template:null,listeners:{show:"show","[remote]data:project:ready":"onReadyProject"},initialize:function(){return this.url_template=i.compile("http://{{ domain }}/project/previous_versions/{{ project_id }}{{#if version_number}}/{{ version_number }}{{/if}}"),this},onReadyProject:function(){this.imc.trigger("data:project:getProject",this.onGetProject,this)},onGetProject:function(e,i){var n;return this.project_id=null,e?(this.log("error","Unable to get project",e),!1):t(i,"object")?(n=Number(i.id),isNaN(n)?(this.log("error","Project id should be a number"),!1):(this.project_id=n,!0)):(this.log("error","Project should be an object"),!1)},getIframeUrl:function(){return t(this.project_id,"number")?this.url_template({domain:window.location.host,project_id:this.project_id,version_number:this.version_number}):!1},show:function(e){return t(this.project_id,"number")?(this.version_number=null,t(e,"string")&&e>0&&(this.version_number=e),this.render(),!0):!1},render:function(){return n.open({width:"80%",height:"80%",iframe:!0,href:this.getIframeUrl()}),this},remove:function(){return n.close(),e.UIController.prototype.remove.apply(this,arguments),!0}});return s}),define("ui/element-resizer/models/element",["backbone","core/utils/is"],function(e,t){return e.Model.extend({initialize:function(e){t(e,"object")&&t(e.config,"object")&&(this.containing_elements=e.config.supported_elements.containers)},defaults:function(){return{element:null,style_declaration:null}},getID:function(){var e=this.get("element");return t(e,"object")&&t(e.id,"string")&&e.id.length?e.id:null},isImageElement:function(){var e=this.get("element");return t(e,"object")?!t(e.tag_name,"string")||e.tag_name.length<1?!1:"img"===e.tag_name.toLowerCase():!1},isContainingElement:function(){var e=this.get("element");return t(e,"object")&&t(this.containing_elements,"array")?!t(e.tag_name,"string")||e.tag_name.length<1?!1:-1!==this.containing_elements.indexOf(e.tag_name.toLowerCase()):!1},isInlineElement:function(){var e=this.get("style_declaration");return t(e,"object")&&t(e.getValue,"function")&&t(e.getValue("display"),"array")&&"inline"===e.getValue("display")[0]?!0:!1}})}),define("ui/element-resizer/views/generic_handle_view",["jquery","underscore","backbone","core/utils/is","core/utils/unit","core/utils/dom","core/utils/cast"],function(e,t,i,n,s,r,o){return i.View.extend({attributes:{"data-tooltips-margin":"0","data-tooltips-title":"Adjust dimension","data-tooltips-side":"left"},events:{mousedown:"startDrag"},className:"resize-handle",$_namespace:".resize-handle",property:"property",min_dimension_size:10,unit:null,setUnit:function(e){return!n(e,"string")||e.length<1?!1:(this.unit=e,!0)},render:function(){return this.setSizeAndPosition(),this.$el.html(this.template()),this.delegateEvents(),this},template:function(){return"<div><span></span></div>"},startDrag:function(i){var s;return n(i,"object")?(i.preventDefault(),this.$el.addClass("dragging"),this.$el.trigger("mouseleave"),t.each(this.attributes,t.bind(function(e,t){this.$el.removeAttr(t)},this)),s=this._getOffset(i),this._monitorMouseMovements(s),e(document).one("mouseup"+this.$_namespace,e.proxy(this,"stopDrag")),!0):!1},stopDrag:function(){return this.$el.removeClass("dragging"),t.each(this.attributes,t.bind(function(e,t){this.$el.attr(t,e)},this)),this._unmonitorMouseMovements(),this.trigger("view:stop-drag"),!0},mouseMoved:function(e,t){var i;return e=o(e,"number"),n(e,"number")&&n(t,"object")?(i=this._getMouseMovement(t),n(i,"number")?(i-=e,this._triggerChangeSize(i),this._moveDragHandle(i),!0):!1):!1},setSizeAndPosition:function(){return!0},_moveDragHandle:function(){return!0},_getOffset:function(){return 0},_getNewPropertyValue:function(){return 0},_getMouseMovement:function(){return 0},_triggerChangeSize:function(e){var t,i,s;return n(e,"number")?(t=this._getElementPosition(),n(t,"object")?(i=this._getNewPropertyValue(e,t),i=Math.max(i,0),s=this._convertToUnit(i),this.trigger("change:"+this.property,s),s):!1):!1},_convertToUnit:function(e){var t=s.convert({element_id:this.model.getID(),media_query_id:this.model.get("style_declaration").getMediaQueryId(),unit_to:this.unit,property:this.property,value:e+"px"});return n(t,"null")&&(t="0"),t+this.unit},_getElementPosition:function(){var e,t,i=this.model.getID(),s=this.model.get("style_declaration"),o=n(s,"object")?s.getMediaQueryId():null;return n(i,"string")&&n(o,"string")?(e=r.getElement(o,i),!n(e,"object")||e.length<1?!1:(t=e.offset(),{x_position:t.left,y_position:t.top,width:e.outerWidth(),height:e.outerHeight(),padding:{top:e.css("padding-top"),right:e.css("padding-right"),bottom:e.css("padding-bottom"),left:e.css("padding-left")},border:{top:e.css("border-top-width"),right:e.css("border-right-width"),bottom:e.css("border-bottom-width"),left:e.css("border-left-width")}})):!1},_monitorMouseMovements:function(t){return t=o(t,"number"),n(t,"number")?(e(document).on("mousemove"+this.$_namespace,e.proxy(this,"mouseMoved",t)),!0):!1},_unmonitorMouseMovements:function(){return e(document).off("mousemove"+this.$_namespace),!0}})}),define("ui/element-resizer/views/width_handle_view",["jquery","underscore","./generic_handle_view","core/utils/is","core/utils/cast"],function(e,t,i,n,s){return i.extend({attributes:{"data-tooltips-margin":"0","data-tooltips-title":"Adjust width","data-tooltips-side":"right"},className:"resize-handle resize-handle-width",$_namespace:".resize-handle-width",property:"width",setSizeAndPosition:function(){var e=this._getElementPosition();return e?(this.$el.css({height:s(e.height,"number"),top:s(e.y_position,"number"),left:s(e.x_position+e.width,"number")}),!0):!1},_getOffset:function(t){return t.offsetX||t.layerX||t.clientX-e(t.target).offset().left},_getNewPropertyValue:function(e,t){var i=s(t.padding.right,"number"),n=s(t.padding.left,"number"),r=s(t.border.right,"number"),o=s(t.border.left,"number");return e-i-n-r-o-t.x_position},_getMouseMovement:function(e){return s(e.pageX,"number")},_moveDragHandle:function(e){var t,i,r,o;return e=s(e,"number"),n(e,"number")?(t=this._getElementPosition(),n(t,"object")?(i=e-t.x_position,r=e,o=t.y_position,i<=this.min_dimension_size&&(r=t.x_position+this.min_dimension_size),this.$el.css({left:r,top:o}),!0):!1):!1}})}),define("ui/element-resizer/views/height_handle_view",["jquery","./generic_handle_view","core/utils/is","core/utils/cast"],function(e,t,i,n){return t.extend({attributes:{"data-tooltips-margin":"0","data-tooltips-title":"Adjust height","data-tooltips-side":"bottom"},className:"resize-handle resize-handle-height",$_namespace:".resize-handle-height",property:"height",setSizeAndPosition:function(){var e=this._getElementPosition();return e?(this.$el.css({width:n(e.width,"number"),top:n(e.y_position+e.height,"number"),left:n(e.x_position,"number")+3}),!0):!1},_getOffset:function(t){return t.offsetY||t.layerY||t.clientY-e(t.target).offset().top},_getNewPropertyValue:function(e,t){var i=n(t.padding.top,"number"),s=n(t.padding.bottom,"number"),r=n(t.border.top,"number"),o=n(t.border.bottom,"number");return e-i-s-r-o-t.y_position},_getMouseMovement:function(e){return n(e.pageY,"number")},_moveDragHandle:function(e){var t,s,r;return e=n(e,"number"),i(e,"number")?(t=this._getElementPosition(),i(t,"object")?(s=e-t.y_position,r=e,s<=this.min_dimension_size&&(r=this.min_dimension_size),this.$el.css({top:r}),!0):!1):!1}})}),define("hbs!ui/element-resizer/templates/image_handle",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="north">\n    <span class="left" data-resize-handle="nw"></span>\n    <span class="center" data-resize-handle="n"></span>\n    <span class="right" data-resize-handle="ne"></span>\n</div>\n<div class="south">\n    <span class="left" data-resize-handle="sw"></span>\n    <span class="center" data-resize-handle="s"></span>\n    <span class="right" data-resize-handle="se"></span>\n</div>\n<div class="west">\n    <span class="center" data-resize-handle="w"></span>\n</div>\n<div class="east">\n    <span class="center" data-resize-handle="e"></span>\n</div>\n'});return t.registerPartial("ui_element-resizer_templates_image_handle",i),i}),define("ui/element-resizer/views/image_handle",["jquery","underscore","backbone","core/utils/is","core/utils/unit","core/utils/dom","hbs!../templates/image_handle"],function(e,t,i,n,s,r,o){var a=i.View.extend({template:o,className:"image-resize-handle",events:{"mouseenter span":"onMouseEnter","mouseleave span":"onMouseLeave","mousedown span":"startDrag"},$_namespace:".image-resize-handle",resize_timeout_id:null,unit:null,page_x:null,page_y:null,resize_handle:null,setUnit:function(e){return!n(e,"string")||e.length<1?!1:(this.unit=e,!0)},setPositionAndSize:function(){var e=this._getElementPosition();return n(e,"object")?(this.$el.css({width:e.outer_width,top:e.y_position,left:e.x_position}),this.$(".south").css({top:e.outer_height}),this.$(".west, .east").css({height:e.outer_height}),clearTimeout(this.resize_timeout_id),this.resize_timeout_id=setTimeout(t.bind(this.setPositionAndSize,this),500),!0):!1},removeActiveClass:function(){return this.$(".active").removeClass("active"),!0},addActiveClass:function(){return!n(this.resize_handle,"string")||this.resize_handle.length<1?!1:(["north","east","south","west"].forEach(function(e){var i=this.resize_handle.split("");t.contains(i,e.charAt(0))&&this.$("."+e).addClass("active")},this),!0)},render:function(){return this.$el.html(this.template()),this.setPositionAndSize(),this.delegateEvents(),this},remove:function(){return clearTimeout(this.resize_timeout_id),i.View.prototype.remove.apply(this,arguments)},onMouseEnter:function(e){return this.$el.hasClass("dragging")?!1:n(this.resize_handle,"string")?!1:(this.setResizeHandleByEvent(e),this.addActiveClass(),!0)},onMouseLeave:function(){return this.$el.hasClass("dragging")?!1:(this.resize_handle=null,this.removeActiveClass(),!0)},setResizeHandleByEvent:function(t){var i;return n(t,"object")?(i=e(t.currentTarget).attr("data-resize-handle"),!n(i,"string")||i.length<1?!1:(this.resize_handle=i,!0)):!1},startDrag:function(t){return n(t,"object")?(t.preventDefault(),this.setResizeHandleByEvent(t),!n(this.resize_handle,"string")||this.resize_handle.length<1?!1:(this.page_x=t.pageX,this.page_y=t.pageY,this.$el.addClass("dragging"),this._monitorMouseMovements(),e(document).one("mouseup"+this.$_namespace,e.proxy(this,"stopDrag")),!0)):!1},stopDrag:function(){return this.$el.removeClass("dragging"),this._unmonitorMouseMovements(),!0},mouseMoved:function(e){var t,i;return n(e,"object")?(t=e.pageX-this.page_x,i=e.pageY-this.page_y,this.page_x=e.pageX,this.page_y=e.pageY,this._triggerChangeSize(t,i),!0):!1},_triggerChangeSize:function(e,t){var i,s,r,o,a;if(!n(e,"number")||isNaN(e))return!1;if(!n(t,"number")||isNaN(t))return!1;if(!n(this.resize_handle,"string")||this.resize_handle.length<1)return!1;if(i=this._getElementPosition(),!n(i,"object"))return!1;switch(this.resize_handle){case"nw":s=i.width-e;break;case"n":r=i.height+t;break;case"ne":s=i.width+e;break;case"w":s=i.width-e;break;case"e":s=i.width+e;break;case"sw":s=i.width-e;break;case"s":r=i.height+t;break;case"se":s=i.width+e}return s&&(o=this._convertToUnit(s,"width"),this.trigger("change:width",o)),r&&(a=this._convertToUnit(r,"height"),this.trigger("change:height",a)),!0},_convertToUnit:function(e,i){var n;return-1===["width","height"].indexOf(i)?!1:(n=s.convert({element_id:this.model.getID(),media_query_id:this.model.get("style_declaration").getMediaQueryId(),unit_to:this.unit,property:i,value:e+"px"}),t.isNull(n)&&(n="0"),n+this.unit)},_getElementPosition:function(){var e,t,i=this.model.getID(),s=this.model.get("style_declaration"),o=n(s,"object")?s.getMediaQueryId():null;return n(i,"string")&&n(o,"string")?(e=r.getElement(o,i),!n(e,"object")||e.length<1?!1:(t=e.offset(),{x_position:t.left,y_position:t.top,width:e.width(),height:e.height(),outer_width:e.outerWidth(),outer_height:e.outerHeight()})):!1},_monitorMouseMovements:function(){return e(document).on("mousemove"+this.$_namespace,e.proxy(this,"mouseMoved")),!0},_unmonitorMouseMovements:function(){return this.page_x=null,this.page_y=null,this.resize_handle=null,e(document).off("mousemove"+this.$_namespace),!0}});return a}),define("ui/element-resizer/index",["jquery","backbone","underscore","core/utils/is","core/utils/unit","./models/element","./views/width_handle_view","./views/height_handle_view","./views/image_handle"],function(e,t,i,n,s,r,o,a,l){"use strict";return t.UIController.extend({namespace:"ui:element-resizer",views:null,listeners:i.extend({},t.UIController.prototype.listeners,{"[remote]data:styles:changed":"updateWhenRequired","[remote]ui:element-overlay:dragStart":"remove","[remote]ui:element-overlay:dragEnd":"render"}),watched_attributes:null,initialize:function(){return this.views={},this.watched_attributes=["margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","width","height","line-height","font-size","border-left","border-left-width","border-right","border-right-width","border","border-width"],this.model=new r({config:this.config}),this.views.drag_width_handle_view=new o({model:this.model}),this.views.drag_width_handle_view.on("change:width",i.partial(this.changeDimension,"width"),this),this.views.drag_height_handle_view=new a({model:this.model}),this.views.drag_height_handle_view.on("change:height",i.partial(this.changeDimension,"height"),this),this.views.image_drag_handle_view=new l({model:this.model}),this.views.image_drag_handle_view.on("change:width",i.partial(this.changeDimension,"width"),this),this.views.drag_width_handle_view.on("view:stop-drag",this.render,this),this.views.drag_height_handle_view.on("view:stop-drag",this.render,this),this.imc.on("data:elements:updated:element",i.throttle(i.bind(this.render,this),500)),this.imc.trigger(this.namespace+":ready"),this},onChangeActiveElement:function(e){return this.remove(),this.model.set({element:null}),n(e,"element")?"body"===e.getSelector()?!1:(this.model.set({element:e.getElement()}),this._getStyleDeclaration(e.getSelector()),!0):!1},render:function(){var t,i,n;return this.remove(),this.model.isImageElement()?(n=this.views.image_drag_handle_view.render(),e(this.app_el).append(n.$el),!0):(t=this.views.drag_width_handle_view.render(),e(this.app_el).append(t.$el),this.model.isContainingElement()&&(i=this.views.drag_height_handle_view.render(),e(this.app_el).append(i.$el)),!0)},changeDimension:function(e,t){return n(e,"string")&&n(t,"string")?n(this.active_style_id,"number")?(this.imc.trigger("data:elements:getElementById",this.model.getID(),function(i,n){return i?(this.log("error","Element resizer :: Could not fetch element by ID "+i.getMessage()),!1):void this._setElementDimension(e,n,t)},this),!0):(this.log("error","Element resizer :: No valid active-style_id: "+this.active_style_id),!1):!1},updateWhenRequired:function(e,t,s,r,o){return n(e,"number")&&n(t,"string")?e!==this.active_style_id?!1:n(o,"array")?!n(s,"string")||s.length<1?!1:i.intersection(o,this.watched_attributes).length<1?!1:(this._getStyleDeclaration(s),!0):!1:!1},remove:function(){this.views.drag_width_handle_view.remove(),this.views.drag_height_handle_view.remove(),this.views.image_drag_handle_view.remove()},_setElementDimension:function(e,t,i){var s={};return s[e]=[i],n(this.active_media_query,"media_query")?void this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,t.getSelector(),s,null,function(e){return e?(this.log("error","Element resizer :: Error setting attributes for style declaration for selector: "+t.getSelector()),!1):!0},this):!1},_getStyleDeclaration:function(e){return!n(e,"string")||e.length<1?!1:n(this.active_media_query,"media_query")?(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,e,{element_id:this.model.getID(),attributes:["width","height","display"]},this._onGetStyleDeclarationBySelector,this),!0):!1},_onGetStyleDeclarationBySelector:function(e,t){var i,r,o,a,l,c;return e||!n(t,"style_declaration")?(this.log("error","Failed to get style declaration",e,t),!1):(this.model.set({style_declaration:t}),this.model.isInlineElement()&&!this.model.isImageElement()?(this.remove(),!1):(i=t.getValue("width"),a=t.getValue("height"),!n(i,"array")||i.length<1||!n(a,"array")||a.length<1?!1:(r=i[0],l=a[0],!n(r,"string")||r.length<1||!n(l,"string")||l.length<1?!1:(o=s.getValueAndUnit(r),c=s.getValueAndUnit(l),n(o,"object")&&n(c,"object")?(this.views.drag_width_handle_view.setUnit(o.unit),this.views.drag_height_handle_view.setUnit(c.unit),this.views.image_drag_handle_view.setUnit(o.unit),this.render(),!0):!1))))}})}),define("ui/css-editor/models/attribute",["backbone"],function(e){"use strict";var t=e.Model.extend({defaults:{key:"",value:""},toJSON:function(){var e={};return e[this.get("key")]=[this.get("value")],e}});return t}),define("ui/css-editor/collections/attributes",["backbone","../models/attribute"],function(e,t){"use strict";var i=e.Collection.extend({model:t,setAttributes:function(e){for(var i=0;i<e.length;i++){var n=e[i];this.add(new t({key:n,value:e[n]}),{merge:!0})}},findByKey:function(e){return this.find(function(t){return t.get("key")===e})},updateAttributes:function(e){for(var i=0;i<e.length;i++){var n=e[i],s=this.findByKey(n);s?s.set("value",e[n]):this.add(new t({key:n,value:e[n]}),{merge:!0})}},compareWith:function(e){var t={newOrUpdated:[],deleted:[]};return e.each(function(e){var i=this.findByKey(e.get("key"));i?i.get("value")!==e.get("value")&&t.newOrUpdated.push(e):t.newOrUpdated.push(e)},this),this.each(function(i){var n=e.findByKey(i.get("key"));n||t.deleted.push(i)},this),t},toAttributesObject:function(){var e={};return this.each(function(t){e[t.get("key")]=[t.get("value")]},this),e},toCSS:function(e){for(var t="",i="",n=0;e>n;n++)i+=" ";return this.each(function(e){t+=i+e.get("key")+": "+e.get("value")+";\n"}),t}});return i}),define("ui/css-editor/models/style-declaration",["backbone","../collections/attributes"],function(e,t){"use strict";var i=e.Model.extend({defaults:{style_id:"",selector:""},initialize:function(){this.style_attributes=new t},updateAttributes:function(e){this.style_attributes.updateAttributes(e)},setAttributes:function(e){this.style_attributes.setAttributes(e)},findAttribute:function(e){return this.style_attributes.find(function(t){return t.get("key")===e})},toJSON:function(){return{style_id:this.get("style_id"),selector:this.get("selector"),attributes:this.style_attributes.toAttributesObject()}},cloneWithStyleAttributes:function(e){var t=this.clone();return t.style_attributes=e,t}});return i}),define("ui/css-editor/collections/style-declarations",["backbone","underscore","core/utils/is","../models/style-declaration","../models/attribute"],function(e,t,i,n,s){"use strict";var r=e.Collection.extend({model:n,fromParsedCss:function(e){return t.each(e.cssRules,function(e){i(e,"object")&&i(e.selectorText,"string")&&t.each(e.selectorText.split(","),function(t){var i=t.trim(),s=this.findBySelector(i);if(s)s.updateAttributes(e.style);else{var r=new n({selector:i});r.setAttributes(e.style),this.add(r)}},this)},this),this},fromStyleDeclarations:function(e){var r,o;return t.each(e,function(e){r=new n({style_id:e.style_declaration.style_id,selector:e.style_declaration.selector}),o=t.map(e.style_declaration.attributes,function(e,t){var n=i(e[0],"array")?this._flattenArrayToCommaSeparatedString(e[0]):e[0];return new s({key:t,value:n})},this),r.style_attributes.add(o),this.add(r)},this),this},findBySelector:function(e){return this.find(function(t){return t.get("selector")===e})},updateWith:function(e,n){var s,r=!1,o=n.delete_missing;return e.each(function(e,n){var s,o=this.findBySelector(e.get("selector"));return i(o,"undefined")?(r=!0,void this.add(e,{at:n})):(s=o.style_attributes.compareWith(e.style_attributes),void(t.isEmpty(s.newOrUpdated)&&t.isEmpty(s.deleted)||(r=!0,o.style_attributes=e.style_attributes)))},this),o?(s=[],this.each(function(t){var n=t.get("selector"),o=e.findBySelector(n);i(o,"undefined")&&(r=!0,s.push(t))},this),this.remove(s),r):r},deleteSelector:function(e){var t=this.findBySelector(e);return i(t,"undefined")?!1:(this.remove(t),!0)},toCSS:function(e){var t="";return this.each(function(i){t+=i.get("selector")+" {\n"+i.style_attributes.toCSS(e)+"}\n\n"}),t},_flattenArrayToCommaSeparatedString:function(e){var i=t.reduce(e,function(e,t){return e+","+t},"");return 0===i.length?"":i.substr(1)}});return r}),define("ace/lib/regexp",["require","exports","module"],function(e,t,i){"use strict";function n(e){return(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":"")}function s(e,t,i){if(Array.prototype.indexOf)return e.indexOf(t,i);for(var n=i||0;n<e.length;n++)if(e[n]===t)return n;return-1}var r={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},o=void 0===r.exec.call(/()??/,"")[1],a=function(){var e=/^/g;return r.test.call(e,""),!e.lastIndex}();a&&o||(RegExp.prototype.exec=function(e){var t,i,l=r.exec.apply(this,arguments);if("string"==typeof e&&l){if(!o&&l.length>1&&s(l,"")>-1&&(i=RegExp(this.source,r.replace.call(n(this),"g","")),r.replace.call(e.slice(l.index),i,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(l[e]=void 0)})),this._xregexp&&this._xregexp.captureNames)for(var c=1;c<l.length;c++)t=this._xregexp.captureNames[c-1],t&&(l[t]=l[c]);!a&&this.global&&!l[0].length&&this.lastIndex>l.index&&this.lastIndex--}return l},a||(RegExp.prototype.test=function(e){var t=r.exec.call(this,e);return t&&this.global&&!t[0].length&&this.lastIndex>t.index&&this.lastIndex--,!!t}))}),define("ace/lib/es5-shim",["require","exports","module"],function(e,t,i){function n(){}function s(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(t){}}function r(e){return e=+e,e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError("Function.prototype.bind called on incompatible "+t);var i=f.call(arguments,1),s=function(){if(this instanceof s){var n=t.apply(this,i.concat(f.call(arguments)));return Object(n)===n?n:this}return t.apply(e,i.concat(f.call(arguments)))};return t.prototype&&(n.prototype=t.prototype,s.prototype=new n,n.prototype=null),s});var o,a,l,c,u,h=Function.prototype.call,d=Array.prototype,p=Object.prototype,f=d.slice,g=h.bind(p.toString),m=h.bind(p.hasOwnProperty);if((u=m(p,"__defineGetter__"))&&(o=h.bind(p.__defineGetter__),a=h.bind(p.__defineSetter__),l=h.bind(p.__lookupGetter__),c=h.bind(p.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function e(e){var t=new Array(e+2);return t[0]=t[1]=0,t}var t,i=[];return i.splice.apply(i,e(20)),i.splice.apply(i,e(26)),t=i.length,i.splice(5,0,"XXX"),t+1==i.length,t+1==i.length?!0:void 0}()){var v=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?v.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(f.call(arguments,2))):[]}}else Array.prototype.splice=function(e,t){var i=this.length;e>0?e>i&&(e=i):void 0==e?e=0:0>e&&(e=Math.max(i+e,0)),i>e+t||(t=i-e);var n=this.slice(e,e+t),s=f.call(arguments,2),r=s.length;if(e===i)r&&this.push.apply(this,s);else{var o=Math.min(t,i-e),a=e+o,l=a+r-o,c=i-a,u=i-o;if(a>l)for(var h=0;c>h;++h)this[l+h]=this[a+h];else if(l>a)for(h=c;h--;)this[l+h]=this[a+h];if(r&&e===u)this.length=u,this.push.apply(this,s);else for(this.length=u+r,h=0;r>h;++h)this[e+h]=s[h]}return n};Array.isArray||(Array.isArray=function(e){return"[object Array]"==g(e)});var y=Object("a"),_="a"!=y[0]||!(0 in y);if(Array.prototype.forEach||(Array.prototype.forEach=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=arguments[1],s=-1,r=i.length>>>0;if("[object Function]"!=g(e))throw new TypeError;for(;++s<r;)s in i&&e.call(n,i[s],s,t)}),Array.prototype.map||(Array.prototype.map=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=i.length>>>0,s=Array(n),r=arguments[1];if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");for(var o=0;n>o;o++)o in i&&(s[o]=e.call(r,i[o],o,t));return s}),Array.prototype.filter||(Array.prototype.filter=function(e){var t,i=I(this),n=_&&"[object String]"==g(this)?this.split(""):i,s=n.length>>>0,r=[],o=arguments[1];if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");for(var a=0;s>a;a++)a in n&&(t=n[a],e.call(o,t,a,i)&&r.push(t));return r}),Array.prototype.every||(Array.prototype.every=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=i.length>>>0,s=arguments[1];if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");for(var r=0;n>r;r++)if(r in i&&!e.call(s,i[r],r,t))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=i.length>>>0,s=arguments[1];if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");for(var r=0;n>r;r++)if(r in i&&e.call(s,i[r],r,t))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var s,r=0;if(arguments.length>=2)s=arguments[1];else for(;;){if(r in i){s=i[r++];break}if(++r>=n)throw new TypeError("reduce of empty array with no initial value")}for(;n>r;r++)r in i&&(s=e.call(void 0,s,i[r],r,t));return s}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=I(this),i=_&&"[object String]"==g(this)?this.split(""):t,n=i.length>>>0;if("[object Function]"!=g(e))throw new TypeError(e+" is not a function");if(!n&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var s,r=n-1;if(arguments.length>=2)s=arguments[1];else for(;;){if(r in i){s=i[r--];break}if(--r<0)throw new TypeError("reduceRight of empty array with no initial value")}do r in this&&(s=e.call(void 0,s,i[r],r,t));while(r--);return s}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var t=_&&"[object String]"==g(this)?this.split(""):I(this),i=t.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=r(arguments[1])),n=n>=0?n:Math.max(0,i+n);i>n;n++)if(n in t&&t[n]===e)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var t=_&&"[object String]"==g(this)?this.split(""):I(this),i=t.length>>>0;if(!i)return-1;var n=i-1;for(arguments.length>1&&(n=Math.min(n,r(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in t&&e===t[n])return n;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:p)}),!Object.getOwnPropertyDescriptor){var b="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(b+e);if(m(e,t)){var i,n,s;if(i={enumerable:!0,configurable:!0},u){var r=e.__proto__;e.__proto__=p;var n=l(e,t),s=c(e,t);if(e.__proto__=r,n||s)return n&&(i.get=n),s&&(i.set=s),i}return i.value=e[t],i}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),!Object.create){var w;w=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var e={};for(var t in e)e[t]=null;return e.constructor=e.hasOwnProperty=e.propertyIsEnumerable=e.isPrototypeOf=e.toLocaleString=e.toString=e.valueOf=e.__proto__=null,e},Object.create=function(e,t){var i;if(null===e)i=w();else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var n=function(){};n.prototype=e,i=new n,i.__proto__=e}return void 0!==t&&Object.defineProperties(i,t),i}}if(Object.defineProperty){var C=s({}),x="undefined"==typeof document||s(document.createElement("div"));if(!C||!x)var E=Object.defineProperty}if(!Object.defineProperty||E){var S="Property description must be an object: ",A="Object.defineProperty called on non-object: ",k="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(e,t,i){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError(A+e);if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError(S+i);if(E)try{return E.call(Object,e,t,i)}catch(n){}if(m(i,"value"))if(u&&(l(e,t)||c(e,t))){var s=e.__proto__;e.__proto__=p,delete e[t],e[t]=i.value,e.__proto__=s}else e[t]=i.value;else{if(!u)throw new TypeError(k);m(i,"get")&&o(e,t,i.get),m(i,"set")&&a(e,t,i.set)}return e}}Object.defineProperties||(Object.defineProperties=function(e,t){for(var i in t)m(t,i)&&Object.defineProperty(e,i,t[i]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(F){Object.freeze=function(e){return function(t){return"function"==typeof t?t:e(t)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)===e)throw new TypeError;for(var t="";m(e,t);)t+="?";e[t]=!0;var i=m(e,t);return delete e[t],i}),!Object.keys){var D=!0,T=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$=T.length;
for(var B in{toString:null})D=!1;Object.keys=function P(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var P=[];for(var t in e)m(e,t)&&P.push(t);if(D)for(var i=0,n=$;n>i;i++){var s=T[i];m(e,s)&&P.push(s)}return P}}Date.now||(Date.now=function(){return(new Date).getTime()});var j="	\n\x0B\f\r ¬†·öÄ·†é‚ÄÄ‚ÄÅ‚ÄÇ‚ÄÉ‚ÄÑ‚ÄÖ‚ÄÜ‚Äá‚Äà‚Äâ‚Ää‚ÄØ‚Åü„ÄÄ\u2028\u2029\ufeff";if(!String.prototype.trim||j.trim()){j="["+j+"]";var M=new RegExp("^"+j+j+"*"),L=new RegExp(j+j+"*$");String.prototype.trim=function(){return String(this).replace(M,"").replace(L,"")}}var I=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}),define("ace/lib/fixoldbrowsers",["require","exports","module","./regexp","./es5-shim"],function(e,t,i){"use strict";e("./regexp"),e("./es5-shim")}),define("ace/lib/dom",["require","exports","module"],function(e,t,i){"use strict";if("undefined"!=typeof document){var n="http://www.w3.org/1999/xhtml";t.getDocumentHead=function(e){return e||(e=document),e.head||e.getElementsByTagName("head")[0]||e.documentElement},t.createElement=function(e,t){return document.createElementNS?document.createElementNS(t||n,e):document.createElement(e)},t.hasCssClass=function(e,t){var i=e.className.split(/\s+/g);return-1!==i.indexOf(t)},t.addCssClass=function(e,i){t.hasCssClass(e,i)||(e.className+=" "+i)},t.removeCssClass=function(e,t){for(var i=e.className.split(/\s+/g);;){var n=i.indexOf(t);if(-1==n)break;i.splice(n,1)}e.className=i.join(" ")},t.toggleCssClass=function(e,t){for(var i=e.className.split(/\s+/g),n=!0;;){var s=i.indexOf(t);if(-1==s)break;n=!1,i.splice(s,1)}return n&&i.push(t),e.className=i.join(" "),n},t.setCssClass=function(e,i,n){n?t.addCssClass(e,i):t.removeCssClass(e,i)},t.hasCssString=function(e,t){var i,n=0;if(t=t||document,t.createStyleSheet&&(i=t.styleSheets)){for(;n<i.length;)if(i[n++].owningElement.id===e)return!0}else if(i=t.getElementsByTagName("style"))for(;n<i.length;)if(i[n++].id===e)return!0;return!1},t.importCssString=function(e,i,s){if(s=s||document,i&&t.hasCssString(i,s))return null;var r;s.createStyleSheet?(r=s.createStyleSheet(),r.cssText=e,i&&(r.owningElement.id=i)):(r=s.createElementNS?s.createElementNS(n,"style"):s.createElement("style"),r.appendChild(s.createTextNode(e)),i&&(r.id=i),t.getDocumentHead(s).appendChild(r))},t.importCssStylsheet=function(e,i){if(i.createStyleSheet)i.createStyleSheet(e);else{var n=t.createElement("link");n.rel="stylesheet",n.href=e,t.getDocumentHead(i).appendChild(n)}},t.getInnerWidth=function(e){return parseInt(t.computedStyle(e,"paddingLeft"),10)+parseInt(t.computedStyle(e,"paddingRight"),10)+e.clientWidth},t.getInnerHeight=function(e){return parseInt(t.computedStyle(e,"paddingTop"),10)+parseInt(t.computedStyle(e,"paddingBottom"),10)+e.clientHeight},void 0!==window.pageYOffset?(t.getPageScrollTop=function(){return window.pageYOffset},t.getPageScrollLeft=function(){return window.pageXOffset}):(t.getPageScrollTop=function(){return document.body.scrollTop},t.getPageScrollLeft=function(){return document.body.scrollLeft}),window.getComputedStyle?t.computedStyle=function(e,t){return t?(window.getComputedStyle(e,"")||{})[t]||"":window.getComputedStyle(e,"")||{}}:t.computedStyle=function(e,t){return t?e.currentStyle[t]:e.currentStyle},t.scrollbarWidth=function(e){var i=t.createElement("ace_inner");i.style.width="100%",i.style.minWidth="0px",i.style.height="200px",i.style.display="block";var n=t.createElement("ace_outer"),s=n.style;s.position="absolute",s.left="-10000px",s.overflow="hidden",s.width="200px",s.minWidth="0px",s.height="150px",s.display="block",n.appendChild(i);var r=e.documentElement;r.appendChild(n);var o=i.offsetWidth;s.overflow="scroll";var a=i.offsetWidth;return o==a&&(a=n.clientWidth),r.removeChild(n),o-a},t.setInnerHtml=function(e,t){var i=e.cloneNode(!1);return i.innerHTML=t,e.parentNode.replaceChild(i,e),i},"textContent"in document.documentElement?(t.setInnerText=function(e,t){e.textContent=t},t.getInnerText=function(e){return e.textContent}):(t.setInnerText=function(e,t){e.innerText=t},t.getInnerText=function(e){return e.innerText}),t.getParentWindow=function(e){return e.defaultView||e.parentWindow}}}),define("ace/lib/oop",["require","exports","module"],function(e,t,i){"use strict";t.inherits=function(){var e=function(){};return function(t,i){e.prototype=i.prototype,t.super_=i.prototype,t.prototype=new e,t.prototype.constructor=t}}(),t.mixin=function(e,t){for(var i in t)e[i]=t[i];return e},t.implement=function(e,i){t.mixin(e,i)}}),define("ace/lib/keys",["require","exports","module","./oop"],function(e,t,i){"use strict";var n=e("./oop"),s=function(){var e={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}};for(var t in e.FUNCTION_KEYS){var i=e.FUNCTION_KEYS[t].toLowerCase();e[i]=parseInt(t,10)}return n.mixin(e,e.MODIFIER_KEYS),n.mixin(e,e.PRINTABLE_KEYS),n.mixin(e,e.FUNCTION_KEYS),e.enter=e["return"],e.escape=e.esc,e.del=e["delete"],e[173]="-",e}();n.mixin(t,s),t.keyCodeToString=function(e){return(s[e]||String.fromCharCode(e)).toLowerCase()}}),define("ace/lib/useragent",["require","exports","module"],function(e,t,i){"use strict";if(t.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},t.getOS=function(){return t.isMac?t.OS.MAC:t.isLinux?t.OS.LINUX:t.OS.WINDOWS},"object"==typeof navigator){var n=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),s=navigator.userAgent;t.isWin="win"==n,t.isMac="mac"==n,t.isLinux="linux"==n,t.isIE=("Microsoft Internet Explorer"==navigator.appName||navigator.appName.indexOf("MSAppHost")>=0)&&parseFloat(navigator.userAgent.match(/MSIE ([0-9]+[\.0-9]+)/)[1]),t.isOldIE=t.isIE&&t.isIE<9,t.isGecko=t.isMozilla=window.controllers&&"Gecko"===window.navigator.product,t.isOldGecko=t.isGecko&&parseInt((navigator.userAgent.match(/rv\:(\d+)/)||[])[1],10)<4,t.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),t.isWebKit=parseFloat(s.split("WebKit/")[1])||void 0,t.isChrome=parseFloat(s.split(" Chrome/")[1])||void 0,t.isAIR=s.indexOf("AdobeAIR")>=0,t.isIPad=s.indexOf("iPad")>=0,t.isTouchPad=s.indexOf("TouchPad")>=0}}),define("ace/lib/event",["require","exports","module","./keys","./useragent","./dom"],function(e,t,i){"use strict";function n(e,t,i){var n=0;if(n=!r.isOpera||"KeyboardEvent"in window||!r.isMac?0|(t.ctrlKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.metaKey?8:0):0|(t.metaKey?1:0)|(t.altKey?2:0)|(t.shiftKey?4:0)|(t.ctrlKey?8:0),i in s.MODIFIER_KEYS){switch(s.MODIFIER_KEYS[i]){case"Alt":n=2;break;case"Shift":n=4;break;case"Ctrl":n=1;break;default:n=8}i=0}return(!r.isMac&&o[91]||o[92])&&(n|=8),8&n&&(91==i||93==i)&&(i=0),n||i in s.FUNCTION_KEYS||i in s.PRINTABLE_KEYS?e(t,n,i):!1}var s=e("./keys"),r=e("./useragent");e("./dom");t.addListener=function(e,t,i){if(e.addEventListener)return e.addEventListener(t,i,!1);if(e.attachEvent){var n=function(){i(window.event)};i._wrapper=n,e.attachEvent("on"+t,n)}},t.removeListener=function(e,t,i){return e.removeEventListener?e.removeEventListener(t,i,!1):void(e.detachEvent&&e.detachEvent("on"+t,i._wrapper||i))},t.stopEvent=function(e){return t.stopPropagation(e),t.preventDefault(e),!1},t.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},t.getButton=function(e){return"dblclick"==e.type?0:"contextmenu"==e.type||e.ctrlKey&&r.isMac?2:e.preventDefault?e.button:{1:0,2:2,4:1}[e.button]},document.documentElement.setCapture?t.capture=function(e,i,n){function s(o){i(o),r||(r=!0,n(o)),t.removeListener(e,"mousemove",i),t.removeListener(e,"mouseup",s),t.removeListener(e,"losecapture",s),e.releaseCapture()}var r=!1;t.addListener(e,"mousemove",i),t.addListener(e,"mouseup",s),t.addListener(e,"losecapture",s),e.setCapture()}:t.capture=function(e,t,i){function n(e){t&&t(e),i&&i(e),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",n,!0),e.stopPropagation()}document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",n,!0)},t.addMouseWheelListener=function(e,i){var n=8,s=function(e){void 0!==e.wheelDelta?void 0!==e.wheelDeltaX?(e.wheelX=-e.wheelDeltaX/n,e.wheelY=-e.wheelDeltaY/n):(e.wheelX=0,e.wheelY=-e.wheelDelta/n):e.axis&&e.axis==e.HORIZONTAL_AXIS?(e.wheelX=5*(e.detail||0),e.wheelY=0):(e.wheelX=0,e.wheelY=5*(e.detail||0)),i(e)};t.addListener(e,"DOMMouseScroll",s),t.addListener(e,"mousewheel",s)},t.addMultiMouseDownListener=function(e,i,n,s){var o,a,l,c=0,u={2:"dblclick",3:"tripleclick",4:"quadclick"};t.addListener(e,"mousedown",function(e){if(0!=t.getButton(e))c=0;else{var r=Math.abs(e.clientX-o)>5||Math.abs(e.clientY-a)>5;(!l||r)&&(c=0),c+=1,l&&clearTimeout(l),l=setTimeout(function(){l=null},i[c-1]||600)}if(1==c&&(o=e.clientX,a=e.clientY),n[s]("mousedown",e),c>4)c=0;else if(c>1)return n[s](u[c],e)}),r.isOldIE&&t.addListener(e,"dblclick",function(e){c=2,l&&clearTimeout(l),l=setTimeout(function(){l=null},i[c-1]||600),n[s]("mousedown",e),n[s](u[c],e)})};var o=Object.create(null);if(t.addCommandKeyListener=function(e,i){var s=t.addListener;if(r.isOldGecko||r.isOpera&&!("KeyboardEvent"in window)){var a=null;s(e,"keydown",function(e){a=e.keyCode}),s(e,"keypress",function(e){return n(i,e,a)})}else{var l=null;s(e,"keydown",function(e){o[e.keyCode]=!0;var t=n(i,e,e.keyCode);return l=e.defaultPrevented,t}),s(e,"keypress",function(e){l&&(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)&&(t.stopEvent(e),l=null)}),s(e,"keyup",function(e){o[e.keyCode]=null}),s(e,"focus",function(e){o=Object.create(null)})}},window.postMessage&&!r.isOldIE){var a=1;t.nextTick=function(e,i){i=i||window;var n="zero-timeout-message-"+a;t.addListener(i,"message",function s(r){r.data==n&&(t.stopPropagation(r),t.removeListener(i,"message",s),e())}),i.postMessage(n,"*")}}t.nextFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,t.nextFrame?t.nextFrame=t.nextFrame.bind(window):t.nextFrame=function(e){setTimeout(e,17)}}),define("ace/lib/lang",["require","exports","module"],function(e,t,i){"use strict";t.stringReverse=function(e){return e.split("").reverse().join("")},t.stringRepeat=function(e,t){for(var i="";t>0;)1&t&&(i+=e),(t>>=1)&&(e+=e);return i};var n=/^\s\s*/,s=/\s\s*$/;t.stringTrimLeft=function(e){return e.replace(n,"")},t.stringTrimRight=function(e){return e.replace(s,"")},t.copyObject=function(e){var t={};for(var i in e)t[i]=e[i];return t},t.copyArray=function(e){for(var t=[],i=0,n=e.length;n>i;i++)e[i]&&"object"==typeof e[i]?t[i]=this.copyObject(e[i]):t[i]=e[i];return t},t.deepCopy=function(e){if("object"!=typeof e)return e;var t=e.constructor();for(var i in e)"object"==typeof e[i]?t[i]=this.deepCopy(e[i]):t[i]=e[i];return t},t.arrayToMap=function(e){for(var t={},i=0;i<e.length;i++)t[e[i]]=1;return t},t.createMap=function(e){var t=Object.create(null);for(var i in e)t[i]=e[i];return t},t.arrayRemove=function(e,t){for(var i=0;i<=e.length;i++)t===e[i]&&e.splice(i,1)},t.escapeRegExp=function(e){return e.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},t.escapeHTML=function(e){return e.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},t.getMatchOffsets=function(e,t){var i=[];return e.replace(t,function(e){i.push({offset:arguments[arguments.length-2],length:e.length})}),i},t.deferredCall=function(e){var t=null,i=function(){t=null,e()},n=function(e){return n.cancel(),t=setTimeout(i,e||0),n};return n.schedule=n,n.call=function(){return this.cancel(),e(),n},n.cancel=function(){return clearTimeout(t),t=null,n},n},t.delayedCall=function(e,t){var i=null,n=function(){i=null,e()},s=function(e){i&&clearTimeout(i),i=setTimeout(n,e||t)};return s.delay=s,s.schedule=function(e){null==i&&(i=setTimeout(n,e||0))},s.call=function(){this.cancel(),e()},s.cancel=function(){i&&clearTimeout(i),i=null},s.isPending=function(){return i},s}}),define("ace/keyboard/textinput",["require","exports","module","../lib/event","../lib/useragent","../lib/dom","../lib/lang"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),r=e("../lib/dom"),o=e("../lib/lang"),a=s.isChrome<18,l=function(e,t){function i(e){if(!g){if(F)t=0,i=e?0:u.value.length-1;else var t=e?2:1,i=2;try{u.setSelectionRange(t,i)}catch(n){}}}function l(){g||(u.value=h,s.isWebKit&&w.schedule())}function c(){setTimeout(function(){m&&(u.style.cssText=m,m=""),null==t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=!0,t.renderer.$moveTextAreaToCursor())},0)}var u=r.createElement("textarea");u.className="ace_text-input",s.isTouchPad&&u.setAttribute("x-palm-disable-auto-cap",!0),u.wrap="off",u.autocorrect="off",u.autocapitalize="off",u.spellcheck=!1,u.style.bottom="2000em",e.insertBefore(u,e.firstChild);var h="",d=!1,p=!1,f=!1,g=!1,m="",v=!0;try{var y=document.activeElement===u}catch(_){}n.addListener(u,"blur",function(){t.onBlur(),y=!1}),n.addListener(u,"focus",function(){y=!0,t.onFocus(),i()}),this.focus=function(){u.focus()},this.blur=function(){u.blur()},this.isFocused=function(){return y};var b=o.delayedCall(function(){y&&i(v)}),w=o.delayedCall(function(){g||(u.value=h,y&&i())});s.isWebKit||t.addEventListener("changeSelection",function(){t.selection.isEmpty()!=v&&(v=!v,b.schedule())}),l(),y&&t.onFocus();var C=function(e){return 0===e.selectionStart&&e.selectionEnd===e.value.length};if(!u.setSelectionRange&&u.createTextRange&&(u.setSelectionRange=function(e,t){var i=this.createTextRange();i.collapse(!0),i.moveStart("character",e),i.moveEnd("character",t),i.select()},C=function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return t&&t.parentElement()==e?t.text==e.value:!1}),s.isOldIE){var x=!1,E=function(e){if(!x){var t=u.value;if(!g&&t&&t!=h){if(e&&t==h[0])return S.schedule();T(t),x=!0,l(),x=!1}}},S=o.delayedCall(E);n.addListener(u,"propertychange",E);var A={13:1,27:1};n.addListener(u,"keyup",function(e){!g||u.value&&!A[e.keyCode]||setTimeout(P,0),(u.value.charCodeAt(0)||0)<129||(g?I():L())})}var k=function(e){d?d=!1:p?p=!1:C(u)?(t.selectAll(),i()):F&&i(t.selection.isEmpty())},F=null;this.setInputHandler=function(e){F=e},this.getInputHandler=function(){return F};var D=!1,T=function(e){F&&(e=F(e),F=null),f?(i(),e&&t.onPaste(e),f=!1):e==h[0]?D&&t.execCommand("del",{source:"ace"}):(e.substring(0,2)==h?e=e.substr(2):e[0]==h[0]?e=e.substr(1):e[e.length-1]==h[0]&&(e=e.slice(0,-1)),e[e.length-1]==h[0]&&(e=e.slice(0,-1)),e&&t.onTextInput(e)),D&&(D=!1)},$=function(e){if(!g){var t=u.value;T(t),l()}},B=function(e){var s=t.getCopyText();if(!s)return void n.preventDefault(e);var r=e.clipboardData||window.clipboardData;if(r&&!a){var o=r.setData("Text",s);o&&(t.onCut(),n.preventDefault(e))}o||(d=!0,u.value=s,u.select(),setTimeout(function(){d=!1,l(),i(),t.onCut()}))},j=function(e){var s=t.getCopyText();if(!s)return void n.preventDefault(e);var r=e.clipboardData||window.clipboardData;if(r&&!a){var o=r.setData("Text",s);o&&(t.onCopy(),n.preventDefault(e))}o||(p=!0,u.value=s,u.select(),setTimeout(function(){p=!1,l(),i(),t.onCopy()}))},M=function(e){var r=e.clipboardData||window.clipboardData;if(r){var o=r.getData("Text");o&&t.onPaste(o),s.isIE&&setTimeout(i),n.preventDefault(e)}else u.value="",f=!0};n.addCommandKeyListener(u,t.onCommandKey.bind(t)),n.addListener(u,"select",k),n.addListener(u,"input",$),n.addListener(u,"cut",B),n.addListener(u,"copy",j),n.addListener(u,"paste",M),"oncut"in u&&"oncopy"in u&&"onpaste"in u||n.addListener(e,"keydown",function(e){if((!s.isMac||e.metaKey)&&e.ctrlKey)switch(e.keyCode){case 67:j(e);break;case 86:M(e);break;case 88:B(e)}});var L=function(e){g||(g={},t.onCompositionStart(),setTimeout(I,0),t.on("mousedown",P),t.selection.isEmpty()||(t.insert(""),t.session.markUndoGroup(),t.selection.clearSelection()),t.session.markUndoGroup())},I=function(){if(g&&(t.onCompositionUpdate(u.value),g.lastValue&&t.undo(),g.lastValue=u.value.replace(/\x01/g,""),g.lastValue)){var e=t.selection.getRange();t.insert(g.lastValue),t.session.markUndoGroup(),g.range=t.selection.getRange(),t.selection.setRange(e),t.selection.clearSelection()}},P=function(e){var i=g;g=!1;var n=setTimeout(function(){var e=u.value.replace(/\x01/g,"");g||(e==i.lastValue?l():!i.lastValue&&e&&(l(),T(e)))});F=function(e){return clearTimeout(n),e=e.replace(/\x01/g,""),e==i.lastValue?"":(i.lastValue&&t.undo(),e)},t.onCompositionEnd(),t.removeListener("mousedown",P),"compositionend"==e.type&&i.range&&t.selection.setRange(i.range)},R=o.delayedCall(I,50);n.addListener(u,"compositionstart",L),n.addListener(u,s.isGecko?"text":"keyup",function(){R.schedule()}),n.addListener(u,"compositionend",P),this.getElement=function(){return u},this.setReadOnly=function(e){u.readOnly=e},this.onContextMenu=function(e){D=!0,m||(m=u.style.cssText),u.style.cssText="z-index:100000;"+(s.isIE?"opacity:0.1;":""),i(t.selection.isEmpty()),t._emit("nativecontextmenu",{target:t});var o=t.container.getBoundingClientRect(),a=r.computedStyle(t.container),l=o.top+(parseInt(a.borderTopWidth)||0),h=o.left+(parseInt(o.borderLeftWidth)||0),d=o.bottom-l-u.clientHeight,p=function(e){u.style.left=e.clientX-h-2+"px",u.style.top=Math.min(e.clientY-l-2,d)+"px"};p(e),"mousedown"==e.type&&(t.renderer.$keepTextAreaAtCursor&&(t.renderer.$keepTextAreaAtCursor=null),s.isWin&&n.capture(t.container,p,c))},this.onContextMenuClose=c,s.isGecko||n.addListener(u,"contextmenu",function(e){t.textInput.onContextMenu(e),c()})};t.TextInput=l}),define("ace/mouse/default_handlers",["require","exports","module","../lib/dom","../lib/useragent"],function(e,t,i){"use strict";function n(e){e.$clickSelection=null;var t=e.editor;t.setDefaultHandler("mousedown",this.onMouseDown.bind(e)),t.setDefaultHandler("dblclick",this.onDoubleClick.bind(e)),t.setDefaultHandler("tripleclick",this.onTripleClick.bind(e)),t.setDefaultHandler("quadclick",this.onQuadClick.bind(e)),t.setDefaultHandler("mousewheel",this.onMouseWheel.bind(e));var i=["select","startSelect","drag","dragEnd","dragWait","dragWaitEnd","startDrag","focusWait"];i.forEach(function(t){e[t]=this[t]},this),e.selectByLines=this.extendSelectionBy.bind(e,"getLineRange"),e.selectByWords=this.extendSelectionBy.bind(e,"getWordRange")}function s(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}function r(e,t){if(e.start.row==e.end.row)var i=2*t.column-e.start.column-e.end.column;else if(e.start.row!=e.end.row-1||e.start.column||e.end.column)var i=2*t.row-e.start.row-e.end.row;else var i=t.column-4;return 0>i?{cursor:e.start,anchor:e.end}:{cursor:e.end,anchor:e.start}}var o=e("../lib/dom"),a=(e("../lib/useragent"),0);(function(){this.onMouseDown=function(e){var t=e.inSelection(),i=e.getDocumentPosition();this.mousedownEvent=e;var n=this.editor,s=e.getButton();if(0!==s){var r=n.getSelectionRange(),o=r.isEmpty();return o&&(n.moveCursorToPosition(i),n.selection.clearSelection()),void n.textInput.onContextMenu(e.domEvent)}return!t||n.isFocused()||(n.focus(),!this.$focusTimout||this.$clickSelection||n.inMultiSelectMode)?(!t||this.$clickSelection||e.getShiftKey()||n.inMultiSelectMode?this.startSelect(i):t&&(this.mousedownEvent.time=(new Date).getTime(),this.setState("dragWait")),this.captureMouse(e),e.preventDefault()):(this.setState("focusWait"),this.captureMouse(e),e.preventDefault())},this.startSelect=function(e){e=e||this.editor.renderer.screenToTextCoordinates(this.x,this.y),this.mousedownEvent.getShiftKey()?this.editor.selection.selectToPosition(e):this.$clickSelection||(this.editor.moveCursorToPosition(e),this.editor.selection.clearSelection()),this.setState("select")},this.select=function(){var e,t=this.editor,i=t.renderer.screenToTextCoordinates(this.x,this.y);if(this.$clickSelection){var n=this.$clickSelection.comparePoint(i);if(-1==n)e=this.$clickSelection.end;else if(1==n)e=this.$clickSelection.start;else{var s=r(this.$clickSelection,i);i=s.cursor,e=s.anchor}t.selection.setSelectionAnchor(e.row,e.column)}t.selection.selectToPosition(i),t.renderer.scrollCursorIntoView()},this.extendSelectionBy=function(e){var t,i=this.editor,n=i.renderer.screenToTextCoordinates(this.x,this.y),s=i.selection[e](n.row,n.column);if(this.$clickSelection){var o=this.$clickSelection.comparePoint(s.start),a=this.$clickSelection.comparePoint(s.end);if(-1==o&&0>=a)t=this.$clickSelection.end,(s.end.row!=n.row||s.end.column!=n.column)&&(n=s.start);else if(1==a&&o>=0)t=this.$clickSelection.start,(s.start.row!=n.row||s.start.column!=n.column)&&(n=s.end);else if(-1==o&&1==a)n=s.end,t=s.start;else{var l=r(this.$clickSelection,n);n=l.cursor,t=l.anchor}i.selection.setSelectionAnchor(t.row,t.column)}i.selection.selectToPosition(n),i.renderer.scrollCursorIntoView()},this.startDrag=function(){var e=this.editor;this.setState("drag"),this.dragRange=e.getSelectionRange();var t=e.getSelectionStyle();this.dragSelectionMarker=e.session.addMarker(this.dragRange,"ace_selection",t),e.clearSelection(),o.addCssClass(e.container,"ace_dragging"),this.$dragKeybinding||(this.$dragKeybinding={handleKeyboard:function(e,t,i,n){return"esc"==i?{command:this.command}:void 0},command:{exec:function(e){var t=e.$mouseHandler;t.dragCursor=null,t.dragEnd(),t.startSelect()}}}),e.keyBinding.addKeyboardHandler(this.$dragKeybinding)},this.focusWait=function(){var e=s(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y),t=(new Date).getTime();(e>a||t-this.mousedownEvent.time>this.$focusTimout)&&this.startSelect(this.mousedownEvent.getDocumentPosition())},this.dragWait=function(e){var t=s(this.mousedownEvent.x,this.mousedownEvent.y,this.x,this.y),i=(new Date).getTime(),n=this.editor;t>a?this.startSelect(this.mousedownEvent.getDocumentPosition()):i-this.mousedownEvent.time>n.$mouseHandler.$dragDelay&&this.startDrag()},this.dragWaitEnd=function(e){this.mousedownEvent.domEvent=e,this.startSelect()},this.drag=function(){var e=this.editor;this.dragCursor=e.renderer.screenToTextCoordinates(this.x,this.y),e.moveCursorToPosition(this.dragCursor),e.renderer.scrollCursorIntoView()},this.dragEnd=function(e){var t=this.editor,i=this.dragCursor,n=this.dragRange;if(o.removeCssClass(t.container,"ace_dragging"),t.session.removeMarker(this.dragSelectionMarker),t.keyBinding.removeKeyboardHandler(this.$dragKeybinding),i){if(t.clearSelection(),e&&(e.ctrlKey||e.altKey)){var s=t.session,r=n;r.end=s.insert(i,s.getTextRange(n)),r.start=i}else{if(n.contains(i.row,i.column))return;var r=t.moveText(n,i)}r&&t.selection.setSelectionRange(r)}},this.onDoubleClick=function(e){var t=e.getDocumentPosition(),i=this.editor,n=i.session,s=n.getBracketRange(t);return s?(s.isEmpty()&&(s.start.column--,s.end.column++),this.$clickSelection=s,void this.setState("select")):(this.$clickSelection=i.selection.getWordRange(t.row,t.column),void this.setState("selectByWords"))},this.onTripleClick=function(e){var t=e.getDocumentPosition(),i=this.editor;this.setState("selectByLines"),this.$clickSelection=i.selection.getLineRange(t.row)},this.onQuadClick=function(e){var t=this.editor;t.selectAll(),this.$clickSelection=t.getSelectionRange(),this.setState("null")},this.onMouseWheel=function(e){if(!e.getShiftKey()&&!e.getAccelKey()){var t=e.domEvent.timeStamp,i=t-(this.$lastScrollTime||0),n=this.editor,s=n.renderer.isScrollableBy(e.wheelX*e.speed,e.wheelY*e.speed);return s||200>i?(this.$lastScrollTime=t,n.renderer.scrollBy(e.wheelX*e.speed,e.wheelY*e.speed),e.stop()):void 0}}}).call(n.prototype),t.DefaultHandlers=n}),define("ace/mouse/default_gutter_handler",["require","exports","module","../lib/dom","../lib/event"],function(e,t,i){"use strict";function n(e){function t(){h=s.createElement("div"),h.className="ace_gutter-tooltip",h.style.display="none",a.container.appendChild(h)}function i(){h||t();var e=u.getDocumentPosition().row,i=l.$annotations[e];if(!i)return n();var s=a.session.getLength();if(e==s){var r=a.renderer.pixelToScreenCoordinates(0,u.y).row,c=u.$pos;if(r>a.session.documentToScreenRow(c.row,c.column))return n()}d!=i&&(d=i.text.join("<br/>"),h.style.display="block",h.innerHTML=d,a.on("mousewheel",n),o(u))}function n(){c&&(c=clearTimeout(c)),d&&(h.style.display="none",d=null,a.removeEventListener("mousewheel",n))}function o(e){var t=a.renderer.$gutter.getBoundingClientRect();h.style.left=e.x+15+"px",e.y+3*a.renderer.lineHeight+15<t.bottom?(h.style.bottom="",h.style.top=e.y+15+"px"):(h.style.top="",h.style.bottom=t.bottom-e.y+5+"px")}var a=e.editor,l=a.renderer.$gutterLayer;e.editor.setDefaultHandler("guttermousedown",function(t){if(a.isFocused()){var i=l.getRegion(t);if("foldWidgets"!=i){var n=t.getDocumentPosition().row,s=a.session.selection;if(t.getShiftKey())s.selectTo(n,0);else{if(2==t.domEvent.detail)return a.selectAll(),t.preventDefault();e.$clickSelection=a.selection.getLineRange(n)}return e.captureMouse(t,"selectByLines"),t.preventDefault()}}});var c,u,h,d;e.editor.setDefaultHandler("guttermousemove",function(t){var r=t.domEvent.target||t.domEvent.srcElement;return s.hasCssClass(r,"ace_fold-widget")?n():(d&&o(t),u=t,void(c||(c=setTimeout(function(){c=null,u&&!e.isMousePressed?i():n()},50))))}),r.addListener(a.renderer.$gutter,"mouseout",function(e){u=null,d&&!c&&(c=setTimeout(function(){c=null,n()},50))})}var s=e("../lib/dom"),r=e("../lib/event");t.GutterHandler=n}),define("ace/mouse/mouse_event",["require","exports","module","../lib/event","../lib/useragent"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),r=t.MouseEvent=function(e,t){this.domEvent=e,this.editor=t,this.x=this.clientX=e.clientX,this.y=this.clientY=e.clientY,this.$pos=null,this.$inSelection=null,this.propagationStopped=!1,this.defaultPrevented=!1};(function(){this.stopPropagation=function(){n.stopPropagation(this.domEvent),this.propagationStopped=!0},this.preventDefault=function(){n.preventDefault(this.domEvent),this.defaultPrevented=!0},this.stop=function(){this.stopPropagation(),this.preventDefault()},this.getDocumentPosition=function(){return this.$pos?this.$pos:(this.$pos=this.editor.renderer.screenToTextCoordinates(this.clientX,this.clientY),this.$pos)},this.inSelection=function(){if(null!==this.$inSelection)return this.$inSelection;var e=this.editor;if(e.getReadOnly())this.$inSelection=!1;else{var t=e.getSelectionRange();if(t.isEmpty())this.$inSelection=!1;else{var i=this.getDocumentPosition();this.$inSelection=t.contains(i.row,i.column)}}return this.$inSelection},this.getButton=function(){return n.getButton(this.domEvent)},this.getShiftKey=function(){return this.domEvent.shiftKey},this.getAccelKey=s.isMac?function(){return this.domEvent.metaKey}:function(){return this.domEvent.ctrlKey}}).call(r.prototype)}),define("ace/mouse/dragdrop",["require","exports","module","../lib/event"],function(e,t,i){"use strict";var n=e("../lib/event"),s=function(e){function t(){c=h.selection.toOrientedRange(),r=h.session.addMarker(c,"ace_selection",h.getSelectionStyle()),h.clearSelection(),clearInterval(l),l=setInterval(f,20),d=0,n.addListener(document,"mousemove",s)}function i(){clearInterval(l),h.session.removeMarker(r),r=null,h.selection.fromOrientedRange(c),d=0,n.removeListener(document,"mousemove",s)}function s(){null==g&&(g=setTimeout(function(){null!=g&&r&&i()},20))}var r,o,a,l,c,u,h=e.editor,d=0,p=h.container;n.addListener(p,"dragenter",function(e){if(!h.getReadOnly()){var i=e.dataTransfer.types;if(!i||-1!==Array.prototype.indexOf.call(i,"text/plain"))return r||t(),d++,n.preventDefault(e)}}),n.addListener(p,"dragover",function(e){if(!h.getReadOnly()){var t=e.dataTransfer.types;if(!t||-1!==Array.prototype.indexOf.call(t,"text/plain"))return null!==g&&(g=null),o=e.clientX,a=e.clientY,n.preventDefault(e)}});var f=function(){u=h.renderer.screenToTextCoordinates(o,a),h.moveCursorToPosition(u),h.renderer.scrollCursorIntoView()};n.addListener(p,"dragleave",function(e){return d--,0>=d&&r?(i(),n.preventDefault(e)):void 0}),n.addListener(p,"drop",function(e){return r?(c.end=h.session.insert(u,e.dataTransfer.getData("Text")),c.start=u,i(),h.focus(),n.preventDefault(e)):void 0});var g=null};t.DragdropHandler=s}),define("ace/lib/net",["require","exports","module","./dom"],function(e,t,i){"use strict";var n=e("./dom");t.get=function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onreadystatechange=function(){4===i.readyState&&t(i.responseText)},i.send(null)},t.loadScript=function(e,t){var i=n.getDocumentHead(),s=document.createElement("script");s.src=e,i.appendChild(s),s.onload=s.onreadystatechange=function(e,i){(i||!s.readyState||"loaded"==s.readyState||"complete"==s.readyState)&&(s=s.onload=s.onreadystatechange=null,i||t())}}}),define("ace/lib/event_emitter",["require","exports","module"],function(e,t,i){"use strict";var n={},s=function(){this.propagationStopped=!0},r=function(){this.defaultPrevented=!0};n._emit=n._dispatchEvent=function(e,t){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var i=this._eventRegistry[e]||[],n=this._defaultHandlers[e];if(i.length||n){"object"==typeof t&&t||(t={}),t.type||(t.type=e),t.stopPropagation||(t.stopPropagation=s),t.preventDefault||(t.preventDefault=r);for(var o=0;o<i.length&&(i[o](t,this),!t.propagationStopped);o++);return n&&!t.defaultPrevented?n(t,this):void 0}},n._signal=function(e,t){var i=(this._eventRegistry||{})[e];if(i)for(var n=0;n<i.length;n++)i[n](t,this)},n.once=function(e,t){var i=this;t&&this.addEventListener(e,function n(){i.removeEventListener(e,n),t.apply(null,arguments)})},n.setDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i||(i=this._defaultHandlers={_disabled_:{}}),i[e]){var n=i[e],s=i._disabled_[e];s||(i._disabled_[e]=s=[]),s.push(n);var r=s.indexOf(t);-1!=r&&s.splice(r,1)}i[e]=t},n.removeDefaultHandler=function(e,t){var i=this._defaultHandlers;if(i){var n=i._disabled_[e];if(i[e]==t){i[e];n&&this.setDefaultHandler(e,n.pop())}else if(n){var s=n.indexOf(t);-1!=s&&n.splice(s,1)}}},n.on=n.addEventListener=function(e,t,i){this._eventRegistry=this._eventRegistry||{};var n=this._eventRegistry[e];return n||(n=this._eventRegistry[e]=[]),-1==n.indexOf(t)&&n[i?"unshift":"push"](t),t},n.off=n.removeListener=n.removeEventListener=function(e,t){this._eventRegistry=this._eventRegistry||{};var i=this._eventRegistry[e];if(i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}},n.removeAllListeners=function(e){this._eventRegistry&&(this._eventRegistry[e]=[])},t.EventEmitter=n}),define("ace/config",["require","exports","module","./lib/lang","./lib/oop","./lib/net","./lib/event_emitter"],function(e,t,i){"no use strict";function n(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})}var s=e("./lib/lang"),r=e("./lib/oop"),o=e("./lib/net"),a=e("./lib/event_emitter").EventEmitter,l=function(){return this}(),c={packaged:!1,workerPath:null,modePath:null,themePath:null,basePath:"",suffix:".js",$moduleUrls:{}};t.get=function(e){if(!c.hasOwnProperty(e))throw new Error("Unknown config key: "+e);return c[e]},t.set=function(e,t){if(!c.hasOwnProperty(e))throw new Error("Unknown config key: "+e);c[e]=t},t.all=function(){return s.copyObject(c)},r.implement(t,a),t.moduleUrl=function(e,t){if(c.$moduleUrls[e])return c.$moduleUrls[e];var i=e.split("/");t=t||i[i.length-2]||"";var n=i[i.length-1].replace(t,"").replace(/(^[\-_])|([\-_]$)/,"");
!n&&i.length>1&&(n=i[i.length-2]);var s=c[t+"Path"];return null==s&&(s=c.basePath),s&&"/"!=s.slice(-1)&&(s+="/"),s+t+"-"+n+this.get("suffix")},t.setModuleUrl=function(e,t){return c.$moduleUrls[e]=t},t.$loading={},t.loadModule=function(i,n){var s,r;Array.isArray(i)&&(r=i[0],i=i[1]);try{s=e(i)}catch(a){}if(s&&!t.$loading[i])return n&&n(s);if(t.$loading[i]||(t.$loading[i]=[]),t.$loading[i].push(n),!(t.$loading[i].length>1)){var l=function(){e([i],function(e){t._emit("load.module",{name:i,module:e});var n=t.$loading[i];t.$loading[i]=null,n.forEach(function(t){t&&t(e)})})};return t.get("packaged")?void o.loadScript(t.moduleUrl(i,r),l):l()}},t.init=function(){if(c.packaged=e.packaged||i.packaged||l.define&&define.packaged,!l.document)return"";for(var s={},r="",o=document.getElementsByTagName("script"),a=0;a<o.length;a++){var u=o[a],h=u.src||u.getAttribute("src");if(h){for(var d=u.attributes,p=0,f=d.length;f>p;p++){var g=d[p];0===g.name.indexOf("data-ace-")&&(s[n(g.name.replace(/^data-ace-/,""))]=g.value)}var m=h.match(/^(.*)\/ace(\-\w+)?\.js(\?|$)/);m&&(r=m[1])}}r&&(s.base=s.base||r,s.packaged=!0),s.basePath=s.base,s.workerPath=s.workerPath||s.base,s.modePath=s.modePath||s.base,s.themePath=s.themePath||s.base,delete s.base;for(var v in s)"undefined"!=typeof s[v]&&t.set(v,s[v])};var u={setOptions:function(e){Object.keys(e).forEach(function(t){this.setOption(t,e[t])},this)},getOptions:function(e){var t={};return e?Array.isArray(e)||(t=e,e=Object.keys(t)):e=Object.keys(this.$options),e.forEach(function(e){t[e]=this.getOption(e)},this),t},setOption:function(e,t){if(this["$"+e]!==t){var i=this.$options[e];if(i){if(i.forwardTo)return this[i.forwardTo]&&this[i.forwardTo].setOption(e,t);i.handlesSet||(this["$"+e]=t),i&&i.set&&i.set.call(this,t)}}},getOption:function(e){var t=this.$options[e];if(t)return t.forwardTo?this[t.forwardTo]&&this[t.forwardTo].getOption(e):t&&t.get?t.get.call(this):this["$"+e]}},h={};t.defineOptions=function(e,t,i){return e.$options||(h[t]=e.$options={}),Object.keys(i).forEach(function(t){var n=i[t];"string"==typeof n&&(n={forwardTo:n}),n.name||(n.name=t),e.$options[n.name]=n,"initialValue"in n&&(e["$"+n.name]=n.initialValue)}),r.implement(e,u),this},t.resetOptions=function(e){Object.keys(e.$options).forEach(function(t){var i=e.$options[t];"value"in i&&e.setOption(t,i.value)})},t.setDefaultValue=function(e,i,n){var s=h[e]||(h[e]={});s[i]&&(s.forwardTo?t.setDefaultValue(s.forwardTo,i,n):s[i].value=n)},t.setDefaultValues=function(e,i){Object.keys(i).forEach(function(n){t.setDefaultValue(e,n,i[n])})}}),define("ace/mouse/mouse_handler",["require","exports","module","../lib/event","../lib/useragent","./default_handlers","./default_gutter_handler","./mouse_event","./dragdrop","../config"],function(e,t,i){"use strict";var n=e("../lib/event"),s=e("../lib/useragent"),r=e("./default_handlers").DefaultHandlers,o=e("./default_gutter_handler").GutterHandler,a=e("./mouse_event").MouseEvent,l=e("./dragdrop").DragdropHandler,c=e("../config"),u=function(e){this.editor=e,new r(this),new o(this),new l(this),n.addListener(e.container,"mousedown",function(t){return e.focus(),n.preventDefault(t)});var t=e.renderer.getMouseEventTarget();n.addListener(t,"click",this.onMouseEvent.bind(this,"click")),n.addListener(t,"mousemove",this.onMouseMove.bind(this,"mousemove")),n.addMultiMouseDownListener(t,[300,300,250],this,"onMouseEvent"),n.addMouseWheelListener(e.container,this.onMouseWheel.bind(this,"mousewheel"));var i=e.renderer.$gutter;n.addListener(i,"mousedown",this.onMouseEvent.bind(this,"guttermousedown")),n.addListener(i,"click",this.onMouseEvent.bind(this,"gutterclick")),n.addListener(i,"dblclick",this.onMouseEvent.bind(this,"gutterdblclick")),n.addListener(i,"mousemove",this.onMouseEvent.bind(this,"guttermousemove"))};(function(){this.onMouseEvent=function(e,t){this.editor._emit(e,new a(t,this.editor))},this.onMouseMove=function(e,t){var i=this.editor._eventRegistry&&this.editor._eventRegistry.mousemove;i&&i.length&&this.editor._emit(e,new a(t,this.editor))},this.onMouseWheel=function(e,t){var i=new a(t,this.editor);i.speed=2*this.$scrollSpeed,i.wheelX=t.wheelX,i.wheelY=t.wheelY,this.editor._emit(e,i)},this.setState=function(e){this.state=e},this.captureMouse=function(e,t){t&&this.setState(t),this.x=e.x,this.y=e.y,this.isMousePressed=!0;var i=this.editor.renderer;i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=null);var r=this,o=function(e){r.x=e.clientX,r.y=e.clientY},a=function(e){clearInterval(c),l(),r[r.state+"End"]&&r[r.state+"End"](e),r.$clickSelection=null,null==i.$keepTextAreaAtCursor&&(i.$keepTextAreaAtCursor=!0,i.$moveTextAreaToCursor()),r.isMousePressed=!1,r.onMouseEvent("mouseup",e)},l=function(){r[r.state]&&r[r.state]()};if(s.isOldIE&&"dblclick"==e.domEvent.type)return setTimeout(function(){a(e.domEvent)});n.capture(this.editor.container,o,a);var c=setInterval(l,20)}}).call(u.prototype),c.defineOptions(u.prototype,"mouseHandler",{scrollSpeed:{initialValue:2},dragDelay:{initialValue:150},focusTimout:{initialValue:0}}),t.MouseHandler=u}),define("ace/mouse/fold_handler",["require","exports","module"],function(e,t,i){"use strict";function n(e){e.on("click",function(t){var i=t.getDocumentPosition(),n=e.session,s=n.getFoldAt(i.row,i.column,1);s&&(t.getAccelKey()?n.removeFold(s):n.expandFold(s),t.stop())}),e.on("gutterclick",function(t){var i=e.renderer.$gutterLayer.getRegion(t);if("foldWidgets"==i){var n=t.getDocumentPosition().row,s=e.session;s.foldWidgets&&s.foldWidgets[n]&&e.session.onFoldWidgetClick(n,t),e.isFocused()||e.focus(),t.stop()}}),e.on("gutterdblclick",function(t){var i=e.renderer.$gutterLayer.getRegion(t);if("foldWidgets"==i){var n=t.getDocumentPosition().row,s=e.session,r=s.getParentFoldRangeData(n,!0),o=r.range||r.firstRange;if(o){var n=o.start.row,a=s.getFoldAt(n,s.getLine(n).length,1);a?s.removeFold(a):(s.addFold("...",o),e.renderer.scrollCursorIntoView({row:o.start.row,column:0}))}t.stop()}})}t.FoldHandler=n}),define("ace/keyboard/keybinding",["require","exports","module","../lib/keys","../lib/event"],function(e,t,i){"use strict";var n=e("../lib/keys"),s=e("../lib/event"),r=function(e){this.$editor=e,this.$data={},this.$handlers=[],this.setDefaultHandler(e.commands)};(function(){this.setDefaultHandler=function(e){this.removeKeyboardHandler(this.$defaultHandler),this.$defaultHandler=e,this.addKeyboardHandler(e,0),this.$data={editor:this.$editor}},this.setKeyboardHandler=function(e){var t=this.$handlers;if(t[t.length-1]!=e){for(;t[t.length-1]&&t[t.length-1]!=this.$defaultHandler;)this.removeKeyboardHandler(t[t.length-1]);this.addKeyboardHandler(e,1)}},this.addKeyboardHandler=function(e,t){if(e){var i=this.$handlers.indexOf(e);-1!=i&&this.$handlers.splice(i,1),void 0==t?this.$handlers.push(e):this.$handlers.splice(t,0,e),-1==i&&e.attach&&e.attach(this.$editor)}},this.removeKeyboardHandler=function(e){var t=this.$handlers.indexOf(e);return-1==t?!1:(this.$handlers.splice(t,1),e.detach&&e.detach(this.$editor),!0)},this.getKeyboardHandler=function(){return this.$handlers[this.$handlers.length-1]},this.$callKeyboardHandlers=function(e,t,i,n){for(var r,o=!1,a=this.$editor.commands,l=this.$handlers.length;l--&&(r=this.$handlers[l].handleKeyboard(this.$data,e,t,i,n),!(r&&r.command&&(o="null"==r.command?!0:a.exec(r.command,this.$editor,r.args,n),o&&n&&-1!=e&&1!=r.passEvent&&s.stopEvent(n),o))););return o},this.onCommandKey=function(e,t,i){var s=n.keyCodeToString(i);this.$callKeyboardHandlers(t,s,i,e)},this.onTextInput=function(e){var t=this.$callKeyboardHandlers(-1,e);t||this.$editor.commands.exec("insertstring",this.$editor,e)}}).call(r.prototype),t.KeyBinding=r}),define("ace/range",["require","exports","module"],function(e,t,i){"use strict";var n=function(e,t){return e.row-t.row||e.column-t.column},s=function(e,t,i,n){this.start={row:e,column:t},this.end={row:i,column:n}};(function(){this.isEqual=function(e){return this.start.row===e.start.row&&this.end.row===e.end.row&&this.start.column===e.start.column&&this.end.column===e.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(e,t){return 0==this.compare(e,t)},this.compareRange=function(e){var t,i=e.end,n=e.start;return t=this.compare(i.row,i.column),1==t?(t=this.compare(n.row,n.column),1==t?2:0==t?1:0):-1==t?-2:(t=this.compare(n.row,n.column),-1==t?-1:1==t?42:0)},this.comparePoint=function(e){return this.compare(e.row,e.column)},this.containsRange=function(e){return 0==this.comparePoint(e.start)&&0==this.comparePoint(e.end)},this.intersects=function(e){var t=this.compareRange(e);return-1==t||0==t||1==t},this.isEnd=function(e,t){return this.end.row==e&&this.end.column==t},this.isStart=function(e,t){return this.start.row==e&&this.start.column==t},this.setStart=function(e,t){"object"==typeof e?(this.start.column=e.column,this.start.row=e.row):(this.start.row=e,this.start.column=t)},this.setEnd=function(e,t){"object"==typeof e?(this.end.column=e.column,this.end.row=e.row):(this.end.row=e,this.end.column=t)},this.inside=function(e,t){return 0==this.compare(e,t)?this.isEnd(e,t)||this.isStart(e,t)?!1:!0:!1},this.insideStart=function(e,t){return 0==this.compare(e,t)?this.isEnd(e,t)?!1:!0:!1},this.insideEnd=function(e,t){return 0==this.compare(e,t)?this.isStart(e,t)?!1:!0:!1},this.compare=function(e,t){return this.isMultiLine()||e!==this.start.row?e<this.start.row?-1:e>this.end.row?1:this.start.row===e?t>=this.start.column?0:-1:this.end.row===e?t<=this.end.column?0:1:0:t<this.start.column?-1:t>this.end.column?1:0},this.compareStart=function(e,t){return this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.compareEnd=function(e,t){return this.end.row==e&&this.end.column==t?1:this.compare(e,t)},this.compareInside=function(e,t){return this.end.row==e&&this.end.column==t?1:this.start.row==e&&this.start.column==t?-1:this.compare(e,t)},this.clipRows=function(e,t){if(this.end.row>t)var i={row:t+1,column:0};else if(this.end.row<e)var i={row:e,column:0};if(this.start.row>t)var n={row:t+1,column:0};else if(this.start.row<e)var n={row:e,column:0};return s.fromPoints(n||this.start,i||this.end)},this.extend=function(e,t){var i=this.compare(e,t);if(0==i)return this;if(-1==i)var n={row:e,column:t};else var r={row:e,column:t};return s.fromPoints(n||this.start,r||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return s.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new s(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new s(this.start.row,0,this.end.row,0)},this.toScreenRange=function(e){var t=e.documentToScreenPosition(this.start),i=e.documentToScreenPosition(this.end);return new s(t.row,t.column,i.row,i.column)},this.moveBy=function(e,t){this.start.row+=e,this.start.column+=t,this.end.row+=e,this.end.column+=t}}).call(s.prototype),s.fromPoints=function(e,t){return new s(e.row,e.column,t.row,t.column)},s.comparePoints=n,s.comparePoints=function(e,t){return e.row-t.row||e.column-t.column},t.Range=s}),define("ace/selection",["require","exports","module","./lib/oop","./lib/lang","./lib/event_emitter","./range"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/lang"),r=e("./lib/event_emitter").EventEmitter,o=e("./range").Range,a=function(e){this.session=e,this.doc=e.getDocument(),this.clearSelection(),this.lead=this.selectionLead=this.doc.createAnchor(0,0),this.anchor=this.selectionAnchor=this.doc.createAnchor(0,0);var t=this;this.lead.on("change",function(e){t._emit("changeCursor"),t.$isEmpty||t._emit("changeSelection"),t.$keepDesiredColumnOnChange||e.old.column==e.value.column||(t.$desiredColumn=null)}),this.selectionAnchor.on("change",function(){t.$isEmpty||t._emit("changeSelection")})};(function(){n.implement(this,r),this.isEmpty=function(){return this.$isEmpty||this.anchor.row==this.lead.row&&this.anchor.column==this.lead.column},this.isMultiLine=function(){return this.isEmpty()?!1:this.getRange().isMultiLine()},this.getCursor=function(){return this.lead.getPosition()},this.setSelectionAnchor=function(e,t){this.anchor.setPosition(e,t),this.$isEmpty&&(this.$isEmpty=!1,this._emit("changeSelection"))},this.getSelectionAnchor=function(){return this.$isEmpty?this.getSelectionLead():this.anchor.getPosition()},this.getSelectionLead=function(){return this.lead.getPosition()},this.shiftSelection=function(e){if(this.$isEmpty)return void this.moveCursorTo(this.lead.row,this.lead.column+e);var t=this.getSelectionAnchor(),i=this.getSelectionLead(),n=this.isBackwards();n&&0===t.column||this.setSelectionAnchor(t.row,t.column+e),(n||0!==i.column)&&this.$moveSelection(function(){this.moveCursorTo(i.row,i.column+e)})},this.isBackwards=function(){var e=this.anchor,t=this.lead;return e.row>t.row||e.row==t.row&&e.column>t.column},this.getRange=function(){var e=this.anchor,t=this.lead;return this.isEmpty()?o.fromPoints(t,t):this.isBackwards()?o.fromPoints(t,e):o.fromPoints(e,t)},this.clearSelection=function(){this.$isEmpty||(this.$isEmpty=!0,this._emit("changeSelection"))},this.selectAll=function(){var e=this.doc.getLength()-1;this.setSelectionAnchor(0,0),this.moveCursorTo(e,this.doc.getLine(e).length)},this.setRange=this.setSelectionRange=function(e,t){t?(this.setSelectionAnchor(e.end.row,e.end.column),this.selectTo(e.start.row,e.start.column)):(this.setSelectionAnchor(e.start.row,e.start.column),this.selectTo(e.end.row,e.end.column)),this.$desiredColumn=null},this.$moveSelection=function(e){var t=this.lead;this.$isEmpty&&this.setSelectionAnchor(t.row,t.column),e.call(this)},this.selectTo=function(e,t){this.$moveSelection(function(){this.moveCursorTo(e,t)})},this.selectToPosition=function(e){this.$moveSelection(function(){this.moveCursorToPosition(e)})},this.selectUp=function(){this.$moveSelection(this.moveCursorUp)},this.selectDown=function(){this.$moveSelection(this.moveCursorDown)},this.selectRight=function(){this.$moveSelection(this.moveCursorRight)},this.selectLeft=function(){this.$moveSelection(this.moveCursorLeft)},this.selectLineStart=function(){this.$moveSelection(this.moveCursorLineStart)},this.selectLineEnd=function(){this.$moveSelection(this.moveCursorLineEnd)},this.selectFileEnd=function(){this.$moveSelection(this.moveCursorFileEnd)},this.selectFileStart=function(){this.$moveSelection(this.moveCursorFileStart)},this.selectWordRight=function(){this.$moveSelection(this.moveCursorWordRight)},this.selectWordLeft=function(){this.$moveSelection(this.moveCursorWordLeft)},this.getWordRange=function(e,t){if("undefined"==typeof t){var i=e||this.lead;e=i.row,t=i.column}return this.session.getWordRange(e,t)},this.selectWord=function(){this.setSelectionRange(this.getWordRange())},this.selectAWord=function(){var e=this.getCursor(),t=this.session.getAWordRange(e.row,e.column);this.setSelectionRange(t)},this.getLineRange=function(e,t){var i,n="number"==typeof e?e:this.lead.row,s=this.session.getFoldLine(n);return s?(n=s.start.row,i=s.end.row):i=n,t?new o(n,0,i,this.session.getLine(i).length):new o(n,0,i+1,0)},this.selectLine=function(){this.setSelectionRange(this.getLineRange())},this.moveCursorUp=function(){this.moveCursorBy(-1,0)},this.moveCursorDown=function(){this.moveCursorBy(1,0)},this.moveCursorLeft=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,-1))this.moveCursorTo(e.start.row,e.start.column);else if(0==t.column)t.row>0&&this.moveCursorTo(t.row-1,this.doc.getLine(t.row-1).length);else{var i=this.session.getTabSize();this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column-i,t.column).split(" ").length-1==i?this.moveCursorBy(0,-i):this.moveCursorBy(0,-1)}},this.moveCursorRight=function(){var e,t=this.lead.getPosition();if(e=this.session.getFoldAt(t.row,t.column,1))this.moveCursorTo(e.end.row,e.end.column);else if(this.lead.column==this.doc.getLine(this.lead.row).length)this.lead.row<this.doc.getLength()-1&&this.moveCursorTo(this.lead.row+1,0);else{var i=this.session.getTabSize(),t=this.lead;this.session.isTabStop(t)&&this.doc.getLine(t.row).slice(t.column,t.column+i).split(" ").length-1==i?this.moveCursorBy(0,i):this.moveCursorBy(0,1)}},this.moveCursorLineStart=function(){var e=this.lead.row,t=this.lead.column,i=this.session.documentToScreenRow(e,t),n=this.session.screenToDocumentPosition(i,0),s=this.session.getDisplayLine(e,null,n.row,n.column),r=s.match(/^\s*/);r[0].length==t||this.session.$useEmacsStyleLineStart||(n.column+=r[0].length),this.moveCursorToPosition(n)},this.moveCursorLineEnd=function(){var e=this.lead,t=this.session.getDocumentLastRowColumnPosition(e.row,e.column);if(this.lead.column==t.column){var i=this.session.getLine(t.row);if(t.column==i.length){var n=i.search(/\s+$/);n>0&&(t.column=n)}}this.moveCursorTo(t.row,t.column)},this.moveCursorFileEnd=function(){var e=this.doc.getLength()-1,t=this.doc.getLine(e).length;this.moveCursorTo(e,t)},this.moveCursorFileStart=function(){this.moveCursorTo(0,0)},this.moveCursorLongWordRight=function(){var e,t=this.lead.row,i=this.lead.column,n=this.doc.getLine(t),s=n.substring(i);this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0;var r=this.session.getFoldAt(t,i,1);return r?void this.moveCursorTo(r.end.row,r.end.column):((e=this.session.nonTokenRe.exec(s))&&(i+=this.session.nonTokenRe.lastIndex,this.session.nonTokenRe.lastIndex=0,s=n.substring(i)),i>=n.length?(this.moveCursorTo(t,n.length),this.moveCursorRight(),void(t<this.doc.getLength()-1&&this.moveCursorWordRight())):((e=this.session.tokenRe.exec(s))&&(i+=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),void this.moveCursorTo(t,i)))},this.moveCursorLongWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))return void this.moveCursorTo(e.start.row,e.start.column);var n=this.session.getFoldStringAt(t,i,-1);null==n&&(n=this.doc.getLine(t).substring(0,i));var r,o=s.stringReverse(n);return this.session.nonTokenRe.lastIndex=0,this.session.tokenRe.lastIndex=0,(r=this.session.nonTokenRe.exec(o))&&(i-=this.session.nonTokenRe.lastIndex,o=o.slice(this.session.nonTokenRe.lastIndex),this.session.nonTokenRe.lastIndex=0),0>=i?(this.moveCursorTo(t,0),this.moveCursorLeft(),void(t>0&&this.moveCursorWordLeft())):((r=this.session.tokenRe.exec(o))&&(i-=this.session.tokenRe.lastIndex,this.session.tokenRe.lastIndex=0),void this.moveCursorTo(t,i))},this.$shortWordEndIndex=function(e){var t,i,n=0,s=/\s/,r=this.session.tokenRe;if(r.lastIndex=0,t=this.session.tokenRe.exec(e))n=this.session.tokenRe.lastIndex;else{for(;(i=e[n])&&s.test(i);)n++;if(1>=n)for(r.lastIndex=0;(i=e[n])&&!r.test(i);)if(r.lastIndex=0,n++,s.test(i)){if(n>2){n--;break}for(;(i=e[n])&&s.test(i);)n++;if(n>2)break}}return r.lastIndex=0,n},this.moveCursorShortWordRight=function(){var e=this.lead.row,t=this.lead.column,i=this.doc.getLine(e),n=i.substring(t),s=this.session.getFoldAt(e,t,1);if(s)return this.moveCursorTo(s.end.row,s.end.column);if(t==i.length){var r=this.doc.getLength();do e++,n=this.doc.getLine(e);while(r>e&&/^\s*$/.test(n));/^\s+/.test(n)||(n=""),t=0}var o=this.$shortWordEndIndex(n);this.moveCursorTo(e,t+o)},this.moveCursorShortWordLeft=function(){var e,t=this.lead.row,i=this.lead.column;if(e=this.session.getFoldAt(t,i,-1))return this.moveCursorTo(e.start.row,e.start.column);var n=this.session.getLine(t).substring(0,i);if(0==i){do t--,n=this.doc.getLine(t);while(t>0&&/^\s*$/.test(n));i=n.length,/\s+$/.test(n)||(n="")}var r=s.stringReverse(n),o=this.$shortWordEndIndex(r);return this.moveCursorTo(t,i-o)},this.moveCursorWordRight=function(){this.session.$selectLongWords?this.moveCursorLongWordRight():this.moveCursorShortWordRight()},this.moveCursorWordLeft=function(){this.session.$selectLongWords?this.moveCursorLongWordLeft():this.moveCursorShortWordLeft()},this.moveCursorBy=function(e,t){var i=this.session.documentToScreenPosition(this.lead.row,this.lead.column);0===t&&(this.$desiredColumn?i.column=this.$desiredColumn:this.$desiredColumn=i.column);var n=this.session.screenToDocumentPosition(i.row+e,i.column);this.moveCursorTo(n.row,n.column+t,0===t)},this.moveCursorToPosition=function(e){this.moveCursorTo(e.row,e.column)},this.moveCursorTo=function(e,t,i){var n=this.session.getFoldAt(e,t,1);n&&(e=n.start.row,t=n.start.column),this.$keepDesiredColumnOnChange=!0,this.lead.setPosition(e,t),this.$keepDesiredColumnOnChange=!1,i||(this.$desiredColumn=null)},this.moveCursorToScreen=function(e,t,i){var n=this.session.screenToDocumentPosition(e,t);this.moveCursorTo(n.row,n.column,i)},this.detach=function(){this.lead.detach(),this.anchor.detach(),this.session=this.doc=null},this.fromOrientedRange=function(e){this.setSelectionRange(e,e.cursor==e.start),this.$desiredColumn=e.desiredColumn||this.$desiredColumn},this.toOrientedRange=function(e){var t=this.getRange();return e?(e.start.column=t.start.column,e.start.row=t.start.row,e.end.column=t.end.column,e.end.row=t.end.row):e=t,e.cursor=this.isBackwards()?e.start:e.end,e.desiredColumn=this.$desiredColumn,e}}).call(a.prototype),t.Selection=a}),define("ace/tokenizer",["require","exports","module"],function(e,t,i){"use strict";var n=1e3,s=function(e){this.states=e,this.regExps={},this.matchMappings={};for(var t in this.states){for(var i=this.states[t],n=[],s=0,r=this.matchMappings[t]={defaultToken:"text"},o="g",a=[],l=0;l<i.length;l++){var c=i[l];if(c.defaultToken&&(r.defaultToken=c.defaultToken),c.caseInsensitive&&(o="gi"),null!=c.regex){c.regex instanceof RegExp&&(c.regex=c.regex.toString().slice(1,-1));var u=c.regex,h=new RegExp("(?:("+u+")|(.))").exec("a").length-2;if(Array.isArray(c.token))if(1==c.token.length||1==h)c.token=c.token[0];else{if(h-1!=c.token.length)throw new Error("number of classes and regexp groups in '"+c.token+"'\n'"+c.regex+"' doesn't match\n"+(h-1)+"!="+c.token.length);c.tokenArray=c.token,c.token=null,c.onMatch=this.$arrayTokens}else"function"!=typeof c.token||c.onMatch||(h>1?c.onMatch=this.$applyToken:c.onMatch=c.token);h>1&&(/\\\d/.test(c.regex)?u=c.regex.replace(/\\([0-9]+)/g,function(e,t){return"\\"+(parseInt(t,10)+s+1)}):(h=1,u=this.removeCapturingGroups(c.regex)),c.splitRegex||"string"==typeof c.token||a.push(c)),r[s]=l,s+=h,n.push(u),c.onMatch||(c.onMatch=null),c.__proto__=null}}a.forEach(function(e){e.splitRegex=this.createSplitterRegexp(e.regex,o)},this),this.regExps[t]=new RegExp("("+n.join(")|(")+")|($)",o)}};(function(){this.$applyToken=function(e){var t=this.splitRegex.exec(e).slice(1),i=this.token.apply(this,t);if("string"==typeof i)return[{type:i,value:e}];for(var n=[],s=0,r=i.length;r>s;s++)t[s]&&(n[n.length]={type:i[s],value:t[s]});return n},this.$arrayTokens=function(e){if(!e)return[];var t=this.splitRegex.exec(e);if(!t)return"text";for(var i=[],n=this.tokenArray,s=0,r=n.length;r>s;s++)t[s+1]&&(i[i.length]={type:n[s],value:t[s+1]});return i},this.removeCapturingGroups=function(e){var t=e.replace(/\[(?:\\.|[^\]])*?\]|\\.|\(\?[:=!]|(\()/g,function(e,t){return t?"(?:":e});return t},this.createSplitterRegexp=function(e,t){if(-1!=e.indexOf("(?=")){var i=0,n=!1,s={};e.replace(/(\\.)|(\((?:\?[=!])?)|(\))|([\[\]])/g,function(e,t,r,o,a,l){return n?n="]"!=a:a?n=!0:o?(i==s.stack&&(s.end=l+1,s.stack=-1),i--):r&&(i++,1!=r.length&&(s.stack=i,s.start=l)),e}),null!=s.end&&/^\)*$/.test(e.substr(s.end))&&(e=e.substring(0,s.start)+e.substr(s.end))}return new RegExp(e,(t||"").replace("g",""))},this.getLineTokens=function(e,t){if(t&&"string"!=typeof t){var i=t.slice(0);t=i[0]}else var i=[];var s=t||"start",r=this.states[s],o=this.matchMappings[s],a=this.regExps[s];a.lastIndex=0;for(var l,c=[],u=0,h={type:null,value:""};l=a.exec(e);){var d=o.defaultToken,p=null,f=l[0],g=a.lastIndex;if(g-f.length>u){var m=e.substring(u,g-f.length);h.type==d?h.value+=m:(h.type&&c.push(h),h={type:d,value:m})}for(var v=0;v<l.length-2;v++)if(void 0!==l[v+1]){p=r[o[v]],d=p.onMatch?p.onMatch(f,s,i):p.token,p.next&&(s="string"==typeof p.next?p.next:p.next(s,i),r=this.states[s],r||(window.console&&console.error&&console.error(s,"doesn't exist"),s="start",r=this.states[s]),o=this.matchMappings[s],u=g,a=this.regExps[s],a.lastIndex=g);break}if(f)if("string"==typeof d)p&&p.merge===!1||h.type!==d?(h.type&&c.push(h),h={type:d,value:f}):h.value+=f;else if(d){h.type&&c.push(h),h={type:null,value:""};for(var v=0;v<d.length;v++)c.push(d[v])}if(u==e.length)break;if(u=g,c.length>n){for(;u<e.length;)h.type&&c.push(h),h={value:e.substring(u,u+=2e3),type:"overflow"};s="start",i=[];break}}return h.type&&c.push(h),{tokens:c,state:i.length?i:s}}}).call(s.prototype),t.Tokenizer=s}),define("ace/mode/text_highlight_rules",["require","exports","module","../lib/lang"],function(e,t,i){"use strict";var n=e("../lib/lang"),s=function(){this.$rules={start:[{token:"empty_line",regex:"^$"},{defaultToken:"text"}]}};(function(){this.addRules=function(e,t){for(var i in e){for(var n=e[i],s=0;s<n.length;s++){var r=n[s];r.next&&("string"!=typeof r.next?r.nextState=t+r.nextState:r.next=t+r.next)}this.$rules[t+i]=n}},this.getRules=function(){return this.$rules},this.embedRules=function(e,t,i,s,r){var o=(new e).getRules();if(s)for(var a=0;a<s.length;a++)s[a]=t+s[a];else{s=[];for(var l in o)s.push(t+l)}if(this.addRules(o,t),i)for(var c=Array.prototype[r?"push":"unshift"],a=0;a<s.length;a++)c.apply(this.$rules[s[a]],n.deepCopy(i));this.$embeds||(this.$embeds=[]),this.$embeds.push(t)},this.getEmbeds=function(){return this.$embeds};var e=function(e,t){return"start"!=e&&t.unshift(this.nextState,e),this.nextState},t=function(e,t){return t[0]!==e?"start":(t.shift(),t.shift())};this.normalizeRules=function(){function i(r){var o=s[r];o.processed=!0;for(var a=0;a<o.length;a++){var l=o[a];!l.regex&&l.start&&(l.regex=l.start,l.next||(l.next=[]),l.next.push({defaultToken:l.token},{token:l.token+".end",regex:l.end||l.start,next:"pop"}),l.token=l.token+".start",l.push=!0);var c=l.next||l.push;if(c&&Array.isArray(c)){var u=l.stateName;u||(u=l.token,"string"!=typeof u&&(u=u[0]||""),s[u]&&(u+=n++)),s[u]=c,l.next=u,i(u)}else"pop"==c&&(l.next=t);if(l.push&&(l.nextState=l.next||l.push,l.next=e,delete l.push),l.rules)for(var h in l.rules)s[h]?s[h].push&&s[h].push.apply(s[h],l.rules[h]):s[h]=l.rules[h];if(l.include||"string"==typeof l)var d=l.include||l,p=s[d];else Array.isArray(l)&&(p=l);if(p){var f=[a,1].concat(p);l.noEscape&&(f=f.filter(function(e){return!e.next})),o.splice.apply(o,f),a--,p=null}l.keywordMap&&(l.token=this.createKeywordMapper(l.keywordMap,l.defaultToken||"text",l.caseInsensitive),delete l.defaultToken)}}var n=0,s=this.$rules;Object.keys(s).forEach(i,this)},this.createKeywordMapper=function(e,t,i,n){var s=Object.create(null);return Object.keys(e).forEach(function(t){var r=e[t];i&&(r=r.toLowerCase());for(var o=r.split(n||"|"),a=o.length;a--;)s[o[a]]=t}),e=null,i?function(e){return s[e.toLowerCase()]||t}:function(e){return s[e]||t}},this.getKeywords=function(){return this.$keywords}}).call(s.prototype),t.TextHighlightRules=s}),define("ace/mode/behaviour",["require","exports","module"],function(e,t,i){"use strict";var n=function(){this.$behaviours={}};(function(){this.add=function(e,t,i){switch(void 0){case this.$behaviours:this.$behaviours={};case this.$behaviours[e]:this.$behaviours[e]={}}this.$behaviours[e][t]=i},this.addBehaviours=function(e){for(var t in e)for(var i in e[t])this.add(t,i,e[t][i])},this.remove=function(e){this.$behaviours&&this.$behaviours[e]&&delete this.$behaviours[e]},this.inherit=function(e,t){if("function"==typeof e)var i=(new e).getBehaviours(t);else var i=e.getBehaviours(t);this.addBehaviours(i)},this.getBehaviours=function(e){if(e){for(var t={},i=0;i<e.length;i++)this.$behaviours[e[i]]&&(t[e[i]]=this.$behaviours[e[i]]);return t}return this.$behaviours}}).call(n.prototype),t.Behaviour=n}),define("ace/unicode",["require","exports","module"],function(e,t,i){"use strict";function n(e){var i=/\w{4}/g;for(var n in e)t.packages[n]=e[n].replace(i,"\\u$&")}t.packages={},n({L:"0041-005A0061-007A00AA00B500BA00C0-00D600D8-00F600F8-02C102C6-02D102E0-02E402EC02EE0370-037403760377037A-037D03860388-038A038C038E-03A103A3-03F503F7-0481048A-05250531-055605590561-058705D0-05EA05F0-05F20621-064A066E066F0671-06D306D506E506E606EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA07F407F507FA0800-0815081A082408280904-0939093D09500958-0961097109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E460E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EC60EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10A0-10C510D0-10FA10FC1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317D717DC1820-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541AA71B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C7D1CE9-1CEC1CEE-1CF11D00-1DBF1E00-1F151F18-1F1D1F20-1F451F48-1F4D1F50-1F571F591F5B1F5D1F5F-1F7D1F80-1FB41FB6-1FBC1FBE1FC2-1FC41FC6-1FCC1FD0-1FD31FD6-1FDB1FE0-1FEC1FF2-1FF41FF6-1FFC2071207F2090-209421022107210A-211321152119-211D212421262128212A-212D212F-2139213C-213F2145-2149214E218321842C00-2C2E2C30-2C5E2C60-2CE42CEB-2CEE2D00-2D252D30-2D652D6F2D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE2E2F300530063031-3035303B303C3041-3096309D-309F30A1-30FA30FC-30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A48CA4D0-A4FDA500-A60CA610-A61FA62AA62BA640-A65FA662-A66EA67F-A697A6A0-A6E5A717-A71FA722-A788A78BA78CA7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2A9CFAA00-AA28AA40-AA42AA44-AA4BAA60-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADB-AADDABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB00-FB06FB13-FB17FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF21-FF3AFF41-FF5AFF66-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",Ll:"0061-007A00AA00B500BA00DF-00F600F8-00FF01010103010501070109010B010D010F01110113011501170119011B011D011F01210123012501270129012B012D012F01310133013501370138013A013C013E014001420144014601480149014B014D014F01510153015501570159015B015D015F01610163016501670169016B016D016F0171017301750177017A017C017E-0180018301850188018C018D019201950199-019B019E01A101A301A501A801AA01AB01AD01B001B401B601B901BA01BD-01BF01C601C901CC01CE01D001D201D401D601D801DA01DC01DD01DF01E101E301E501E701E901EB01ED01EF01F001F301F501F901FB01FD01FF02010203020502070209020B020D020F02110213021502170219021B021D021F02210223022502270229022B022D022F02310233-0239023C023F0240024202470249024B024D024F-02930295-02AF037103730377037B-037D039003AC-03CE03D003D103D5-03D703D903DB03DD03DF03E103E303E503E703E903EB03ED03EF-03F303F503F803FB03FC0430-045F04610463046504670469046B046D046F04710473047504770479047B047D047F0481048B048D048F04910493049504970499049B049D049F04A104A304A504A704A904AB04AD04AF04B104B304B504B704B904BB04BD04BF04C204C404C604C804CA04CC04CE04CF04D104D304D504D704D904DB04DD04DF04E104E304E504E704E904EB04ED04EF04F104F304F504F704F904FB04FD04FF05010503050505070509050B050D050F05110513051505170519051B051D051F0521052305250561-05871D00-1D2B1D62-1D771D79-1D9A1E011E031E051E071E091E0B1E0D1E0F1E111E131E151E171E191E1B1E1D1E1F1E211E231E251E271E291E2B1E2D1E2F1E311E331E351E371E391E3B1E3D1E3F1E411E431E451E471E491E4B1E4D1E4F1E511E531E551E571E591E5B1E5D1E5F1E611E631E651E671E691E6B1E6D1E6F1E711E731E751E771E791E7B1E7D1E7F1E811E831E851E871E891E8B1E8D1E8F1E911E931E95-1E9D1E9F1EA11EA31EA51EA71EA91EAB1EAD1EAF1EB11EB31EB51EB71EB91EBB1EBD1EBF1EC11EC31EC51EC71EC91ECB1ECD1ECF1ED11ED31ED51ED71ED91EDB1EDD1EDF1EE11EE31EE51EE71EE91EEB1EED1EEF1EF11EF31EF51EF71EF91EFB1EFD1EFF-1F071F10-1F151F20-1F271F30-1F371F40-1F451F50-1F571F60-1F671F70-1F7D1F80-1F871F90-1F971FA0-1FA71FB0-1FB41FB61FB71FBE1FC2-1FC41FC61FC71FD0-1FD31FD61FD71FE0-1FE71FF2-1FF41FF61FF7210A210E210F2113212F21342139213C213D2146-2149214E21842C30-2C5E2C612C652C662C682C6A2C6C2C712C732C742C76-2C7C2C812C832C852C872C892C8B2C8D2C8F2C912C932C952C972C992C9B2C9D2C9F2CA12CA32CA52CA72CA92CAB2CAD2CAF2CB12CB32CB52CB72CB92CBB2CBD2CBF2CC12CC32CC52CC72CC92CCB2CCD2CCF2CD12CD32CD52CD72CD92CDB2CDD2CDF2CE12CE32CE42CEC2CEE2D00-2D25A641A643A645A647A649A64BA64DA64FA651A653A655A657A659A65BA65DA65FA663A665A667A669A66BA66DA681A683A685A687A689A68BA68DA68FA691A693A695A697A723A725A727A729A72BA72DA72F-A731A733A735A737A739A73BA73DA73FA741A743A745A747A749A74BA74DA74FA751A753A755A757A759A75BA75DA75FA761A763A765A767A769A76BA76DA76FA771-A778A77AA77CA77FA781A783A785A787A78CFB00-FB06FB13-FB17FF41-FF5A",
Lu:"0041-005A00C0-00D600D8-00DE01000102010401060108010A010C010E01100112011401160118011A011C011E01200122012401260128012A012C012E01300132013401360139013B013D013F0141014301450147014A014C014E01500152015401560158015A015C015E01600162016401660168016A016C016E017001720174017601780179017B017D018101820184018601870189-018B018E-0191019301940196-0198019C019D019F01A001A201A401A601A701A901AC01AE01AF01B1-01B301B501B701B801BC01C401C701CA01CD01CF01D101D301D501D701D901DB01DE01E001E201E401E601E801EA01EC01EE01F101F401F6-01F801FA01FC01FE02000202020402060208020A020C020E02100212021402160218021A021C021E02200222022402260228022A022C022E02300232023A023B023D023E02410243-02460248024A024C024E03700372037603860388-038A038C038E038F0391-03A103A3-03AB03CF03D2-03D403D803DA03DC03DE03E003E203E403E603E803EA03EC03EE03F403F703F903FA03FD-042F04600462046404660468046A046C046E04700472047404760478047A047C047E0480048A048C048E04900492049404960498049A049C049E04A004A204A404A604A804AA04AC04AE04B004B204B404B604B804BA04BC04BE04C004C104C304C504C704C904CB04CD04D004D204D404D604D804DA04DC04DE04E004E204E404E604E804EA04EC04EE04F004F204F404F604F804FA04FC04FE05000502050405060508050A050C050E05100512051405160518051A051C051E0520052205240531-055610A0-10C51E001E021E041E061E081E0A1E0C1E0E1E101E121E141E161E181E1A1E1C1E1E1E201E221E241E261E281E2A1E2C1E2E1E301E321E341E361E381E3A1E3C1E3E1E401E421E441E461E481E4A1E4C1E4E1E501E521E541E561E581E5A1E5C1E5E1E601E621E641E661E681E6A1E6C1E6E1E701E721E741E761E781E7A1E7C1E7E1E801E821E841E861E881E8A1E8C1E8E1E901E921E941E9E1EA01EA21EA41EA61EA81EAA1EAC1EAE1EB01EB21EB41EB61EB81EBA1EBC1EBE1EC01EC21EC41EC61EC81ECA1ECC1ECE1ED01ED21ED41ED61ED81EDA1EDC1EDE1EE01EE21EE41EE61EE81EEA1EEC1EEE1EF01EF21EF41EF61EF81EFA1EFC1EFE1F08-1F0F1F18-1F1D1F28-1F2F1F38-1F3F1F48-1F4D1F591F5B1F5D1F5F1F68-1F6F1FB8-1FBB1FC8-1FCB1FD8-1FDB1FE8-1FEC1FF8-1FFB21022107210B-210D2110-211221152119-211D212421262128212A-212D2130-2133213E213F214521832C00-2C2E2C602C62-2C642C672C692C6B2C6D-2C702C722C752C7E-2C802C822C842C862C882C8A2C8C2C8E2C902C922C942C962C982C9A2C9C2C9E2CA02CA22CA42CA62CA82CAA2CAC2CAE2CB02CB22CB42CB62CB82CBA2CBC2CBE2CC02CC22CC42CC62CC82CCA2CCC2CCE2CD02CD22CD42CD62CD82CDA2CDC2CDE2CE02CE22CEB2CEDA640A642A644A646A648A64AA64CA64EA650A652A654A656A658A65AA65CA65EA662A664A666A668A66AA66CA680A682A684A686A688A68AA68CA68EA690A692A694A696A722A724A726A728A72AA72CA72EA732A734A736A738A73AA73CA73EA740A742A744A746A748A74AA74CA74EA750A752A754A756A758A75AA75CA75EA760A762A764A766A768A76AA76CA76EA779A77BA77DA77EA780A782A784A786A78BFF21-FF3A",Lt:"01C501C801CB01F21F88-1F8F1F98-1F9F1FA8-1FAF1FBC1FCC1FFC",Lm:"02B0-02C102C6-02D102E0-02E402EC02EE0374037A0559064006E506E607F407F507FA081A0824082809710E460EC610FC17D718431AA71C78-1C7D1D2C-1D611D781D9B-1DBF2071207F2090-20942C7D2D6F2E2F30053031-3035303B309D309E30FC-30FEA015A4F8-A4FDA60CA67FA717-A71FA770A788A9CFAA70AADDFF70FF9EFF9F",Lo:"01BB01C0-01C3029405D0-05EA05F0-05F20621-063F0641-064A066E066F0671-06D306D506EE06EF06FA-06FC06FF07100712-072F074D-07A507B107CA-07EA0800-08150904-0939093D09500958-096109720979-097F0985-098C098F09900993-09A809AA-09B009B209B6-09B909BD09CE09DC09DD09DF-09E109F009F10A05-0A0A0A0F0A100A13-0A280A2A-0A300A320A330A350A360A380A390A59-0A5C0A5E0A72-0A740A85-0A8D0A8F-0A910A93-0AA80AAA-0AB00AB20AB30AB5-0AB90ABD0AD00AE00AE10B05-0B0C0B0F0B100B13-0B280B2A-0B300B320B330B35-0B390B3D0B5C0B5D0B5F-0B610B710B830B85-0B8A0B8E-0B900B92-0B950B990B9A0B9C0B9E0B9F0BA30BA40BA8-0BAA0BAE-0BB90BD00C05-0C0C0C0E-0C100C12-0C280C2A-0C330C35-0C390C3D0C580C590C600C610C85-0C8C0C8E-0C900C92-0CA80CAA-0CB30CB5-0CB90CBD0CDE0CE00CE10D05-0D0C0D0E-0D100D12-0D280D2A-0D390D3D0D600D610D7A-0D7F0D85-0D960D9A-0DB10DB3-0DBB0DBD0DC0-0DC60E01-0E300E320E330E40-0E450E810E820E840E870E880E8A0E8D0E94-0E970E99-0E9F0EA1-0EA30EA50EA70EAA0EAB0EAD-0EB00EB20EB30EBD0EC0-0EC40EDC0EDD0F000F40-0F470F49-0F6C0F88-0F8B1000-102A103F1050-1055105A-105D106110651066106E-10701075-1081108E10D0-10FA1100-1248124A-124D1250-12561258125A-125D1260-1288128A-128D1290-12B012B2-12B512B8-12BE12C012C2-12C512C8-12D612D8-13101312-13151318-135A1380-138F13A0-13F41401-166C166F-167F1681-169A16A0-16EA1700-170C170E-17111720-17311740-17511760-176C176E-17701780-17B317DC1820-18421844-18771880-18A818AA18B0-18F51900-191C1950-196D1970-19741980-19AB19C1-19C71A00-1A161A20-1A541B05-1B331B45-1B4B1B83-1BA01BAE1BAF1C00-1C231C4D-1C4F1C5A-1C771CE9-1CEC1CEE-1CF12135-21382D30-2D652D80-2D962DA0-2DA62DA8-2DAE2DB0-2DB62DB8-2DBE2DC0-2DC62DC8-2DCE2DD0-2DD62DD8-2DDE3006303C3041-3096309F30A1-30FA30FF3105-312D3131-318E31A0-31B731F0-31FF3400-4DB54E00-9FCBA000-A014A016-A48CA4D0-A4F7A500-A60BA610-A61FA62AA62BA66EA6A0-A6E5A7FB-A801A803-A805A807-A80AA80C-A822A840-A873A882-A8B3A8F2-A8F7A8FBA90A-A925A930-A946A960-A97CA984-A9B2AA00-AA28AA40-AA42AA44-AA4BAA60-AA6FAA71-AA76AA7AAA80-AAAFAAB1AAB5AAB6AAB9-AABDAAC0AAC2AADBAADCABC0-ABE2AC00-D7A3D7B0-D7C6D7CB-D7FBF900-FA2DFA30-FA6DFA70-FAD9FB1DFB1F-FB28FB2A-FB36FB38-FB3CFB3EFB40FB41FB43FB44FB46-FBB1FBD3-FD3DFD50-FD8FFD92-FDC7FDF0-FDFBFE70-FE74FE76-FEFCFF66-FF6FFF71-FF9DFFA0-FFBEFFC2-FFC7FFCA-FFCFFFD2-FFD7FFDA-FFDC",M:"0300-036F0483-04890591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DE-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0903093C093E-094E0951-0955096209630981-098309BC09BE-09C409C709C809CB-09CD09D709E209E30A01-0A030A3C0A3E-0A420A470A480A4B-0A4D0A510A700A710A750A81-0A830ABC0ABE-0AC50AC7-0AC90ACB-0ACD0AE20AE30B01-0B030B3C0B3E-0B440B470B480B4B-0B4D0B560B570B620B630B820BBE-0BC20BC6-0BC80BCA-0BCD0BD70C01-0C030C3E-0C440C46-0C480C4A-0C4D0C550C560C620C630C820C830CBC0CBE-0CC40CC6-0CC80CCA-0CCD0CD50CD60CE20CE30D020D030D3E-0D440D46-0D480D4A-0D4D0D570D620D630D820D830DCA0DCF-0DD40DD60DD8-0DDF0DF20DF30E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F3E0F3F0F71-0F840F860F870F90-0F970F99-0FBC0FC6102B-103E1056-1059105E-10601062-10641067-106D1071-10741082-108D108F109A-109D135F1712-17141732-1734175217531772177317B6-17D317DD180B-180D18A91920-192B1930-193B19B0-19C019C819C91A17-1A1B1A55-1A5E1A60-1A7C1A7F1B00-1B041B34-1B441B6B-1B731B80-1B821BA1-1BAA1C24-1C371CD0-1CD21CD4-1CE81CED1CF21DC0-1DE61DFD-1DFF20D0-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66F-A672A67CA67DA6F0A6F1A802A806A80BA823-A827A880A881A8B4-A8C4A8E0-A8F1A926-A92DA947-A953A980-A983A9B3-A9C0AA29-AA36AA43AA4CAA4DAA7BAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE3-ABEAABECABEDFB1EFE00-FE0FFE20-FE26",Mn:"0300-036F0483-04870591-05BD05BF05C105C205C405C505C70610-061A064B-065E067006D6-06DC06DF-06E406E706E806EA-06ED07110730-074A07A6-07B007EB-07F30816-0819081B-08230825-08270829-082D0900-0902093C0941-0948094D0951-095509620963098109BC09C1-09C409CD09E209E30A010A020A3C0A410A420A470A480A4B-0A4D0A510A700A710A750A810A820ABC0AC1-0AC50AC70AC80ACD0AE20AE30B010B3C0B3F0B41-0B440B4D0B560B620B630B820BC00BCD0C3E-0C400C46-0C480C4A-0C4D0C550C560C620C630CBC0CBF0CC60CCC0CCD0CE20CE30D41-0D440D4D0D620D630DCA0DD2-0DD40DD60E310E34-0E3A0E47-0E4E0EB10EB4-0EB90EBB0EBC0EC8-0ECD0F180F190F350F370F390F71-0F7E0F80-0F840F860F870F90-0F970F99-0FBC0FC6102D-10301032-10371039103A103D103E10581059105E-10601071-1074108210851086108D109D135F1712-17141732-1734175217531772177317B7-17BD17C617C9-17D317DD180B-180D18A91920-19221927192819321939-193B1A171A181A561A58-1A5E1A601A621A65-1A6C1A73-1A7C1A7F1B00-1B031B341B36-1B3A1B3C1B421B6B-1B731B801B811BA2-1BA51BA81BA91C2C-1C331C361C371CD0-1CD21CD4-1CE01CE2-1CE81CED1DC0-1DE61DFD-1DFF20D0-20DC20E120E5-20F02CEF-2CF12DE0-2DFF302A-302F3099309AA66FA67CA67DA6F0A6F1A802A806A80BA825A826A8C4A8E0-A8F1A926-A92DA947-A951A980-A982A9B3A9B6-A9B9A9BCAA29-AA2EAA31AA32AA35AA36AA43AA4CAAB0AAB2-AAB4AAB7AAB8AABEAABFAAC1ABE5ABE8ABEDFB1EFE00-FE0FFE20-FE26",Mc:"0903093E-09400949-094C094E0982098309BE-09C009C709C809CB09CC09D70A030A3E-0A400A830ABE-0AC00AC90ACB0ACC0B020B030B3E0B400B470B480B4B0B4C0B570BBE0BBF0BC10BC20BC6-0BC80BCA-0BCC0BD70C01-0C030C41-0C440C820C830CBE0CC0-0CC40CC70CC80CCA0CCB0CD50CD60D020D030D3E-0D400D46-0D480D4A-0D4C0D570D820D830DCF-0DD10DD8-0DDF0DF20DF30F3E0F3F0F7F102B102C10311038103B103C105610571062-10641067-106D108310841087-108C108F109A-109C17B617BE-17C517C717C81923-19261929-192B193019311933-193819B0-19C019C819C91A19-1A1B1A551A571A611A631A641A6D-1A721B041B351B3B1B3D-1B411B431B441B821BA11BA61BA71BAA1C24-1C2B1C341C351CE11CF2A823A824A827A880A881A8B4-A8C3A952A953A983A9B4A9B5A9BAA9BBA9BD-A9C0AA2FAA30AA33AA34AA4DAA7BABE3ABE4ABE6ABE7ABE9ABEAABEC",Me:"0488048906DE20DD-20E020E2-20E4A670-A672",N:"0030-003900B200B300B900BC-00BE0660-066906F0-06F907C0-07C90966-096F09E6-09EF09F4-09F90A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BF20C66-0C6F0C78-0C7E0CE6-0CEF0D66-0D750E50-0E590ED0-0ED90F20-0F331040-10491090-10991369-137C16EE-16F017E0-17E917F0-17F91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C5920702074-20792080-20892150-21822185-21892460-249B24EA-24FF2776-27932CFD30073021-30293038-303A3192-31953220-32293251-325F3280-328932B1-32BFA620-A629A6E6-A6EFA830-A835A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nd:"0030-00390660-066906F0-06F907C0-07C90966-096F09E6-09EF0A66-0A6F0AE6-0AEF0B66-0B6F0BE6-0BEF0C66-0C6F0CE6-0CEF0D66-0D6F0E50-0E590ED0-0ED90F20-0F291040-10491090-109917E0-17E91810-18191946-194F19D0-19DA1A80-1A891A90-1A991B50-1B591BB0-1BB91C40-1C491C50-1C59A620-A629A8D0-A8D9A900-A909A9D0-A9D9AA50-AA59ABF0-ABF9FF10-FF19",Nl:"16EE-16F02160-21822185-218830073021-30293038-303AA6E6-A6EF",No:"00B200B300B900BC-00BE09F4-09F90BF0-0BF20C78-0C7E0D70-0D750F2A-0F331369-137C17F0-17F920702074-20792080-20892150-215F21892460-249B24EA-24FF2776-27932CFD3192-31953220-32293251-325F3280-328932B1-32BFA830-A835",P:"0021-00230025-002A002C-002F003A003B003F0040005B-005D005F007B007D00A100AB00B700BB00BF037E0387055A-055F0589058A05BE05C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F3A-0F3D0F850FD0-0FD4104A-104F10FB1361-13681400166D166E169B169C16EB-16ED1735173617D4-17D617D8-17DA1800-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD32010-20272030-20432045-20512053-205E207D207E208D208E2329232A2768-277527C527C627E6-27EF2983-299829D8-29DB29FC29FD2CF9-2CFC2CFE2CFF2E00-2E2E2E302E313001-30033008-30113014-301F3030303D30A030FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFD3EFD3FFE10-FE19FE30-FE52FE54-FE61FE63FE68FE6AFE6BFF01-FF03FF05-FF0AFF0C-FF0FFF1AFF1BFF1FFF20FF3B-FF3DFF3FFF5BFF5DFF5F-FF65",Pd:"002D058A05BE140018062010-20152E172E1A301C303030A0FE31FE32FE58FE63FF0D",Ps:"0028005B007B0F3A0F3C169B201A201E2045207D208D23292768276A276C276E27702772277427C527E627E827EA27EC27EE2983298529872989298B298D298F299129932995299729D829DA29FC2E222E242E262E283008300A300C300E3010301430163018301A301DFD3EFE17FE35FE37FE39FE3BFE3DFE3FFE41FE43FE47FE59FE5BFE5DFF08FF3BFF5BFF5FFF62",Pe:"0029005D007D0F3B0F3D169C2046207E208E232A2769276B276D276F27712773277527C627E727E927EB27ED27EF298429862988298A298C298E2990299229942996299829D929DB29FD2E232E252E272E293009300B300D300F3011301530173019301B301E301FFD3FFE18FE36FE38FE3AFE3CFE3EFE40FE42FE44FE48FE5AFE5CFE5EFF09FF3DFF5DFF60FF63",Pi:"00AB2018201B201C201F20392E022E042E092E0C2E1C2E20",Pf:"00BB2019201D203A2E032E052E0A2E0D2E1D2E21",Pc:"005F203F20402054FE33FE34FE4D-FE4FFF3F",Po:"0021-00230025-0027002A002C002E002F003A003B003F0040005C00A100B700BF037E0387055A-055F058905C005C305C605F305F40609060A060C060D061B061E061F066A-066D06D40700-070D07F7-07F90830-083E0964096509700DF40E4F0E5A0E5B0F04-0F120F850FD0-0FD4104A-104F10FB1361-1368166D166E16EB-16ED1735173617D4-17D617D8-17DA1800-18051807-180A1944194519DE19DF1A1E1A1F1AA0-1AA61AA8-1AAD1B5A-1B601C3B-1C3F1C7E1C7F1CD3201620172020-20272030-2038203B-203E2041-20432047-205120532055-205E2CF9-2CFC2CFE2CFF2E002E012E06-2E082E0B2E0E-2E162E182E192E1B2E1E2E1F2E2A-2E2E2E302E313001-3003303D30FBA4FEA4FFA60D-A60FA673A67EA6F2-A6F7A874-A877A8CEA8CFA8F8-A8FAA92EA92FA95FA9C1-A9CDA9DEA9DFAA5C-AA5FAADEAADFABEBFE10-FE16FE19FE30FE45FE46FE49-FE4CFE50-FE52FE54-FE57FE5F-FE61FE68FE6AFE6BFF01-FF03FF05-FF07FF0AFF0CFF0EFF0FFF1AFF1BFF1FFF20FF3CFF61FF64FF65",S:"0024002B003C-003E005E0060007C007E00A2-00A900AC00AE-00B100B400B600B800D700F702C2-02C502D2-02DF02E5-02EB02ED02EF-02FF03750384038503F604820606-0608060B060E060F06E906FD06FE07F609F209F309FA09FB0AF10B700BF3-0BFA0C7F0CF10CF20D790E3F0F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-139917DB194019E0-19FF1B61-1B6A1B74-1B7C1FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE20442052207A-207C208A-208C20A0-20B8210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B2140-2144214A-214D214F2190-2328232B-23E82400-24262440-244A249C-24E92500-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE27C0-27C427C7-27CA27CC27D0-27E527F0-29822999-29D729DC-29FB29FE-2B4C2B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F309B309C319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A700-A716A720A721A789A78AA828-A82BA836-A839AA77-AA79FB29FDFCFDFDFE62FE64-FE66FE69FF04FF0BFF1C-FF1EFF3EFF40FF5CFF5EFFE0-FFE6FFE8-FFEEFFFCFFFD",Sm:"002B003C-003E007C007E00AC00B100D700F703F60606-060820442052207A-207C208A-208C2140-2144214B2190-2194219A219B21A021A321A621AE21CE21CF21D221D421F4-22FF2308-230B23202321237C239B-23B323DC-23E125B725C125F8-25FF266F27C0-27C427C7-27CA27CC27D0-27E527F0-27FF2900-29822999-29D729DC-29FB29FE-2AFF2B30-2B442B47-2B4CFB29FE62FE64-FE66FF0BFF1C-FF1EFF5CFF5EFFE2FFE9-FFEC",Sc:"002400A2-00A5060B09F209F309FB0AF10BF90E3F17DB20A0-20B8A838FDFCFE69FF04FFE0FFE1FFE5FFE6",Sk:"005E006000A800AF00B400B802C2-02C502D2-02DF02E5-02EB02ED02EF-02FF0375038403851FBD1FBF-1FC11FCD-1FCF1FDD-1FDF1FED-1FEF1FFD1FFE309B309CA700-A716A720A721A789A78AFF3EFF40FFE3",So:"00A600A700A900AE00B000B60482060E060F06E906FD06FE07F609FA0B700BF3-0BF80BFA0C7F0CF10CF20D790F01-0F030F13-0F170F1A-0F1F0F340F360F380FBE-0FC50FC7-0FCC0FCE0FCF0FD5-0FD8109E109F13601390-1399194019E0-19FF1B61-1B6A1B74-1B7C210021012103-21062108210921142116-2118211E-2123212521272129212E213A213B214A214C214D214F2195-2199219C-219F21A121A221A421A521A7-21AD21AF-21CD21D021D121D321D5-21F32300-2307230C-231F2322-2328232B-237B237D-239A23B4-23DB23E2-23E82400-24262440-244A249C-24E92500-25B625B8-25C025C2-25F72600-266E2670-26CD26CF-26E126E326E8-26FF2701-27042706-2709270C-27272729-274B274D274F-27522756-275E2761-276727942798-27AF27B1-27BE2800-28FF2B00-2B2F2B452B462B50-2B592CE5-2CEA2E80-2E992E9B-2EF32F00-2FD52FF0-2FFB300430123013302030363037303E303F319031913196-319F31C0-31E33200-321E322A-32503260-327F328A-32B032C0-32FE3300-33FF4DC0-4DFFA490-A4C6A828-A82BA836A837A839AA77-AA79FDFDFFE4FFE8FFEDFFEEFFFCFFFD",Z:"002000A01680180E2000-200A20282029202F205F3000",Zs:"002000A01680180E2000-200A202F205F3000",Zl:"2028",Zp:"2029",C:"0000-001F007F-009F00AD03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-0605061C061D0620065F06DD070E070F074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17B417B517DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF200B-200F202A-202E2060-206F20722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-F8FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFD-FF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFFBFFFEFFFF",Cc:"0000-001F007F-009F",Cf:"00AD0600-060306DD070F17B417B5200B-200F202A-202E2060-2064206A-206FFEFFFFF9-FFFB",Co:"E000-F8FF",Cs:"D800-DFFF",Cn:"03780379037F-0383038B038D03A20526-05300557055805600588058B-059005C8-05CF05EB-05EF05F5-05FF06040605061C061D0620065F070E074B074C07B2-07BF07FB-07FF082E082F083F-08FF093A093B094F095609570973-097809800984098D098E0991099209A909B109B3-09B509BA09BB09C509C609C909CA09CF-09D609D8-09DB09DE09E409E509FC-0A000A040A0B-0A0E0A110A120A290A310A340A370A3A0A3B0A3D0A43-0A460A490A4A0A4E-0A500A52-0A580A5D0A5F-0A650A76-0A800A840A8E0A920AA90AB10AB40ABA0ABB0AC60ACA0ACE0ACF0AD1-0ADF0AE40AE50AF00AF2-0B000B040B0D0B0E0B110B120B290B310B340B3A0B3B0B450B460B490B4A0B4E-0B550B58-0B5B0B5E0B640B650B72-0B810B840B8B-0B8D0B910B96-0B980B9B0B9D0BA0-0BA20BA5-0BA70BAB-0BAD0BBA-0BBD0BC3-0BC50BC90BCE0BCF0BD1-0BD60BD8-0BE50BFB-0C000C040C0D0C110C290C340C3A-0C3C0C450C490C4E-0C540C570C5A-0C5F0C640C650C70-0C770C800C810C840C8D0C910CA90CB40CBA0CBB0CC50CC90CCE-0CD40CD7-0CDD0CDF0CE40CE50CF00CF3-0D010D040D0D0D110D290D3A-0D3C0D450D490D4E-0D560D58-0D5F0D640D650D76-0D780D800D810D840D97-0D990DB20DBC0DBE0DBF0DC7-0DC90DCB-0DCE0DD50DD70DE0-0DF10DF5-0E000E3B-0E3E0E5C-0E800E830E850E860E890E8B0E8C0E8E-0E930E980EA00EA40EA60EA80EA90EAC0EBA0EBE0EBF0EC50EC70ECE0ECF0EDA0EDB0EDE-0EFF0F480F6D-0F700F8C-0F8F0F980FBD0FCD0FD9-0FFF10C6-10CF10FD-10FF1249124E124F12571259125E125F1289128E128F12B112B612B712BF12C112C612C712D7131113161317135B-135E137D-137F139A-139F13F5-13FF169D-169F16F1-16FF170D1715-171F1737-173F1754-175F176D17711774-177F17DE17DF17EA-17EF17FA-17FF180F181A-181F1878-187F18AB-18AF18F6-18FF191D-191F192C-192F193C-193F1941-1943196E196F1975-197F19AC-19AF19CA-19CF19DB-19DD1A1C1A1D1A5F1A7D1A7E1A8A-1A8F1A9A-1A9F1AAE-1AFF1B4C-1B4F1B7D-1B7F1BAB-1BAD1BBA-1BFF1C38-1C3A1C4A-1C4C1C80-1CCF1CF3-1CFF1DE7-1DFC1F161F171F1E1F1F1F461F471F4E1F4F1F581F5A1F5C1F5E1F7E1F7F1FB51FC51FD41FD51FDC1FF01FF11FF51FFF2065-206920722073208F2095-209F20B9-20CF20F1-20FF218A-218F23E9-23FF2427-243F244B-245F26CE26E226E4-26E727002705270A270B2728274C274E2753-2755275F27602795-279727B027BF27CB27CD-27CF2B4D-2B4F2B5A-2BFF2C2F2C5F2CF2-2CF82D26-2D2F2D66-2D6E2D70-2D7F2D97-2D9F2DA72DAF2DB72DBF2DC72DCF2DD72DDF2E32-2E7F2E9A2EF4-2EFF2FD6-2FEF2FFC-2FFF3040309730983100-3104312E-3130318F31B8-31BF31E4-31EF321F32FF4DB6-4DBF9FCC-9FFFA48D-A48FA4C7-A4CFA62C-A63FA660A661A674-A67BA698-A69FA6F8-A6FFA78D-A7FAA82C-A82FA83A-A83FA878-A87FA8C5-A8CDA8DA-A8DFA8FC-A8FFA954-A95EA97D-A97FA9CEA9DA-A9DDA9E0-A9FFAA37-AA3FAA4EAA4FAA5AAA5BAA7C-AA7FAAC3-AADAAAE0-ABBFABEEABEFABFA-ABFFD7A4-D7AFD7C7-D7CAD7FC-D7FFFA2EFA2FFA6EFA6FFADA-FAFFFB07-FB12FB18-FB1CFB37FB3DFB3FFB42FB45FBB2-FBD2FD40-FD4FFD90FD91FDC8-FDEFFDFEFDFFFE1A-FE1FFE27-FE2FFE53FE67FE6C-FE6FFE75FEFDFEFEFF00FFBF-FFC1FFC8FFC9FFD0FFD1FFD8FFD9FFDD-FFDFFFE7FFEF-FFF8FFFEFFFF"})}),define("ace/token_iterator",["require","exports","module"],function(e,t,i){"use strict";var n=function(e,t,i){this.$session=e,this.$row=t,this.$rowTokens=e.getTokens(t);var n=e.getTokenAt(t,i);this.$tokenIndex=n?n.index:-1};(function(){this.stepBackward=function(){for(this.$tokenIndex-=1;this.$tokenIndex<0;){if(this.$row-=1,this.$row<0)return this.$row=0,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=this.$rowTokens.length-1}return this.$rowTokens[this.$tokenIndex]},this.stepForward=function(){this.$tokenIndex+=1;for(var e;this.$tokenIndex>=this.$rowTokens.length;){if(this.$row+=1,e||(e=this.$session.getLength()),this.$row>=e)return this.$row=e-1,null;this.$rowTokens=this.$session.getTokens(this.$row),this.$tokenIndex=0}return this.$rowTokens[this.$tokenIndex]},this.getCurrentToken=function(){return this.$rowTokens[this.$tokenIndex]},this.getCurrentTokenRow=function(){return this.$row},this.getCurrentTokenColumn=function(){var e=this.$rowTokens,t=this.$tokenIndex,i=e[t].start;if(void 0!==i)return i;for(i=0;t>0;)t-=1,i+=e[t].value.length;return i}}).call(n.prototype),t.TokenIterator=n}),define("ace/mode/text",["require","exports","module","../tokenizer","./text_highlight_rules","./behaviour","../unicode","../lib/lang","../token_iterator","../range"],function(e,t,i){"use strict";var n=e("../tokenizer").Tokenizer,s=e("./text_highlight_rules").TextHighlightRules,r=e("./behaviour").Behaviour,o=e("../unicode"),a=e("../lib/lang"),l=e("../token_iterator").TokenIterator,c=e("../range").Range,u=function(){this.$tokenizer=new n((new s).getRules()),this.$behaviour=new r};(function(){this.tokenRe=new RegExp("^["+o.packages.L+o.packages.Mn+o.packages.Mc+o.packages.Nd+o.packages.Pc+"\\$_]+","g"),this.nonTokenRe=new RegExp("^(?:[^"+o.packages.L+o.packages.Mn+o.packages.Mc+o.packages.Nd+o.packages.Pc+"\\$_]|s])+","g"),this.getTokenizer=function(){return this.$tokenizer},this.lineCommentStart="",this.blockComment="",this.toggleCommentLines=function(e,t,i,n){function s(e){for(var t=i;n>=t;t++)e(r.getLine(t),t)}var r=t.doc,o=!0,l=!0,c=1/0,u=t.getTabSize(),h=!1;if(this.lineCommentStart){if(Array.isArray(this.lineCommentStart))var d=this.lineCommentStart.map(a.escapeRegExp).join("|"),p=this.lineCommentStart[0];else var d=a.escapeRegExp(this.lineCommentStart),p=this.lineCommentStart;d=new RegExp("^(\\s*)(?:"+d+") ?"),h=t.getUseSoftTabs();var f=function(e,t){var i=e.match(d);if(i){var n=i[1].length,s=i[0].length;y(e,n,s)||" "!=i[0][s-1]||s--,r.removeInLine(t,n,s)}},g=p+" ",m=function(e,t){(!o||/\S/.test(e))&&(y(e,c,c)?r.insertInLine({row:t,column:c},g):r.insertInLine({row:t,column:c},p))},v=function(e,t){return d.test(e)},y=function(e,t,i){for(var n=0;t--&&" "==e.charAt(t);)n++;if(n%u!=0)return!1;for(var n=0;" "==e.charAt(i++);)n++;return u>2?n%u!=u-1:n%u==0}}else{if(!this.blockComment)return!1;var p=this.blockComment.start,_=this.blockComment.end,d=new RegExp("^(\\s*)(?:"+a.escapeRegExp(p)+")"),b=new RegExp("(?:"+a.escapeRegExp(_)+")\\s*$"),m=function(e,t){v(e,t)||(!o||/\S/.test(e))&&(r.insertInLine({row:t,column:e.length},_),r.insertInLine({row:t,column:c},p))},f=function(e,t){var i;(i=e.match(b))&&r.removeInLine(t,e.length-i[0].length,e.length),(i=e.match(d))&&r.removeInLine(t,i[1].length,i[0].length)},v=function(e,i){if(d.test(e))return!0;for(var n=t.getTokens(i),s=0;s<n.length;s++)if("comment"===n[s].type)return!0}}var w=1/0;s(function(e,t){var i=e.search(/\S/);-1!==i?(c>i&&(c=i),l&&!v(e,t)&&(l=!1)):w>e.length&&(w=e.length)}),c==1/0&&(c=w,o=!1,l=!1),h&&c%u!=0&&(c=Math.floor(c/u)*u),s(l?f:m)},this.toggleBlockComment=function(e,t,i,n){var s=this.blockComment;if(s){!s.start&&s[0]&&(s=s[0]);var r,o,a=new l(t,n.row,n.column),u=a.getCurrentToken(),h=(t.selection,t.selection.toOrientedRange());if(u&&/comment/.test(u.type)){for(var d,p;u&&/comment/.test(u.type);){var f=u.value.indexOf(s.start);if(-1!=f){var g=a.getCurrentTokenRow(),m=a.getCurrentTokenColumn()+f;d=new c(g,m,g,m+s.start.length);break}u=a.stepBackward()}for(var a=new l(t,n.row,n.column),u=a.getCurrentToken();u&&/comment/.test(u.type);){var f=u.value.indexOf(s.end);if(-1!=f){var g=a.getCurrentTokenRow(),m=a.getCurrentTokenColumn()+f;p=new c(g,m,g,m+s.end.length);break}u=a.stepForward()}p&&t.remove(p),d&&(t.remove(d),r=d.start.row,o=-s.start.length)}else o=s.start.length,r=i.start.row,t.insert(i.end,s.end),t.insert(i.start,s.start);h.start.row==r&&(h.start.column+=o),h.end.row==r&&(h.end.column+=o),t.selection.fromOrientedRange(h)}},this.getNextLineIndent=function(e,t,i){return this.$getIndent(t)},this.checkOutdent=function(e,t,i){return!1},this.autoOutdent=function(e,t,i){},this.$getIndent=function(e){return e.match(/^\s*/)[0]},this.createWorker=function(e){return null},this.createModeDelegates=function(e){if(this.$embeds){this.$modes={};for(var t=0;t<this.$embeds.length;t++)e[this.$embeds[t]]&&(this.$modes[this.$embeds[t]]=new e[this.$embeds[t]]);for(var i=["toggleCommentLines","getNextLineIndent","checkOutdent","autoOutdent","transformAction"],t=0;t<i.length;t++)!function(e){var n=i[t],s=e[n];e[i[t]]=function(){return this.$delegator(n,arguments,s)}}(this)}},this.$delegator=function(e,t,i){var n=t[0];"string"!=typeof n&&(n=n[0]);for(var s=0;s<this.$embeds.length;s++)if(this.$modes[this.$embeds[s]]){var r=n.split(this.$embeds[s]);if(!r[0]&&r[1]){t[0]=r[1];var o=this.$modes[this.$embeds[s]];return o[e].apply(o,t)}}var a=i.apply(this,t);return i?a:void 0},this.transformAction=function(e,t,i,n,s){if(this.$behaviour){var r=this.$behaviour.getBehaviours();for(var o in r)if(r[o][t]){var a=r[o][t].apply(this,arguments);if(a)return a}}}}).call(u.prototype),t.Mode=u}),define("ace/anchor",["require","exports","module","./lib/oop","./lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,r=t.Anchor=function(e,t,i){this.document=e,"undefined"==typeof i?this.setPosition(t.row,t.column):this.setPosition(t,i),this.$onChange=this.onChange.bind(this),e.on("change",this.$onChange)};(function(){n.implement(this,s),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.onChange=function(e){var t=e.data,i=t.range;if((i.start.row!=i.end.row||i.start.row==this.row)&&!(i.start.row>this.row||i.start.row==this.row&&i.start.column>this.column)){var n=this.row,s=this.column,r=i.start,o=i.end;"insertText"===t.action?r.row===n&&r.column<=s?r.row===o.row?s+=o.column-r.column:(s-=r.column,n+=o.row-r.row):r.row!==o.row&&r.row<n&&(n+=o.row-r.row):"insertLines"===t.action?r.row<=n&&(n+=o.row-r.row):"removeText"===t.action?r.row===n&&r.column<s?s=o.column>=s?r.column:Math.max(0,s-(o.column-r.column)):r.row!==o.row&&r.row<n?(o.row===n&&(s=Math.max(0,s-o.column)+r.column),n-=o.row-r.row):o.row===n&&(n-=o.row-r.row,s=Math.max(0,s-o.column)+r.column):"removeLines"==t.action&&r.row<=n&&(o.row<=n?n-=o.row-r.row:(n=r.row,s=0)),this.setPosition(n,s,!0)}},this.setPosition=function(e,t,i){var n;if(n=i?{row:e,column:t}:this.$clipPositionToDocument(e,t),this.row!=n.row||this.column!=n.column){var s={row:this.row,column:this.column};this.row=n.row,this.column=n.column,this._emit("change",{old:s,value:n})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.$clipPositionToDocument=function(e,t){var i={};return e>=this.document.getLength()?(i.row=Math.max(0,this.document.getLength()-1),i.column=this.document.getLine(i.row).length):0>e?(i.row=0,i.column=0):(i.row=e,i.column=Math.min(this.document.getLine(i.row).length,Math.max(0,t))),0>t&&(i.column=0),i}}).call(r.prototype)}),define("ace/document",["require","exports","module","./lib/oop","./lib/event_emitter","./range","./anchor"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,r=e("./range").Range,o=e("./anchor").Anchor,a=function(e){this.$lines=[],0==e.length?this.$lines=[""]:Array.isArray(e)?this._insertLines(0,e):this.insert({row:0,column:0},e)};(function(){n.implement(this,s),this.setValue=function(e){var t=this.getLength();this.remove(new r(0,0,t,this.getLine(t-1).length)),this.insert({row:0,column:0},e)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(e,t){return new o(this,e,t)},0=="aaa".split(/a/).length?this.$split=function(e){return e.replace(/\r\n|\r/g,"\n").split("\n")}:this.$split=function(e){return e.split(/\r\n|\r|\n/)},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=t?t[1]:"\n"},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\r\n";case"unix":return"\n";default:return this.$autoNewLine}},this.$autoNewLine="\n",this.$newLineMode="auto",this.setNewLineMode=function(e){this.$newLineMode!==e&&(this.$newLineMode=e)},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(e){return"\r\n"==e||"\r"==e||"\n"==e},this.getLine=function(e){return this.$lines[e]||""},this.getLines=function(e,t){return this.$lines.slice(e,t+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(e){if(e.start.row==e.end.row)return this.$lines[e.start.row].substring(e.start.column,e.end.column);var t=this.getLines(e.start.row,e.end.row);t[0]=(t[0]||"").substring(e.start.column);var i=t.length-1;return e.end.row-e.start.row==i&&(t[i]=t[i].substring(0,e.end.column)),t.join(this.getNewLineCharacter())},this.$clipPosition=function(e){var t=this.getLength();return e.row>=t?(e.row=Math.max(0,t-1),e.column=this.getLine(t-1).length):e.row<0&&(e.row=0),e},this.insert=function(e,t){if(!t||0===t.length)return e;e=this.$clipPosition(e),this.getLength()<=1&&this.$detectNewLine(t);var i=this.$split(t),n=i.splice(0,1)[0],s=0==i.length?null:i.splice(i.length-1,1)[0];return e=this.insertInLine(e,n),null!==s&&(e=this.insertNewLine(e),e=this._insertLines(e.row,i),e=this.insertInLine(e,s||"")),e},this.insertLines=function(e,t){return e>=this.getLength()?this.insert({row:e,column:0},"\n"+t.join("\n")):this._insertLines(Math.max(e,0),t)},this._insertLines=function(e,t){if(0==t.length)return{row:e,column:0};if(t.length>65535){var i=this._insertLines(e,t.slice(65535));t=t.slice(0,65535)}var n=[e,0];n.push.apply(n,t),this.$lines.splice.apply(this.$lines,n);var s=new r(e,0,e+t.length,0),o={action:"insertLines",range:s,lines:t};return this._emit("change",{data:o}),i||s.end},this.insertNewLine=function(e){e=this.$clipPosition(e);var t=this.$lines[e.row]||"";this.$lines[e.row]=t.substring(0,e.column),this.$lines.splice(e.row+1,0,t.substring(e.column,t.length));var i={row:e.row+1,column:0},n={action:"insertText",range:r.fromPoints(e,i),text:this.getNewLineCharacter()};return this._emit("change",{data:n}),i},this.insertInLine=function(e,t){if(0==t.length)return e;var i=this.$lines[e.row]||"";this.$lines[e.row]=i.substring(0,e.column)+t+i.substring(e.column);var n={row:e.row,column:e.column+t.length},s={action:"insertText",range:r.fromPoints(e,n),text:t};return this._emit("change",{data:s}),n},this.remove=function(e){if(e.start=this.$clipPosition(e.start),e.end=this.$clipPosition(e.end),e.isEmpty())return e.start;var t=e.start.row,i=e.end.row;if(e.isMultiLine()){var n=0==e.start.column?t:t+1,s=i-1;e.end.column>0&&this.removeInLine(i,0,e.end.column),s>=n&&this._removeLines(n,s),n!=t&&(this.removeInLine(t,e.start.column,this.getLine(t).length),this.removeNewLine(e.start.row))}else this.removeInLine(t,e.start.column,e.end.column);return e.start},this.removeInLine=function(e,t,i){if(t!=i){var n=new r(e,t,e,i),s=this.getLine(e),o=s.substring(t,i),a=s.substring(0,t)+s.substring(i,s.length);this.$lines.splice(e,1,a);var l={action:"removeText",range:n,text:o};return this._emit("change",{data:l}),n.start}},this.removeLines=function(e,t){return 0>e||t>=this.getLength()?this.remove(new r(e,0,t+1,0)):this._removeLines(e,t);
},this._removeLines=function(e,t){var i=new r(e,0,t+1,0),n=this.$lines.splice(e,t-e+1),s={action:"removeLines",range:i,nl:this.getNewLineCharacter(),lines:n};return this._emit("change",{data:s}),n},this.removeNewLine=function(e){var t=this.getLine(e),i=this.getLine(e+1),n=new r(e,t.length,e+1,0),s=t+i;this.$lines.splice(e,2,s);var o={action:"removeText",range:n,text:this.getNewLineCharacter()};this._emit("change",{data:o})},this.replace=function(e,t){if(0==t.length&&e.isEmpty())return e.start;if(t==this.getTextRange(e))return e.end;if(this.remove(e),t)var i=this.insert(e.start,t);else i=e.start;return i},this.applyDeltas=function(e){for(var t=0;t<e.length;t++){var i=e[t],n=r.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this.insertLines(n.start.row,i.lines):"insertText"==i.action?this.insert(n.start,i.text):"removeLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"removeText"==i.action&&this.remove(n)}},this.revertDeltas=function(e){for(var t=e.length-1;t>=0;t--){var i=e[t],n=r.fromPoints(i.range.start,i.range.end);"insertLines"==i.action?this._removeLines(n.start.row,n.end.row-1):"insertText"==i.action?this.remove(n):"removeLines"==i.action?this._insertLines(n.start.row,i.lines):"removeText"==i.action&&this.insert(n.start,i.text)}},this.indexToPosition=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=t||0,r=i.length;r>s;s++)if(e-=i[s].length+n,0>e)return{row:s,column:e+i[s].length+n};return{row:r-1,column:i[r-1].length}},this.positionToIndex=function(e,t){for(var i=this.$lines||this.getAllLines(),n=this.getNewLineCharacter().length,s=0,r=Math.min(e.row,i.length),o=t||0;r>o;++o)s+=i[o].length+n;return s+e.column}}).call(a.prototype),t.Document=a}),define("ace/background_tokenizer",["require","exports","module","./lib/oop","./lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/event_emitter").EventEmitter,r=function(e,t){this.running=!1,this.lines=[],this.states=[],this.currentLine=0,this.tokenizer=e;var i=this;this.$worker=function(){if(i.running){for(var e=new Date,t=i.currentLine,n=i.doc,s=0,r=n.getLength();i.currentLine<r;){for(i.$tokenizeRow(i.currentLine);i.lines[i.currentLine];)i.currentLine++;if(s++,s%5==0&&new Date-e>20)return i.fireUpdateEvent(t,i.currentLine-1),void(i.running=setTimeout(i.$worker,20))}i.running=!1,i.fireUpdateEvent(t,r-1)}}};(function(){n.implement(this,s),this.setTokenizer=function(e){this.tokenizer=e,this.lines=[],this.states=[],this.start(0)},this.setDocument=function(e){this.doc=e,this.lines=[],this.states=[],this.stop()},this.fireUpdateEvent=function(e,t){var i={first:e,last:t};this._emit("update",{data:i})},this.start=function(e){this.currentLine=Math.min(e||0,this.currentLine,this.doc.getLength()),this.lines.splice(this.currentLine,this.lines.length),this.states.splice(this.currentLine,this.states.length),this.stop(),this.running=setTimeout(this.$worker,700)},this.$updateOnChange=function(e){var t=e.range,i=t.start.row,n=t.end.row-i;if(0===n)this.lines[i]=null;else if("removeText"==e.action||"removeLines"==e.action)this.lines.splice(i,n+1,null),this.states.splice(i,n+1,null);else{var s=Array(n+1);s.unshift(i,1),this.lines.splice.apply(this.lines,s),this.states.splice.apply(this.states,s)}this.currentLine=Math.min(i,this.currentLine,this.doc.getLength()),this.stop(),this.running=setTimeout(this.$worker,700)},this.stop=function(){this.running&&clearTimeout(this.running),this.running=!1},this.getTokens=function(e){return this.lines[e]||this.$tokenizeRow(e)},this.getState=function(e){return this.currentLine==e&&this.$tokenizeRow(e),this.states[e]||"start"},this.$tokenizeRow=function(e){var t=this.doc.getLine(e),i=this.states[e-1],n=this.tokenizer.getLineTokens(t,i,e);return this.states[e]+""!=n.state+""?(this.states[e]=n.state,this.lines[e+1]=null,this.currentLine>e+1&&(this.currentLine=e+1)):this.currentLine==e&&(this.currentLine=e+1),this.lines[e]=n.tokens}}).call(r.prototype),t.BackgroundTokenizer=r}),define("ace/search_highlight",["require","exports","module","./lib/lang","./lib/oop","./range"],function(e,t,i){"use strict";var n=e("./lib/lang"),s=(e("./lib/oop"),e("./range").Range),r=function(e,t,i){this.setRegexp(e),this.clazz=t,this.type=i||"text"};(function(){this.MAX_RANGES=500,this.setRegexp=function(e){this.regExp+""!=e+""&&(this.regExp=e,this.cache=[])},this.update=function(e,t,i,r){if(this.regExp)for(var o=r.firstRow,a=r.lastRow,l=o;a>=l;l++){var c=this.cache[l];null==c&&(c=n.getMatchOffsets(i.getLine(l),this.regExp),c.length>this.MAX_RANGES&&(c=c.slice(0,this.MAX_RANGES)),c=c.map(function(e){return new s(l,e.offset,l,e.offset+e.length)}),this.cache[l]=c.length?c:"");for(var u=c.length;u--;)t.drawSingleLineMarker(e,c[u].toScreenRange(i),this.clazz,r)}}}).call(r.prototype),t.SearchHighlight=r}),define("ace/edit_session/fold_line",["require","exports","module","../range"],function(e,t,i){"use strict";function n(e,t){this.foldData=e,Array.isArray(t)?this.folds=t:t=this.folds=[t];var i=t[t.length-1];this.range=new s(t[0].start.row,t[0].start.column,i.end.row,i.end.column),this.start=this.range.start,this.end=this.range.end,this.folds.forEach(function(e){e.setFoldLine(this)},this)}var s=e("../range").Range;(function(){this.shiftRow=function(e){this.start.row+=e,this.end.row+=e,this.folds.forEach(function(t){t.start.row+=e,t.end.row+=e})},this.addFold=function(e){if(e.sameRow){if(e.start.row<this.startRow||e.endRow>this.endRow)throw"Can't add a fold to this FoldLine as it has no connection";this.folds.push(e),this.folds.sort(function(e,t){return-e.range.compareEnd(t.start.row,t.start.column)}),this.range.compareEnd(e.start.row,e.start.column)>0?(this.end.row=e.end.row,this.end.column=e.end.column):this.range.compareStart(e.end.row,e.end.column)<0&&(this.start.row=e.start.row,this.start.column=e.start.column)}else if(e.start.row==this.end.row)this.folds.push(e),this.end.row=e.end.row,this.end.column=e.end.column;else{if(e.end.row!=this.start.row)throw"Trying to add fold to FoldRow that doesn't have a matching row";this.folds.unshift(e),this.start.row=e.start.row,this.start.column=e.start.column}e.foldLine=this},this.containsRow=function(e){return e>=this.start.row&&e<=this.end.row},this.walk=function(e,t,i){var n,s,r,o=0,a=this.folds,l=!0;null==t&&(t=this.end.row,i=this.end.column);for(var c=0;c<a.length;c++){if(n=a[c],s=n.range.compareStart(t,i),-1==s)return void e(null,t,i,o,l);if(r=e(null,n.start.row,n.start.column,o,l),r=!r&&e(n.placeholder,n.start.row,n.start.column,o),r||0==s)return;l=!n.sameRow,o=n.end.column}e(null,t,i,o,l)},this.getNextFoldTo=function(e,t){for(var i,n,s=0;s<this.folds.length;s++){if(i=this.folds[s],n=i.range.compareEnd(e,t),-1==n)return{fold:i,kind:"after"};if(0==n)return{fold:i,kind:"inside"}}return null},this.addRemoveChars=function(e,t,i){var n,s,r=this.getNextFoldTo(e,t);if(r)if(n=r.fold,"inside"==r.kind&&n.start.column!=t&&n.start.row!=e)window.console&&window.console.log(e,t,n);else if(n.start.row==e){s=this.folds;var o=s.indexOf(n);for(0==o&&(this.start.column+=i),o;o<s.length;o++){if(n=s[o],n.start.column+=i,!n.sameRow)return;n.end.column+=i}this.end.column+=i}},this.split=function(e,t){var i=this.getNextFoldTo(e,t).fold,s=this.folds,r=this.foldData;if(!i)return null;var o=s.indexOf(i),a=s[o-1];this.end.row=a.end.row,this.end.column=a.end.column,s=s.splice(o,s.length-o);var l=new n(r,s);return r.splice(r.indexOf(this)+1,0,l),l},this.merge=function(e){for(var t=e.folds,i=0;i<t.length;i++)this.addFold(t[i]);var n=this.foldData;n.splice(n.indexOf(e),1)},this.toString=function(){var e=[this.range.toString()+": ["];return this.folds.forEach(function(t){e.push("  "+t.toString())}),e.push("]"),e.join("\n")},this.idxToPosition=function(e){for(var t,i=0,n=0;n<this.folds.length;n++){var t=this.folds[n];if(e-=t.start.column-i,0>e)return{row:t.start.row,column:t.start.column+e};if(e-=t.placeholder.length,0>e)return t.start;i=t.end.column}return{row:this.end.row,column:this.end.column+e}}}).call(n.prototype),t.FoldLine=n}),define("ace/range_list",["require","exports","module","./range"],function(e,t,i){"use strict";var n=e("./range").Range,s=n.comparePoints,r=function(){this.ranges=[]};(function(){this.comparePoints=s,this.pointIndex=function(e,t,i){for(var n=this.ranges,r=i||0;r<n.length;r++){var o=n[r],a=s(e,o.end);if(!(a>0)){var l=s(e,o.start);return 0===a?t&&0!==l?-r-2:r:l>0||0===l&&!t?r:-r-1}}return-r-1},this.add=function(e){var t=!e.isEmpty(),i=this.pointIndex(e.start,t);0>i&&(i=-i-1);var n=this.pointIndex(e.end,t,i);return 0>n?n=-n-1:n++,this.ranges.splice(i,n-i,e)},this.addList=function(e){for(var t=[],i=e.length;i--;)t.push.call(t,this.add(e[i]));return t},this.substractPoint=function(e){var t=this.pointIndex(e);return t>=0?this.ranges.splice(t,1):void 0},this.merge=function(){var e=[],t=this.ranges;t=t.sort(function(e,t){return s(e.start,t.start)});for(var i,n=t[0],r=1;r<t.length;r++){i=n,n=t[r];var o=s(i.end,n.start);0>o||(0!=o||i.isEmpty()||n.isEmpty())&&(s(i.end,n.end)<0&&(i.end.row=n.end.row,i.end.column=n.end.column),t.splice(r,1),e.push(n),n=i,r--)}return this.ranges=t,e},this.contains=function(e,t){return this.pointIndex({row:e,column:t})>=0},this.containsPoint=function(e){return this.pointIndex(e)>=0},this.rangeAtPoint=function(e){var t=this.pointIndex(e);return t>=0?this.ranges[t]:void 0},this.clipRows=function(e,t){var i=this.ranges;if(i[0].start.row>t||i[i.length-1].start.row<e)return[];var n=this.pointIndex({row:e,column:0});0>n&&(n=-n-1);var s=this.pointIndex({row:t,column:0},n);0>s&&(s=-s-1);for(var r=[],o=n;s>o;o++)r.push(i[o]);return r},this.removeAll=function(){return this.ranges.splice(0,this.ranges.length)},this.attach=function(e){this.session&&this.detach(),this.session=e,this.onChange=this.$onChange.bind(this),this.session.on("change",this.onChange)},this.detach=function(){this.session&&(this.session.removeListener("change",this.onChange),this.session=null)},this.$onChange=function(e){var t=e.data.range;if("i"==e.data.action[0])var i=t.start,n=t.end;else var n=t.start,i=t.end;for(var s=i.row,r=n.row,o=r-s,a=-i.column+n.column,l=this.ranges,c=0,u=l.length;u>c;c++){var h=l[c];if(!(h.end.row<s)){if(h.start.row>s)break;h.start.row==s&&h.start.column>=i.column&&(h.start.column+=a,h.start.row+=o),h.end.row==s&&h.end.column>=i.column&&(h.end.column==i.column&&a>0&&u-1>c&&h.end.column>h.start.column&&h.end.column==l[c+1].start.column&&(h.end.column-=a),h.end.column+=a,h.end.row+=o)}}if(0!=o&&u>c)for(;u>c;c++){var h=l[c];h.start.row+=o,h.end.row+=o}}}).call(r.prototype),t.RangeList=r}),define("ace/edit_session/fold",["require","exports","module","../range","../range_list","../lib/oop"],function(e,t,i){"use strict";function n(e,t){e.row-=t.row,0==e.row&&(e.column-=t.column)}function s(e,t){n(e.start,t),n(e.end,t)}function r(e,t){0==e.row&&(e.column+=t.column),e.row+=t.row}function o(e,t){r(e.start,t),r(e.end,t)}var a=(e("../range").Range,e("../range_list").RangeList),l=e("../lib/oop"),c=t.Fold=function(e,t){this.foldLine=null,this.placeholder=t,this.range=e,this.start=e.start,this.end=e.end,this.sameRow=e.start.row==e.end.row,this.subFolds=this.ranges=[]};l.inherits(c,a),function(){this.toString=function(){return'"'+this.placeholder+'" '+this.range.toString()},this.setFoldLine=function(e){this.foldLine=e,this.subFolds.forEach(function(t){t.setFoldLine(e)})},this.clone=function(){var e=this.range.clone(),t=new c(e,this.placeholder);return this.subFolds.forEach(function(e){t.subFolds.push(e.clone())}),t.collapseChildren=this.collapseChildren,t},this.addSubFold=function(e){if(!this.range.isEqual(e)){if(!this.range.containsRange(e))throw"A fold can't intersect already existing fold"+e.range+this.range;s(e,this.start);for(var t=e.start.row,i=e.start.column,n=0,r=-1;n<this.subFolds.length&&(r=this.subFolds[n].range.compare(t,i),1==r);n++);var o=this.subFolds[n];if(0==r)return o.addSubFold(e);for(var t=e.range.end.row,i=e.range.end.column,a=n,r=-1;a<this.subFolds.length&&(r=this.subFolds[a].range.compare(t,i),1==r);a++);this.subFolds[a];if(0==r)throw"A fold can't intersect already existing fold"+e.range+this.range;this.subFolds.splice(n,a-n,e);return e.setFoldLine(this.foldLine),e}},this.restoreRange=function(e){return o(e,this.start)}}.call(c.prototype)}),define("ace/edit_session/folding",["require","exports","module","../range","./fold_line","./fold","../token_iterator"],function(e,t,i){"use strict";function n(){this.getFoldAt=function(e,t,i){var n=this.getFoldLine(e);if(!n)return null;for(var s=n.folds,r=0;r<s.length;r++){var o=s[r];if(o.range.contains(e,t)){if(1==i&&o.range.isEnd(e,t))continue;if(-1==i&&o.range.isStart(e,t))continue;return o}}},this.getFoldsInRange=function(e){var t=e.start,i=e.end,n=this.$foldData,s=[];t.column+=1,i.column-=1;for(var r=0;r<n.length;r++){var o=n[r].range.compareRange(e);if(2!=o){if(-2==o)break;for(var a=n[r].folds,l=0;l<a.length;l++){var c=a[l];if(o=c.range.compareRange(e),-2==o)break;if(2!=o){if(42==o)break;s.push(c)}}}}return t.column-=1,i.column+=1,s},this.getAllFolds=function(){function e(e){t.push(e)}for(var t=[],i=this.$foldData,n=0;n<i.length;n++)for(var s=0;s<i[n].folds.length;s++)e(i[n].folds[s]);return t},this.getFoldStringAt=function(e,t,i,n){if(n=n||this.getFoldLine(e),!n)return null;for(var s,r,o={end:{column:0}},a=0;a<n.folds.length;a++){r=n.folds[a];var l=r.range.compareEnd(e,t);if(-1==l){s=this.getLine(r.start.row).substring(o.end.column,r.start.column);break}if(0===l)return null;o=r}return s||(s=this.getLine(r.start.row).substring(o.end.column)),-1==i?s.substring(0,t-o.end.column):1==i?s.substring(t-o.end.column):s},this.getFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0),n;n<i.length;n++){var s=i[n];if(s.start.row<=e&&s.end.row>=e)return s;if(s.end.row>e)return null}return null},this.getNextFoldLine=function(e,t){var i=this.$foldData,n=0;for(t&&(n=i.indexOf(t)),-1==n&&(n=0),n;n<i.length;n++){var s=i[n];if(s.end.row>=e)return s}return null},this.getFoldedRowCount=function(e,t){for(var i=this.$foldData,n=t-e+1,s=0;s<i.length;s++){var r=i[s],o=r.end.row,a=r.start.row;if(o>=t){t>a&&(a>=e?n-=t-a:n=0);break}o>=e&&(n-=a>=e?o-a:o-e+1)}return n},this.$addFoldLine=function(e){return this.$foldData.push(e),this.$foldData.sort(function(e,t){return e.start.row-t.start.row}),e},this.addFold=function(e,t){var i,n=this.$foldData,s=!1;e instanceof o?i=e:(i=new o(t,e),i.collapseChildren=t.collapseChildren),this.$clipRangeToDocument(i.range);var a=i.start.row,l=i.start.column,c=i.end.row,u=i.end.column;if(a==c&&2>u-l)throw"The range has to be at least 2 characters width";var h=this.getFoldAt(a,l,1),d=this.getFoldAt(c,u,-1);if(h&&d==h)return h.addSubFold(i);if(h&&!h.range.isStart(a,l)||d&&!d.range.isEnd(c,u))throw"A fold can't intersect already existing fold"+i.range+h.range;var p=this.getFoldsInRange(i.range);p.length>0&&(this.removeFolds(p),p.forEach(function(e){i.addSubFold(e)}));for(var f=0;f<n.length;f++){var g=n[f];if(c==g.start.row){g.addFold(i),s=!0;break}if(a==g.end.row){if(g.addFold(i),s=!0,!i.sameRow){var m=n[f+1];if(m&&m.start.row==c){g.merge(m);break}}break}if(c<=g.start.row)break}return s||(g=this.$addFoldLine(new r(this.$foldData,i))),this.$useWrapMode?this.$updateWrapData(g.start.row,g.start.row):this.$updateRowLengthCache(g.start.row,g.start.row),this.$modified=!0,this._emit("changeFold",{data:i,action:"add"}),i},this.addFolds=function(e){e.forEach(function(e){this.addFold(e)},this)},this.removeFold=function(e){var t=e.foldLine,i=t.start.row,n=t.end.row,s=this.$foldData,r=t.folds;if(1==r.length)s.splice(s.indexOf(t),1);else if(t.range.isEnd(e.end.row,e.end.column))r.pop(),t.end.row=r[r.length-1].end.row,t.end.column=r[r.length-1].end.column;else if(t.range.isStart(e.start.row,e.start.column))r.shift(),t.start.row=r[0].start.row,t.start.column=r[0].start.column;else if(e.sameRow)r.splice(r.indexOf(e),1);else{var o=t.split(e.start.row,e.start.column);r=o.folds,r.shift(),o.start.row=r[0].start.row,o.start.column=r[0].start.column}this.$updating||(this.$useWrapMode?this.$updateWrapData(i,n):this.$updateRowLengthCache(i,n)),this.$modified=!0,this._emit("changeFold",{data:e,action:"remove"})},this.removeFolds=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i]);t.forEach(function(e){this.removeFold(e)},this),this.$modified=!0},this.expandFold=function(e){this.removeFold(e),e.subFolds.forEach(function(t){e.restoreRange(t),this.addFold(t)},this),e.collapseChildren>0&&this.foldAll(e.start.row+1,e.end.row,e.collapseChildren-1),e.subFolds=[]},this.expandFolds=function(e){e.forEach(function(e){this.expandFold(e)},this)},this.unfold=function(e,t){var i,n;if(null==e?(i=new s(0,0,this.getLength(),0),t=!0):i="number"==typeof e?new s(e,0,e,this.getLine(e).length):"row"in e?s.fromPoints(e,e):e,n=this.getFoldsInRange(i),t)this.removeFolds(n);else for(;n.length;)this.expandFolds(n),n=this.getFoldsInRange(i)},this.isRowFolded=function(e,t){return!!this.getFoldLine(e,t)},this.getRowFoldEnd=function(e,t){var i=this.getFoldLine(e,t);return i?i.end.row:e},this.getRowFoldStart=function(e,t){var i=this.getFoldLine(e,t);return i?i.start.row:e},this.getFoldDisplayLine=function(e,t,i,n,s){null==n&&(n=e.start.row,s=0),null==t&&(t=e.end.row,i=this.getLine(t).length);var r=this.doc,o="";return e.walk(function(e,t,i,a){if(!(n>t)){if(t==n){if(s>i)return;a=Math.max(s,a)}o+=null!=e?e:r.getLine(t).substring(a,i)}},t,i),o},this.getDisplayLine=function(e,t,i,n){var s=this.getFoldLine(e);if(s)return this.getFoldDisplayLine(s,e,t,i,n);var r;return r=this.doc.getLine(e),r.substring(n||0,t||r.length)},this.$cloneFoldData=function(){var e=[];return e=this.$foldData.map(function(t){var i=t.folds.map(function(e){return e.clone()});return new r(e,i)})},this.toggleFold=function(e){var t,i,n=this.selection,s=n.getRange();if(s.isEmpty()){var r=s.start;if(t=this.getFoldAt(r.row,r.column))return void this.expandFold(t);(i=this.findMatchingBracket(r))?1==s.comparePoint(i)?s.end=i:(s.start=i,s.start.column++,s.end.column--):(i=this.findMatchingBracket({row:r.row,column:r.column+1}))?(1==s.comparePoint(i)?s.end=i:s.start=i,s.start.column++):s=this.getCommentFoldRange(r.row,r.column)||s}else{var o=this.getFoldsInRange(s);if(e&&o.length)return void this.expandFolds(o);1==o.length&&(t=o[0])}if(t||(t=this.getFoldAt(s.start.row,s.start.column)),t&&t.range.toString()==s.toString())return void this.expandFold(t);var a="...";if(!s.isMultiLine()){if(a=this.getTextRange(s),a.length<4)return;a=a.trim().substring(0,2)+".."}this.addFold(a,s)},this.getCommentFoldRange=function(e,t,i){var n=new a(this,e,t),r=n.getCurrentToken();if(r&&/^comment|string/.test(r.type)){var o=new s,l=new RegExp(r.type.replace(/\..*/,"\\."));if(1!=i){do r=n.stepBackward();while(r&&l.test(r.type));n.stepForward()}if(o.start.row=n.getCurrentTokenRow(),o.start.column=n.getCurrentTokenColumn()+2,n=new a(this,e,t),-1!=i){do r=n.stepForward();while(r&&l.test(r.type));r=n.stepBackward()}else r=n.getCurrentToken();return o.end.row=n.getCurrentTokenRow(),o.end.column=n.getCurrentTokenColumn()+r.value.length-2,o}},this.foldAll=function(e,t,i){void 0==i&&(i=1e5);var n=this.foldWidgets;t=t||this.getLength();for(var s=e||0;t>s;s++)if(null==n[s]&&(n[s]=this.getFoldWidget(s)),"start"==n[s]){var r=this.getFoldWidgetRange(s);if(r&&r.end.row<=t)try{var o=this.addFold("...",r);o.collapseChildren=i}catch(a){}s=r.end.row}},this.$foldStyles={manual:1,markbegin:1,markbeginend:1},this.$foldStyle="markbegin",this.setFoldStyle=function(e){if(!this.$foldStyles[e])throw new Error("invalid fold style: "+e+"["+Object.keys(this.$foldStyles).join(", ")+"]");if(this.$foldStyle!=e){this.$foldStyle=e,"manual"==e&&this.unfold();var t=this.$foldMode;this.$setFolding(null),this.$setFolding(t)}},this.$setFolding=function(e){if(this.$foldMode!=e){if(this.$foldMode=e,this.removeListener("change",this.$updateFoldWidgets),this._emit("changeAnnotation"),!e||"manual"==this.$foldStyle)return void(this.foldWidgets=null);this.foldWidgets=[],this.getFoldWidget=e.getFoldWidget.bind(e,this,this.$foldStyle),this.getFoldWidgetRange=e.getFoldWidgetRange.bind(e,this,this.$foldStyle),this.$updateFoldWidgets=this.updateFoldWidgets.bind(this),this.on("change",this.$updateFoldWidgets)}},this.getParentFoldRangeData=function(e,t){var i=this.foldWidgets;if(!i||t&&i[e])return{};for(var n,s=e-1;s>=0;){var r=i[s];if(null==r&&(r=i[s]=this.getFoldWidget(s)),"start"==r){var o=this.getFoldWidgetRange(s);if(n||(n=o),o&&o.end.row>=e)break}s--}return{range:-1!==s&&o,firstRange:n}},this.onFoldWidgetClick=function(e,t){var i=this.getFoldWidget(e),n=this.getLine(e);t=t.domEvent;var s=t.shiftKey,r=t.ctrlKey||t.metaKey,o=t.altKey,a="end"===i?-1:1,l=this.getFoldAt(e,-1===a?0:n.length,a);if(l)return void(s||r?this.removeFold(l):this.expandFold(l));var c=this.getFoldWidgetRange(e);if(c&&!c.isMultiLine()&&(l=this.getFoldAt(c.start.row,c.start.column,1),l&&c.isEqual(l.range)))return void this.removeFold(l);if(o){var u=this.getParentFoldRangeData(e);if(u.range)var h=u.range.start.row+1,d=u.range.end.row;this.foldAll(h,d,r?1e4:0)}else if(s){var d=c?c.end.row:this.getLength();this.foldAll(e+1,c.end.row,r?1e4:0)}else c&&(r&&(c.collapseChildren=1e4),this.addFold("...",c));c||((t.target||t.srcElement).className+=" ace_invalid")},this.updateFoldWidgets=function(e){var t=e.data,i=t.range,n=i.start.row,s=i.end.row-n;if(0===s)this.foldWidgets[n]=null;else if("removeText"==t.action||"removeLines"==t.action)this.foldWidgets.splice(n,s+1,null);else{var r=Array(s+1);r.unshift(n,1),this.foldWidgets.splice.apply(this.foldWidgets,r)}}}var s=e("../range").Range,r=e("./fold_line").FoldLine,o=e("./fold").Fold,a=e("../token_iterator").TokenIterator;t.Folding=n}),define("ace/edit_session/bracket_match",["require","exports","module","../token_iterator","../range"],function(e,t,i){"use strict";function n(){this.findMatchingBracket=function(e,t){if(0==e.column)return null;var i=t||this.getLine(e.row).charAt(e.column-1);if(""==i)return null;var n=i.match(/([\(\[\{])|([\)\]\}])/);return n?n[1]?this.$findClosingBracket(n[1],e):this.$findOpeningBracket(n[2],e):null},this.getBracketRange=function(e){var t,i=this.getLine(e.row),n=!0,s=i.charAt(e.column-1),o=s&&s.match(/([\(\[\{])|([\)\]\}])/);if(o||(s=i.charAt(e.column),e={row:e.row,column:e.column+1},o=s&&s.match(/([\(\[\{])|([\)\]\}])/),n=!1),!o)return null;if(o[1]){var a=this.$findClosingBracket(o[1],e);if(!a)return null;t=r.fromPoints(e,a),n||(t.end.column++,t.start.column--),t.cursor=t.end}else{var a=this.$findOpeningBracket(o[2],e);if(!a)return null;t=r.fromPoints(a,e),n||(t.start.column++,t.end.column--),t.cursor=t.start}return t},this.$brackets={")":"(","(":")","]":"[","[":"]","{":"}","}":"{"},this.$findOpeningBracket=function(e,t,i){var n=this.$brackets[e],r=1,o=new s(this,t.row,t.column),a=o.getCurrentToken();if(a||(a=o.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("rparen",".paren")+")+"));for(var l=t.column-o.getCurrentTokenColumn()-2,c=a.value;;){for(;l>=0;){var u=c.charAt(l);if(u==n){if(r-=1,0==r)return{row:o.getCurrentTokenRow(),column:l+o.getCurrentTokenColumn()}}else u==e&&(r+=1);l-=1}do a=o.stepBackward();while(a&&!i.test(a.type));if(null==a)break;c=a.value,l=c.length-1}return null}},this.$findClosingBracket=function(e,t,i){var n=this.$brackets[e],r=1,o=new s(this,t.row,t.column),a=o.getCurrentToken();if(a||(a=o.stepForward()),a){i||(i=new RegExp("(\\.?"+a.type.replace(".","\\.").replace("lparen",".paren")+")+"));for(var l=t.column-o.getCurrentTokenColumn();;){for(var c=a.value,u=c.length;u>l;){var h=c.charAt(l);if(h==n){if(r-=1,0==r)return{row:o.getCurrentTokenRow(),column:l+o.getCurrentTokenColumn()}}else h==e&&(r+=1);l+=1}do a=o.stepForward();while(a&&!i.test(a.type));if(null==a)break;l=0}return null}}}var s=e("../token_iterator").TokenIterator,r=e("../range").Range;t.BracketMatch=n}),define("ace/edit_session",["require","exports","module","./lib/oop","./lib/lang","./config","./lib/event_emitter","./selection","./mode/text","./range","./document","./background_tokenizer","./search_highlight","./edit_session/folding","./edit_session/bracket_match"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/lang"),r=e("./config"),o=e("./lib/event_emitter").EventEmitter,a=e("./selection").Selection,l=e("./mode/text").Mode,c=e("./range").Range,u=e("./document").Document,h=e("./background_tokenizer").BackgroundTokenizer,d=e("./search_highlight").SearchHighlight,p=function(e,t){this.$breakpoints=[],this.$decorations=[],this.$frontMarkers={},this.$backMarkers={},this.$markerId=1,this.$undoSelect=!0,this.$foldData=[],this.$foldData.toString=function(){return this.join("\n")},this.on("changeFold",this.onChangeFold.bind(this)),this.$onChange=this.onChange.bind(this),"object"==typeof e&&e.getLine||(e=new u(e)),this.setDocument(e),this.selection=new a(this),r.resetOptions(this),this.setMode(t),r._emit("session",this)};(function(){function t(e){return 4352>e?!1:e>=4352&&4447>=e||e>=4515&&4519>=e||e>=4602&&4607>=e||e>=9001&&9002>=e||e>=11904&&11929>=e||e>=11931&&12019>=e||e>=12032&&12245>=e||e>=12272&&12283>=e||e>=12288&&12350>=e||e>=12353&&12438>=e||e>=12441&&12543>=e||e>=12549&&12589>=e||e>=12593&&12686>=e||e>=12688&&12730>=e||e>=12736&&12771>=e||e>=12784&&12830>=e||e>=12832&&12871>=e||e>=12880&&13054>=e||e>=13056&&19903>=e||e>=19968&&42124>=e||e>=42128&&42182>=e||e>=43360&&43388>=e||e>=44032&&55203>=e||e>=55216&&55238>=e||e>=55243&&55291>=e||e>=63744&&64255>=e||e>=65040&&65049>=e||e>=65072&&65106>=e||e>=65108&&65126>=e||e>=65128&&65131>=e||e>=65281&&65376>=e||e>=65504&&65510>=e}n.implement(this,o),this.setDocument=function(e){this.doc&&this.doc.removeListener("change",this.$onChange),this.doc=e,e.on("change",this.$onChange),this.bgTokenizer&&this.bgTokenizer.setDocument(this.getDocument()),this.resetCaches()},this.getDocument=function(){return this.doc},this.$resetRowCache=function(e){if(!e)return this.$docRowCache=[],void(this.$screenRowCache=[]);var t=this.$docRowCache.length,i=this.$getRowCacheIndex(this.$docRowCache,e)+1;t>i&&(this.$docRowCache.splice(i,t),this.$screenRowCache.splice(i,t))},this.$getRowCacheIndex=function(e,t){for(var i=0,n=e.length-1;n>=i;){var s=i+n>>1,r=e[s];if(t>r)i=s+1;else{if(!(r>t))return s;n=s-1}}return i-1},this.resetCaches=function(){this.$modified=!0,this.$wrapData=[],this.$rowLengthCache=[],this.$resetRowCache(0),this.bgTokenizer&&this.bgTokenizer.start(0)},this.onChangeFold=function(e){var t=e.data;this.$resetRowCache(t.start.row)},this.onChange=function(e){var t=e.data;this.$modified=!0,this.$resetRowCache(t.range.start.row);var i=this.$updateInternalDataOnChange(e);this.$fromUndo||!this.$undoManager||t.ignore||(this.$deltasDoc.push(t),i&&0!=i.length&&this.$deltasFold.push({action:"removeFolds",folds:i}),this.$informUndoManager.schedule()),this.bgTokenizer.$updateOnChange(t),this._emit("change",e)},this.setValue=function(e){this.doc.setValue(e),this.selection.moveCursorTo(0,0),this.selection.clearSelection(),this.$resetRowCache(0),this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.getUndoManager().reset()},this.getValue=this.toString=function(){return this.doc.getValue()},this.getSelection=function(){return this.selection},this.getState=function(e){return this.bgTokenizer.getState(e)},this.getTokens=function(e){return this.bgTokenizer.getTokens(e)},this.getTokenAt=function(e,t){var i,n=this.bgTokenizer.getTokens(e),s=0;if(null==t)r=n.length-1,s=this.getLine(e).length;else for(var r=0;r<n.length&&(s+=n[r].value.length,!(s>=t));r++);return(i=n[r])?(i.index=r,i.start=s-i.value.length,i):null},this.setUndoManager=function(e){if(this.$undoManager=e,this.$deltas=[],this.$deltasDoc=[],this.$deltasFold=[],this.$informUndoManager&&this.$informUndoManager.cancel(),e){var t=this;this.$syncInformUndoManager=function(){t.$informUndoManager.cancel(),t.$deltasFold.length&&(t.$deltas.push({group:"fold",deltas:t.$deltasFold}),t.$deltasFold=[]),t.$deltasDoc.length&&(t.$deltas.push({group:"doc",deltas:t.$deltasDoc}),t.$deltasDoc=[]),t.$deltas.length>0&&e.execute({action:"aceupdate",args:[t.$deltas,t]}),t.$deltas=[]},this.$informUndoManager=s.delayedCall(this.$syncInformUndoManager)}},this.markUndoGroup=function(){this.$syncInformUndoManager&&this.$syncInformUndoManager()},this.$defaultUndoManager={undo:function(){},redo:function(){},reset:function(){}},this.getUndoManager=function(){return this.$undoManager||this.$defaultUndoManager},this.getTabString=function(){return this.getUseSoftTabs()?s.stringRepeat(" ",this.getTabSize()):"	"},this.setUseSoftTabs=function(e){this.setOption("useSoftTabs",e)},this.getUseSoftTabs=function(){return this.$useSoftTabs},this.setTabSize=function(e){this.setOption("tabSize",e)},this.getTabSize=function(){return this.$tabSize},this.isTabStop=function(e){return this.$useSoftTabs&&e.column%this.$tabSize==0},this.$overwrite=!1,this.setOverwrite=function(e){this.setOption("overwrite",e)},this.getOverwrite=function(){return this.$overwrite},this.toggleOverwrite=function(){this.setOverwrite(!this.$overwrite)},this.addGutterDecoration=function(e,t){this.$decorations[e]||(this.$decorations[e]=""),this.$decorations[e]+=" "+t,this._emit("changeBreakpoint",{})},this.removeGutterDecoration=function(e,t){this.$decorations[e]=(this.$decorations[e]||"").replace(" "+t,""),this._emit("changeBreakpoint",{})},this.getBreakpoints=function(){return this.$breakpoints},this.setBreakpoints=function(e){this.$breakpoints=[];for(var t=0;t<e.length;t++)this.$breakpoints[e[t]]="ace_breakpoint";this._emit("changeBreakpoint",{})},this.clearBreakpoints=function(){this.$breakpoints=[],this._emit("changeBreakpoint",{})},this.setBreakpoint=function(e,t){void 0===t&&(t="ace_breakpoint"),t?this.$breakpoints[e]=t:delete this.$breakpoints[e],this._emit("changeBreakpoint",{})},this.clearBreakpoint=function(e){delete this.$breakpoints[e],this._emit("changeBreakpoint",{})},this.addMarker=function(e,t,i,n){var s=this.$markerId++,r={range:e,type:i||"line",renderer:"function"==typeof i?i:null,clazz:t,inFront:!!n,id:s};return n?(this.$frontMarkers[s]=r,this._emit("changeFrontMarker")):(this.$backMarkers[s]=r,this._emit("changeBackMarker")),s},this.addDynamicMarker=function(e,t){if(e.update){var i=this.$markerId++;return e.id=i,e.inFront=!!t,t?(this.$frontMarkers[i]=e,this._emit("changeFrontMarker")):(this.$backMarkers[i]=e,this._emit("changeBackMarker")),e}},this.removeMarker=function(e){var t=this.$frontMarkers[e]||this.$backMarkers[e];if(t){var i=t.inFront?this.$frontMarkers:this.$backMarkers;t&&(delete i[e],this._emit(t.inFront?"changeFrontMarker":"changeBackMarker"))}},this.getMarkers=function(e){return e?this.$frontMarkers:this.$backMarkers},this.highlight=function(e){if(!this.$searchHighlight){var t=new d(null,"ace_selected-word","text");this.$searchHighlight=this.addDynamicMarker(t)}this.$searchHighlight.setRegexp(e)},this.highlightLines=function(e,t,i,n){"number"!=typeof t&&(i=t,t=e),i||(i="ace_step");var s=new c(e,0,t,1/0);return s.id=this.addMarker(s,i,"fullLine",n),s},this.setAnnotations=function(e){this.$annotations=e,this._emit("changeAnnotation",{})},this.getAnnotations=function(){return this.$annotations||[]},this.clearAnnotations=function(){this.setAnnotations([])},this.$detectNewLine=function(e){var t=e.match(/^.*?(\r?\n)/m);t?this.$autoNewLine=t[1]:this.$autoNewLine="\n"},this.getWordRange=function(e,t){var i=this.getLine(e),n=!1;if(t>0&&(n=!!i.charAt(t-1).match(this.tokenRe)),n||(n=!!i.charAt(t).match(this.tokenRe)),n)var s=this.tokenRe;else if(/^\s+$/.test(i.slice(t-1,t+1)))var s=/\s/;else var s=this.nonTokenRe;var r=t;if(r>0){do r--;while(r>=0&&i.charAt(r).match(s));r++}for(var o=t;o<i.length&&i.charAt(o).match(s);)o++;return new c(e,r,e,o)},this.getAWordRange=function(e,t){for(var i=this.getWordRange(e,t),n=this.getLine(i.end.row);n.charAt(i.end.column).match(/[ \t]/);)i.end.column+=1;return i},this.setNewLineMode=function(e){this.doc.setNewLineMode(e)},this.getNewLineMode=function(){return this.doc.getNewLineMode()},this.setUseWorker=function(e){this.setOption("useWorker",e)},this.getUseWorker=function(){
return this.$useWorker},this.onReloadTokenizer=function(e){var t=e.data;this.bgTokenizer.start(t.first),this._emit("tokenizerUpdate",e)},this.$modes={},this.$mode=null,this.$modeId=null,this.setMode=function(e){if(e&&"object"==typeof e){if(e.getTokenizer)return this.$onChangeMode(e);var t=e,i=t.path}else i=e||"ace/mode/text";return this.$modes["ace/mode/text"]||(this.$modes["ace/mode/text"]=new l),this.$modes[i]&&!t?this.$onChangeMode(this.$modes[i]):(this.$modeId=i,r.loadModule(["mode",i],function(e){return this.$modeId===i?this.$modes[i]&&!t?this.$onChangeMode(this.$modes[i]):void(e&&e.Mode&&(e=new e.Mode(t),t||(this.$modes[i]=e,e.$id=i),this.$onChangeMode(e))):void 0}.bind(this)),void(this.$mode||this.$onChangeMode(this.$modes["ace/mode/text"],!0)))},this.$onChangeMode=function(e,t){if(this.$mode!==e){this.$mode=e,this.$stopWorker(),this.$useWorker&&this.$startWorker();var i=e.getTokenizer();if(void 0!==i.addEventListener){var n=this.onReloadTokenizer.bind(this);i.addEventListener("update",n)}if(this.bgTokenizer)this.bgTokenizer.setTokenizer(i);else{this.bgTokenizer=new h(i);var s=this;this.bgTokenizer.addEventListener("update",function(e){s._emit("tokenizerUpdate",e)})}this.bgTokenizer.setDocument(this.getDocument()),this.tokenRe=e.tokenRe,this.nonTokenRe=e.nonTokenRe,t||(this.$modeId=e.$id,this.$setFolding(e.foldingRules),this._emit("changeMode"),this.bgTokenizer.start(0))}},this.$stopWorker=function(){this.$worker&&this.$worker.terminate(),this.$worker=null},this.$startWorker=function(){if("undefined"==typeof Worker||e.noWorker)this.$worker=null;else try{this.$worker=this.$mode.createWorker(this)}catch(t){console.log("Could not load worker"),console.log(t),this.$worker=null}},this.getMode=function(){return this.$mode},this.$scrollTop=0,this.setScrollTop=function(e){e=Math.round(Math.max(0,e)),this.$scrollTop===e||isNaN(e)||(this.$scrollTop=e,this._signal("changeScrollTop",e))},this.getScrollTop=function(){return this.$scrollTop},this.$scrollLeft=0,this.setScrollLeft=function(e){e=Math.round(Math.max(0,e)),this.$scrollLeft===e||isNaN(e)||(this.$scrollLeft=e,this._signal("changeScrollLeft",e))},this.getScrollLeft=function(){return this.$scrollLeft},this.getScreenWidth=function(){return this.$computeWidth(),this.screenWidth},this.$computeWidth=function(e){if(this.$modified||e){if(this.$modified=!1,this.$useWrapMode)return this.screenWidth=this.$wrapLimit;for(var t=this.doc.getAllLines(),i=this.$rowLengthCache,n=0,s=0,r=this.$foldData[s],o=r?r.start.row:1/0,a=t.length,l=0;a>l;l++){if(l>o){if(l=r.end.row+1,l>=a)break;r=this.$foldData[s++],o=r?r.start.row:1/0}null==i[l]&&(i[l]=this.$getStringScreenWidth(t[l])[0]),i[l]>n&&(n=i[l])}this.screenWidth=n}},this.getLine=function(e){return this.doc.getLine(e)},this.getLines=function(e,t){return this.doc.getLines(e,t)},this.getLength=function(){return this.doc.getLength()},this.getTextRange=function(e){return this.doc.getTextRange(e||this.selection.getRange())},this.insert=function(e,t){return this.doc.insert(e,t)},this.remove=function(e){return this.doc.remove(e)},this.undoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=e.length-1;-1!=n;n--){var s=e[n];"doc"==s.group?(this.doc.revertDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!0,i)):s.deltas.forEach(function(e){this.addFolds(e.folds)},this)}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.redoChanges=function(e,t){if(e.length){this.$fromUndo=!0;for(var i=null,n=0;n<e.length;n++){var s=e[n];"doc"==s.group&&(this.doc.applyDeltas(s.deltas),i=this.$getUndoSelection(s.deltas,!1,i))}return this.$fromUndo=!1,i&&this.$undoSelect&&!t&&this.selection.setSelectionRange(i),i}},this.setUndoSelect=function(e){this.$undoSelect=e},this.$getUndoSelection=function(e,t,i){function n(e){var i="insertText"===e.action||"insertLines"===e.action;return t?!i:i}var s,r,o=e[0],a=!1;n(o)?(s=o.range.clone(),a=!0):(s=c.fromPoints(o.range.start,o.range.start),a=!1);for(var l=1;l<e.length;l++)o=e[l],n(o)?(r=o.range.start,-1==s.compare(r.row,r.column)&&s.setStart(o.range.start),r=o.range.end,1==s.compare(r.row,r.column)&&s.setEnd(o.range.end),a=!0):(r=o.range.start,-1==s.compare(r.row,r.column)&&(s=c.fromPoints(o.range.start,o.range.start)),a=!1);if(null!=i){var u=i.compareRange(s);1==u?s.setStart(i.start):-1==u&&s.setEnd(i.end)}return s},this.replace=function(e,t){return this.doc.replace(e,t)},this.moveText=function(e,t,i){var n=this.getTextRange(e),s=this.getFoldsInRange(e),r=c.fromPoints(t,t);if(!i){this.remove(e);var o=e.start.row-e.end.row,a=o?-e.end.column:e.start.column-e.end.column;a&&(r.start.row==e.end.row&&r.start.column>e.end.column&&(r.start.column+=a),r.end.row==e.end.row&&r.end.column>e.end.column&&(r.end.column+=a)),o&&r.start.row>=e.end.row&&(r.start.row+=o,r.end.row+=o)}if(this.insert(r.start,n),s.length){var l=e.start,u=r.start,o=u.row-l.row,a=u.column-l.column;this.addFolds(s.map(function(e){return e=e.clone(),e.start.row==l.row&&(e.start.column+=a),e.end.row==l.row&&(e.end.column+=a),e.start.row+=o,e.end.row+=o,e}))}return r},this.indentRows=function(e,t,i){i=i.replace(/\t/g,this.getTabString());for(var n=e;t>=n;n++)this.insert({row:n,column:0},i)},this.outdentRows=function(e){for(var t=e.collapseRows(),i=new c(0,0,0,0),n=this.getTabSize(),s=t.start.row;s<=t.end.row;++s){var r=this.getLine(s);i.start.row=s,i.end.row=s;for(var o=0;n>o&&" "==r.charAt(o);++o);n>o&&"	"==r.charAt(o)?(i.start.column=o,i.end.column=o+1):(i.start.column=0,i.end.column=o),this.remove(i)}},this.$moveLines=function(e,t,i){if(e=this.getRowFoldStart(e),t=this.getRowFoldEnd(t),0>i){var n=this.getRowFoldStart(e+i);if(0>n)return 0;var s=n-e}else if(i>0){var n=this.getRowFoldEnd(t+i);if(n>this.doc.getLength()-1)return 0;var s=n-t}else{e=this.$clipRowToDocument(e),t=this.$clipRowToDocument(t);var s=t-e+1}var r=new c(e,0,t,Number.MAX_VALUE),o=this.getFoldsInRange(r).map(function(e){return e=e.clone(),e.start.row+=s,e.end.row+=s,e}),a=0==i?this.doc.getLines(e,t):this.doc.removeLines(e,t);return this.doc.insertLines(e+s,a),o.length&&this.addFolds(o),s},this.moveLinesUp=function(e,t){return this.$moveLines(e,t,-1)},this.moveLinesDown=function(e,t){return this.$moveLines(e,t,1)},this.duplicateLines=function(e,t){return this.$moveLines(e,t,0)},this.$clipRowToDocument=function(e){return Math.max(0,Math.min(e,this.doc.getLength()-1))},this.$clipColumnToRow=function(e,t){return 0>t?0:Math.min(this.doc.getLine(e).length,t)},this.$clipPositionToDocument=function(e,t){if(t=Math.max(0,t),0>e)e=0,t=0;else{var i=this.doc.getLength();e>=i?(e=i-1,t=this.doc.getLine(i-1).length):t=Math.min(this.doc.getLine(e).length,t)}return{row:e,column:t}},this.$clipRangeToDocument=function(e){e.start.row<0?(e.start.row=0,e.start.column=0):e.start.column=this.$clipColumnToRow(e.start.row,e.start.column);var t=this.doc.getLength()-1;return e.end.row>t?(e.end.row=t,e.end.column=this.doc.getLine(t).length):e.end.column=this.$clipColumnToRow(e.end.row,e.end.column),e},this.$wrapLimit=80,this.$useWrapMode=!1,this.$wrapLimitRange={min:null,max:null},this.setUseWrapMode=function(e){if(e!=this.$useWrapMode){if(this.$useWrapMode=e,this.$modified=!0,this.$resetRowCache(0),e){var t=this.getLength();this.$wrapData=[];for(var i=0;t>i;i++)this.$wrapData.push([]);this.$updateWrapData(0,t-1)}this._emit("changeWrapMode")}},this.getUseWrapMode=function(){return this.$useWrapMode},this.setWrapLimitRange=function(e,t){(this.$wrapLimitRange.min!==e||this.$wrapLimitRange.max!==t)&&(this.$wrapLimitRange.min=e,this.$wrapLimitRange.max=t,this.$modified=!0,this._emit("changeWrapMode"))},this.adjustWrapLimit=function(e,t){var i=this.$wrapLimitRange;i.max<0&&(i={min:t,max:t});var n=this.$constrainWrapLimit(e,i.min,i.max);return n!=this.$wrapLimit&&n>1?(this.$wrapLimit=n,this.$modified=!0,this.$useWrapMode&&(this.$updateWrapData(0,this.getLength()-1),this.$resetRowCache(0),this._emit("changeWrapLimit")),!0):!1},this.$constrainWrapLimit=function(e,t,i){return t&&(e=Math.max(t,e)),i&&(e=Math.min(i,e)),e},this.getWrapLimit=function(){return this.$wrapLimit},this.setWrapLimit=function(e){this.setWrapLimitRange(e,e)},this.getWrapLimitRange=function(){return{min:this.$wrapLimitRange.min,max:this.$wrapLimitRange.max}},this.$updateInternalDataOnChange=function(e){var t,i=this.$useWrapMode,n=e.data.action,s=e.data.range.start.row,r=e.data.range.end.row,o=e.data.range.start,a=e.data.range.end,l=null;if(-1!=n.indexOf("Lines")?(r="insertLines"==n?s+e.data.lines.length:s,t=e.data.lines?e.data.lines.length:r-s):t=r-s,this.$updating=!0,0!=t)if(-1!=n.indexOf("remove")){this[i?"$wrapData":"$rowLengthCache"].splice(s,t);var c=this.$foldData;l=this.getFoldsInRange(e.data.range),this.removeFolds(l);var u=this.getFoldLine(a.row),h=0;if(u){u.addRemoveChars(a.row,a.column,o.column-a.column),u.shiftRow(-t);var d=this.getFoldLine(s);d&&d!==u&&(d.merge(u),u=d),h=c.indexOf(u)+1}for(h;h<c.length;h++){var u=c[h];u.start.row>=a.row&&u.shiftRow(-t)}r=s}else{var p;if(i){p=[s,0];for(var f=0;t>f;f++)p.push([]);this.$wrapData.splice.apply(this.$wrapData,p)}else p=Array(t),p.unshift(s,0),this.$rowLengthCache.splice.apply(this.$rowLengthCache,p);var c=this.$foldData,u=this.getFoldLine(s),h=0;if(u){var g=u.range.compareInside(o.row,o.column);0==g?(u=u.split(o.row,o.column),u.shiftRow(t),u.addRemoveChars(r,0,a.column-o.column)):-1==g&&(u.addRemoveChars(s,0,a.column-o.column),u.shiftRow(t)),h=c.indexOf(u)+1}for(h;h<c.length;h++){var u=c[h];u.start.row>=s&&u.shiftRow(t)}}else{t=Math.abs(e.data.range.start.column-e.data.range.end.column),-1!=n.indexOf("remove")&&(l=this.getFoldsInRange(e.data.range),this.removeFolds(l),t=-t);var u=this.getFoldLine(s);u&&u.addRemoveChars(s,o.column,t)}return i&&this.$wrapData.length!=this.doc.getLength()&&console.error("doc.getLength() and $wrapData.length have to be the same!"),this.$updating=!1,i?this.$updateWrapData(s,r):this.$updateRowLengthCache(s,r),l},this.$updateRowLengthCache=function(e,t,i){this.$rowLengthCache[e]=null,this.$rowLengthCache[t]=null},this.$updateWrapData=function(e,t){var i,n,r=this.doc.getAllLines(),o=this.getTabSize(),a=this.$wrapData,l=this.$wrapLimit,c=e;for(t=Math.min(t,r.length-1);t>=c;)if(n=this.getFoldLine(c,n)){for(i=[],n.walk(function(e,t,n,s){var o;if(null!=e){o=this.$getDisplayTokens(e,i.length),o[0]=u;for(var a=1;a<o.length;a++)o[a]=p}else o=this.$getDisplayTokens(r[t].substring(s,n),i.length);i=i.concat(o)}.bind(this),n.end.row,r[n.end.row].length+1);0!=i.length&&i[i.length-1]>=g;)i.pop();a[n.start.row]=this.$computeWrapSplits(i,l,o),c=n.end.row+1}else i=this.$getDisplayTokens(s.stringTrimRight(r[c])),a[c]=this.$computeWrapSplits(i,l,o),c++};var i=1,a=2,u=3,p=4,f=9,g=10,m=11,v=12;this.$computeWrapSplits=function(e,t){function i(t){var i=e.slice(r,t),s=i.length;i.join("").replace(/12/g,function(){s-=1}).replace(/2/g,function(){s-=1}),o+=s,n.push(o),r=t}if(0==e.length)return[];for(var n=[],s=e.length,r=0,o=0;s-r>t;){var a=r+t;if(e[a]>=g){for(;e[a]>=g;)a++;i(a)}else if(e[a]!=u&&e[a]!=p){for(var l=Math.max(a-10,r-1);a>l&&e[a]<u;)a--;for(;a>l&&e[a]==f;)a--;a>l?i(++a):(a=r+t,i(a))}else{for(a;a!=r-1&&e[a]!=u;a--);if(a>r){i(a);continue}for(a=r+t;a<e.length&&e[a]==p;a++);if(a==e.length)break;i(a)}}return n},this.$getDisplayTokens=function(e,n){var s,r=[];n=n||0;for(var o=0;o<e.length;o++){var l=e.charCodeAt(o);if(9==l){s=this.getScreenTabSize(r.length+n),r.push(m);for(var c=1;s>c;c++)r.push(v)}else 32==l?r.push(g):l>39&&48>l||l>57&&64>l?r.push(f):l>=4352&&t(l)?r.push(i,a):r.push(i)}return r},this.$getStringScreenWidth=function(e,i,n){if(0==i)return[0,0];null==i&&(i=1/0),n=n||0;var s,r;for(r=0;r<e.length&&(s=e.charCodeAt(r),n+=9==s?this.getScreenTabSize(n):s>=4352&&t(s)?2:1,!(n>i));r++);return[n,r]},this.getRowLength=function(e){return this.$useWrapMode&&this.$wrapData[e]?this.$wrapData[e].length+1:1},this.getScreenLastRowColumn=function(e){var t=this.screenToDocumentPosition(e,Number.MAX_VALUE);return this.documentToScreenColumn(t.row,t.column)},this.getDocumentLastRowColumn=function(e,t){var i=this.documentToScreenRow(e,t);return this.getScreenLastRowColumn(i)},this.getDocumentLastRowColumnPosition=function(e,t){var i=this.documentToScreenRow(e,t);return this.screenToDocumentPosition(i,Number.MAX_VALUE/10)},this.getRowSplitData=function(e){return this.$useWrapMode?this.$wrapData[e]:void 0},this.getScreenTabSize=function(e){return this.$tabSize-e%this.$tabSize},this.screenToDocumentRow=function(e,t){return this.screenToDocumentPosition(e,t).row},this.screenToDocumentColumn=function(e,t){return this.screenToDocumentPosition(e,t).column},this.screenToDocumentPosition=function(e,t){if(0>e)return{row:0,column:0};var i,n,s=0,r=0,o=0,a=0,l=this.$screenRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0)var o=l[c],s=this.$docRowCache[c],h=e>l[u-1];else var h=!u;for(var d=this.getLength()-1,p=this.getNextFoldLine(s),f=p?p.start.row:1/0;e>=o&&(a=this.getRowLength(s),!(o+a-1>=e||s>=d));)o+=a,s++,s>f&&(s=p.end.row+1,p=this.getNextFoldLine(s,p),f=p?p.start.row:1/0),h&&(this.$docRowCache.push(s),this.$screenRowCache.push(o));if(p&&p.start.row<=s)i=this.getFoldDisplayLine(p),s=p.start.row;else{if(e>=o+a||s>d)return{row:d,column:this.getLine(d).length};i=this.getLine(s),p=null}if(this.$useWrapMode){var g=this.$wrapData[s];g&&(n=g[e-o],e>o&&g.length&&(r=g[e-o-1]||g[g.length-1],i=i.substring(r)))}return r+=this.$getStringScreenWidth(i,t)[1],this.$useWrapMode&&r>=n&&(r=n-1),p?p.idxToPosition(r):{row:s,column:r}},this.documentToScreenPosition=function(e,t){if("undefined"==typeof t)var i=this.$clipPositionToDocument(e.row,e.column);else i=this.$clipPositionToDocument(e,t);e=i.row,t=i.column;var n=0,s=null,r=null;r=this.getFoldAt(e,t,1),r&&(e=r.start.row,t=r.start.column);var o,a=0,l=this.$docRowCache,c=this.$getRowCacheIndex(l,e),u=l.length;if(u&&c>=0)var a=l[c],n=this.$screenRowCache[c],h=e>l[u-1];else var h=!u;for(var d=this.getNextFoldLine(a),p=d?d.start.row:1/0;e>a;){if(a>=p){if(o=d.end.row+1,o>e)break;d=this.getNextFoldLine(o,d),p=d?d.start.row:1/0}else o=a+1;n+=this.getRowLength(a),a=o,h&&(this.$docRowCache.push(a),this.$screenRowCache.push(n))}var f="";if(d&&a>=p?(f=this.getFoldDisplayLine(d,e,t),s=d.start.row):(f=this.getLine(e).substring(0,t),s=e),this.$useWrapMode){for(var g=this.$wrapData[s],m=0;f.length>=g[m];)n++,m++;f=f.substring(g[m-1]||0,f.length)}return{row:n,column:this.$getStringScreenWidth(f)[0]}},this.documentToScreenColumn=function(e,t){return this.documentToScreenPosition(e,t).column},this.documentToScreenRow=function(e,t){return this.documentToScreenPosition(e,t).row},this.getScreenLength=function(){var e=0,t=null;if(this.$useWrapMode)for(var i=this.$wrapData.length,n=0,s=0,t=this.$foldData[s++],r=t?t.start.row:1/0;i>n;)e+=this.$wrapData[n].length+1,n++,n>r&&(n=t.end.row+1,t=this.$foldData[s++],r=t?t.start.row:1/0);else{e=this.getLength();for(var o=this.$foldData,s=0;s<o.length;s++)t=o[s],e-=t.end.row-t.start.row}return e}}).call(p.prototype),e("./edit_session/folding").Folding.call(p.prototype),e("./edit_session/bracket_match").BracketMatch.call(p.prototype),r.defineOptions(p.prototype,"session",{wrap:{set:function(e){if(e&&"off"!=e?"free"==e?e=!0:"printMargin"==e?e=-1:"string"==typeof e&&(e=parseInt(e,10)||!1):e=!1,this.$wrap!=e){if(e){var t="number"==typeof e?e:null;this.setWrapLimitRange(t,t),this.setUseWrapMode(!0)}else this.setUseWrapMode(!1);this.$wrap=e}},get:function(){return this.getUseWrapMode()?this.getWrapLimitRange().min||"free":"off"},handlesSet:!0},firstLineNumber:{set:function(){this._emit("changeBreakpoint")},initialValue:1},useWorker:{set:function(e){this.$useWorker=e,this.$stopWorker(),e&&this.$startWorker()},initialValue:!0},useSoftTabs:{initialValue:!0},tabSize:{set:function(e){isNaN(e)||this.$tabSize===e||(this.$modified=!0,this.$rowLengthCache=[],this.$tabSize=e,this._emit("changeTabSize"))},initialValue:4,handlesSet:!0},overwrite:{set:function(e){this._emit("changeOverwrite")},initialValue:!1},newLineMode:{set:function(e){this.doc.setNewLineMode(e)},get:function(){return this.doc.getNewLineMode()},handlesSet:!0}}),t.EditSession=p}),define("ace/search",["require","exports","module","./lib/lang","./lib/oop","./range"],function(e,t,i){"use strict";var n=e("./lib/lang"),s=e("./lib/oop"),r=e("./range").Range,o=function(){this.$options={}};(function(){this.set=function(e){return s.mixin(this.$options,e),this},this.getOptions=function(){return n.copyObject(this.$options)},this.setOptions=function(e){this.$options=e},this.find=function(e){var t=this.$matchIterator(e,this.$options);if(!t)return!1;var i=null;return t.forEach(function(e,t,n){if(e.start)i=e;else{var s=e.offset+(n||0);i=new r(t,s,t,s+e.length)}return!0}),i},this.findAll=function(e){var t=this.$options;if(!t.needle)return[];this.$assembleRegExp(t);var i=t.range,s=i?e.getLines(i.start.row,i.end.row):e.doc.getAllLines(),o=[],a=t.re;if(t.$isMultiLine)for(var l=a.length,c=s.length-l,u=a.offset||0;c>=u;u++){for(var h=0;l>h&&-1!=s[u+h].search(a[h]);h++);var d=s[u],p=s[u+l-1],f=d.match(a[0])[0].length,g=p.match(a[l-1])[0].length;o.push(new r(u,d.length-f,u+l-1,g))}else for(var m=0;m<s.length;m++)for(var v=n.getMatchOffsets(s[m],a),h=0;h<v.length;h++){var y=v[h];o.push(new r(m,y.offset,m,y.offset+y.length))}if(i){for(var _=i.start.column,b=i.start.column,m=0,h=o.length-1;h>m&&o[m].start.column<_&&o[m].start.row==i.start.row;)m++;for(;h>m&&o[h].end.column>b&&o[h].end.row==i.end.row;)h--;for(o=o.slice(m,h+1),m=0,h=o.length;h>m;m++)o[m].start.row+=i.start.row,o[m].end.row+=i.start.row}return o},this.replace=function(e,t){var i=this.$options,n=this.$assembleRegExp(i);if(i.$isMultiLine)return t;if(n){var s=n.exec(e);if(!s||s[0].length!=e.length)return null;if(t=e.replace(n,t),i.preserveCase){t=t.split("");for(var r=Math.min(e.length,e.length);r--;){var o=e[r];o&&o.toLowerCase()!=o?t[r]=t[r].toUpperCase():t[r]=t[r].toLowerCase()}t=t.join("")}return t}},this.$matchIterator=function(e,t){var i=this.$assembleRegExp(t);if(!i)return!1;var s,o=this,a=t.backwards;if(t.$isMultiLine)var l=i.length,c=function(t,n,o){var a=t.search(i[0]);if(-1!=a){for(var c=1;l>c;c++)if(t=e.getLine(n+c),-1==t.search(i[c]))return;var u=t.match(i[l-1])[0].length,h=new r(n,a,n+l-1,u);return 1==i.offset?(h.start.row--,h.start.column=Number.MAX_VALUE):o&&(h.start.column+=o),s(h)?!0:void 0}};else if(a)var c=function(e,t,r){for(var o=n.getMatchOffsets(e,i),a=o.length-1;a>=0;a--)if(s(o[a],t,r))return!0};else var c=function(e,t,r){for(var o=n.getMatchOffsets(e,i),a=0;a<o.length;a++)if(s(o[a],t,r))return!0};return{forEach:function(i){s=i,o.$lineIterator(e,t).forEach(c)}}},this.$assembleRegExp=function(e,t){if(e.needle instanceof RegExp)return e.re=e.needle;var i=e.needle;if(!e.needle)return e.re=!1;e.regExp||(i=n.escapeRegExp(i)),e.wholeWord&&(i="\\b"+i+"\\b");var s=e.caseSensitive?"g":"gi";if(e.$isMultiLine=!t&&/[\n\r]/.test(i),e.$isMultiLine)return e.re=this.$assembleMultilineRegExp(i,s);try{var r=new RegExp(i,s)}catch(o){r=!1}return e.re=r},this.$assembleMultilineRegExp=function(e,t){for(var i=e.replace(/\r\n|\r|\n/g,"$\n^").split("\n"),n=[],s=0;s<i.length;s++)try{n.push(new RegExp(i[s],t))}catch(r){return!1}return""==i[0]?(n.shift(),n.offset=1):n.offset=0,n},this.$lineIterator=function(e,t){var i=1==t.backwards,n=0!=t.skipCurrent,s=t.range,r=t.start;r||(r=s?s[i?"end":"start"]:e.selection.getRange()),r.start&&(r=r[n!=i?"end":"start"]);var o=s?s.start.row:0,a=s?s.end.row:e.getLength()-1,l=i?function(i){var n=r.row,s=e.getLine(n).substring(0,r.column);if(!i(s,n)){for(n--;n>=o;n--)if(i(e.getLine(n),n))return;if(0!=t.wrap)for(n=a,o=r.row;n>=o;n--)if(i(e.getLine(n),n))return}}:function(i){var n=r.row,s=e.getLine(n).substr(r.column);if(!i(s,n,r.column)){for(n+=1;a>=n;n++)if(i(e.getLine(n),n))return;if(0!=t.wrap)for(n=o,a=r.row;a>=n;n++)if(i(e.getLine(n),n))return}};return{forEach:l}}}).call(o.prototype),t.Search=o}),define("ace/keyboard/hash_handler",["require","exports","module","../lib/keys","../lib/useragent"],function(e,t,i){"use strict";function n(e,t){this.platform=t||(r.isMac?"mac":"win"),this.commands={},this.commmandKeyBinding={},this.addCommands(e)}var s=e("../lib/keys"),r=e("../lib/useragent");(function(){this.addCommand=function(e){this.commands[e.name]&&this.removeCommand(e),this.commands[e.name]=e,e.bindKey&&this._buildKeyHash(e)},this.removeCommand=function(e){var t="string"==typeof e?e:e.name;e=this.commands[t],delete this.commands[t];var i=this.commmandKeyBinding;for(var n in i)for(var s in i[n])i[n][s]==e&&delete i[n][s]},this.bindKey=function(e,t){if(e){if("function"==typeof t)return void this.addCommand({exec:t,bindKey:e,name:t.name||e});var i=this.commmandKeyBinding;e.split("|").forEach(function(e){var n=this.parseKeys(e,t),s=n.hashId;(i[s]||(i[s]={}))[n.key]=t},this)}},this.addCommands=function(e){e&&Object.keys(e).forEach(function(t){var i=e[t];return"string"==typeof i?this.bindKey(i,t):("function"==typeof i&&(i={exec:i}),i.name||(i.name=t),void this.addCommand(i))},this)},this.removeCommands=function(e){Object.keys(e).forEach(function(t){this.removeCommand(e[t])},this)},this.bindKeys=function(e){Object.keys(e).forEach(function(t){this.bindKey(t,e[t])},this)},this._buildKeyHash=function(e){var t=e.bindKey;if(t){var i="string"==typeof t?t:t[this.platform];this.bindKey(i,e)}},this.parseKeys=function(e){-1!=e.indexOf(" ")&&(e=e.split(/\s+/).pop());var t=e.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(e){return e}),i=t.pop(),n=s[i];if(s.FUNCTION_KEYS[n])i=s.FUNCTION_KEYS[n].toLowerCase();else{if(!t.length)return{key:i,hashId:-1};if(1==t.length&&"shift"==t[0])return{key:i.toUpperCase(),hashId:-1}}for(var r=0,o=t.length;o--;){var a=s.KEY_MODS[t[o]];if(null==a)return"undefined"!=typeof console&&console.error("invalid modifier "+t[o]+" in "+e),!1;r|=a}return{key:i,hashId:r}},this.findKeyCommand=function(e,t){var i=this.commmandKeyBinding;return i[e]&&i[e][t]},this.handleKeyboard=function(e,t,i,n){return{command:this.findKeyCommand(t,i)}}}).call(n.prototype),t.HashHandler=n}),define("ace/commands/command_manager",["require","exports","module","../lib/oop","../keyboard/hash_handler","../lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../keyboard/hash_handler").HashHandler,r=e("../lib/event_emitter").EventEmitter,o=function(e,t){this.platform=e,this.commands=this.byName={},this.commmandKeyBinding={},this.addCommands(t),this.setDefaultHandler("exec",function(e){return e.command.exec(e.editor,e.args||{})})};n.inherits(o,s),function(){n.implement(this,r),this.exec=function(e,t,i){if("string"==typeof e&&(e=this.commands[e]),!e)return!1;if(t&&t.$readOnly&&!e.readOnly)return!1;var n={editor:t,command:e,args:i},s=this._emit("exec",n);return this._signal("afterExec",n),s===!1?!1:!0},this.toggleRecording=function(e){return this.$inReplay?void 0:(e&&e._emit("changeStatus"),this.recording?(this.macro.pop(),this.removeEventListener("exec",this.$addCommandToMacro),this.macro.length||(this.macro=this.oldMacro),this.recording=!1):(this.$addCommandToMacro||(this.$addCommandToMacro=function(e){this.macro.push([e.command,e.args])}.bind(this)),this.oldMacro=this.macro,this.macro=[],this.on("exec",this.$addCommandToMacro),this.recording=!0))},this.replay=function(e){if(!this.$inReplay&&this.macro){if(this.recording)return this.toggleRecording(e);try{this.$inReplay=!0,this.macro.forEach(function(t){"string"==typeof t?this.exec(t,e):this.exec(t[0],e,t[1])},this)}finally{this.$inReplay=!1}}},this.trimMacro=function(e){return e.map(function(e){return"string"!=typeof e[0]&&(e[0]=e[0].name),e[1]||(e=e[0]),e})}}.call(o.prototype),t.CommandManager=o}),define("ace/commands/default_commands",["require","exports","module","../lib/lang","../config"],function(e,t,i){"use strict";function n(e,t){return{win:e,mac:t}}var s=e("../lib/lang"),r=e("../config");t.commands=[{name:"showSettingsMenu",bindKey:n("Ctrl-,","Command-,"),exec:function(e){r.loadModule("ace/ext/settings_menu",function(t){t.init(e),e.showSettingsMenu()})},readOnly:!0},{name:"selectall",bindKey:n("Ctrl-A","Command-A"),exec:function(e){e.selectAll()},readOnly:!0},{name:"centerselection",bindKey:n(null,"Ctrl-L"),exec:function(e){e.centerSelection()},readOnly:!0},{name:"gotoline",bindKey:n("Ctrl-L","Command-L"),exec:function(e){var t=parseInt(prompt("Enter line number:"),10);isNaN(t)||e.gotoLine(t)},readOnly:!0},{name:"fold",bindKey:n("Alt-L|Ctrl-F1","Command-Alt-L|Command-F1"),exec:function(e){e.session.toggleFold(!1)},readOnly:!0},{name:"unfold",bindKey:n("Alt-Shift-L|Ctrl-Shift-F1","Command-Alt-Shift-L|Command-Shift-F1"),exec:function(e){e.session.toggleFold(!0)},readOnly:!0},{name:"foldall",bindKey:n("Alt-0","Command-Option-0"),exec:function(e){e.session.foldAll()},readOnly:!0},{name:"unfoldall",bindKey:n("Alt-Shift-0","Command-Option-Shift-0"),exec:function(e){e.session.unfold()},readOnly:!0},{name:"findnext",bindKey:n("Ctrl-K","Command-G"),exec:function(e){e.findNext()},readOnly:!0},{name:"findprevious",bindKey:n("Ctrl-Shift-K","Command-Shift-G"),exec:function(e){e.findPrevious()},readOnly:!0},{name:"find",bindKey:n("Ctrl-F","Command-F"),exec:function(e){r.loadModule("ace/ext/searchbox",function(t){t.Search(e)})},readOnly:!0},{name:"overwrite",bindKey:"Insert",exec:function(e){e.toggleOverwrite()},readOnly:!0},{name:"selecttostart",bindKey:n("Ctrl-Shift-Home","Command-Shift-Up"),exec:function(e){e.getSelection().selectFileStart()},multiSelectAction:"forEach",readOnly:!0},{name:"gotostart",bindKey:n("Ctrl-Home","Command-Home|Command-Up"),exec:function(e){e.navigateFileStart()},multiSelectAction:"forEach",readOnly:!0},{name:"selectup",bindKey:n("Shift-Up","Shift-Up"),exec:function(e){e.getSelection().selectUp()},multiSelectAction:"forEach",readOnly:!0},{name:"golineup",bindKey:n("Up","Up|Ctrl-P"),exec:function(e,t){e.navigateUp(t.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selecttoend",bindKey:n("Ctrl-Shift-End","Command-Shift-Down"),exec:function(e){e.getSelection().selectFileEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"gotoend",bindKey:n("Ctrl-End","Command-End|Command-Down"),exec:function(e){e.navigateFileEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"selectdown",bindKey:n("Shift-Down","Shift-Down"),exec:function(e){e.getSelection().selectDown()},multiSelectAction:"forEach",readOnly:!0},{name:"golinedown",bindKey:n("Down","Down|Ctrl-N"),exec:function(e,t){e.navigateDown(t.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selectwordleft",bindKey:n("Ctrl-Shift-Left","Option-Shift-Left"),exec:function(e){e.getSelection().selectWordLeft()},multiSelectAction:"forEach",readOnly:!0},{name:"gotowordleft",bindKey:n("Ctrl-Left","Option-Left"),exec:function(e){e.navigateWordLeft()},multiSelectAction:"forEach",readOnly:!0},{name:"selecttolinestart",bindKey:n("Alt-Shift-Left","Command-Shift-Left"),exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",readOnly:!0},{name:"gotolinestart",bindKey:n("Alt-Left|Home","Command-Left|Home|Ctrl-A"),exec:function(e){e.navigateLineStart()},multiSelectAction:"forEach",readOnly:!0},{name:"selectleft",bindKey:n("Shift-Left","Shift-Left"),exec:function(e){e.getSelection().selectLeft()},multiSelectAction:"forEach",readOnly:!0},{name:"gotoleft",bindKey:n("Left","Left|Ctrl-B"),exec:function(e,t){e.navigateLeft(t.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selectwordright",bindKey:n("Ctrl-Shift-Right","Option-Shift-Right"),exec:function(e){e.getSelection().selectWordRight()},multiSelectAction:"forEach",readOnly:!0},{name:"gotowordright",bindKey:n("Ctrl-Right","Option-Right"),exec:function(e){e.navigateWordRight()},multiSelectAction:"forEach",readOnly:!0},{name:"selecttolineend",bindKey:n("Alt-Shift-Right","Command-Shift-Right"),exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"gotolineend",bindKey:n("Alt-Right|End","Command-Right|End|Ctrl-E"),exec:function(e){e.navigateLineEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"selectright",bindKey:n("Shift-Right","Shift-Right"),exec:function(e){e.getSelection().selectRight()},multiSelectAction:"forEach",readOnly:!0},{name:"gotoright",bindKey:n("Right","Right|Ctrl-F"),exec:function(e,t){e.navigateRight(t.times)},multiSelectAction:"forEach",readOnly:!0},{name:"selectpagedown",bindKey:"Shift-PageDown",exec:function(e){e.selectPageDown()},readOnly:!0},{name:"pagedown",bindKey:n(null,"Option-PageDown"),exec:function(e){e.scrollPageDown()},readOnly:!0},{name:"gotopagedown",bindKey:n("PageDown","PageDown|Ctrl-V"),exec:function(e){e.gotoPageDown()},readOnly:!0},{name:"selectpageup",bindKey:"Shift-PageUp",exec:function(e){e.selectPageUp()},readOnly:!0},{name:"pageup",bindKey:n(null,"Option-PageUp"),exec:function(e){e.scrollPageUp()},readOnly:!0},{name:"gotopageup",bindKey:"PageUp",exec:function(e){e.gotoPageUp()},readOnly:!0},{name:"scrollup",bindKey:n("Ctrl-Up",null),exec:function(e){e.renderer.scrollBy(0,-2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"scrolldown",bindKey:n("Ctrl-Down",null),exec:function(e){e.renderer.scrollBy(0,2*e.renderer.layerConfig.lineHeight)},readOnly:!0},{name:"selectlinestart",bindKey:"Shift-Home",exec:function(e){e.getSelection().selectLineStart()},multiSelectAction:"forEach",readOnly:!0},{name:"selectlineend",bindKey:"Shift-End",exec:function(e){e.getSelection().selectLineEnd()},multiSelectAction:"forEach",readOnly:!0},{name:"togglerecording",bindKey:n("Ctrl-Alt-E","Command-Option-E"),exec:function(e){e.commands.toggleRecording(e)},readOnly:!0},{name:"replaymacro",bindKey:n("Ctrl-Shift-E","Command-Shift-E"),exec:function(e){e.commands.replay(e)},readOnly:!0},{name:"jumptomatching",bindKey:n("Ctrl-P","Ctrl-Shift-P"),exec:function(e){e.jumpToMatching()},multiSelectAction:"forEach",readOnly:!0},{name:"selecttomatching",bindKey:n("Ctrl-Shift-P",null),exec:function(e){e.jumpToMatching(!0)},multiSelectAction:"forEach",readOnly:!0},{name:"cut",exec:function(e){var t=e.getSelectionRange();e._emit("cut",t),e.selection.isEmpty()||(e.session.remove(t),e.clearSelection())},multiSelectAction:"forEach"},{name:"removeline",bindKey:n("Ctrl-D","Command-D"),exec:function(e){e.removeLines()},multiSelectAction:"forEachLine"},{name:"duplicateSelection",bindKey:n("Ctrl-Shift-D","Command-Shift-D"),exec:function(e){e.duplicateSelection()},multiSelectAction:"forEach"},{name:"sortlines",bindKey:n("Ctrl-Alt-S","Command-Alt-S"),exec:function(e){e.sortLines()},multiSelectAction:"forEachLine"},{name:"togglecomment",bindKey:n("Ctrl-/","Command-/"),exec:function(e){e.toggleCommentLines()},multiSelectAction:"forEachLine"},{name:"toggleBlockComment",bindKey:n("Ctrl-Shift-/","Command-Shift-/"),exec:function(e){e.toggleBlockComment()},multiSelectAction:"forEach"},{name:"modifyNumberUp",bindKey:n("Ctrl-Shift-Up","Alt-Shift-Up"),exec:function(e){e.modifyNumber(1)},multiSelectAction:"forEach"},{name:"modifyNumberDown",bindKey:n("Ctrl-Shift-Down","Alt-Shift-Down"),exec:function(e){e.modifyNumber(-1)},multiSelectAction:"forEach"},{name:"replace",bindKey:n("Ctrl-H","Command-Option-F"),exec:function(e){r.loadModule("ace/ext/searchbox",function(t){t.Search(e,!0)})}},{name:"undo",bindKey:n("Ctrl-Z","Command-Z"),exec:function(e){e.undo()}},{name:"redo",bindKey:n("Ctrl-Shift-Z|Ctrl-Y","Command-Shift-Z|Command-Y"),exec:function(e){e.redo()}},{name:"copylinesup",bindKey:n("Alt-Shift-Up","Command-Option-Up"),exec:function(e){e.copyLinesUp()}},{name:"movelinesup",bindKey:n("Alt-Up","Option-Up"),exec:function(e){e.moveLinesUp()}},{name:"copylinesdown",bindKey:n("Alt-Shift-Down","Command-Option-Down"),exec:function(e){e.copyLinesDown()}},{name:"movelinesdown",bindKey:n("Alt-Down","Option-Down"),exec:function(e){e.moveLinesDown()}},{name:"del",bindKey:n("Delete","Delete|Ctrl-D"),exec:function(e){e.remove("right")},multiSelectAction:"forEach"},{name:"backspace",bindKey:n("Command-Backspace|Option-Backspace|Shift-Backspace|Backspace","Ctrl-Backspace|Command-Backspace|Shift-Backspace|Backspace|Ctrl-H"),exec:function(e){e.remove("left")},multiSelectAction:"forEach"},{name:"removetolinestart",bindKey:n("Alt-Backspace","Command-Backspace"),
exec:function(e){e.removeToLineStart()},multiSelectAction:"forEach"},{name:"removetolineend",bindKey:n("Alt-Delete","Ctrl-K"),exec:function(e){e.removeToLineEnd()},multiSelectAction:"forEach"},{name:"removewordleft",bindKey:n("Ctrl-Backspace","Alt-Backspace|Ctrl-Alt-Backspace"),exec:function(e){e.removeWordLeft()},multiSelectAction:"forEach"},{name:"removewordright",bindKey:n("Ctrl-Delete","Alt-Delete"),exec:function(e){e.removeWordRight()},multiSelectAction:"forEach"},{name:"outdent",bindKey:n("Shift-Tab","Shift-Tab"),exec:function(e){e.blockOutdent()},multiSelectAction:"forEach"},{name:"indent",bindKey:n("Tab","Tab"),exec:function(e){e.indent()},multiSelectAction:"forEach"},{name:"blockoutdent",bindKey:n("Ctrl-[","Ctrl-["),exec:function(e){e.blockOutdent()},multiSelectAction:"forEachLine"},{name:"blockindent",bindKey:n("Ctrl-]","Ctrl-]"),exec:function(e){e.blockIndent()},multiSelectAction:"forEachLine"},{name:"insertstring",exec:function(e,t){e.insert(t)},multiSelectAction:"forEach"},{name:"inserttext",exec:function(e,t){e.insert(s.stringRepeat(t.text||"",t.times||1))},multiSelectAction:"forEach"},{name:"splitline",bindKey:n(null,"Ctrl-O"),exec:function(e){e.splitLine()},multiSelectAction:"forEach"},{name:"transposeletters",bindKey:n("Ctrl-T","Ctrl-T"),exec:function(e){e.transposeLetters()},multiSelectAction:function(e){e.transposeSelections(1)}},{name:"touppercase",bindKey:n("Ctrl-U","Ctrl-U"),exec:function(e){e.toUpperCase()},multiSelectAction:"forEach"},{name:"tolowercase",bindKey:n("Ctrl-Shift-U","Ctrl-Shift-U"),exec:function(e){e.toLowerCase()},multiSelectAction:"forEach"}]}),define("ace/editor",["require","exports","module","./lib/fixoldbrowsers","./lib/oop","./lib/dom","./lib/lang","./lib/useragent","./keyboard/textinput","./mouse/mouse_handler","./mouse/fold_handler","./keyboard/keybinding","./edit_session","./search","./range","./lib/event_emitter","./commands/command_manager","./commands/default_commands","./config"],function(e,t,i){"use strict";e("./lib/fixoldbrowsers");var n=e("./lib/oop"),s=e("./lib/dom"),r=e("./lib/lang"),o=e("./lib/useragent"),a=e("./keyboard/textinput").TextInput,l=e("./mouse/mouse_handler").MouseHandler,c=e("./mouse/fold_handler").FoldHandler,u=e("./keyboard/keybinding").KeyBinding,h=e("./edit_session").EditSession,d=e("./search").Search,p=e("./range").Range,f=e("./lib/event_emitter").EventEmitter,g=e("./commands/command_manager").CommandManager,m=e("./commands/default_commands").commands,v=e("./config"),y=function(e,t){var i=e.getContainerElement();this.container=i,this.renderer=e,this.commands=new g(o.isMac?"mac":"win",m),this.textInput=new a(e.getTextAreaContainer(),this),this.renderer.textarea=this.textInput.getElement(),this.keyBinding=new u(this),this.$mouseHandler=new l(this),new c(this),this.$blockScrolling=0,this.$search=(new d).set({wrap:!0}),this.setSession(t||new h("")),v.resetOptions(this),v._emit("editor",this)};(function(){n.implement(this,f),this.setKeyboardHandler=function(e){if(e)if("string"==typeof e){this.$keybindingId=e;var t=this;v.loadModule(["keybinding",e],function(i){t.$keybindingId==e&&t.keyBinding.setKeyboardHandler(i&&i.handler)})}else delete this.$keybindingId,this.keyBinding.setKeyboardHandler(e);else this.keyBinding.setKeyboardHandler(null)},this.getKeyboardHandler=function(){return this.keyBinding.getKeyboardHandler()},this.setSession=function(e){if(this.session!=e){if(this.session){var t=this.session;this.session.removeEventListener("change",this.$onDocumentChange),this.session.removeEventListener("changeMode",this.$onChangeMode),this.session.removeEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.session.removeEventListener("changeTabSize",this.$onChangeTabSize),this.session.removeEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.session.removeEventListener("changeWrapMode",this.$onChangeWrapMode),this.session.removeEventListener("onChangeFold",this.$onChangeFold),this.session.removeEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.session.removeEventListener("changeBackMarker",this.$onChangeBackMarker),this.session.removeEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.session.removeEventListener("changeAnnotation",this.$onChangeAnnotation),this.session.removeEventListener("changeOverwrite",this.$onCursorChange),this.session.removeEventListener("changeScrollTop",this.$onScrollTopChange),this.session.removeEventListener("changeScrollLeft",this.$onScrollLeftChange);var i=this.session.getSelection();i.removeEventListener("changeCursor",this.$onCursorChange),i.removeEventListener("changeSelection",this.$onSelectionChange)}this.session=e,this.$onDocumentChange=this.onDocumentChange.bind(this),e.addEventListener("change",this.$onDocumentChange),this.renderer.setSession(e),this.$onChangeMode=this.onChangeMode.bind(this),e.addEventListener("changeMode",this.$onChangeMode),this.$onTokenizerUpdate=this.onTokenizerUpdate.bind(this),e.addEventListener("tokenizerUpdate",this.$onTokenizerUpdate),this.$onChangeTabSize=this.renderer.onChangeTabSize.bind(this.renderer),e.addEventListener("changeTabSize",this.$onChangeTabSize),this.$onChangeWrapLimit=this.onChangeWrapLimit.bind(this),e.addEventListener("changeWrapLimit",this.$onChangeWrapLimit),this.$onChangeWrapMode=this.onChangeWrapMode.bind(this),e.addEventListener("changeWrapMode",this.$onChangeWrapMode),this.$onChangeFold=this.onChangeFold.bind(this),e.addEventListener("changeFold",this.$onChangeFold),this.$onChangeFrontMarker=this.onChangeFrontMarker.bind(this),this.session.addEventListener("changeFrontMarker",this.$onChangeFrontMarker),this.$onChangeBackMarker=this.onChangeBackMarker.bind(this),this.session.addEventListener("changeBackMarker",this.$onChangeBackMarker),this.$onChangeBreakpoint=this.onChangeBreakpoint.bind(this),this.session.addEventListener("changeBreakpoint",this.$onChangeBreakpoint),this.$onChangeAnnotation=this.onChangeAnnotation.bind(this),this.session.addEventListener("changeAnnotation",this.$onChangeAnnotation),this.$onCursorChange=this.onCursorChange.bind(this),this.session.addEventListener("changeOverwrite",this.$onCursorChange),this.$onScrollTopChange=this.onScrollTopChange.bind(this),this.session.addEventListener("changeScrollTop",this.$onScrollTopChange),this.$onScrollLeftChange=this.onScrollLeftChange.bind(this),this.session.addEventListener("changeScrollLeft",this.$onScrollLeftChange),this.selection=e.getSelection(),this.selection.addEventListener("changeCursor",this.$onCursorChange),this.$onSelectionChange=this.onSelectionChange.bind(this),this.selection.addEventListener("changeSelection",this.$onSelectionChange),this.onChangeMode(),this.$blockScrolling+=1,this.onCursorChange(),this.$blockScrolling-=1,this.onScrollTopChange(),this.onScrollLeftChange(),this.onSelectionChange(),this.onChangeFrontMarker(),this.onChangeBackMarker(),this.onChangeBreakpoint(),this.onChangeAnnotation(),this.session.getUseWrapMode()&&this.renderer.adjustWrapLimit(),this.renderer.updateFull(),this._emit("changeSession",{session:e,oldSession:t})}},this.getSession=function(){return this.session},this.setValue=function(e,t){return this.session.doc.setValue(e),t?1==t?this.navigateFileEnd():-1==t&&this.navigateFileStart():this.selectAll(),e},this.getValue=function(){return this.session.getValue()},this.getSelection=function(){return this.selection},this.resize=function(e){this.renderer.onResize(e)},this.setTheme=function(e){this.renderer.setTheme(e)},this.getTheme=function(){return this.renderer.getTheme()},this.setStyle=function(e){this.renderer.setStyle(e)},this.unsetStyle=function(e){this.renderer.unsetStyle(e)},this.getFontSize=function(){return this.getOption("fontSize")||s.computedStyle(this.container,"fontSize")},this.setFontSize=function(e){this.setOption("fontSize",e)},this.$highlightBrackets=function(){if(this.session.$bracketHighlight&&(this.session.removeMarker(this.session.$bracketHighlight),this.session.$bracketHighlight=null),!this.$highlightPending){var e=this;this.$highlightPending=!0,setTimeout(function(){e.$highlightPending=!1;var t=e.session.findMatchingBracket(e.getCursorPosition());if(t)var i=new p(t.row,t.column,t.row,t.column+1);else if(e.session.$mode.getMatching)var i=e.session.$mode.getMatching(e.session);i&&(e.session.$bracketHighlight=e.session.addMarker(i,"ace_bracket","text"))},50)}},this.focus=function(){var e=this;setTimeout(function(){e.textInput.focus()}),this.textInput.focus()},this.isFocused=function(){return this.textInput.isFocused()},this.blur=function(){this.textInput.blur()},this.onFocus=function(){this.$isFocused||(this.$isFocused=!0,this.renderer.showCursor(),this.renderer.visualizeFocus(),this._emit("focus"))},this.onBlur=function(){this.$isFocused&&(this.$isFocused=!1,this.renderer.hideCursor(),this.renderer.visualizeBlur(),this._emit("blur"))},this.$cursorChange=function(){this.renderer.updateCursor()},this.onDocumentChange=function(e){var t,i=e.data,n=i.range;t=n.start.row==n.end.row&&"insertLines"!=i.action&&"removeLines"!=i.action?n.end.row:1/0,this.renderer.updateLines(n.start.row,t),this._emit("change",e),this.$cursorChange()},this.onTokenizerUpdate=function(e){var t=e.data;this.renderer.updateLines(t.first,t.last)},this.onScrollTopChange=function(){this.renderer.scrollToY(this.session.getScrollTop())},this.onScrollLeftChange=function(){this.renderer.scrollToX(this.session.getScrollLeft())},this.onCursorChange=function(){this.$cursorChange(),this.$blockScrolling||this.renderer.scrollCursorIntoView(),this.$highlightBrackets(),this.$updateHighlightActiveLine(),this._emit("changeSelection")},this.$updateHighlightActiveLine=function(){var e,t=this.getSession();if(this.$highlightActiveLine&&("line"==this.$selectionStyle&&this.selection.isMultiLine()||(e=this.getCursorPosition())),t.$highlightLineMarker&&!e)t.removeMarker(t.$highlightLineMarker.id),t.$highlightLineMarker=null;else if(!t.$highlightLineMarker&&e){var i=new p(e.row,e.column,e.row,1/0);i.id=t.addMarker(i,"ace_active-line","screenLine"),t.$highlightLineMarker=i}else e&&(t.$highlightLineMarker.start.row=e.row,t.$highlightLineMarker.end.row=e.row,t.$highlightLineMarker.start.column=e.column,t._emit("changeBackMarker"))},this.onSelectionChange=function(e){var t=this.session;if(t.$selectionMarker&&t.removeMarker(t.$selectionMarker),t.$selectionMarker=null,this.selection.isEmpty())this.$updateHighlightActiveLine();else{var i=this.selection.getRange(),n=this.getSelectionStyle();t.$selectionMarker=t.addMarker(i,"ace_selection",n)}var s=this.$highlightSelectedWord&&this.$getSelectionHighLightRegexp();this.session.highlight(s),this._emit("changeSelection")},this.$getSelectionHighLightRegexp=function(){var e=this.session,t=this.getSelectionRange();if(!t.isEmpty()&&!t.isMultiLine()){var i=t.start.column-1,n=t.end.column+1,s=e.getLine(t.start.row),r=s.length,o=s.substring(Math.max(i,0),Math.min(n,r));if(!(i>=0&&/^[\w\d]/.test(o)||r>=n&&/[\w\d]$/.test(o))&&(o=s.substring(t.start.column,t.end.column),/^[\w\d]+$/.test(o))){var a=this.$search.$assembleRegExp({wholeWord:!0,caseSensitive:!0,needle:o});return a}}},this.onChangeFrontMarker=function(){this.renderer.updateFrontMarkers()},this.onChangeBackMarker=function(){this.renderer.updateBackMarkers()},this.onChangeBreakpoint=function(){this.renderer.updateBreakpoints()},this.onChangeAnnotation=function(){this.renderer.setAnnotations(this.session.getAnnotations())},this.onChangeMode=function(e){this.renderer.updateText(),this._emit("changeMode",e)},this.onChangeWrapLimit=function(){this.renderer.updateFull()},this.onChangeWrapMode=function(){this.renderer.onResize(!0)},this.onChangeFold=function(){this.$updateHighlightActiveLine(),this.renderer.updateFull()},this.getCopyText=function(){var e="";return this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange())),this._emit("copy",e),e},this.onCopy=function(){this.commands.exec("copy",this)},this.onCut=function(){this.commands.exec("cut",this)},this.onPaste=function(e){this.$readOnly||(this._emit("paste",e),this.insert(e))},this.execCommand=function(e,t){this.commands.exec(e,this,t)},this.insert=function(e){var t=this.session,i=t.getMode(),n=this.getCursorPosition();if(this.getBehavioursEnabled()){var s=i.transformAction(t.getState(n.row),"insertion",this,t,e);s&&(e=s.text)}if(e=e.replace("	",this.session.getTabString()),this.selection.isEmpty()){if(this.session.getOverwrite()){var r=new p.fromPoints(n,n);r.end.column+=e.length,this.session.remove(r)}}else n=this.session.remove(this.getSelectionRange()),this.clearSelection();this.clearSelection();var o=n.column,a=t.getState(n.row),l=t.getLine(n.row),c=i.checkOutdent(a,l,e),u=t.insert(n,e);if(s&&s.selection&&(2==s.selection.length?this.selection.setSelectionRange(new p(n.row,o+s.selection[0],n.row,o+s.selection[1])):this.selection.setSelectionRange(new p(n.row+s.selection[0],s.selection[1],n.row+s.selection[2],s.selection[3]))),t.getDocument().isNewLine(e)){var h=i.getNextLineIndent(a,l.slice(0,n.column),t.getTabString());this.moveCursorTo(n.row+1,0);for(var d=t.getTabSize(),f=Number.MAX_VALUE,g=n.row+1;g<=u.row;++g){var m=0;l=t.getLine(g);for(var v=0;v<l.length;++v)if("	"==l.charAt(v))m+=d;else{if(" "!=l.charAt(v))break;m+=1}/[^\s]/.test(l)&&(f=Math.min(m,f))}for(var g=n.row+1;g<=u.row;++g){var y=f;l=t.getLine(g);for(var v=0;v<l.length&&y>0;++v)"	"==l.charAt(v)?y-=d:" "==l.charAt(v)&&(y-=1);t.remove(new p(g,0,g,v))}t.indentRows(n.row+1,u.row,h)}c&&i.autoOutdent(a,t,n.row)},this.onTextInput=function(e){this.keyBinding.onTextInput(e)},this.onCommandKey=function(e,t,i){this.keyBinding.onCommandKey(e,t,i)},this.setOverwrite=function(e){this.session.setOverwrite(e)},this.getOverwrite=function(){return this.session.getOverwrite()},this.toggleOverwrite=function(){this.session.toggleOverwrite()},this.setScrollSpeed=function(e){this.setOption("scrollSpeed",e)},this.getScrollSpeed=function(){return this.getOption("scrollSpeed")},this.setDragDelay=function(e){this.setOption("dragDelay",e)},this.getDragDelay=function(){return this.getOption("dragDelay")},this.setSelectionStyle=function(e){this.setOption("selectionStyle",e)},this.getSelectionStyle=function(){return this.getOption("selectionStyle")},this.setHighlightActiveLine=function(e){this.setOption("highlightActiveLine",e)},this.getHighlightActiveLine=function(){return this.getOption("highlightActiveLine")},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.setHighlightSelectedWord=function(e){this.setOption("highlightSelectedWord",e)},this.getHighlightSelectedWord=function(){return this.$highlightSelectedWord},this.setAnimatedScroll=function(e){this.renderer.setAnimatedScroll(e)},this.getAnimatedScroll=function(){return this.renderer.getAnimatedScroll()},this.setShowInvisibles=function(e){this.renderer.setShowInvisibles(e)},this.getShowInvisibles=function(){return this.renderer.getShowInvisibles()},this.setDisplayIndentGuides=function(e){this.renderer.setDisplayIndentGuides(e)},this.getDisplayIndentGuides=function(){return this.renderer.getDisplayIndentGuides()},this.setShowPrintMargin=function(e){this.renderer.setShowPrintMargin(e)},this.getShowPrintMargin=function(){return this.renderer.getShowPrintMargin()},this.setPrintMarginColumn=function(e){this.renderer.setPrintMarginColumn(e)},this.getPrintMarginColumn=function(){return this.renderer.getPrintMarginColumn()},this.setReadOnly=function(e){this.setOption("readOnly",e)},this.getReadOnly=function(){return this.getOption("readOnly")},this.setBehavioursEnabled=function(e){this.setOption("behavioursEnabled",e)},this.getBehavioursEnabled=function(){return this.getOption("behavioursEnabled")},this.setWrapBehavioursEnabled=function(e){this.setOption("wrapBehavioursEnabled",e)},this.getWrapBehavioursEnabled=function(){return this.getOption("wrapBehavioursEnabled")},this.setShowFoldWidgets=function(e){this.setOption("showFoldWidgets",e)},this.getShowFoldWidgets=function(){return this.getOption("showFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.remove=function(e){this.selection.isEmpty()&&("left"==e?this.selection.selectLeft():this.selection.selectRight());var t=this.getSelectionRange();if(this.getBehavioursEnabled()){var i=this.session,n=i.getState(t.start.row),s=i.getMode().transformAction(n,"deletion",this,i,t);s&&(t=s)}this.session.remove(t),this.clearSelection()},this.removeWordRight=function(){this.selection.isEmpty()&&this.selection.selectWordRight(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeWordLeft=function(){this.selection.isEmpty()&&this.selection.selectWordLeft(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineStart=function(){this.selection.isEmpty()&&this.selection.selectLineStart(),this.session.remove(this.getSelectionRange()),this.clearSelection()},this.removeToLineEnd=function(){this.selection.isEmpty()&&this.selection.selectLineEnd();var e=this.getSelectionRange();e.start.column==e.end.column&&e.start.row==e.end.row&&(e.end.column=0,e.end.row++),this.session.remove(e),this.clearSelection()},this.splitLine=function(){this.selection.isEmpty()||(this.session.remove(this.getSelectionRange()),this.clearSelection());var e=this.getCursorPosition();this.insert("\n"),this.moveCursorToPosition(e)},this.transposeLetters=function(){if(this.selection.isEmpty()){var e=this.getCursorPosition(),t=e.column;if(0!==t){var i,n,s=this.session.getLine(e.row);t<s.length?(i=s.charAt(t)+s.charAt(t-1),n=new p(e.row,t-1,e.row,t+1)):(i=s.charAt(t-1)+s.charAt(t-2),n=new p(e.row,t-2,e.row,t)),this.session.replace(n,i)}}},this.toLowerCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toLowerCase()),this.selection.setSelectionRange(e)},this.toUpperCase=function(){var e=this.getSelectionRange();this.selection.isEmpty()&&this.selection.selectWord();var t=this.getSelectionRange(),i=this.session.getTextRange(t);this.session.replace(t,i.toUpperCase()),this.selection.setSelectionRange(e)},this.indent=function(){var e=this.session,t=this.getSelectionRange();if(!(t.start.row<t.end.row||t.start.column<t.end.column)){var i;if(this.session.getUseSoftTabs()){var n=e.getTabSize(),s=this.getCursorPosition(),o=e.documentToScreenColumn(s.row,s.column),a=n-o%n;i=r.stringRepeat(" ",a)}else i="	";return this.insert(i)}var l=this.$getSelectedRows();e.indentRows(l.first,l.last,"	")},this.blockIndent=function(){var e=this.$getSelectedRows();this.session.indentRows(e.first,e.last,"	")},this.blockOutdent=function(){var e=this.session.getSelection();this.session.outdentRows(e.getRange())},this.sortLines=function(){var e=this.$getSelectedRows(),t=this.session,i=[];for(s=e.first;s<=e.last;s++)i.push(t.getLine(s));i.sort(function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0});for(var n=new p(0,0,0,0),s=e.first;s<=e.last;s++){var r=t.getLine(s);n.start.row=s,n.end.row=s,n.end.column=r.length,t.replace(n,i[s-e.first])}},this.toggleCommentLines=function(){var e=this.session.getState(this.getCursorPosition().row),t=this.$getSelectedRows();this.session.getMode().toggleCommentLines(e,this.session,t.first,t.last)},this.toggleBlockComment=function(){var e=this.getCursorPosition(),t=this.session.getState(e.row),i=this.getSelectionRange();this.session.getMode().toggleBlockComment(t,this.session,i,e)},this.getNumberAt=function(e,t){var i=/[\-]?[0-9]+(?:\.[0-9]+)?/g;i.lastIndex=0;for(var n=this.session.getLine(e);i.lastIndex<t;){var s=i.exec(n);if(s.index<=t&&s.index+s[0].length>=t){var r={value:s[0],start:s.index,end:s.index+s[0].length};return r}}return null},this.modifyNumber=function(e){var t=this.selection.getCursor().row,i=this.selection.getCursor().column,n=new p(t,i-1,t,i),s=this.session.getTextRange(n);if(!isNaN(parseFloat(s))&&isFinite(s)){var r=this.getNumberAt(t,i);if(r){var o=r.value.indexOf(".")>=0?r.start+r.value.indexOf(".")+1:r.end,a=r.start+r.value.length-o,l=parseFloat(r.value);l*=Math.pow(10,a),e*=o!==r.end&&o>i?Math.pow(10,r.end-i-1):Math.pow(10,r.end-i),l+=e,l/=Math.pow(10,a);var c=l.toFixed(a),u=new p(t,r.start,t,r.end);this.session.replace(u,c),this.moveCursorTo(t,Math.max(r.start+1,i+c.length-r.value.length))}}},this.removeLines=function(){var e,t=this.$getSelectedRows();e=0===t.first||t.last+1<this.session.getLength()?new p(t.first,0,t.last+1,0):new p(t.first-1,this.session.getLine(t.first-1).length,t.last,this.session.getLine(t.last).length),this.session.remove(e),this.clearSelection()},this.duplicateSelection=function(){var e=this.selection,t=this.session,i=e.getRange(),n=e.isBackwards();if(i.isEmpty()){var s=i.start.row;t.duplicateLines(s,s)}else{var r=n?i.start:i.end,o=t.insert(r,t.getTextRange(i),!1);i.start=r,i.end=o,e.setSelectionRange(i,n)}},this.moveLinesDown=function(){this.$moveLines(function(e,t){return this.session.moveLinesDown(e,t)})},this.moveLinesUp=function(){this.$moveLines(function(e,t){return this.session.moveLinesUp(e,t)})},this.moveText=function(e,t){return this.session.moveText(e,t)},this.copyLinesUp=function(){this.$moveLines(function(e,t){return this.session.duplicateLines(e,t),0})},this.copyLinesDown=function(){this.$moveLines(function(e,t){return this.session.duplicateLines(e,t)})},this.$moveLines=function(e){var t=this.selection;if(!t.inMultiSelectMode||this.inVirtualSelectionMode){var i=t.toOrientedRange(),n=this.$getSelectedRows(i),s=e.call(this,n.first,n.last);i.moveBy(s,0),t.fromOrientedRange(i)}else{var r=t.rangeList.ranges;t.rangeList.detach(this.session);for(var o=r.length;o--;){for(var a=o,n=r[o].collapseRows(),l=n.end.row,c=n.start.row;o--;){var n=r[o].collapseRows();if(!(c-n.end.row<=1))break;c=n.end.row}o++;for(var s=e.call(this,c,l);a>=o;)r[a].moveBy(s,0),a--}t.fromOrientedRange(t.ranges[0]),t.rangeList.attach(this.session)}},this.$getSelectedRows=function(){var e=this.getSelectionRange().collapseRows();return{first:e.start.row,last:e.end.row}},this.onCompositionStart=function(e){this.renderer.showComposition(this.getCursorPosition())},this.onCompositionUpdate=function(e){this.renderer.setCompositionText(e)},this.onCompositionEnd=function(){this.renderer.hideComposition()},this.getFirstVisibleRow=function(){return this.renderer.getFirstVisibleRow()},this.getLastVisibleRow=function(){return this.renderer.getLastVisibleRow()},this.isRowVisible=function(e){return e>=this.getFirstVisibleRow()&&e<=this.getLastVisibleRow()},this.isRowFullyVisible=function(e){return e>=this.renderer.getFirstFullyVisibleRow()&&e<=this.renderer.getLastFullyVisibleRow()},this.$getVisibleRowCount=function(){return this.renderer.getScrollBottomRow()-this.renderer.getScrollTopRow()+1},this.$moveByPage=function(e,t){var i=this.renderer,n=this.renderer.layerConfig,s=e*Math.floor(n.height/n.lineHeight);this.$blockScrolling++,1==t?this.selection.$moveSelection(function(){this.moveCursorBy(s,0)}):0==t&&(this.selection.moveCursorBy(s,0),this.selection.clearSelection()),this.$blockScrolling--;var r=i.scrollTop;i.scrollBy(0,s*n.lineHeight),null!=t&&i.scrollCursorIntoView(null,.5),i.animateScrolling(r)},this.selectPageDown=function(){this.$moveByPage(1,!0)},this.selectPageUp=function(){this.$moveByPage(-1,!0)},this.gotoPageDown=function(){this.$moveByPage(1,!1)},this.gotoPageUp=function(){this.$moveByPage(-1,!1)},this.scrollPageDown=function(){this.$moveByPage(1)},this.scrollPageUp=function(){this.$moveByPage(-1)},this.scrollToRow=function(e){this.renderer.scrollToRow(e)},this.scrollToLine=function(e,t,i,n){this.renderer.scrollToLine(e,t,i,n)},this.centerSelection=function(){var e=this.getSelectionRange(),t={row:Math.floor(e.start.row+(e.end.row-e.start.row)/2),column:Math.floor(e.start.column+(e.end.column-e.start.column)/2)};this.renderer.alignCursor(t,.5)},this.getCursorPosition=function(){return this.selection.getCursor()},this.getCursorPositionScreen=function(){return this.session.documentToScreenPosition(this.getCursorPosition())},this.getSelectionRange=function(){return this.selection.getRange()},this.selectAll=function(){this.$blockScrolling+=1,this.selection.selectAll(),this.$blockScrolling-=1},this.clearSelection=function(){this.selection.clearSelection()},this.moveCursorTo=function(e,t){this.selection.moveCursorTo(e,t)},this.moveCursorToPosition=function(e){this.selection.moveCursorToPosition(e)},this.jumpToMatching=function(e){var t=this.getCursorPosition(),i=this.session.getBracketRange(t);if(!i){if(i=this.find({needle:/[{}()\[\]]/g,preventScroll:!0,start:{row:t.row,column:t.column-1}}),!i)return;var n=i.start;n.row==t.row&&Math.abs(n.column-t.column)<2&&(i=this.session.getBracketRange(n))}n=i&&i.cursor||n,n&&(e?i&&i.isEqual(this.getSelectionRange())?this.clearSelection():this.selection.selectTo(n.row,n.column):(this.clearSelection(),this.moveCursorTo(n.row,n.column)))},this.gotoLine=function(e,t,i){this.selection.clearSelection(),this.session.unfold({row:e-1,column:t||0}),this.$blockScrolling+=1,this.exitMultiSelectMode&&this.exitMultiSelectMode(),this.moveCursorTo(e-1,t||0),this.$blockScrolling-=1,this.isRowFullyVisible(e-1)||this.scrollToLine(e-1,!0,i)},this.navigateTo=function(e,t){this.clearSelection(),this.moveCursorTo(e,t)},this.navigateUp=function(e){if(this.selection.isMultiLine()&&!this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),e=e||1,this.selection.moveCursorBy(-e,0)},this.navigateDown=function(e){if(this.selection.isMultiLine()&&this.selection.isBackwards()){var t=this.selection.anchor.getPosition();return this.moveCursorToPosition(t)}this.selection.clearSelection(),e=e||1,this.selection.moveCursorBy(e,0)},this.navigateLeft=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorLeft();else{var t=this.getSelectionRange().start;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateRight=function(e){if(this.selection.isEmpty())for(e=e||1;e--;)this.selection.moveCursorRight();else{var t=this.getSelectionRange().end;this.moveCursorToPosition(t)}this.clearSelection()},this.navigateLineStart=function(){this.selection.moveCursorLineStart(),this.clearSelection()},this.navigateLineEnd=function(){this.selection.moveCursorLineEnd(),this.clearSelection()},this.navigateFileEnd=function(){var e=this.renderer.scrollTop;this.selection.moveCursorFileEnd(),this.clearSelection(),this.renderer.animateScrolling(e)},this.navigateFileStart=function(){var e=this.renderer.scrollTop;this.selection.moveCursorFileStart(),this.clearSelection(),this.renderer.animateScrolling(e)},this.navigateWordRight=function(){this.selection.moveCursorWordRight(),this.clearSelection()},this.navigateWordLeft=function(){this.selection.moveCursorWordLeft(),this.clearSelection()},this.replace=function(e,t){t&&this.$search.set(t);var i=this.$search.find(this.session),n=0;return i?(this.$tryReplace(i,e)&&(n=1),null!==i&&(this.selection.setSelectionRange(i),this.renderer.scrollSelectionIntoView(i.start,i.end)),n):n},this.replaceAll=function(e,t){t&&this.$search.set(t);var i=this.$search.findAll(this.session),n=0;if(!i.length)return n;this.$blockScrolling+=1;var s=this.getSelectionRange();this.clearSelection(),this.selection.moveCursorTo(0,0);for(var r=i.length-1;r>=0;--r)this.$tryReplace(i[r],e)&&n++;return this.selection.setSelectionRange(s),this.$blockScrolling-=1,n},this.$tryReplace=function(e,t){var i=this.session.getTextRange(e);return t=this.$search.replace(i,t),null!==t?(e.end=this.session.replace(e,t),e):null},this.getLastSearchOptions=function(){return this.$search.getOptions()},this.find=function(e,t,i){t||(t={}),"string"==typeof e||e instanceof RegExp?t.needle=e:"object"==typeof e&&n.mixin(t,e);var s=this.selection.getRange();null==t.needle&&(e=this.session.getTextRange(s)||this.$search.$options.needle,e||(s=this.session.getWordRange(s.start.row,s.start.column),e=this.session.getTextRange(s)),this.$search.set({needle:e})),this.$search.set(t),t.start||this.$search.set({start:s});var r=this.$search.find(this.session);return t.preventScroll?r:r?(this.revealRange(r,i),r):(t.backwards?s.start=s.end:s.end=s.start,void this.selection.setRange(s))},this.findNext=function(e,t){this.find({skipCurrent:!0,backwards:!1},e,t)},this.findPrevious=function(e,t){this.find(e,{skipCurrent:!0,backwards:!0},t)},this.revealRange=function(e,t){this.$blockScrolling+=1,this.session.unfold(e),this.selection.setSelectionRange(e),this.$blockScrolling-=1;var i=this.renderer.scrollTop;this.renderer.scrollSelectionIntoView(e.start,e.end,.5),0!=t&&this.renderer.animateScrolling(i)},this.undo=function(){this.$blockScrolling++,this.session.getUndoManager().undo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.redo=function(){this.$blockScrolling++,this.session.getUndoManager().redo(),this.$blockScrolling--,this.renderer.scrollCursorIntoView(null,.5)},this.destroy=function(){this.renderer.destroy(),this._emit("destroy",this)},this.setAutoScrollEditorIntoView=function(e){if(e!==!1){var t,i=this,n=!1;this.$scrollAnchor||(this.$scrollAnchor=document.createElement("div"));var s=this.$scrollAnchor;s.style.cssText="position:absolute",this.container.insertBefore(s,this.container.firstChild);var r=this.on("changeSelection",function(){n=!0}),o=this.renderer.on("beforeRender",function(){n&&(t=i.renderer.container.getBoundingClientRect())}),a=this.renderer.on("afterRender",function(){if(n&&t&&i.isFocused()){var e=i.renderer,r=e.$cursorLayer.$pixelPos,o=e.layerConfig,a=r.top-o.offset;n=r.top>=0&&a+t.top<0?!0:r.top<o.height&&r.top+t.top+o.lineHeight>window.innerHeight?!1:null,null!=n&&(s.style.top=a+"px",s.style.left=r.left+"px",s.style.height=o.lineHeight+"px",s.scrollIntoView(n)),n=t=null}});this.setAutoScrollEditorIntoView=function(e){e!==!0&&(delete this.setAutoScrollEditorIntoView,this.removeEventListener("changeSelection",r),this.renderer.removeEventListener("afterRender",a),this.renderer.removeEventListener("beforeRender",o))}}},this.$resetCursorStyle=function(){var e=this.$cursorStyle||"ace",t=this.renderer.$cursorLayer;t&&(t.setSmoothBlinking("smooth"==e),t.isBlinking=!this.$readOnly&&"wide"!=e)}}).call(y.prototype),v.defineOptions(y.prototype,"editor",{selectionStyle:{set:function(e){this.onSelectionChange(),this._emit("changeSelectionStyle",{data:e})},initialValue:"line"},highlightActiveLine:{set:function(){this.$updateHighlightActiveLine()},initialValue:!0},highlightSelectedWord:{set:function(e){this.$onSelectionChange()},initialValue:!0},readOnly:{set:function(e){this.$resetCursorStyle()},initialValue:!1},cursorStyle:{set:function(e){this.$resetCursorStyle()},values:["ace","slim","smooth","wide"],initialValue:"ace"},behavioursEnabled:{initialValue:!0},wrapBehavioursEnabled:{initialValue:!0},hScrollBarAlwaysVisible:"renderer",highlightGutterLine:"renderer",animatedScroll:"renderer",showInvisibles:"renderer",showPrintMargin:"renderer",printMarginColumn:"renderer",printMargin:"renderer",fadeFoldWidgets:"renderer",showFoldWidgets:"renderer",showGutter:"renderer",displayIndentGuides:"renderer",fontSize:"renderer",fontFamily:"renderer",scrollSpeed:"$mouseHandler",dragDelay:"$mouseHandler",focusTimout:"$mouseHandler",firstLineNumber:"session",overwrite:"session",newLineMode:"session",useWorker:"session",useSoftTabs:"session",tabSize:"session",wrap:"session",foldStyle:"session"}),t.Editor=y}),define("ace/undomanager",["require","exports","module"],function(e,t,i){"use strict";var n=function(){this.reset()};(function(){this.execute=function(e){var t=e.args[0];this.$doc=e.args[1],this.$undoStack.push(t),this.$redoStack=[],this.dirtyCounter<0&&(this.dirtyCounter=NaN),this.dirtyCounter++},this.undo=function(e){var t=this.$undoStack.pop(),i=null;return t&&(i=this.$doc.undoChanges(t,e),this.$redoStack.push(t),this.dirtyCounter--),
i},this.redo=function(e){var t=this.$redoStack.pop(),i=null;return t&&(i=this.$doc.redoChanges(t,e),this.$undoStack.push(t),this.dirtyCounter++),i},this.reset=function(){this.$undoStack=[],this.$redoStack=[],this.dirtyCounter=0},this.hasUndo=function(){return this.$undoStack.length>0},this.hasRedo=function(){return this.$redoStack.length>0},this.markClean=function(){this.dirtyCounter=0},this.isClean=function(){return 0===this.dirtyCounter}}).call(n.prototype),t.UndoManager=n}),define("ace/layer/gutter",["require","exports","module","../lib/dom","../lib/oop","../lib/lang","../lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/dom"),s=e("../lib/oop"),r=e("../lib/lang"),o=e("../lib/event_emitter").EventEmitter,a=function(e){this.element=n.createElement("div"),this.element.className="ace_layer ace_gutter-layer",e.appendChild(this.element),this.setShowFoldWidgets(this.$showFoldWidgets),this.gutterWidth=0,this.$annotations=[],this.$updateAnnotations=this.$updateAnnotations.bind(this)};(function(){s.implement(this,o),this.setSession=function(e){this.session&&this.session.removeEventListener("change",this.$updateAnnotations),this.session=e,e.on("change",this.$updateAnnotations)},this.addGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.addGutterDecoration"),this.session.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){window.console&&console.warn&&console.warn("deprecated use session.removeGutterDecoration"),this.session.removeGutterDecoration(e,t)},this.setAnnotations=function(e){this.$annotations=[];for(var t,i,n=0;n<e.length;n++){var s=e[n],i=s.row,t=this.$annotations[i];t||(t=this.$annotations[i]={text:[]});var o=s.text;o=o?r.escapeHTML(o):s.html||"",-1===t.text.indexOf(o)&&t.text.push(o);var a=s.type;"error"==a?t.className=" ace_error":"warning"==a&&" ace_error"!=t.className?t.className=" ace_warning":"info"!=a||t.className||(t.className=" ace_info")}},this.$updateAnnotations=function(e){if(this.$annotations.length){var t=e.data,i=t.range,n=i.start.row,s=i.end.row-n;if(0===s);else if("removeText"==t.action||"removeLines"==t.action)this.$annotations.splice(n,s+1,null);else{var r=Array(s+1);r.unshift(n,1),this.$annotations.splice.apply(this.$annotations,r)}}},this.update=function(e){for(var t={className:""},i=[],s=e.firstRow,r=e.lastRow,o=this.session.getNextFoldLine(s),a=o?o.start.row:1/0,l=this.$showFoldWidgets&&this.session.foldWidgets,c=this.session.$breakpoints,u=this.session.$decorations,h=this.session.$firstLineNumber,d=0;;){if(s>a&&(s=o.end.row+1,o=this.session.getNextFoldLine(s,o),a=o?o.start.row:1/0),s>r)break;var p=this.$annotations[s]||t;if(i.push("<div class='ace_gutter-cell ",c[s]||"",u[s]||"",p.className,"' style='height:",this.session.getRowLength(s)*e.lineHeight,"px;'>",d=s+h),l){var f=l[s];null==f&&(f=l[s]=this.session.getFoldWidget(s)),f&&i.push("<span class='ace_fold-widget ace_",f,"start"==f&&s==a&&s<o.end.row?" ace_closed":" ace_open","' style='height:",e.lineHeight,"px","'></span>")}i.push("</div>"),s++}this.element=n.setInnerHtml(this.element,i.join("")),this.element.style.height=e.minHeight+"px",this.session.$useWrapMode&&(d=this.session.getLength());var g=(""+d).length*e.characterWidth,m=this.$padding||this.$computePadding();g+=m.left+m.right,g!==this.gutterWidth&&(this.gutterWidth=g,this.element.style.width=Math.ceil(this.gutterWidth)+"px",this._emit("changeGutterWidth",g))},this.$showFoldWidgets=!0,this.setShowFoldWidgets=function(e){e?n.addCssClass(this.element,"ace_folding-enabled"):n.removeCssClass(this.element,"ace_folding-enabled"),this.$showFoldWidgets=e,this.$padding=null},this.getShowFoldWidgets=function(){return this.$showFoldWidgets},this.$computePadding=function(){if(!this.element.firstChild)return{left:0,right:0};var e=n.computedStyle(this.element.firstChild);return this.$padding={},this.$padding.left=parseInt(e.paddingLeft)+1,this.$padding.right=parseInt(e.paddingRight),this.$padding},this.getRegion=function(e){var t=this.$padding||this.$computePadding(),i=this.element.getBoundingClientRect();return e.x<t.left+i.left?"markers":this.$showFoldWidgets&&e.x>i.right-t.right?"foldWidgets":void 0}}).call(a.prototype),t.Gutter=a}),define("ace/layer/marker",["require","exports","module","../range","../lib/dom"],function(e,t,i){"use strict";var n=e("../range").Range,s=e("../lib/dom"),r=function(e){this.element=s.createElement("div"),this.element.className="ace_layer ace_marker-layer",e.appendChild(this.element)};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setMarkers=function(e){this.markers=e},this.update=function(e){var e=e||this.config;if(e){this.config=e;var t=[];for(var i in this.markers){var n=this.markers[i];if(n.range){var r=n.range.clipRows(e.firstRow,e.lastRow);if(!r.isEmpty())if(r=r.toScreenRange(this.session),n.renderer){var o=this.$getTop(r.start.row,e),a=this.$padding+r.start.column*e.characterWidth;n.renderer(t,r,a,o,e)}else"fullLine"==n.type?this.drawFullLineMarker(t,r,n.clazz,e):"screenLine"==n.type?this.drawScreenLineMarker(t,r,n.clazz,e):r.isMultiLine()?"text"==n.type?this.drawTextMarker(t,r,n.clazz,e):this.drawMultiLineMarker(t,r,n.clazz,e):this.drawSingleLineMarker(t,r,n.clazz+" ace_start",e)}else n.update(t,this,this.session,e)}this.element=s.setInnerHtml(this.element,t.join(""))}},this.$getTop=function(e,t){return(e-t.firstRowScreen)*t.lineHeight},this.drawTextMarker=function(e,t,i,s,r){var o=t.start.row,a=new n(o,t.start.column,o,this.session.getScreenLastRowColumn(o));for(this.drawSingleLineMarker(e,a,i+" ace_start",s,1,r),o=t.end.row,a=new n(o,0,o,t.end.column),this.drawSingleLineMarker(e,a,i,s,0,r),o=t.start.row+1;o<t.end.row;o++)a.start.row=o,a.end.row=o,a.end.column=this.session.getScreenLastRowColumn(o),this.drawSingleLineMarker(e,a,i,s,1,r)},this.drawMultiLineMarker=function(e,t,i,n,s){var r=this.$padding,o=n.lineHeight,a=this.$getTop(t.start.row,n),l=r+t.start.column*n.characterWidth;s=s||"",e.push("<div class='",i," ace_start' style='","height:",o,"px;","right:0;","top:",a,"px;","left:",l,"px;",s,"'></div>"),a=this.$getTop(t.end.row,n);var c=t.end.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",o,"px;","width:",c,"px;","top:",a,"px;","left:",r,"px;",s,"'></div>"),o=(t.end.row-t.start.row-1)*n.lineHeight,0>o||(a=this.$getTop(t.start.row+1,n),e.push("<div class='",i,"' style='","height:",o,"px;","right:0;","top:",a,"px;","left:",r,"px;",s,"'></div>"))},this.drawSingleLineMarker=function(e,t,i,n,s,r){var o=n.lineHeight,a=(t.end.column+(s||0)-t.start.column)*n.characterWidth,l=this.$getTop(t.start.row,n),c=this.$padding+t.start.column*n.characterWidth;e.push("<div class='",i,"' style='","height:",o,"px;","width:",a,"px;","top:",l,"px;","left:",c,"px;",r||"","'></div>")},this.drawFullLineMarker=function(e,t,i,n,s){var r=this.$getTop(t.start.row,n),o=n.lineHeight;t.start.row!=t.end.row&&(o+=this.$getTop(t.end.row,n)-r),e.push("<div class='",i,"' style='","height:",o,"px;","top:",r,"px;","left:0;right:0;",s||"","'></div>")},this.drawScreenLineMarker=function(e,t,i,n,s){var r=this.$getTop(t.start.row,n),o=n.lineHeight;e.push("<div class='",i,"' style='","height:",o,"px;","top:",r,"px;","left:0;right:0;",s||"","'></div>")}}).call(r.prototype),t.Marker=r}),define("ace/layer/text",["require","exports","module","../lib/oop","../lib/dom","../lib/lang","../lib/useragent","../lib/event_emitter"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/dom"),r=e("../lib/lang"),o=e("../lib/useragent"),a=e("../lib/event_emitter").EventEmitter,l=function(e){this.element=s.createElement("div"),this.element.className="ace_layer ace_text-layer",e.appendChild(this.element),this.$characterSize={width:0,height:0},this.checkForSizeChanges(),this.$pollSizeChanges()};(function(){n.implement(this,a),this.EOF_CHAR="¬∂",this.EOL_CHAR="¬¨",this.TAB_CHAR="‚Üí",this.SPACE_CHAR="¬∑",this.$padding=0,this.setPadding=function(e){this.$padding=e,this.element.style.padding="0 "+e+"px"},this.getLineHeight=function(){return this.$characterSize.height||1},this.getCharacterWidth=function(){return this.$characterSize.width||1},this.checkForSizeChanges=function(){var e=this.$measureSizes();if(e&&(this.$characterSize.width!==e.width||this.$characterSize.height!==e.height)){this.$measureNode.style.fontWeight="bold";var t=this.$measureSizes();this.$measureNode.style.fontWeight="",this.$characterSize=e,this.allowBoldFonts=t&&t.width===e.width&&t.height===e.height,this._emit("changeCharacterSize",{data:e})}},this.$pollSizeChanges=function(){var e=this;this.$pollSizeChangesTimer=setInterval(function(){e.checkForSizeChanges()},500)},this.$fontStyles={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,lineHeight:1},this.$measureSizes=o.isIE||o.isOldGecko?function(){var e=1e3;if(!this.$measureNode){var t=this.$measureNode=s.createElement("div"),i=t.style;if(i.width=i.height="auto",i.left=i.top=40*-e+"px",i.visibility="hidden",i.position="fixed",i.overflow="visible",i.whiteSpace="nowrap",t.innerHTML=r.stringRepeat("Xy",e),this.element.ownerDocument.body)this.element.ownerDocument.body.appendChild(t);else{for(var n=this.element.parentNode;!s.hasCssClass(n,"ace_editor");)n=n.parentNode;n.appendChild(t)}}if(!this.element.offsetWidth)return null;var i=this.$measureNode.style,o=s.computedStyle(this.element);for(var a in this.$fontStyles)i[a]=o[a];var l={height:this.$measureNode.offsetHeight,width:this.$measureNode.offsetWidth/(2*e)};return 0==l.width||0==l.height?null:l}:function(){if(!this.$measureNode){var e=this.$measureNode=s.createElement("div"),t=e.style;t.width=t.height="auto",t.left=t.top="-100px",t.visibility="hidden",t.position="fixed",t.overflow="visible",t.whiteSpace="nowrap",e.innerHTML="X";for(var i=this.element.parentNode;i&&!s.hasCssClass(i,"ace_editor");)i=i.parentNode;if(!i)return this.$measureNode=null;i.appendChild(e)}var n=this.$measureNode.getBoundingClientRect(),r={height:n.height,width:n.width};return 0==r.width||0==r.height?null:r},this.setSession=function(e){this.session=e,this.$computeTabString()},this.showInvisibles=!1,this.setShowInvisibles=function(e){return this.showInvisibles==e?!1:(this.showInvisibles=e,this.$computeTabString(),!0)},this.displayIndentGuides=!0,this.setDisplayIndentGuides=function(e){return this.displayIndentGuides==e?!1:(this.displayIndentGuides=e,this.$computeTabString(),!0)},this.$tabStrings=[],this.onChangeTabSize=this.$computeTabString=function(){var e=this.session.getTabSize();this.tabSize=e;for(var t=this.$tabStrings=[0],i=1;e+1>i;i++)this.showInvisibles?t.push("<span class='ace_invisible'>"+this.TAB_CHAR+r.stringRepeat("¬†",i-1)+"</span>"):t.push(r.stringRepeat("¬†",i));if(this.displayIndentGuides){this.$indentGuideRe=/\s\S| \t|\t |\s$/;var n="ace_indent-guide";if(this.showInvisibles){n+=" ace_invisible";var s=r.stringRepeat(this.SPACE_CHAR,this.tabSize),o=this.TAB_CHAR+r.stringRepeat("¬†",this.tabSize-1)}else var s=r.stringRepeat("¬†",this.tabSize),o=s;this.$tabStrings[" "]="<span class='"+n+"'>"+s+"</span>",this.$tabStrings["	"]="<span class='"+n+"'>"+o+"</span>"}},this.updateLines=function(e,t,i){(this.config.lastRow!=e.lastRow||this.config.firstRow!=e.firstRow)&&this.scrollLines(e),this.config=e;for(var n=Math.max(t,e.firstRow),r=Math.min(i,e.lastRow),o=this.element.childNodes,a=0,l=e.firstRow;n>l;l++){var c=this.session.getFoldLine(l);if(c){if(c.containsRow(n)){n=c.start.row;break}l=c.end.row}a++}for(var l=n,c=this.session.getNextFoldLine(l),u=c?c.start.row:1/0;;){if(l>u&&(l=c.end.row+1,c=this.session.getNextFoldLine(l,c),u=c?c.start.row:1/0),l>r)break;var h=o[a++];if(h){var d=[];this.$renderLine(d,l,!this.$useLineGroups(),l==u?c:!1),s.setInnerHtml(h,d.join(""))}l++}},this.scrollLines=function(e){var t=this.config;if(this.config=e,!t||t.lastRow<e.firstRow)return this.update(e);if(e.lastRow<t.firstRow)return this.update(e);var i=this.element;if(t.firstRow<e.firstRow)for(var n=this.session.getFoldedRowCount(t.firstRow,e.firstRow-1);n>0;n--)i.removeChild(i.firstChild);if(t.lastRow>e.lastRow)for(var n=this.session.getFoldedRowCount(e.lastRow+1,t.lastRow);n>0;n--)i.removeChild(i.lastChild);if(e.firstRow<t.firstRow){var s=this.$renderLinesFragment(e,e.firstRow,t.firstRow-1);i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s)}if(e.lastRow>t.lastRow){var s=this.$renderLinesFragment(e,t.lastRow+1,e.lastRow);i.appendChild(s)}},this.$renderLinesFragment=function(e,t,i){for(var n=this.element.ownerDocument.createDocumentFragment(),r=t,o=this.session.getNextFoldLine(r),a=o?o.start.row:1/0;;){if(r>a&&(r=o.end.row+1,o=this.session.getNextFoldLine(r,o),a=o?o.start.row:1/0),r>i)break;var l=s.createElement("div"),c=[];if(this.$renderLine(c,r,!1,r==a?o:!1),l.innerHTML=c.join(""),this.$useLineGroups())l.className="ace_line_group",n.appendChild(l);else for(var u=l.childNodes;u.length;)n.appendChild(u[0]);r++}return n},this.update=function(e){this.config=e;for(var t=[],i=e.firstRow,n=e.lastRow,r=i,o=this.session.getNextFoldLine(r),a=o?o.start.row:1/0;;){if(r>a&&(r=o.end.row+1,o=this.session.getNextFoldLine(r,o),a=o?o.start.row:1/0),r>n)break;this.$useLineGroups()&&t.push("<div class='ace_line_group'>"),this.$renderLine(t,r,!1,r==a?o:!1),this.$useLineGroups()&&t.push("</div>"),r++}this.element=s.setInnerHtml(this.element,t.join(""))},this.$textToken={text:!0,rparen:!0,lparen:!0},this.$renderToken=function(e,t,i,n){var s=this,o=/\t|&|<|( +)|([\x00-\x1f\x80-\xa0\u1680\u180E\u2000-\u200f\u2028\u2029\u202F\u205F\u3000\uFEFF])|[\u1100-\u115F\u11A3-\u11A7\u11FA-\u11FF\u2329-\u232A\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3000-\u303E\u3041-\u3096\u3099-\u30FF\u3105-\u312D\u3131-\u318E\u3190-\u31BA\u31C0-\u31E3\u31F0-\u321E\u3220-\u3247\u3250-\u32FE\u3300-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFAFF\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE66\uFE68-\uFE6B\uFF01-\uFF60\uFFE0-\uFFE6]/g,a=function(e,i,n,o,a){if(i)return s.showInvisibles?"<span class='ace_invisible'>"+r.stringRepeat(s.SPACE_CHAR,e.length)+"</span>":r.stringRepeat("¬†",e.length);if("&"==e)return"&#38;";if("<"==e)return"&#60;";if("	"==e){var l=s.session.getScreenTabSize(t+o);return t+=l-1,s.$tabStrings[l]}if("„ÄÄ"==e){var c=s.showInvisibles?"ace_cjk ace_invisible":"ace_cjk",u=s.showInvisibles?s.SPACE_CHAR:"";return t+=1,"<span class='"+c+"' style='width:"+2*s.config.characterWidth+"px'>"+u+"</span>"}return n?"<span class='ace_invisible ace_invalid'>"+s.SPACE_CHAR+"</span>":(t+=1,"<span class='ace_cjk' style='width:"+2*s.config.characterWidth+"px'>"+e+"</span>")},l=n.replace(o,a);if(this.$textToken[i.type])e.push(l);else{var c="ace_"+i.type.replace(/\./g," ace_"),u="";"fold"==i.type&&(u=" style='width:"+i.value.length*this.config.characterWidth+"px;' "),e.push("<span class='",c,"'",u,">",l,"</span>")}return t+n.length},this.renderIndentGuide=function(e,t){var i=t.search(this.$indentGuideRe);return 0>=i?t:" "==t[0]?(i-=i%this.tabSize,e.push(r.stringRepeat(this.$tabStrings[" "],i/this.tabSize)),t.substr(i)):"	"==t[0]?(e.push(r.stringRepeat(this.$tabStrings["	"],i)),t.substr(i)):t},this.$renderWrappedLine=function(e,t,i,n){for(var s=0,r=0,o=i[0],a=0,l=0;l<t.length;l++){var c=t[l],u=c.value;if(0==l&&this.displayIndentGuides){if(s=u.length,u=this.renderIndentGuide(e,u),!u)continue;s-=u.length}if(s+u.length<o)a=this.$renderToken(e,a,c,u),s+=u.length;else{for(;s+u.length>=o;)a=this.$renderToken(e,a,c,u.substring(0,o-s)),u=u.substring(o-s),s=o,n||e.push("</div>","<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),r++,a=0,o=i[r]||Number.MAX_VALUE;0!=u.length&&(s+=u.length,a=this.$renderToken(e,a,c,u))}}},this.$renderSimpleLine=function(e,t){var i=0,n=t[0],s=n.value;this.displayIndentGuides&&(s=this.renderIndentGuide(e,s)),s&&(i=this.$renderToken(e,i,n,s));for(var r=1;r<t.length;r++)n=t[r],s=n.value,i=this.$renderToken(e,i,n,s)},this.$renderLine=function(e,t,i,n){if(n||0==n||(n=this.session.getFoldLine(t)),n)var s=this.$getFoldLineTokens(t,n);else var s=this.session.getTokens(t);if(i||e.push("<div class='ace_line' style='height:",this.config.lineHeight,"px'>"),s.length){var r=this.session.getRowSplitData(t);r&&r.length?this.$renderWrappedLine(e,s,r,i):this.$renderSimpleLine(e,s)}this.showInvisibles&&(n&&(t=n.end.row),e.push("<span class='ace_invisible'>",t==this.session.getLength()-1?this.EOF_CHAR:this.EOL_CHAR,"</span>")),i||e.push("</div>")},this.$getFoldLineTokens=function(e,t){function i(e,t,i){for(var n=0,r=0;r+e[n].value.length<t;)if(r+=e[n].value.length,n++,n==e.length)return;if(r!=t){var o=e[n].value.substring(t-r);o.length>i-t&&(o=o.substring(0,i-t)),s.push({type:e[n].type,value:o}),r=t+o.length,n+=1}for(;i>r&&n<e.length;){var o=e[n].value;o.length+r>i?s.push({type:e[n].type,value:o.substring(0,i-r)}):s.push(e[n]),r+=o.length,n+=1}}var n=this.session,s=[],r=n.getTokens(e);return t.walk(function(e,t,o,a,l){null!=e?s.push({type:"fold",value:e}):(l&&(r=n.getTokens(t)),r.length&&i(r,a,o))},t.end.row,this.session.getLine(t.end.row).length),s},this.$useLineGroups=function(){return this.session.getUseWrapMode()},this.destroy=function(){clearInterval(this.$pollSizeChangesTimer),this.$measureNode&&this.$measureNode.parentNode.removeChild(this.$measureNode),delete this.$measureNode}}).call(l.prototype),t.Text=l}),define("ace/layer/cursor",["require","exports","module","../lib/dom"],function(e,t,i){"use strict";var n=e("../lib/dom"),s=function(e){this.element=n.createElement("div"),this.element.className="ace_layer ace_cursor-layer",e.appendChild(this.element),this.isVisible=!1,this.isBlinking=!0,this.blinkInterval=1e3,this.smoothBlinking=!1,this.cursors=[],this.cursor=this.addCursor(),n.addCssClass(this.element,"ace_hidden-cursors")};(function(){this.$padding=0,this.setPadding=function(e){this.$padding=e},this.setSession=function(e){this.session=e},this.setBlinking=function(e){e!=this.isBlinking&&(this.isBlinking=e,this.restartTimer())},this.setBlinkInterval=function(e){e!=this.blinkInterval&&(this.blinkInterval=e,this.restartTimer())},this.setSmoothBlinking=function(e){e!=this.smoothBlinking&&(this.smoothBlinking=e,e?n.addCssClass(this.element,"ace_smooth-blinking"):n.removeCssClass(this.element,"ace_smooth-blinking"),this.restartTimer())},this.addCursor=function(){var e=n.createElement("div");return e.className="ace_cursor",this.element.appendChild(e),this.cursors.push(e),e},this.removeCursor=function(){if(this.cursors.length>1){var e=this.cursors.pop();return e.parentNode.removeChild(e),e}},this.hideCursor=function(){this.isVisible=!1,n.addCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.showCursor=function(){this.isVisible=!0,n.removeCssClass(this.element,"ace_hidden-cursors"),this.restartTimer()},this.restartTimer=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId),this.smoothBlinking&&n.removeCssClass(this.element,"ace_smooth-blinking");for(var e=this.cursors.length;e--;)this.cursors[e].style.opacity="";if(this.isBlinking&&this.blinkInterval&&this.isVisible){this.smoothBlinking&&setTimeout(function(){n.addCssClass(this.element,"ace_smooth-blinking")}.bind(this));var t=function(){this.timeoutId=setTimeout(function(){for(var e=this.cursors.length;e--;)this.cursors[e].style.opacity=0}.bind(this),.6*this.blinkInterval)}.bind(this);this.intervalId=setInterval(function(){for(var e=this.cursors.length;e--;)this.cursors[e].style.opacity="";t()}.bind(this),this.blinkInterval),t()}},this.getPixelPosition=function(e,t){if(!this.config||!this.session)return{left:0,top:0};e||(e=this.session.selection.getCursor());var i=this.session.documentToScreenPosition(e),n=this.$padding+i.column*this.config.characterWidth,s=(i.row-(t?this.config.firstRowScreen:0))*this.config.lineHeight;return{left:n,top:s}},this.update=function(e){this.config=e;var t=this.session.$selectionMarkers,i=0,n=0;(void 0===t||0===t.length)&&(t=[{cursor:null}]);for(var i=0,s=t.length;s>i;i++){var r=this.getPixelPosition(t[i].cursor,!0);if(!((r.top>e.height+e.offset||r.top<-e.offset)&&i>1)){var o=(this.cursors[n++]||this.addCursor()).style;o.left=r.left+"px",o.top=r.top+"px",o.width=e.characterWidth+"px",o.height=e.lineHeight+"px"}}for(;this.cursors.length>n;)this.removeCursor();var a=this.session.getOverwrite();this.$setOverwrite(a),this.$pixelPos=r,this.restartTimer()},this.$setOverwrite=function(e){e!=this.overwrite&&(this.overwrite=e,e?n.addCssClass(this.element,"ace_overwrite-cursors"):n.removeCssClass(this.element,"ace_overwrite-cursors"))},this.destroy=function(){clearInterval(this.intervalId),clearTimeout(this.timeoutId)}}).call(s.prototype),t.Cursor=s}),define("ace/scrollbar",["require","exports","module","./lib/oop","./lib/dom","./lib/event","./lib/event_emitter"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/dom"),r=e("./lib/event"),o=e("./lib/event_emitter").EventEmitter,a=function(e){this.element=s.createElement("div"),this.element.className="ace_scrollbar",this.inner=s.createElement("div"),this.inner.className="ace_scrollbar-inner",this.element.appendChild(this.inner),e.appendChild(this.element),this.width=s.scrollbarWidth(e.ownerDocument),this.element.style.width=(this.width||15)+5+"px",r.addListener(this.element,"scroll",this.onScroll.bind(this))};(function(){n.implement(this,o),this.onScroll=function(){this.skipEvent||(this.scrollTop=this.element.scrollTop,this._emit("scroll",{data:this.scrollTop})),this.skipEvent=!1},this.getWidth=function(){return this.width},this.setHeight=function(e){this.element.style.height=e+"px"},this.setInnerHeight=function(e){this.inner.style.height=e+"px"},this.setScrollTop=function(e){this.scrollTop!=e&&(this.skipEvent=!0,this.scrollTop=this.element.scrollTop=e)}}).call(a.prototype),t.ScrollBar=a}),define("ace/renderloop",["require","exports","module","./lib/event"],function(e,t,i){"use strict";var n=e("./lib/event"),s=function(e,t){this.onRender=e,this.pending=!1,this.changes=0,this.window=t||window};(function(){this.schedule=function(e){if(this.changes=this.changes|e,!this.pending){this.pending=!0;var t=this;n.nextFrame(function(){t.pending=!1;for(var e;e=t.changes;)t.changes=0,t.onRender(e)},this.window)}}}).call(s.prototype),t.RenderLoop=s}),function(){var e="undefined"!=typeof require&&require;define("ace/requirejs/text",["require","exports","module","../lib/net"],function(t,i,n){"use strict";i.load=function(i,n,s,r){e&&e.nodeRequire?s(e.nodeRequire("fs").readFileSync(n.toUrl(i),"utf8")):t("../lib/net").get(n.toUrl(i),s)}})}(),define("ace/virtual_renderer",["require","exports","module","./lib/oop","./lib/dom","./lib/event","./lib/useragent","./config","./layer/gutter","./layer/marker","./layer/text","./layer/cursor","./scrollbar","./renderloop","./lib/event_emitter","./requirejs/text!./css/editor.css"],function(e,t,i){"use strict";var n=e("./lib/oop"),s=e("./lib/dom"),r=e("./lib/event"),o=e("./lib/useragent"),a=e("./config"),l=e("./layer/gutter").Gutter,c=e("./layer/marker").Marker,u=e("./layer/text").Text,h=e("./layer/cursor").Cursor,d=e("./scrollbar").ScrollBar,p=e("./renderloop").RenderLoop,f=e("./lib/event_emitter").EventEmitter,g=e("./requirejs/text!./css/editor.css");s.importCssString(g,"ace_editor");var m=function(e,t){var i=this;this.container=e||s.createElement("div"),this.$keepTextAreaAtCursor=!o.isIE,s.addCssClass(this.container,"ace_editor"),this.setTheme(t),this.$gutter=s.createElement("div"),this.$gutter.className="ace_gutter",this.container.appendChild(this.$gutter),this.scroller=s.createElement("div"),this.scroller.className="ace_scroller",this.container.appendChild(this.scroller),this.content=s.createElement("div"),this.content.className="ace_content",this.scroller.appendChild(this.content),this.$gutterLayer=new l(this.$gutter),this.$gutterLayer.on("changeGutterWidth",this.onGutterResize.bind(this)),this.$markerBack=new c(this.content);var n=this.$textLayer=new u(this.content);this.canvas=n.element,this.$markerFront=new c(this.content),this.$cursorLayer=new h(this.content),this.$horizScroll=!1,this.scrollBar=new d(this.container),this.scrollBar.addEventListener("scroll",function(e){i.$scrollAnimation||i.session.setScrollTop(e.data)}),this.scrollTop=0,this.scrollLeft=0,r.addListener(this.scroller,"scroll",function(){var e=i.scroller.scrollLeft;i.scrollLeft=e,i.session.setScrollLeft(e)}),this.cursorPos={row:0,column:0},this.$textLayer.addEventListener("changeCharacterSize",function(){i.updateCharacterSize(),i.onResize(!0)}),this.$size={width:0,height:0,scrollerHeight:0,scrollerWidth:0},this.layerConfig={width:1,padding:0,firstRow:0,firstRowScreen:0,lastRow:0,lineHeight:1,characterWidth:1,minHeight:1,maxHeight:1,offset:0,height:1},this.$loop=new p(this.$renderChanges.bind(this),this.container.ownerDocument.defaultView),this.$loop.schedule(this.CHANGE_FULL),this.updateCharacterSize(),this.setPadding(4),a.resetOptions(this),a._emit("renderer",this)};(function(){this.CHANGE_CURSOR=1,this.CHANGE_MARKER=2,this.CHANGE_GUTTER=4,this.CHANGE_SCROLL=8,this.CHANGE_LINES=16,this.CHANGE_TEXT=32,this.CHANGE_SIZE=64,this.CHANGE_MARKER_BACK=128,this.CHANGE_MARKER_FRONT=256,this.CHANGE_FULL=512,this.CHANGE_H_SCROLL=1024,n.implement(this,f),this.updateCharacterSize=function(){this.$textLayer.allowBoldFonts!=this.$allowBoldFonts&&(this.$allowBoldFonts=this.$textLayer.allowBoldFonts,this.setStyle("ace_nobold",!this.$allowBoldFonts)),this.characterWidth=this.$textLayer.getCharacterWidth(),this.lineHeight=this.$textLayer.getLineHeight(),this.$updatePrintMargin()},this.setSession=function(e){this.session=e,this.scroller.className="ace_scroller",this.$cursorLayer.setSession(e),this.$markerBack.setSession(e),this.$markerFront.setSession(e),this.$gutterLayer.setSession(e),this.$textLayer.setSession(e),this.$loop.schedule(this.CHANGE_FULL)},this.updateLines=function(e,t){void 0===t&&(t=1/0),this.$changedLines?(this.$changedLines.firstRow>e&&(this.$changedLines.firstRow=e),this.$changedLines.lastRow<t&&(this.$changedLines.lastRow=t)):this.$changedLines={firstRow:e,lastRow:t},this.$changedLines.firstRow>this.layerConfig.lastRow||this.$changedLines.lastRow<this.layerConfig.firstRow||this.$loop.schedule(this.CHANGE_LINES)},this.onChangeTabSize=function(){this.$loop.schedule(this.CHANGE_TEXT|this.CHANGE_MARKER),this.$textLayer.onChangeTabSize()},this.updateText=function(){this.$loop.schedule(this.CHANGE_TEXT)},this.updateFull=function(e){e?this.$renderChanges(this.CHANGE_FULL,!0):this.$loop.schedule(this.CHANGE_FULL)},this.updateFontSize=function(){this.$textLayer.checkForSizeChanges()},this.onResize=function(e,t,i,n){var r=0,o=this.$size;if(!(this.resizing>2)){if(this.resizing>1?this.resizing++:this.resizing=e?1:0,n||(n=s.getInnerHeight(this.container)),n&&(e||o.height!=n)&&(o.height=n,r=this.CHANGE_SIZE,o.scrollerHeight=this.scroller.clientHeight,(e||!o.scrollerHeight)&&(o.scrollerHeight=o.height,this.$horizScroll&&(o.scrollerHeight-=this.scrollBar.getWidth())),this.scrollBar.setHeight(o.scrollerHeight),this.session&&(this.session.setScrollTop(this.getScrollTop()),r|=this.CHANGE_FULL)),i||(i=s.getInnerWidth(this.container)),i&&(e||this.resizing>1||o.width!=i)){r=this.CHANGE_SIZE,o.width=i;var t=this.$showGutter?this.$gutter.offsetWidth:0;this.scroller.style.left=t+"px",o.scrollerWidth=Math.max(0,i-t-this.scrollBar.getWidth()),this.scroller.style.right=this.scrollBar.getWidth()+"px",(this.session&&this.session.getUseWrapMode()&&this.adjustWrapLimit()||e)&&(r|=this.CHANGE_FULL)}this.$size.scrollerHeight&&(e?this.$renderChanges(r,!0):this.$loop.schedule(r),e&&(this.$gutterLayer.$padding=null),e&&delete this.resizing)}},this.onGutterResize=function(){var e=this.$size.width,t=this.$showGutter?this.$gutter.offsetWidth:0;this.scroller.style.left=t+"px",this.$size.scrollerWidth=Math.max(0,e-t-this.scrollBar.getWidth()),this.session.getUseWrapMode()&&this.adjustWrapLimit()?this.$loop.schedule(this.CHANGE_FULL):this.$loop.schedule(this.CHANGE_MARKER)},this.adjustWrapLimit=function(){var e=this.$size.scrollerWidth-2*this.$padding,t=Math.floor(e/this.characterWidth);return this.session.adjustWrapLimit(t,this.$showPrintMargin&&this.$printMarginColumn)},this.setAnimatedScroll=function(e){this.setOption("animatedScroll",e)},this.getAnimatedScroll=function(){return this.$animatedScroll},this.setShowInvisibles=function(e){this.setOption("showInvisibles",e)},this.getShowInvisibles=function(){return this.getOption("showInvisibles")},this.getDisplayIndentGuides=function(){return this.getOption("displayIndentGuides")},this.setDisplayIndentGuides=function(e){this.setOption("displayIndentGuides",e)},this.setShowPrintMargin=function(e){this.setOption("showPrintMargin",e)},this.getShowPrintMargin=function(){return this.getOption("showPrintMargin")},this.setPrintMarginColumn=function(e){this.setOption("printMarginColumn",e)},this.getPrintMarginColumn=function(){return this.getOption("printMarginColumn")},this.getShowGutter=function(){return this.getOption("showGutter")},this.setShowGutter=function(e){return this.setOption("showGutter",e)},this.getFadeFoldWidgets=function(){return this.getOption("fadeFoldWidgets")},this.setFadeFoldWidgets=function(e){this.setOption("fadeFoldWidgets",e)},this.setHighlightGutterLine=function(e){this.setOption("highlightGutterLine",e)},this.getHighlightGutterLine=function(){return this.getOption("highlightGutterLine")},this.$updateGutterLineHighlight=function(){var e=this.$cursorLayer.$pixelPos,t=this.layerConfig.lineHeight;if(this.session.getUseWrapMode()){var i=this.session.selection.getCursor();i.column=0,e=this.$cursorLayer.getPixelPosition(i,!0),t*=this.session.getRowLength(i.row)}this.$gutterLineHighlight.style.top=e.top-this.layerConfig.offset+"px",this.$gutterLineHighlight.style.height=t+"px"},this.$updatePrintMargin=function(){if(this.$showPrintMargin||this.$printMarginEl){if(!this.$printMarginEl){var e=s.createElement("div");e.className="ace_layer ace_print-margin-layer",this.$printMarginEl=s.createElement("div"),this.$printMarginEl.className="ace_print-margin",e.appendChild(this.$printMarginEl),this.content.insertBefore(e,this.content.firstChild)}var t=this.$printMarginEl.style;t.left=this.characterWidth*this.$printMarginColumn+this.$padding+"px",t.visibility=this.$showPrintMargin?"visible":"hidden",this.session&&-1==this.session.$wrap&&this.adjustWrapLimit()}},this.getContainerElement=function(){return this.container},this.getMouseEventTarget=function(){return this.content},this.getTextAreaContainer=function(){return this.container},this.$moveTextAreaToCursor=function(){if(this.$keepTextAreaAtCursor){var e=this.layerConfig,t=this.$cursorLayer.$pixelPos.top,i=this.$cursorLayer.$pixelPos.left;t-=e.offset;var n=this.lineHeight;if(!(0>t||t>e.height-n)){var s=this.characterWidth;if(this.$composition){var r=this.textarea.value.replace(/^\x01+/,"");s*=this.session.$getStringScreenWidth(r)[0]+2,n+=2,t-=1}i-=this.scrollLeft,i>this.$size.scrollerWidth-s&&(i=this.$size.scrollerWidth-s),i-=this.scrollBar.width,this.textarea.style.height=n+"px",this.textarea.style.width=s+"px",this.textarea.style.right=Math.max(0,this.$size.scrollerWidth-i-s)+"px",this.textarea.style.bottom=Math.max(0,this.$size.height-t-n)+"px"}}},this.getFirstVisibleRow=function(){return this.layerConfig.firstRow},this.getFirstFullyVisibleRow=function(){return this.layerConfig.firstRow+(0===this.layerConfig.offset?0:1)},this.getLastFullyVisibleRow=function(){var e=Math.floor((this.layerConfig.height+this.layerConfig.offset)/this.layerConfig.lineHeight);return this.layerConfig.firstRow-1+e},this.getLastVisibleRow=function(){return this.layerConfig.lastRow},this.$padding=null,this.setPadding=function(e){this.$padding=e,this.$textLayer.setPadding(e),this.$cursorLayer.setPadding(e),this.$markerFront.setPadding(e),this.$markerBack.setPadding(e),this.$loop.schedule(this.CHANGE_FULL),this.$updatePrintMargin()},this.getHScrollBarAlwaysVisible=function(){return this.$hScrollBarAlwaysVisible},this.setHScrollBarAlwaysVisible=function(e){this.setOption("hScrollBarAlwaysVisible",e)},this.$updateScrollBar=function(){this.scrollBar.setInnerHeight(this.layerConfig.maxHeight),
this.scrollBar.setScrollTop(this.scrollTop)},this.$renderChanges=function(e,t){if(t||e&&this.session&&this.container.offsetWidth){if(this._signal("beforeRender"),(e&this.CHANGE_FULL||e&this.CHANGE_SIZE||e&this.CHANGE_TEXT||e&this.CHANGE_LINES||e&this.CHANGE_SCROLL)&&this.$computeLayerConfig(),e&this.CHANGE_H_SCROLL){this.scroller.scrollLeft=this.scrollLeft;var i=this.scroller.scrollLeft;this.scrollLeft=i,this.session.setScrollLeft(i),this.scroller.className=0==this.scrollLeft?"ace_scroller":"ace_scroller ace_scroll-left"}if(e&this.CHANGE_FULL)return this.$textLayer.checkForSizeChanges(),this.$updateScrollBar(),this.$textLayer.update(this.layerConfig),this.$showGutter&&this.$gutterLayer.update(this.layerConfig),this.$markerBack.update(this.layerConfig),this.$markerFront.update(this.layerConfig),this.$cursorLayer.update(this.layerConfig),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),void this._signal("afterRender");if(e&this.CHANGE_SCROLL)return e&this.CHANGE_TEXT||e&this.CHANGE_LINES?this.$textLayer.update(this.layerConfig):this.$textLayer.scrollLines(this.layerConfig),this.$showGutter&&this.$gutterLayer.update(this.layerConfig),this.$markerBack.update(this.layerConfig),this.$markerFront.update(this.layerConfig),this.$cursorLayer.update(this.layerConfig),this.$highlightGutterLine&&this.$updateGutterLineHighlight(),this.$moveTextAreaToCursor(),this.$updateScrollBar(),void this._signal("afterRender");e&this.CHANGE_TEXT?(this.$textLayer.update(this.layerConfig),this.$showGutter&&this.$gutterLayer.update(this.layerConfig)):e&this.CHANGE_LINES?(this.$updateLines()||e&this.CHANGE_GUTTER&&this.$showGutter)&&this.$gutterLayer.update(this.layerConfig):(e&this.CHANGE_TEXT||e&this.CHANGE_GUTTER)&&this.$showGutter&&this.$gutterLayer.update(this.layerConfig),e&this.CHANGE_CURSOR&&(this.$cursorLayer.update(this.layerConfig),this.$moveTextAreaToCursor(),this.$highlightGutterLine&&this.$updateGutterLineHighlight()),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_FRONT)&&this.$markerFront.update(this.layerConfig),e&(this.CHANGE_MARKER|this.CHANGE_MARKER_BACK)&&this.$markerBack.update(this.layerConfig),e&this.CHANGE_SIZE&&this.$updateScrollBar(),this._signal("afterRender")}},this.$computeLayerConfig=function(){if(!this.$size.scrollerHeight)return this.onResize(!0);var e=this.session,t=this.scrollTop%this.lineHeight,i=this.$size.scrollerHeight+this.lineHeight,n=this.$getLongestLine(),s=this.$hScrollBarAlwaysVisible||this.$size.scrollerWidth-n<0,r=this.$horizScroll!==s;this.$horizScroll=s,r&&(this.scroller.style.overflowX=s?"scroll":"hidden",s||this.session.setScrollLeft(0));var o=this.session.getScreenLength()*this.lineHeight;this.session.setScrollTop(Math.max(0,Math.min(this.scrollTop,o-this.$size.scrollerHeight)));var a,l,c=Math.ceil(i/this.lineHeight)-1,u=Math.max(0,Math.round((this.scrollTop-t)/this.lineHeight)),h=u+c,d=this.lineHeight;u=e.screenToDocumentRow(u,0);var p=e.getFoldLine(u);p&&(u=p.start.row),a=e.documentToScreenRow(u,0),l=e.getRowLength(u)*d,h=Math.min(e.screenToDocumentRow(h,0),e.getLength()-1),i=this.$size.scrollerHeight+e.getRowLength(h)*d+l,t=this.scrollTop-a*d,this.layerConfig={width:n,padding:this.$padding,firstRow:u,firstRowScreen:a,lastRow:h,lineHeight:d,characterWidth:this.characterWidth,minHeight:i,maxHeight:o,offset:t,height:this.$size.scrollerHeight},this.$gutterLayer.element.style.marginTop=-t+"px",this.content.style.marginTop=-t+"px",this.content.style.width=n+2*this.$padding+"px",this.content.style.height=i+"px",r&&this.onResize(!0)},this.$updateLines=function(){var e=this.$changedLines.firstRow,t=this.$changedLines.lastRow;this.$changedLines=null;var i=this.layerConfig;return e>i.lastRow+1||t<i.firstRow?void 0:t===1/0?(this.$showGutter&&this.$gutterLayer.update(i),void this.$textLayer.update(i)):(this.$textLayer.updateLines(i,e,t),!0)},this.$getLongestLine=function(){var e=this.session.getScreenWidth();return this.$textLayer.showInvisibles&&(e+=1),Math.max(this.$size.scrollerWidth-2*this.$padding,Math.round(e*this.characterWidth))},this.updateFrontMarkers=function(){this.$markerFront.setMarkers(this.session.getMarkers(!0)),this.$loop.schedule(this.CHANGE_MARKER_FRONT)},this.updateBackMarkers=function(){this.$markerBack.setMarkers(this.session.getMarkers()),this.$loop.schedule(this.CHANGE_MARKER_BACK)},this.addGutterDecoration=function(e,t){this.$gutterLayer.addGutterDecoration(e,t)},this.removeGutterDecoration=function(e,t){this.$gutterLayer.removeGutterDecoration(e,t)},this.updateBreakpoints=function(e){this.$loop.schedule(this.CHANGE_GUTTER)},this.setAnnotations=function(e){this.$gutterLayer.setAnnotations(e),this.$loop.schedule(this.CHANGE_GUTTER)},this.updateCursor=function(){this.$loop.schedule(this.CHANGE_CURSOR)},this.hideCursor=function(){this.$cursorLayer.hideCursor()},this.showCursor=function(){this.$cursorLayer.showCursor()},this.scrollSelectionIntoView=function(e,t,i){this.scrollCursorIntoView(e,i),this.scrollCursorIntoView(t,i)},this.scrollCursorIntoView=function(e,t){if(0!==this.$size.scrollerHeight){var i=this.$cursorLayer.getPixelPosition(e),n=i.left,s=i.top;this.scrollTop>s?(t&&(s-=t*this.$size.scrollerHeight),this.session.setScrollTop(s)):this.scrollTop+this.$size.scrollerHeight<s+this.lineHeight&&(t&&(s+=t*this.$size.scrollerHeight),this.session.setScrollTop(s+this.lineHeight-this.$size.scrollerHeight));var r=this.scrollLeft;r>n?(n<this.$padding+2*this.layerConfig.characterWidth&&(n=0),this.session.setScrollLeft(n)):r+this.$size.scrollerWidth<n+this.characterWidth&&this.session.setScrollLeft(Math.round(n+this.characterWidth-this.$size.scrollerWidth))}},this.getScrollTop=function(){return this.session.getScrollTop()},this.getScrollLeft=function(){return this.session.getScrollLeft()},this.getScrollTopRow=function(){return this.scrollTop/this.lineHeight},this.getScrollBottomRow=function(){return Math.max(0,Math.floor((this.scrollTop+this.$size.scrollerHeight)/this.lineHeight)-1)},this.scrollToRow=function(e){this.session.setScrollTop(e*this.lineHeight)},this.alignCursor=function(e,t){"number"==typeof e&&(e={row:e,column:0});var i=this.$cursorLayer.getPixelPosition(e),n=this.$size.scrollerHeight-this.lineHeight,s=i.top-n*(t||0);return this.session.setScrollTop(s),s},this.STEPS=8,this.$calcSteps=function(e,t){var i=0,n=this.STEPS,s=[],r=function(e,t,i){return i*(Math.pow(e-1,3)+1)+t};for(i=0;n>i;++i)s.push(r(i/this.STEPS,e,t-e));return s},this.scrollToLine=function(e,t,i,n){var s=this.$cursorLayer.getPixelPosition({row:e,column:0}),r=s.top;t&&(r-=this.$size.scrollerHeight/2);var o=this.scrollTop;this.session.setScrollTop(r),i!==!1&&this.animateScrolling(o,n)},this.animateScrolling=function(e,t){var i=this.scrollTop;if(this.$animatedScroll){var n=this,s=n.$calcSteps(e,i);this.$scrollAnimation={from:e,to:i},clearInterval(this.$timer),n.session.setScrollTop(s.shift()),this.$timer=setInterval(function(){s.length?(n.session.setScrollTop(s.shift()),n.session.$scrollTop=i):null!=i?(n.session.$scrollTop=-1,n.session.setScrollTop(i),i=null):(n.$timer=clearInterval(n.$timer),n.$scrollAnimation=null,t&&t())},10)}},this.scrollToY=function(e){this.scrollTop!==e&&(this.$loop.schedule(this.CHANGE_SCROLL),this.scrollTop=e)},this.scrollToX=function(e){0>e&&(e=0),this.scrollLeft!==e&&(this.scrollLeft=e),this.$loop.schedule(this.CHANGE_H_SCROLL)},this.scrollBy=function(e,t){t&&this.session.setScrollTop(this.session.getScrollTop()+t),e&&this.session.setScrollLeft(this.session.getScrollLeft()+e)},this.isScrollableBy=function(e,t){return 0>t&&this.session.getScrollTop()>=1?!0:t>0&&this.session.getScrollTop()+this.$size.scrollerHeight-this.layerConfig.maxHeight<-1?!0:void 0},this.pixelToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=(e+this.scrollLeft-i.left-this.$padding)/this.characterWidth,s=Math.floor((t+this.scrollTop-i.top)/this.lineHeight),r=Math.round(n);return{row:s,column:r,side:n-r>0?1:-1}},this.screenToTextCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=Math.round((e+this.scrollLeft-i.left-this.$padding)/this.characterWidth),s=Math.floor((t+this.scrollTop-i.top)/this.lineHeight);return this.session.screenToDocumentPosition(s,Math.max(n,0))},this.textToScreenCoordinates=function(e,t){var i=this.scroller.getBoundingClientRect(),n=this.session.documentToScreenPosition(e,t),s=this.$padding+Math.round(n.column*this.characterWidth),r=n.row*this.lineHeight;return{pageX:i.left+s-this.scrollLeft,pageY:i.top+r-this.scrollTop}},this.visualizeFocus=function(){s.addCssClass(this.container,"ace_focus")},this.visualizeBlur=function(){s.removeCssClass(this.container,"ace_focus")},this.showComposition=function(e){this.$composition||(this.$composition={keepTextAreaAtCursor:this.$keepTextAreaAtCursor,cssText:this.textarea.style.cssText}),this.$keepTextAreaAtCursor=!0,s.addCssClass(this.textarea,"ace_composition"),this.textarea.style.cssText="",this.$moveTextAreaToCursor()},this.setCompositionText=function(e){this.$moveTextAreaToCursor()},this.hideComposition=function(){this.$composition&&(s.removeCssClass(this.textarea,"ace_composition"),this.$keepTextAreaAtCursor=this.$composition.keepTextAreaAtCursor,this.textarea.style.cssText=this.$composition.cssText,this.$composition=null)},this.setTheme=function(e){function t(t){if(i.$themeValue==e&&t.cssClass){s.importCssString(t.cssText,t.cssClass,i.container.ownerDocument),i.theme&&s.removeCssClass(i.container,i.theme.cssClass),i.$theme=t.cssClass,i.theme=t,s.addCssClass(i.container,t.cssClass),s.setCssClass(i.container,"ace_dark",t.isDark);var n=t.padding||4;i.$padding&&n!=i.$padding&&i.setPadding(n),i.$size&&(i.$size.width=0,i.onResize()),i._dispatchEvent("themeLoaded",{theme:t})}}var i=this;if(this.$themeValue=e,i._dispatchEvent("themeChange",{theme:e}),e&&"string"!=typeof e)t(e);else{var n=e||"ace/theme/textmate";a.loadModule(["theme",n],t)}},this.getTheme=function(){return this.$themeValue},this.setStyle=function(e,t){s.setCssClass(this.container,e,0!=t)},this.unsetStyle=function(e){s.removeCssClass(this.container,e)},this.destroy=function(){this.$textLayer.destroy(),this.$cursorLayer.destroy()}}).call(m.prototype),a.defineOptions(m.prototype,"renderer",{animatedScroll:{initialValue:!1},showInvisibles:{set:function(e){this.$textLayer.setShowInvisibles(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!1},showPrintMargin:{set:function(){this.$updatePrintMargin()},initialValue:!0},printMarginColumn:{set:function(){this.$updatePrintMargin()},initialValue:80},printMargin:{set:function(e){"number"==typeof e&&(this.$printMarginColumn=e),this.$showPrintMargin=!!e,this.$updatePrintMargin()},get:function(){return this.$showPrintMargin&&this.$printMarginColumn}},showGutter:{set:function(e){this.$gutter.style.display=e?"block":"none",this.onGutterResize()},initialValue:!0},fadeFoldWidgets:{set:function(e){s.setCssClass(this.$gutter,"ace_fade-fold-widgets",e)},initialValue:!1},showFoldWidgets:{set:function(e){this.$gutterLayer.setShowFoldWidgets(e)},initialValue:!0},displayIndentGuides:{set:function(e){this.$textLayer.setDisplayIndentGuides(e)&&this.$loop.schedule(this.CHANGE_TEXT)},initialValue:!0},highlightGutterLine:{set:function(e){return this.$gutterLineHighlight?(this.$gutterLineHighlight.style.display=e?"":"none",void(this.$cursorLayer.$pixelPos&&this.$updateGutterLineHighlight())):(this.$gutterLineHighlight=s.createElement("div"),this.$gutterLineHighlight.className="ace_gutter-active-line",void this.$gutter.appendChild(this.$gutterLineHighlight))},initialValue:!1,value:!0},hScrollBarAlwaysVisible:{set:function(e){this.$hScrollBarAlwaysVisible=e,this.$hScrollBarAlwaysVisible&&this.$horizScroll||this.$loop.schedule(this.CHANGE_SCROLL)},initialValue:!1},fontSize:{set:function(e){"number"==typeof e&&(e+="px"),this.container.style.fontSize=e,this.updateFontSize()},initialValue:12},fontFamily:{set:function(e){this.container.style.fontFamily=e,this.updateFontSize()}}}),t.VirtualRenderer=m}),define("ace/mouse/multi_select_handler",["require","exports","module","../lib/event"],function(e,t,i){function n(e,t){return e.row==t.row&&e.column==t.column}function s(e){var t=e.domEvent,i=t.altKey,s=t.shiftKey,o=e.getAccelKey(),a=e.getButton();if(e.editor.inMultiSelectMode&&2==a)return void e.editor.textInput.onContextMenu(e.domEvent);if(!o&&!i)return void(0==a&&e.editor.inMultiSelectMode&&e.editor.exitMultiSelectMode());var l=e.editor,c=l.selection,u=l.inMultiSelectMode,h=e.getDocumentPosition(),d=c.getCursor(),p=e.inSelection()||c.isEmpty()&&n(h,d),f=e.x,g=e.y,m=function(e){f=e.clientX,g=e.clientY},v=function(){var e=l.renderer.pixelToScreenCoordinates(f,g),t=y.screenToDocumentPosition(e.row,e.column);n(b,e)&&n(t,c.selectionLead)||(b=e,l.selection.moveCursorToPosition(t),l.selection.clearSelection(),l.renderer.scrollCursorIntoView(),l.removeSelectionMarkers(w),w=c.rectangularRangeBlock(b,_),w.forEach(l.addSelectionMarker,l),l.updateSelectionMarkers())},y=l.session,_=l.renderer.pixelToScreenCoordinates(f,g),b=_;if(!o||s||i||0!=a){if(i&&0==a){e.stop(),u&&!o?c.toSingleRange():!u&&o&&c.addRange();var w=[];s?(_=y.documentToScreenPosition(c.lead),v()):(c.moveCursorToPosition(h),c.clearSelection());var C=function(e){clearInterval(E),l.removeSelectionMarkers(w);for(var t=0;t<w.length;t++)c.addRange(w[t])},x=v;r.capture(l.container,m,C);var E=setInterval(function(){x()},20);return e.preventDefault()}}else{if(!u&&p)return;if(!u){var S=c.toOrientedRange();l.addSelectionMarker(S)}var A=c.rangeList.rangeAtPoint(h);l.once("mouseup",function(){var e=c.toOrientedRange();A&&e.isEmpty()&&n(A.cursor,e.cursor)?c.substractPoint(e.cursor):(S&&(l.removeSelectionMarker(S),c.addRange(S)),c.addRange(e))})}}var r=e("../lib/event");t.onMouseDown=s}),define("ace/commands/multi_select_commands",["require","exports","module","../keyboard/hash_handler"],function(e,t,i){t.defaultCommands=[{name:"addCursorAbove",exec:function(e){e.selectMoreLines(-1)},bindKey:{win:"Ctrl-Alt-Up",mac:"Ctrl-Alt-Up"},readonly:!0},{name:"addCursorBelow",exec:function(e){e.selectMoreLines(1)},bindKey:{win:"Ctrl-Alt-Down",mac:"Ctrl-Alt-Down"},readonly:!0},{name:"addCursorAboveSkipCurrent",exec:function(e){e.selectMoreLines(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Up",mac:"Ctrl-Alt-Shift-Up"},readonly:!0},{name:"addCursorBelowSkipCurrent",exec:function(e){e.selectMoreLines(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Down",mac:"Ctrl-Alt-Shift-Down"},readonly:!0},{name:"selectMoreBefore",exec:function(e){e.selectMore(-1)},bindKey:{win:"Ctrl-Alt-Left",mac:"Ctrl-Alt-Left"},readonly:!0},{name:"selectMoreAfter",exec:function(e){e.selectMore(1)},bindKey:{win:"Ctrl-Alt-Right",mac:"Ctrl-Alt-Right"},readonly:!0},{name:"selectNextBefore",exec:function(e){e.selectMore(-1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Left",mac:"Ctrl-Alt-Shift-Left"},readonly:!0},{name:"selectNextAfter",exec:function(e){e.selectMore(1,!0)},bindKey:{win:"Ctrl-Alt-Shift-Right",mac:"Ctrl-Alt-Shift-Right"},readonly:!0},{name:"splitIntoLines",exec:function(e){e.multiSelect.splitIntoLines()},bindKey:{win:"Ctrl-Alt-L",mac:"Ctrl-Alt-L"},readonly:!0},{name:"alignCursors",exec:function(e){e.alignCursors()},bindKey:{win:"Ctrl-Alt-A",mac:"Ctrl-Alt-A"}}],t.multiSelectCommands=[{name:"singleSelection",bindKey:"esc",exec:function(e){e.exitMultiSelectMode()},readonly:!0,isAvailable:function(e){return e&&e.inMultiSelectMode}}];var n=e("../keyboard/hash_handler").HashHandler;t.keyboardHandler=new n(t.multiSelectCommands)}),define("ace/multi_select",["require","exports","module","./range_list","./range","./selection","./mouse/multi_select_handler","./lib/event","./lib/lang","./commands/multi_select_commands","./search","./edit_session","./editor"],function(e,t,i){function n(e,t,i){return g.$options.wrap=!0,g.$options.needle=t,g.$options.backwards=-1==i,g.find(e)}function s(e,t){return e.row==t.row&&e.column==t.column}function r(e){e.$onAddRange=e.$onAddRange.bind(e),e.$onRemoveRange=e.$onRemoveRange.bind(e),e.$onMultiSelect=e.$onMultiSelect.bind(e),e.$onSingleSelect=e.$onSingleSelect.bind(e),t.onSessionChange.call(e,e),e.on("changeSession",t.onSessionChange.bind(e)),e.on("mousedown",u),e.commands.addCommands(p.defaultCommands),o(e)}function o(e){function t(){n&&(s.style.cursor="",n=!1)}var i=e.textInput.getElement(),n=!1,s=e.renderer.content;h.addListener(i,"keydown",function(e){18!=e.keyCode||e.ctrlKey||e.shiftKey||e.metaKey?n&&(s.style.cursor=""):n||(s.style.cursor="crosshair",n=!0)}),h.addListener(i,"keyup",t),h.addListener(i,"blur",t)}var a=e("./range_list").RangeList,l=e("./range").Range,c=e("./selection").Selection,u=e("./mouse/multi_select_handler").onMouseDown,h=e("./lib/event"),d=e("./lib/lang"),p=e("./commands/multi_select_commands");t.commands=p.defaultCommands.concat(p.multiSelectCommands);var f=e("./search").Search,g=new f,m=e("./edit_session").EditSession;(function(){this.getSelectionMarkers=function(){return this.$selectionMarkers}}).call(m.prototype),function(){this.ranges=null,this.rangeList=null,this.addRange=function(e,t){if(e){if(!this.inMultiSelectMode&&0==this.rangeCount){var i=this.toOrientedRange();if(this.rangeList.add(i),this.rangeList.add(e),2!=this.rangeList.ranges.length)return this.rangeList.removeAll(),t||this.fromOrientedRange(e);this.rangeList.removeAll(),this.rangeList.add(i),this.$onAddRange(i)}e.cursor||(e.cursor=e.end);var n=this.rangeList.add(e);return this.$onAddRange(e),n.length&&this.$onRemoveRange(n),this.rangeCount>1&&!this.inMultiSelectMode&&(this._emit("multiSelect"),this.inMultiSelectMode=!0,this.session.$undoSelect=!1,this.rangeList.attach(this.session)),t||this.fromOrientedRange(e)}},this.toSingleRange=function(e){e=e||this.ranges[0];var t=this.rangeList.removeAll();t.length&&this.$onRemoveRange(t),e&&this.fromOrientedRange(e)},this.substractPoint=function(e){var t=this.rangeList.substractPoint(e);return t?(this.$onRemoveRange(t),t[0]):void 0},this.mergeOverlappingRanges=function(){var e=this.rangeList.merge();e.length?this.$onRemoveRange(e):this.ranges[0]&&this.fromOrientedRange(this.ranges[0])},this.$onAddRange=function(e){this.rangeCount=this.rangeList.ranges.length,this.ranges.unshift(e),this._emit("addRange",{range:e})},this.$onRemoveRange=function(e){if(this.rangeCount=this.rangeList.ranges.length,1==this.rangeCount&&this.inMultiSelectMode){var t=this.rangeList.ranges.pop();e.push(t),this.rangeCount=0}for(var i=e.length;i--;){var n=this.ranges.indexOf(e[i]);this.ranges.splice(n,1)}this._emit("removeRange",{ranges:e}),0==this.rangeCount&&this.inMultiSelectMode&&(this.inMultiSelectMode=!1,this._emit("singleSelect"),this.session.$undoSelect=!0,this.rangeList.detach(this.session)),t=t||this.ranges[0],t&&!t.isEqual(this.getRange())&&this.fromOrientedRange(t)},this.$initRangeList=function(){this.rangeList||(this.rangeList=new a,this.ranges=[],this.rangeCount=0)},this.getAllRanges=function(){return this.rangeList.ranges.concat()},this.splitIntoLines=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],i=l.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{var i=this.getRange(),n=this.isBackwards(),s=i.start.row,r=i.end.row;if(s==r){if(n)var o=i.end,a=i.start;else var o=i.start,a=i.end;return this.addRange(l.fromPoints(a,a)),void this.addRange(l.fromPoints(o,o))}var c=[],u=this.getLineRange(s,!0);u.start.column=i.start.column,c.push(u);for(var h=s+1;r>h;h++)c.push(this.getLineRange(h,!0));u=this.getLineRange(r,!0),u.end.column=i.end.column,c.push(u),c.forEach(this.addRange,this)}},this.toggleBlockSelection=function(){if(this.rangeCount>1){var e=this.rangeList.ranges,t=e[e.length-1],i=l.fromPoints(e[0].start,t.end);this.toSingleRange(),this.setSelectionRange(i,t.cursor==t.start)}else{var n=this.session.documentToScreenPosition(this.selectionLead),s=this.session.documentToScreenPosition(this.selectionAnchor),r=this.rectangularRangeBlock(n,s);r.forEach(this.addRange,this)}},this.rectangularRangeBlock=function(e,t,i){var n=[],r=e.column<t.column;if(r)var o=e.column,a=t.column;else var o=t.column,a=e.column;var c=e.row<t.row;if(c)var u=e.row,h=t.row;else var u=t.row,h=e.row;0>o&&(o=0),0>u&&(u=0),u==h&&(i=!0);for(var d=u;h>=d;d++){var p=l.fromPoints(this.session.screenToDocumentPosition(d,o),this.session.screenToDocumentPosition(d,a));if(p.isEmpty()){if(f&&s(p.end,f))break;var f=p.end}p.cursor=r?p.start:p.end,n.push(p)}if(c&&n.reverse(),!i){for(var g=n.length-1;n[g].isEmpty()&&g>0;)g--;if(g>0)for(var m=0;n[m].isEmpty();)m++;for(var v=g;v>=m;v--)n[v].isEmpty()&&n.splice(v,1)}return n}}.call(c.prototype);var v=e("./editor").Editor;(function(){this.updateSelectionMarkers=function(){this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.addSelectionMarker=function(e){e.cursor||(e.cursor=e.end);var t=this.getSelectionStyle();return e.marker=this.session.addMarker(e,"ace_selection",t),this.session.$selectionMarkers.push(e),this.session.selectionMarkerCount=this.session.$selectionMarkers.length,e},this.removeSelectionMarker=function(e){if(e.marker){this.session.removeMarker(e.marker);var t=this.session.$selectionMarkers.indexOf(e);-1!=t&&this.session.$selectionMarkers.splice(t,1),this.session.selectionMarkerCount=this.session.$selectionMarkers.length}},this.removeSelectionMarkers=function(e){for(var t=this.session.$selectionMarkers,i=e.length;i--;){var n=e[i];if(n.marker){this.session.removeMarker(n.marker);var s=t.indexOf(n);-1!=s&&t.splice(s,1)}}this.session.selectionMarkerCount=t.length},this.$onAddRange=function(e){this.addSelectionMarker(e.range),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onRemoveRange=function(e){this.removeSelectionMarkers(e.ranges),this.renderer.updateCursor(),this.renderer.updateBackMarkers()},this.$onMultiSelect=function(e){this.inMultiSelectMode||(this.inMultiSelectMode=!0,this.setStyle("ace_multiselect"),this.keyBinding.addKeyboardHandler(p.keyboardHandler),this.commands.setDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onSingleSelect=function(e){this.session.multiSelect.inVirtualMode||(this.inMultiSelectMode=!1,this.unsetStyle("ace_multiselect"),this.keyBinding.removeKeyboardHandler(p.keyboardHandler),this.commands.removeDefaultHandler("exec",this.$onMultiSelectExec),this.renderer.updateCursor(),this.renderer.updateBackMarkers())},this.$onMultiSelectExec=function(e){var t=e.command,i=e.editor;if(i.multiSelect){if(t.multiSelectAction)"forEach"==t.multiSelectAction?n=i.forEachSelection(t,e.args):"forEachLine"==t.multiSelectAction?n=i.forEachSelection(t,e.args,!0):"single"==t.multiSelectAction?(i.exitMultiSelectMode(),n=t.exec(i,e.args||{})):n=t.multiSelectAction(i,e.args||{});else{var n=t.exec(i,e.args||{});i.multiSelect.addRange(i.multiSelect.toOrientedRange()),i.multiSelect.mergeOverlappingRanges()}return n}},this.forEachSelection=function(e,t,i){if(!this.inVirtualSelectionMode){var n,s=this.session,r=this.selection,o=r.rangeList,a=r._eventRegistry;r._eventRegistry={};var l=new c(s);this.inVirtualSelectionMode=!0;for(var u=o.ranges.length;u--;){if(i)for(;u>0&&o.ranges[u].start.row==o.ranges[u-1].end.row;)u--;l.fromOrientedRange(o.ranges[u]),this.selection=s.selection=l;var h=e.exec(this,t||{});void 0==!n&&(n=h),l.toOrientedRange(o.ranges[u])}l.detach(),this.selection=s.selection=r,this.inVirtualSelectionMode=!1,r._eventRegistry=a,r.mergeOverlappingRanges();var d=this.renderer.$scrollAnimation;return this.onCursorChange(),this.onSelectionChange(),d&&d.from==d.to&&this.renderer.animateScrolling(d.from),n}},this.exitMultiSelectMode=function(){this.inMultiSelectMode&&!this.inVirtualSelectionMode&&this.multiSelect.toSingleRange()},this.getCopyText=function(){var e="";if(this.inMultiSelectMode&&!this.inVirtualSelectionMode){for(var t=this.multiSelect.rangeList.ranges,i=[],n=0;n<t.length;n++)i.push(this.session.getTextRange(t[n]));var s=this.session.getDocument().getNewLineCharacter();e=i.join(s),e.length==(i.length-1)*s.length&&(e="")}else this.selection.isEmpty()||(e=this.session.getTextRange(this.getSelectionRange()));return this._signal("copy",e),e},this.onPaste=function(e){if(!this.$readOnly){if(this._signal("paste",e),!this.inMultiSelectMode||this.inVirtualSelectionMode)return this.insert(e);var t=e.split(/\r\n|\r|\n/),i=this.selection.rangeList.ranges;if(t.length>i.length||t.length<2||!t[1])return this.commands.exec("insertstring",this,e);for(var n=i.length;n--;){var s=i[n];s.isEmpty()||this.session.remove(s),this.session.insert(s.start,t[n])}}},this.findAll=function(e,t,i){t=t||{},t.needle=e||t.needle,this.$search.set(t);var n=this.$search.findAll(this.session);if(!n.length)return 0;this.$blockScrolling+=1;var s=this.multiSelect;i||s.toSingleRange(n[0]);for(var r=n.length;r--;)s.addRange(n[r],!0);return this.$blockScrolling-=1,n.length},this.selectMoreLines=function(e,t){var i=this.selection.toOrientedRange(),n=i.cursor==i.end,s=this.session.documentToScreenPosition(i.cursor);this.selection.$desiredColumn&&(s.column=this.selection.$desiredColumn);var r=this.session.screenToDocumentPosition(s.row+e,s.column);if(i.isEmpty())var o=r;else var a=this.session.documentToScreenPosition(n?i.end:i.start),o=this.session.screenToDocumentPosition(a.row+e,a.column);if(n){var c=l.fromPoints(r,o);c.cursor=c.start}else{var c=l.fromPoints(o,r);c.cursor=c.end}if(c.desiredColumn=s.column,this.selection.inMultiSelectMode){if(t)var u=i.cursor}else this.selection.addRange(i);this.selection.addRange(c),u&&this.selection.substractPoint(u)},this.transposeSelections=function(e){for(var t=this.session,i=t.multiSelect,n=i.ranges,s=n.length;s--;){var r=n[s];if(r.isEmpty()){var o=t.getWordRange(r.start.row,r.start.column);r.start.row=o.start.row,r.start.column=o.start.column,r.end.row=o.end.row,r.end.column=o.end.column}}i.mergeOverlappingRanges();for(var a=[],s=n.length;s--;){var r=n[s];a.unshift(t.getTextRange(r))}0>e?a.unshift(a.pop()):a.push(a.shift());for(var s=n.length;s--;){var r=n[s],o=r.clone();t.replace(r,a[s]),r.start.row=o.start.row,r.start.column=o.start.column}},this.selectMore=function(e,t){var i=this.session,s=i.multiSelect,r=s.toOrientedRange();if(r.isEmpty()){var r=i.getWordRange(r.start.row,r.start.column);r.cursor=r.end,this.multiSelect.addRange(r)}var o=i.getTextRange(r),a=n(i,o,e);a&&(a.cursor=-1==e?a.start:a.end,this.multiSelect.addRange(a)),t&&this.multiSelect.substractPoint(r.cursor)},this.alignCursors=function(){var e=this.session,t=e.multiSelect,i=t.ranges;if(i.length){var n=-1,s=i.filter(function(e){return e.cursor.row==n?!0:void(n=e.cursor.row)});t.$onRemoveRange(s);var r=0,o=1/0,a=i.map(function(t){var i=t.cursor,n=e.getLine(i.row),s=n.substr(i.column).search(/\S/g);return-1==s&&(s=0),i.column>r&&(r=i.column),o>s&&(o=s),s});i.forEach(function(t,i){var n=t.cursor,s=r-n.column,c=a[i]-o;s>c?e.insert(n,d.stringRepeat(" ",s-c)):e.remove(new l(n.row,n.column,n.row,n.column-s+c)),t.start.column=t.end.column=r,t.start.row=t.end.row=n.row,t.cursor=t.end}),t.fromOrientedRange(i[0]),this.renderer.updateCursor(),this.renderer.updateBackMarkers()}else{var c=this.selection.getRange(),u=c.start.row,h=c.end.row,p=this.session.doc.removeLines(u,h);p=this.$reAlignText(p),this.session.doc.insertLines(u,p),c.start.column=0,c.end.column=p[p.length-1].length,this.selection.setRange(c)}},this.$reAlignText=function(e){function t(e){return d.stringRepeat(" ",e)}function i(e){return e[2]?t(r)+e[2]+t(o-e[2].length+a)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function n(e){return e[2]?t(r+o-e[2].length)+e[2]+t(a," ")+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}function s(e){return e[2]?t(r)+e[2]+t(a)+e[4].replace(/^([=:])\s+/,"$1 "):e[0]}var r,o,a,l=!0,c=!0;return e.map(function(e){var t=e.match(/(\s*)(.*?)(\s*)([=:].*)/);return t?null==r?(r=t[1].length,o=t[2].length,a=t[3].length,t):(r+o+a!=t[1].length+t[2].length+t[3].length&&(c=!1),r!=t[1].length&&(l=!1),r>t[1].length&&(r=t[1].length),o<t[2].length&&(o=t[2].length),a>t[3].length&&(a=t[3].length),t):[e]}).map(l?c?n:i:s)}}).call(v.prototype),t.onSessionChange=function(e){var t=e.session;t.multiSelect||(t.$selectionMarkers=[],t.selection.$initRangeList(),t.multiSelect=t.selection),this.multiSelect=t.multiSelect;var i=e.oldSession;i&&(i.multiSelect.removeEventListener("addRange",this.$onAddRange),i.multiSelect.removeEventListener("removeRange",this.$onRemoveRange),i.multiSelect.removeEventListener("multiSelect",this.$onMultiSelect),i.multiSelect.removeEventListener("singleSelect",this.$onSingleSelect)),t.multiSelect.on("addRange",this.$onAddRange),t.multiSelect.on("removeRange",this.$onRemoveRange),t.multiSelect.on("multiSelect",this.$onMultiSelect),t.multiSelect.on("singleSelect",this.$onSingleSelect),this.inMultiSelectMode!=t.selection.inMultiSelectMode&&(t.selection.inMultiSelectMode?this.$onMultiSelect():this.$onSingleSelect())},t.MultiSelect=r}),define("ace/worker/worker_client",["require","exports","module","../lib/oop","../lib/event_emitter","../config"],function(e,t,i){"use strict";var n=e("../lib/oop"),s=e("../lib/event_emitter").EventEmitter,r=e("../config"),o=function(t,i,n){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.onMessage=this.onMessage.bind(this),this.onError=this.onError.bind(this),e.nameToUrl&&!e.toUrl&&(e.toUrl=e.nameToUrl);var s;if(r.get("packaged")||!e.toUrl)s=r.moduleUrl(i,"worker");else{var o=this.$normalizePath;s=o(e.toUrl("ace/worker/worker.js",null,"_"));var a={};t.forEach(function(t){a[t]=o(e.toUrl(t,null,"_").replace(/(\.js)?(\?.*)?$/,""))})}this.$worker=new Worker(s),this.$worker.postMessage({init:!0,tlns:a,module:i,classname:n}),this.callbackId=1,this.callbacks={},this.$worker.onerror=this.onError,this.$worker.onmessage=this.onMessage};(function(){n.implement(this,s),this.onError=function(e){throw window.console&&console.log&&console.log(e),e},this.onMessage=function(e){var t=e.data;switch(t.type){case"log":window.console&&console.log&&console.log.apply(console,t.data);break;case"event":this._emit(t.name,{data:t.data});break;case"call":var i=this.callbacks[t.id];i&&(i(t.data),delete this.callbacks[t.id])}},this.$normalizePath=function(e){return location.host?(e=e.replace(/^[a-z]+:\/\/[^\/]+/,""),e=location.protocol+"//"+location.host+("/"==e.charAt(0)?"":location.pathname.replace(/\/[^\/]*$/,""))+"/"+e.replace(/^[\/]+/,"")):e},this.terminate=function(){this._emit("terminate",{}),this.$worker.terminate(),this.$worker=null,this.$doc.removeEventListener("change",this.changeListener),this.$doc=null},this.send=function(e,t){this.$worker.postMessage({command:e,args:t})},this.call=function(e,t,i){if(i){var n=this.callbackId++;this.callbacks[n]=i,t.push(n)}this.send(e,t)},this.emit=function(e,t){try{this.$worker.postMessage({event:e,data:{data:t.data}})}catch(i){}},this.attachToDocument=function(e){this.$doc&&this.terminate(),this.$doc=e,this.call("setValue",[e.getValue()]),e.on("change",this.changeListener)},this.changeListener=function(e){this.deltaQueue?this.deltaQueue.push(e.data):(this.deltaQueue=[e.data],setTimeout(this.$sendDeltaQueue,1))},this.$sendDeltaQueue=function(){var e=this.deltaQueue;e&&(this.deltaQueue=null,e.length>20&&e.length>this.$doc.getLength()>>1?this.call("setValue",[this.$doc.getValue()]):this.emit("change",{data:e}))}}).call(o.prototype);var a=function(e,t,i){this.$sendDeltaQueue=this.$sendDeltaQueue.bind(this),this.changeListener=this.changeListener.bind(this),this.callbackId=1,this.callbacks={},this.messageBuffer=[];var n=null,o=Object.create(s),a=this;this.$worker={},this.$worker.terminate=function(){},this.$worker.postMessage=function(e){a.messageBuffer.push(e),n&&setTimeout(l)};var l=function(){var e=a.messageBuffer.shift();e.command?n[e.command].apply(n,e.args):e.event&&o._emit(e.event,e.data)};o.postMessage=function(e){a.onMessage({data:e})},o.callback=function(e,t){this.postMessage({type:"call",id:t,data:e})},o.emit=function(e,t){this.postMessage({type:"event",name:e,data:t})},r.loadModule(["worker",t],function(e){for(n=new e[i](o);a.messageBuffer.length;)l()})};a.prototype=o.prototype,t.UIWorkerClient=a,t.WorkerClient=o;
}),define("ace/placeholder",["require","exports","module","./range","./lib/event_emitter","./lib/oop"],function(e,t,i){"use strict";var n=e("./range").Range,s=e("./lib/event_emitter").EventEmitter,r=e("./lib/oop"),o=function(e,t,i,n,s,r){var o=this;this.length=t,this.session=e,this.doc=e.getDocument(),this.mainClass=s,this.othersClass=r,this.$onUpdate=this.onUpdate.bind(this),this.doc.on("change",this.$onUpdate),this.$others=n,this.$onCursorChange=function(){setTimeout(function(){o.onCursorChange()})},this.$pos=i;var a=e.getUndoManager().$undoStack||e.getUndoManager().$undostack||{length:-1};this.$undoStackDepth=a.length,this.setup(),e.selection.on("changeCursor",this.$onCursorChange)};(function(){r.implement(this,s),this.setup=function(){var e=this,t=this.doc,i=this.session,s=this.$pos;this.pos=t.createAnchor(s.row,s.column),this.markerId=i.addMarker(new n(s.row,s.column,s.row,s.column+this.length),this.mainClass,null,!1),this.pos.on("change",function(t){i.removeMarker(e.markerId),e.markerId=i.addMarker(new n(t.value.row,t.value.column,t.value.row,t.value.column+e.length),e.mainClass,null,!1)}),this.others=[],this.$others.forEach(function(i){var n=t.createAnchor(i.row,i.column);e.others.push(n)}),i.setUndoSelect(!1)},this.showOtherMarkers=function(){if(!this.othersActive){var e=this.session,t=this;this.othersActive=!0,this.others.forEach(function(i){i.markerId=e.addMarker(new n(i.row,i.column,i.row,i.column+t.length),t.othersClass,null,!1),i.on("change",function(s){e.removeMarker(i.markerId),i.markerId=e.addMarker(new n(s.value.row,s.value.column,s.value.row,s.value.column+t.length),t.othersClass,null,!1)})})}},this.hideOtherMarkers=function(){if(this.othersActive){this.othersActive=!1;for(var e=0;e<this.others.length;e++)this.session.removeMarker(this.others[e].markerId)}},this.onUpdate=function(e){var t=e.data,i=t.range;if(i.start.row===i.end.row&&i.start.row===this.pos.row&&!this.$updating){this.$updating=!0;var s="insertText"===t.action?i.end.column-i.start.column:i.start.column-i.end.column;if(i.start.column>=this.pos.column&&i.start.column<=this.pos.column+this.length+1){var r=i.start.column-this.pos.column;if(this.length+=s,!this.session.$fromUndo){if("insertText"===t.action)for(var o=this.others.length-1;o>=0;o--){var a=this.others[o],l={row:a.row,column:a.column+r};a.row===i.start.row&&i.start.column<a.column&&(l.column+=s),this.doc.insert(l,t.text)}else if("removeText"===t.action)for(var o=this.others.length-1;o>=0;o--){var a=this.others[o],l={row:a.row,column:a.column+r};a.row===i.start.row&&i.start.column<a.column&&(l.column+=s),this.doc.remove(new n(l.row,l.column,l.row,l.column-s))}i.start.column===this.pos.column&&"insertText"===t.action?setTimeout(function(){this.pos.setPosition(this.pos.row,this.pos.column-s);for(var e=0;e<this.others.length;e++){var t=this.others[e],n={row:t.row,column:t.column-s};t.row===i.start.row&&i.start.column<t.column&&(n.column+=s),t.setPosition(n.row,n.column)}}.bind(this),0):i.start.column===this.pos.column&&"removeText"===t.action&&setTimeout(function(){for(var e=0;e<this.others.length;e++){var t=this.others[e];t.row===i.start.row&&i.start.column<t.column&&t.setPosition(t.row,t.column-s)}}.bind(this),0)}this.pos._emit("change",{value:this.pos});for(var o=0;o<this.others.length;o++)this.others[o]._emit("change",{value:this.others[o]})}this.$updating=!1}},this.onCursorChange=function(e){if(!this.$updating){var t=this.session.selection.getCursor();t.row===this.pos.row&&t.column>=this.pos.column&&t.column<=this.pos.column+this.length?(this.showOtherMarkers(),this._emit("cursorEnter",e)):(this.hideOtherMarkers(),this._emit("cursorLeave",e))}},this.detach=function(){this.session.removeMarker(this.markerId),this.hideOtherMarkers(),this.doc.removeEventListener("change",this.$onUpdate),this.session.selection.removeEventListener("changeCursor",this.$onCursorChange),this.pos.detach();for(var e=0;e<this.others.length;e++)this.others[e].detach();this.session.setUndoSelect(!0)},this.cancel=function(){if(-1===this.$undoStackDepth)throw Error("Canceling placeholders only supported with undo manager attached to session.");for(var e=this.session.getUndoManager(),t=(e.$undoStack||e.$undostack).length-this.$undoStackDepth,i=0;t>i;i++)e.undo(!0)}}).call(o.prototype),t.PlaceHolder=o}),define("ace/mode/folding/fold_mode",["require","exports","module","../../range"],function(e,t,i){"use strict";var n=e("../../range").Range,s=t.FoldMode=function(){};(function(){this.foldingStartMarker=null,this.foldingStopMarker=null,this.getFoldWidget=function(e,t,i){var n=e.getLine(i);return this.foldingStartMarker.test(n)?"start":"markbeginend"==t&&this.foldingStopMarker&&this.foldingStopMarker.test(n)?"end":""},this.getFoldWidgetRange=function(e,t,i){return null},this.indentationBlock=function(e,t,i){var s=/\S/,r=e.getLine(t),o=r.search(s);if(-1!=o){for(var a=i||r.length,l=e.getLength(),c=t,u=t;++t<l;){var h=e.getLine(t).search(s);if(-1!=h){if(o>=h)break;u=t}}if(u>c){var d=e.getLine(u).length;return new n(c,a,u,d)}}},this.openingBracketBlock=function(e,t,i,s,r){var o={row:i,column:s+1},a=e.$findClosingBracket(t,o,r);if(a){var l=e.foldWidgets[a.row];return null==l&&(l=this.getFoldWidget(e,a.row)),"start"==l&&a.row>o.row&&(a.row--,a.column=e.getLine(a.row).length),n.fromPoints(o,a)}},this.closingBracketBlock=function(e,t,i,s,r){var o={row:i,column:s},a=e.$findOpeningBracket(t,o);return a?(a.column++,o.column--,n.fromPoints(a,o)):void 0}}).call(s.prototype)}),define("ace/theme/textmate",["require","exports","module","../requirejs/text!./textmate.css","../lib/dom"],function(e,t,i){"use strict";t.isDark=!1,t.cssClass="ace-tm",t.cssText=e("../requirejs/text!./textmate.css");var n=e("../lib/dom");n.importCssString(t.cssText,t.cssClass)}),define("ace/ace",["require","exports","module","./lib/fixoldbrowsers","./lib/dom","./lib/event","./editor","./edit_session","./undomanager","./virtual_renderer","./multi_select","./worker/worker_client","./keyboard/hash_handler","./placeholder","./mode/folding/fold_mode","./theme/textmate","./config"],function(e,t,i){"use strict";e("./lib/fixoldbrowsers");var n=e("./lib/dom"),s=e("./lib/event"),r=e("./editor").Editor,o=e("./edit_session").EditSession,a=e("./undomanager").UndoManager,l=e("./virtual_renderer").VirtualRenderer,c=e("./multi_select").MultiSelect;e("./worker/worker_client"),e("./keyboard/hash_handler"),e("./placeholder"),e("./mode/folding/fold_mode"),e("./theme/textmate"),t.config=e("./config"),t.require=e,t.edit=function(e){if("string"==typeof e){var i=e,e=document.getElementById(i);if(!e)throw"ace.edit can't find div #"+i}if(e.env&&e.env.editor instanceof r)return e.env.editor;var o=t.createEditSession(n.getInnerText(e));e.innerHTML="";var a=new r(new l(e));new c(a),a.setSession(o);var u={document:o,editor:a,onResize:a.resize.bind(a,null)};return s.addListener(window,"resize",u.onResize),a.on("destroy",function(){s.removeListener(window,"resize",u.onResize)}),e.env=a.env=u,a},t.createEditSession=function(e,t){var i=new o(e,t);return i.setUndoManager(new a),i},t.EditSession=o,t.UndoManager=a}),define("ui/css-editor/views/editorView",["jquery","underscore","backbone","core/utils/is","core/utils/css","../collections/style-declarations","../collections/attributes","ace/ace","ace/range","cssom","cssom-global"],function(e,t,i,n,s,r,o,a,l,c){"use strict";var u=i.View.extend({id:"cssEditor",timeout:null,throttle_time:750,ignoreChanges:!1,indentation:3,initialized_with_style_declarations:!1,active_element_style_dec_class:"for-active-element",initialize:function(){this._initializeAceEditor(),this.model.on("change:width",this.changeWidth,this),this.style_declarations=this._convertToCollection([])},_initializeAceEditor:function(){var e=this;this.editor=a.edit(this.el),this.session=this.editor.getSession(),this.editor.setTheme("ace/theme/chrome"),this.editor.setHighlightActiveLine(!0),this.editor.setShowPrintMargin(!1),this.editor.commands.removeCommands(["find","gotoline","findall","replace","replaceall"]),this.session.setMode("ace/mode/css"),this.session.setUseWrapMode(!0),this.session.on("changeAnnotation",function(){e._annotationsChangedEvent.call(e)}),this.session.on("change",function(t){e._changedEvent.call(e,t)})},updateStyleDeclarations:function(e,t){var i,s;return n(e,"array")?this._isValidSource()||n(t,"object")&&t.force===!0?(i=this._convertToCollection(e),s=this.style_declarations.updateWith(i,{delete_missing:!0}),s&&this._updateEditorWithCss(this.style_declarations.toCSS(this.indentation)),this.render(),!0):!0:!1},updateStyleDeclaration:function(e,t){var i,n;return this._isValidSource()&&this.style_declarations&&(i=this._convertToCollection(t),n=this.style_declarations.updateWith(i,{delete_missing:!1}),n&&(this._updateEditorWithCss(this.style_declarations.toCSS(this.indentation)),this.render())),!0},deleteStyleDeclaration:function(e){if(this._isValidSource()&&this.style_declarations){var t=this.style_declarations.deleteSelector(e);t&&(this._updateEditorWithCss(this.style_declarations.toCSS(this.indentation)),this.render())}},render:function(){return this.delegateEvents(),this},changeWidth:function(){return this.editor.resize(),!0},positionCursorAtSelector:function(e){var t;return n(e,"string")||this._gotoLastLine(),t=this._getStyleDeclarationStartPosition(e),n(t,"object")?this.editor.moveCursorToPosition(t):this._gotoLastLine(),!0},_changedEvent:function(){this.ignoreChanges||this._throttledUpdate()},_annotationsChangedEvent:function(){},_getStyleDeclarationStartPosition:function(e){var t=new RegExp("^"+e+"(\\s?){"),i=this.editor.find(t,{regExp:!0});return n(i,"object")?i.start:!1},_gotoLastLine:function(){var e=this.session.getLength();return this.editor.gotoLine(e),!0},_updateEditorWithCss:function(e){var t=this.editor.selection.getCursor();this.ignoreChanges=!0,this.session.setValue(e),this.ignoreChanges=!1,this.editor.moveCursorToPosition(t)},_throttledUpdate:function(){var e=this;void 0!==this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){e._updateFromCss.call(e)},e.throttle_time)},_isValidSource:function(){return 0===this.session.getValue().length||0===this.session.getAnnotations().length},_isValidCss:function(e,i){function n(t){for(var i=0,n=0;t>=n;n++)"\n"===e[n]&&i++;return i}var s,r=!0;return t.each(i.cssRules,function(e){e instanceof c.CSSStyleRule?(e.selectorText.match("#")&&(s=n(e.__starts),this.setAnnotation(s,0,"ID's are not supported.","error"),r=!1),e.selectorText.match(/\n/g)&&(s=n(e.__starts),this.setAnnotation(s,0,"New lines in selectors are not supported.","error"),r=!1)):(s=n(e.__starts),this.setAnnotation(s,0,"@-rules are not supported.","error"),r=!1)},this),r},_updateFromCss:function(){var e,t,i,n=this.editor.getValue();return this._isValidSource()&&(e=c.parse(n),this._isValidCss(n,e)&&(t=this._convertCssToStyleDeclarations(e),i=this._findChanges(t),this.style_declarations=t,this._triggerChangeSetEvent(i))),this.style_declarations},_convertCssToStyleDeclarations:function(e){return(new r).fromParsedCss(e)},_convertToCollection:function(e){var t=n(e,"array")?e:[e];return(new r).fromStyleDeclarations(t)},setAnnotation:function(e,t,i,n){this.session.setAnnotations([{row:e,column:t||0,text:i||"Unknown error",type:n||"error"}])},_findChanges:function(e){var t,i,n,s,r={new_style_declarations:[],upd_style_declarations:[],del_style_declarations:[],upd_style_declarations_del_attribute:[]};return e.each(function(e){t=null,this.style_declarations&&(t=this.style_declarations.findBySelector(e.get("selector"))),t?(i=t.style_attributes.compareWith(e.style_attributes),i.deleted.length>0&&(n=t.cloneWithStyleAttributes(new o(i.deleted)),r.upd_style_declarations_del_attribute.push(n.toJSON())),i.newOrUpdated.length>0&&(s=t.cloneWithStyleAttributes(new o(i.newOrUpdated)),r.upd_style_declarations.push(s.toJSON()))):r.new_style_declarations.push(e.toJSON())},this),this.style_declarations&&this.style_declarations.each(function(t){e.findBySelector(t.get("selector"))||r.del_style_declarations.push(t.toJSON())}),r},_triggerChangeSetEvent:function(e){t.isEmpty(e.new_style_declarations)&&t.isEmpty(e.upd_style_declarations)&&t.isEmpty(e.del_style_declarations)&&t.isEmpty(e.upd_style_declarations_del_attribute)||this.trigger("changeSet",e)}});return u}),define("ui/css-editor/views/dragger",["jquery","backbone"],function(e,t){return t.View.extend({attributes:{"data-tooltips-title":"Adjust width","data-tooltips-side":"left"},tagName:"div",className:"width-dragger",events:{mousedown:"startDrag"},render:function(){return this.$el=e(this.el),this.delegateEvents(),this},startDrag:function(t){t.preventDefault(),this.$el.addClass("dragging"),e(document).on("mousemove",e.proxy(this.handleMousemove,this)),e(document).on("mouseup",e.proxy(this.endDrag,this))},endDrag:function(){return this.$el.removeClass("dragging"),e(document).off("mousemove",e.proxy(this.handleMousemove,this)),e(document).off("mouseup",e.proxy(this.endDrag,this)),this.trigger("dragger:complete"),!0},handleMousemove:function(t){var i;t.preventDefault(),i=t.clientX,this.trigger("dragger:dragged-to",e(window).width(),i)},remove:function(){this.$el.hasClass("dragging")&&this.endDrag(),t.View.prototype.remove.apply(this,arguments)}})}),define("hbs!ui/css-editor/templates/viewport",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<h3 class="viewport-title">',(r=i.title)?r=r.call(t,{hash:{}}):(r=t.title,r=typeof r===a?r.apply(t):r),o+=l(r)+"</h3>\n"});return t.registerPartial("ui_css-editor_templates_viewport",i),i}),define("ui/css-editor/views/viewport",["backbone","hbs!../templates/viewport"],function(e,t){var i=e.View.extend({className:"ui-viewport-title",template:t,initialize:function(){this.model.on("change:media_query",this.render,this)},render:function(){var e=this.model.getTitleAsCss();return this.$el.html(this.template({title:e})),this},destroy:function(){return this.model.off(null,null,this),!0}});return i}),define("ui/css-editor/models/editor-width",["backbone","underscore","core/utils/is"],function(e,t,i){"use strict";return e.Model.extend({defaults:{min_width:"400px",width:"400px"},initialize:function(){var e=this.validate(this.attributes);e&&this.trigger("error",this,e)},validate:function(e){return i(e.width,"string")?parseInt(e.width,10)<parseInt(this.get("min_width"),10)?"width must be at least "+this.get("min_width"):void 0:"width must be a string"},updateWidth:function(e,t){var n;return i(e,"number")&&i(t,"number")?(n=this._convertToPercentage(e,t),n>100?!1:(this.set("width",t+"px",{validate:!0}),!0)):!1},_convertToPercentage:function(e,t){return t/e*100}})}),define("hbs!ui/css-editor/templates/editor",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="dialog insert-dialog">\n    <div class="header">\n        <h4>Project CSS</h4>\n    </div>\n    <div class="dialog-body">\n    </div>\n</div>'});return t.registerPartial("ui_css-editor_templates_editor",i),i}),define("ui/css-editor/dropdown",["jquery","backbone","underscore","core/utils/is","core/typecastError","core/components/dropdown/index","./views/editorView","./views/dragger","./views/viewport","./models/editor-width","hbs!./templates/editor"],function(e,t,i,n,s,r,o,a,l,c,u){var h=r.extend({namespace:"ui:css-editor:dropdown",className:"css-editor-container",views:null,custom_position:!0,insertedElementParent:null,initialize:function(){return this.views={},this.models={},h.__super__.initialize.apply(this,arguments),this.$el.html(u()),this.models.editor_width=new c,this.models.editor_width.on("change:width",this.changeWidth,this),this.models.media_query=this.options.media_query_model,this.views.viewport=new l({model:this.models.media_query}),this.views.editorView=new o({model:this.models.editor_width}),this.views.dragger=new a,this.views.dragger.on("dragger:dragged-to",function(e,t){var i=e-t;this.models.editor_width.updateWidth(e,i)},this),this.views.dragger.on("dragger:complete",this.resized,this),this},render:function(){return this.$el.off("transitionend webkitTransitionEnd otransitionend"),h.__super__.render.call(this,[this.views.viewport,this.views.dragger]),this.views.editorView.render(),this.$el.find(".dialog .dialog-body").append(this.views.editorView.$el),this.delegateEvents(),window.getComputedStyle(this.el).getPropertyValue("top"),this.$el.addClass("dropdown-shown"),this.resized(),this},remove:function(){var e=this;return this.$el.on("transitionend webkitTransitionEnd otransitionend",i.bind(function(){h.__super__.remove.apply(e,arguments),this.announce("closed")},this)),this._is_rendered&&this.announce("closing"),this.$el.removeClass("dropdown-shown"),this.setRendered(!1),!0},changeWidth:function(e,t){return n(t,"string")?(this.$el.css("width",t),!0):!1},resized:function(){return this.announce("resized",this.$el.width()+20),!0}});return h}),define("ui/css-editor/views/menuView",["jquery","backbone"],function(e,t){"use strict";var i=t.View.extend({className:"css-editor navigation-alt",tagName:"ul",events:{click:"clicked"},initialize:function(){this.options.parent_el?this.parent_el=e(this.options.parent_el):this.parent_el=e("<div/>")},render:function(){return this.$el.html(this.template()),this.parent_el.append(this.$el),this},template:function(){return"<li><span>Edit CSS</span></li>"},clicked:function(){this.trigger("css-editor:menu-clicked")},remove:function(){return i.__super__.remove.apply(this,arguments),!0}});return i}),define("ui/css-editor/models/media-query",["underscore","backbone","core/utils/is"],function(e,t,i){return t.Model.extend({config:null,initialize:function(e,t){i(t.config,"object")||(t.config={}),this.config=t.config},getTitleAsCss:function(){var e,t=this.get("media_query");return e=this._attributesToString(t),i(e,"string")?e:this.config.default_title},_attributesToString:function(t){return i(t,"object")&&Object.keys(t.attributes).length?e.reduce(t.attributes,function(e,t,i){return e+" and ("+i+": "+t+")"},"@media only "+t.type):null}})}),define("ui/css-editor/index",["jquery","underscore","backbone","core/utils/is","core/utils/cast","./dropdown","./views/menuView","./models/media-query"],function(e,t,i,n,s,r,o,a){"use strict";var l=i.UIController.extend({namespace:"ui:css-editor",views:null,models:null,default_media_query:null,listeners:t.extend({},i.UIController.prototype.listeners,{"[remote]data:styles:changed":"stylesChangedEvent","[remote]data:styles:deleted:styleDeclaration":"deletedStyleDeclarationEvent","[remote]data:styles:ready":"onDataStylesReady"}),initialize:function(){this.app_el?this.app_el=e(this.app_el):this.app_el=e("<div/>"),this.views={menuView:new o({parent_el:this.app_el.find(".edit-css-nav")})},this.views.menuView.render(),this.models={media_query:new a(null,{config:this.config})},this.listenTo(this.views.menuView,"css-editor:menu-clicked",this.toggleEditor,this),this.editorDropDown=new r({imc:this.imc,media_query_model:this.models.media_query,target_el:this.app_el,parent_el:this.app_el}),this.editorDropDown.views.editorView.on("changeSet",this.changeSetEvent,this)},remove:function(){return this.views.menuView.remove(),this.editorDropDown.remove(),l.__super__.remove.apply(this,arguments),!0},getEditorToPositionCursorAtSelectorForElement:function(e){return n(e,"element")?(this.editorDropDown.views.editorView.positionCursorAtSelector(e.getSelector()),!0):!1},toggleEditor:function(){return this.editorDropDown.isRendered()?(this.editorDropDown.close(),this.editorDropDown.views.editorView.initialized_with_style_declarations=!1):(this._stylesChanged(),this.imc.trigger("service:metrics:record","Grey bar 'Edit CSS'")),!0},changeSetEvent:function(e){var i=this;return n(e,"object")?(n(e.upd_style_declarations,"array")&&t.each(e.upd_style_declarations,function(e){i.imc.trigger("data:styles:setAttributesForStyleDeclaration",i.active_style_id,i._getActiveMediaQueryId(),e.selector,e.attributes,null,function(t){t&&i.imc.trigger("service:log:error","Error invoking `data:styles:setAttributesForStyleDeclaration` with attributes activeStyleId="+i.active_style_id+", selector="+e.selector+", attributes="+e.attributes+". Error="+t)},this)},this),t.each(e.new_style_declarations,function(e){i.imc.trigger("data:styles:setAttributesForStyleDeclaration",i.active_style_id,i._getActiveMediaQueryId(),e.selector,e.attributes,null,function(t){t&&i.imc.trigger("service:log:error","Error invoking `data:styles:setAttributesForStyleDeclaration` with attributes activeStyleId="+i.active_style_id+", selector="+e.selector+", attributes="+e.attributes+". Error="+t)},this)}),t.each(e.upd_style_declarations_del_attribute,function(e){var t=Object.keys(e.attributes);i.imc.trigger("data:styles:removeAttributesForStyleDeclaration",i.active_style_id,i._getActiveMediaQueryId(),e.selector,t,null,function(t){t&&i.imc.trigger("service:log:error","Error invoking `data:styles:removeAttributesForStyleDeclaration` with attributes activeStyleId="+i.active_style_id+", selector="+e.selector+", attributes="+e.attributes+". Error="+t)},this)}),t.each(e.del_style_declarations,function(e){i.imc.trigger("data:styles:deleteStyleDeclaration",i.active_style_id,i._getActiveMediaQueryId(),e.selector,null)},this),!0):!1},onChangeActiveStyle:function(){return this.editorDropDown.isRendered()&&this._stylesChanged(),!0},onDataStylesReady:function(){this.imc.trigger("data:styles:getDefaultMediaQuery",function(e,t){return e?(this.log({message:"Error fetching default media query",err:e}),!1):void(this.default_media_query=t)},this)},onChangeActiveElement:function(e){return n(e,"element")?void(this.editorDropDown.isRendered()&&this.getEditorToPositionCursorAtSelectorForElement(e)):!1},onChangeActiveMediaQuery:function(e){return n(e,"media_query")?(this.models.media_query.set({media_query:e.getMediaQuery()}),this.editorDropDown.isRendered()&&this._stylesChanged({force:!0}),!0):(this.models.media_query.set({media_query:null}),this.active_media_query=this.default_media_query,this.editorDropDown.isRendered()&&this._stylesChanged({force:!0}),!1)},stylesChangedEvent:function(e,t,i,n){return this.editorDropDown.isRendered()&&(this.editorDropDown.views.editorView.initialized_with_style_declarations?this.editorDropDown.views.editorView.updateStyleDeclaration(i,n):this._stylesChanged()),!0},deletedStyleDeclarationEvent:function(e){return this.editorDropDown.isRendered()&&(this.editorDropDown.views.editorView.initialized_with_style_declarations?this.editorDropDown.views.editorView.deleteStyleDeclaration(e):this._stylesChanged()),!0},_stylesChanged:function(e){return n(this.active_style_id,"number")?(this.imc.trigger("data:styles:getStyleDeclarationsByStyleAndMediaQuery",this.active_style_id,this._getActiveMediaQueryId(),function(){var t=s(arguments,"array");t.push(e),this._styleDeclarationCallback.apply(this,t)},this),!0):!1},_getActiveMediaQueryId:function(){return n(this.active_media_query,"media_query")?this.active_media_query.getMediaQuery().id:n(this.default_media_query,"media_query")?this.default_media_query.getMediaQuery().id:null},_styleDeclarationCallback:function(e,t,i){return e?(this.imc.trigger("service:log:error","Error data:styles module for getStyleDeclarationsByStyleAndMediaQuery."),!1):(this.editorDropDown.views.editorView.updateStyleDeclarations(t,i),this._openEditor())},_openEditor:function(){return this.editorDropDown.isRendered()||(this.editorDropDown.open(),this.getEditorToPositionCursorAtSelectorForElement(this.active_element)),!0}});return l}),define("hbs!ui/element-overlay/templates/element_controls",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n;return(n=i.parent_selector)?n=n.call(e,{hash:{}}):(n=e.parent_selector,n=typeof n===g?n.apply(e):n),m(n)}function o(e,t){return"body"}function a(e,t){var n,s="";return s+='\n    <button class="image-source"><span></span>',n=i["if"].call(e,e.has_image,{hash:{},inverse:v.program(8,c,t),fn:v.program(6,l,t)}),(n||0===n)&&(s+=n),s+=" image</button>\n    "}function l(e,t){return"Edit"}function c(e,t){return"Add"}function u(e,t){return'\n            <li class="element-revert-size">\n                <span class="btn" data-tooltips-title="Revert image size"></span>\n            </li>\n        '}function h(e,t){return'\n            <li class="element-alignment">\n                <span class="btn btn-drop" data-tooltips-title="Text Align"></span>\n                <div class="drop-panel" style="display: none;">\n                    <ul data-attribute="text-align" id="element-alignment" class="element-alignment-inner">\n                        <li data-attribute="left" class="btn left" data-tooltips-title="Text-align: left" data-tooltips-side="right"><span>Left</span></li>\n                        <li data-attribute="center" class="btn center" data-tooltips-title="Text-align: center" data-tooltips-side="right"><span>Centre</span></li>\n                        <li data-attribute="justify" class="btn justify" data-tooltips-title="Text-align: justify" data-tooltips-side="right"><span>Justify</span></li>\n                        <li data-attribute="right" class="btn right" data-tooltips-title="Text-align: right" data-tooltips-side="right"><span>Right</span></li>\n                    </ul>\n                </div><!-- /drop-panel -->\n            </li>\n        '}function d(e,t){return'\n            <li class="element-extras">\n                <span class="btn" data-tooltips-title="Text Effects &amp; CSS Columns"></span>\n            </li>\n        '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var p,f="",g="function",m=this.escapeExpression,v=this;return f+='<div class="element-controls-holder">\n    <span class="btn select-parent" data-tooltips-title="Select ',p=i["if"].call(t,t.has_parent,{hash:{},inverse:v.program(3,o,s),fn:v.program(1,r,s)}),(p||0===p)&&(f+=p),f+='" data-tooltips-margin="-1">\n        <span>PARENT</span>\n    </span>\n    <div class="visible" id="element-label">\n        <span data-tooltips-title="Change element">',(p=i.selector)?p=p.call(t,{hash:{}}):(p=t.selector,p=typeof p===g?p.apply(t):p),f+=m(p)+"</span>\n    </div>\n\n    ",p=i["if"].call(t,t.is_image,{hash:{},inverse:v.noop,fn:v.program(5,a,s)}),(p||0===p)&&(f+=p),f+='\n\n    <div class="width-height-controls">\n        <div id="element-width-input" data-tooltips-title="Element width" data-tooltips-margin="1"></div>\n        <div id="element-height-input" data-tooltips-title="Element height" data-tooltips-margin="1"></div>\n    </div>\n\n    <section class="delete-element" data-tooltips-title="Delete" data-tooltips-margin="-3"><span data-icon="ÓÄù" aria-hidden="true"></span><span class="screen-reader-text">Delete this element</span></section>\n    <section class="duplicate-element" data-tooltips-title="Duplicate" data-tooltips-margin="-3"><span class="btn copy"><span>Duplicate</span></span></section>\n    <ul class="master">\n        ',p=i["if"].call(t,t.is_image,{hash:{},inverse:v.noop,fn:v.program(10,u,s)}),(p||0===p)&&(f+=p),f+="\n        ",p=i.unless.call(t,t.is_image,{hash:{},inverse:v.noop,fn:v.program(12,h,s)}),(p||0===p)&&(f+=p),f+='\n        <li class="element-float-clear">\n            <span class="btn btn-drop" data-tooltips-title="Floats &amp; Clears"></span>\n            <div class="drop-panel" style="display: none;">\n                <ul data-attribute="float" id="element-float" class="element-float">\n                    <li data-attribute="left" class="btn left" data-tooltips-title="Float: left" data-tooltips-side="right"><span>Left</span></li>\n                    <li data-attribute="right" class="btn right" data-tooltips-title="Float: right" data-tooltips-side="right"><span>Right</span></li>\n                    <li data-attribute="none" class="btn none" data-tooltips-title="Float: none" data-tooltips-side="right"><span>None</span></li>\n                </ul>\n                <div class="separator"></div>\n                <ul data-attribute="clear" id="element-clear" class="element-clear">\n                    <li data-attribute="left" class="btn left" data-tooltips-title="Clear: left" data-tooltips-side="right"><span>Left</span></li>\n                    <li data-attribute="right" class="btn right" data-tooltips-title="Clear: right" data-tooltips-side="right"><span>Right</span></li>\n                    <li data-attribute="both" class="btn both" data-tooltips-title="Clear: both" data-tooltips-side="right"><span>Both</span></li>\n                    <li data-attribute="none" class="btn none" data-tooltips-title="Clear: none" data-tooltips-side="right"><span>None</span></li>\n                </ul>\n            </div><!-- /drop-panel -->\n        </li>\n        ',p=i.unless.call(t,t.is_image,{hash:{},inverse:v.noop,fn:v.program(14,d,s)}),(p||0===p)&&(f+=p),f+='\n    </ul>\n    <div class="clear"></div>\n</div><!-- /element-controls-holder -->\n'});return t.registerPartial("ui_element-overlay_templates_element_controls",i),i}),define("ui/element-overlay/views/controls",["jquery","backbone","core/utils/is","hbs!../templates/element_controls","core/components/unitvalue/index"],function(e,t,i,n,s){"use strict";var r=t.View.extend({namespace:"ui:element-dropdown",className:"element-controls",views:null,available_element_units:["px","em","%"],default_container_width:"480px",events:{"click .select-parent":"selectParent","mouseover .select-parent":"onHoverSelectParent","mouseout .select-parent":"offHoverSelectParent","click #element-label span":"changeElementType","click .master .btn-drop":"toggleDropdown","click .element-revert-size .btn":"revertSize","click .element-extras .btn":"showAdvancedControls","click .delete-element":"deleteElement","click .duplicate-element":"duplicateElement","click .element-alignment-inner .btn":"setTextAlignmentEmit","click .element-float .btn":"setFloatsEmit","click .element-clear .btn":"setClearsEmit","click .image-source":"onAddImageClick"},initialize:function(){return this.views={},this.views.width_unit_value=new s({css_property:"width",disable_views:["stepper","slider"],"default":{value:"",unit:"px"}}),this.views.height_unit_value=new s({css_property:"height",disable_views:["stepper","slider"],"default":{value:"",unit:"px"}}),this},render:function(){var e,t,s=this.model.get("element"),r=i(s,"element"),o=this.model.get("style_declaration"),a=i(o,"object"),l=this.model.isImageElement();return this.$el.attr("data-droppable",""),this.$el.attr("data-droppable-element-id",s.getElement().id),r&&a&&(this.views.width_unit_value.setElementIdAndMediaQueryId(s.getElement().id,o.getMediaQueryId()),this.views.height_unit_value.setElementIdAndMediaQueryId(s.getElement().id,o.getMediaQueryId())),this.$el.empty(),r?(this.views.width_unit_value.changeUnits(this.available_element_units),this.views.height_unit_value.changeUnits(this.available_element_units),this.$el.html(n({selector:s.getSelector(),has_parent:s.getParentElement()?!0:!1,parent_selector:this._buildParentSelector(s.getParentElement()),is_image:l,has_image:!this.model.isPlaceholder()})),(!this.model.isInlineElement()||l)&&(e=this.$el.find("#element-width-input"),t=this.$el.find("#element-height-input"),e.append(this.views.width_unit_value.$el).addClass("element-size-first-input"),this.model.isContainingElement()&&!l?t.append(this.views.height_unit_value.$el).addClass("element-size-last-input"):e.removeClass("element-size-first-input").addClass("element-size-last-input")),this.stopListening(this.model),this.delegateEvents(),this.listenTo(this.model,"change:style_declaration",this._setIconState),this.listenTo(this.model,"change:style_declaration",this._setUnitAndValue),this.listenTo(this.views.width_unit_value,"change",this.onInputChange),this.listenTo(this.views.height_unit_value,"change",this.onInputChange),a&&(this._setUnitAndValue(),this._setIconState(void 0,o)),this):(this.trigger("log-error",{message:"Cannot render element dropdown. `model.element` should be already set"
}),!1)},onHoverSelectParent:function(){return this.trigger("on:hover:select-parent"),!0},offHoverSelectParent:function(){return this.trigger("off:hover:select-parent"),!0},cloneStyleDeclaration:function(){return i(this.model.get("style_declaration"),"object")?e.extend(!0,{},this.model.get("style_declaration")):!1},selectParent:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.trigger("select-parent")},changeElementType:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.trigger("change-element-type")},toggleDropdown:function(t){var i,n;t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i=e(t.currentTarget),n=i.siblings(".drop-panel"),n.toggle(),this.$el.find(".drop-panel").not(n).hide()},revertSize:function(){return this.trigger("remove-style",["width","height"]),!0},showAdvancedControls:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.$el.find(".drop-panel").hide(),this.trigger("show-advanced-controls")},duplicateElement:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.$el.find(".drop-panel").hide(),this.trigger("duplicate-element")},deleteElement:function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.$el.find(".drop-panel").hide(),this.trigger("delete-element")},setTextAlignmentEmit:function(e){this._handleBtnClick(e,"text-align")},setFloatsEmit:function(e){this._handleBtnClick(e,"float")},setClearsEmit:function(e){this._handleBtnClick(e,"clear")},onAddImageClick:function(){this.model.trigger("display:asset-source-controls")},_buildParentSelector:function(e){var t;return i(e,"object")?(t=e.tag_name,e.attributes["class"]&&(t+="."+e.attributes["class"]),t):!1},_setUnitAndValue:function(){return this.views.width_unit_value.setValueByStyleDeclaration(this.cloneStyleDeclaration()),this.views.height_unit_value.setValueByStyleDeclaration(this.cloneStyleDeclaration()),this.views.width_unit_value.render(),this.views.height_unit_value.render(),!0},_setIconState:function(e,t){if(!i(t,"object")||!i(t.getStyleDeclaration,"function"))return!1;var n,s,r=t.getStyleDeclaration();return i(r,"object")&&i(r.attributes,"object")?(n=r.attributes,i(n["text-align"],"array")&&n["text-align"].length>0&&i(n["text-align"][0],"string")?(s=n["text-align"][0],this._setActiveTextAlignOuterButton(s,t.isInherited("text-align"))):this._unsetActiveTextAlignOuterButton(),i(n["float"],"array")&&n["float"].length>0&&i(n["float"][0],"string")?(s=n["float"][0],this._setActiveFloatClearOuterButton("float",s,t.isInherited("float"))):this._unsetActiveFloatClearOuterButton("float"),i(n.clear,"array")&&n.clear.length>0&&i(n.clear[0],"string")?(s=n.clear[0],this._setActiveFloatClearOuterButton("clear",s,t.isInherited("clear"))):this._unsetActiveFloatClearOuterButton("clear"),this):!1},_setActiveTextAlignOuterButton:function(e,t){var n=this.$el.find(".element-alignment .btn-drop");this.$el.find(".element-alignment-inner .btn").removeClass("active"),i(t,"boolean")&&!t?(n.addClass("active"),this.$el.find(".element-alignment-inner .btn."+e).addClass("active")):n.removeClass("active"),n.removeClass("left").removeClass("right").removeClass("justify").removeClass("center"),n.addClass(e)},_unsetActiveTextAlignOuterButton:function(){var e=this.$el.find(".element-alignment .btn-drop");e.removeClass("active"),e.removeClass("left").removeClass("right").removeClass("justify").removeClass("center"),this.$el.find(".element-alignment-inner .btn").removeClass("active")},_setActiveFloatClearOuterButton:function(e,t,n){var s=this.$el.find(".element-float-clear .btn-drop");"float"===e?(s.removeClass("float-left").removeClass("float-right").removeClass("float-none"),i(n,"boolean")&&!n?(s.addClass("active-float"),s.addClass("float-"+t)):s.removeClass("active-float")):(s.removeClass("clear-left").removeClass("clear-right").removeClass("clear-both").removeClass("clear-none"),i(n,"boolean")&&!n?(s.addClass("active-clear"),s.addClass("clear-"+t)):s.removeClass("active-clear")),this.$el.find(".element-"+e+" .btn").removeClass("active"),i(n,"boolean")&&!n&&this.$el.find(".element-"+e+" .btn."+t).addClass("active")},_unsetActiveFloatClearOuterButton:function(e){var t=this.$el.find(".element-float-clear .btn-drop");"float"===e?(t.removeClass("active-float"),t.removeClass("float-left").removeClass("float-right").removeClass("float-none")):(t.removeClass("active-clear"),t.removeClass("clear-left").removeClass("clear-right").removeClass("clear-both").removeClass("clear-none")),this.$el.find(".element-"+e+" .btn").removeClass("active")},onInputChange:function(e,t){var n={},s=[];return i(e,"string")&&(i(t,"string")||i(t,"undefined"))?(void 0===t?(s=[e],this.model.isImageElement()&&s.push("height"),this.trigger("remove-style",s)):(n[e]=[t],this.trigger("set-style",n)),this._setUnitAndValue(),!0):!1},_handleBtnClick:function(t,n){var s,r,o,a={};return s=e(t.currentTarget),o=s.hasClass("active"),r=s.data("attribute"),s.parents(".drop-panel").hide(),i(r,"string")?(o?this.trigger("remove-style",[n]):(a[n]=[r],this.trigger("set-style",a)),this):!1}});return r}),define("hbs!ui/element-overlay/templates/dragBar",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<span class="inner" data-droppable data-droppable-element-id="',(r=i.element_id)?r=r.call(t,{hash:{}}):(r=t.element_id,r=typeof r===a?r.apply(t):r),o+=l(r)+'"></span>\n'});return t.registerPartial("ui_element-overlay_templates_dragBar",i),i}),define("ui/element-overlay/views/dragBar",["jquery","backbone","hbs!../templates/dragBar"],function(e,t,i){"use strict";return t.View.extend({tagName:"span",className:"drag-element",render:function(){return this.$el.html(i({element_id:this.model.get("element").getElement().id})),this.delegateEvents(),this}})}),define("ui/element-overlay/model/active-element",["underscore","backbone","core/utils/is"],function(e,t,i){"use strict";var n=t.Model.extend({defaults:{element:null,style_declaration:null},initialize:function(e){i(e,"object")&&i(e.config,"object")&&(this.containing_elements=e.config.supported_elements.containers)},allowed_file_extensions:["png","jpg","svg","gif"],isInlineElement:function(){var e,t=this.get("style_declaration");return i(t,"object")&&i(t.style_declaration,"object")&&i(t.style_declaration.attributes,"object")&&i(t.style_declaration.attributes.display,"array")?(e=t.style_declaration.attributes.display[0],"inline"===e?!0:!1):!1},isImageElement:function(){var e=this.get("element");return i(e,"element")?"img"===e.getElement().tag_name:!1},isContainingElement:function(){var e=this.get("element");return i(e,"element")?-1!==this.containing_elements.indexOf(e.getElement().tag_name):!1},isPlaceholder:function(){var e=this.get("element").element;return this.isImageElement()?this.isSrcForPlaceholder(e.attributes.src):!1},isSrcForPlaceholder:function(e){return!i(e,"string")||e.length<1?!1:null!==e.match(this.placeholders_dir)?!0:!1},setPlaceholdersDir:function(e){return!i(e,"string")||e.length<1?!1:(this.placeholders_dir=e,!0)},setAllowedFileExtensions:function(e){return i(e,"array")?(this.allowed_file_extensions=e,!0):!1},getShortenedSrc:function(e){var t,n,s,r=20;return!i(e,"string")||e.length<1?!1:(t=e.split("/"),n=t.pop(),n.length<1&&(n=t.pop()),s=n.length,s>r&&(n="..."+n.substring(s-r+3)),n)},isValidSrc:function(t){var n,s,r,o;return!i(t,"string")||t.length<1?!1:(n=t.split("/"),s=e.last(n),r=s.split("."),r.length<2?!1:(o=r[1].toLowerCase(),e.contains(this.allowed_file_extensions,o)?!0:!1))},outputAllowedFileExtensions:function(){var t,i=e.chain(this.allowed_file_extensions).map(function(e){return e.toUpperCase()}).uniq().value();return t="",t+=e.initial(i).join(", "),t+=" or ",t+=e.last(i)}});return n}),define("hbs!ui/element-overlay/templates/src-input",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return" placeholder"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l=this,c="function",u=this.escapeExpression;return a+='<div class="input-wrapper',o=i.unless.call(t,t.src,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+='">\n    <input type="text" value="',(o=i.src)?o=o.call(t,{hash:{}}):(o=t.src,o=typeof o===c?o.apply(t):o),a+=u(o)+'" placeholder="Paste image URL here‚Ä¶" class="input"></input>\n</div>\n'});return t.registerPartial("ui_element-overlay_templates_src-input",i),i}),define("ui/element-overlay/views/SrcInput",["jquery","underscore","backbone","core/utils/is","hbs!../templates/src-input"],function(e,t,i,n,s){var r=i.View.extend({template:s,events:{"focus .input":"onFocus","keypress .input":"onKeypress","blur .input":"onBlur","paste .input":"onPaste"},className:"src-input",config:null,src:null,allowed_file_extensions:null,initialize:function(e){return this.config={},n(e,"object")&&n(e.config,"object")&&(this.config=e.config),this},onFocus:function(){var e=this.$(".input");return e.val(this.src),t.defer(t.bind(function(){e.select()},this)),!0},onKeypress:function(t){return t instanceof e.Event?(13===t.which&&this.onSubmit(t),!0):!1},onSubmit:function(t){var i,n;return t instanceof e.Event?(i=e(t.currentTarget),1!==i.length?!1:(n=i.val(),n.length<1&&(n=this.config.placeholder_image),this.model.isValidSrc(n)?(this.src!==n&&(this.setSrc(n),this.model.trigger("change:src",n)),this.render(),!0):(this.model.trigger("error:set","Not a valid file type, please reference a "+this.model.outputAllowedFileExtensions()),!1))):!1},onBlur:function(t){var i;return t instanceof e.Event?(t.preventDefault(),i=this.model.getShortenedSrc(this.src)||"",this.$(".input").val(i),!0):!1},onPaste:function(e){return t.defer(t.bind(function(){this.onSubmit(e)},this)),!0},setSrc:function(e){return!n(e,"string")||e.length<1?!1:(this.src=this.model.isSrcForPlaceholder(e)?"":e,!0)},render:function(){return this.$el.html(this.template({src:this.model.getShortenedSrc(this.src)})),this.delegateEvents(),this}});return r}),define("hbs!core/components/file-upload/templates/file-upload",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+="<span>",(r=i.button_text)?r=r.call(t,{hash:{}}):(r=t.button_text,r=typeof r===a?r.apply(t):r),o+=l(r)+'</span>\n<form enctype="multipart/form-data">\n    <input type="file" class="upload" title="Upload a file from your computer" />\n</form>\n'});return t.registerPartial("core_components_file-upload_templates_file-upload",i),i}),define("core/components/file-upload/views/FileUpload",["jquery","underscore","backbone","core/utils/is","./../../../typecastError","hbs!./../templates/file-upload"],function(e,t,i,n,s,r){return i.View.extend({template:r,tagName:"div",className:"file-upload",events:{"change input":"_onInputChanged",dragenter:"_stopStandardEventBehaviour",dragleave:"_stopStandardEventBehaviour",drop:"_onDrop"},allowed_mime_types:null,max_file_size:null,url:null,button_text:null,project_id:null,initialize:function(e){this.url=this._getBaseApiUrl()+"/assets",this.allowed_mime_types=["image/jpeg","image/png","image/gif","image/svg+xml","video/mp4","video/avi","video/x-flv"],this.max_file_size=5242880,this.button_text="Upload file",n(e,"object")||(e={}),n(e.url,"string")&&e.url.length>0&&(this.url=e.url),n(e.allowed_mime_types,"array")&&e.allowed_mime_types.length>0&&(this.allowed_mime_types=e.allowed_mime_types),n(e.max_file_size,"number")&&e.max_file_size>0&&(this.max_file_size=e.max_file_size),n(e.button_text,"string")&&e.button_text.length>0&&(this.button_text=e.button_text),t.bindAll(this,"_onProgressEvent","_onSuccess","_onFail")},render:function(){var e=this.template({button_text:this.button_text});return this.$el.html(e),this.delegateEvents(),this},setText:function(e){return!n(e,"string")||e.length<1?!1:(this.button_text=e,!0)},_getBaseApiUrl:function(){return"https://api."+window.location.host+"/v1"},_getDroppedFile:function(e){var t;return n(e,"object")?t=e.originalEvent.dataTransfer.files[0]:!1},_getFile:function(){var e=this.$el.find("input").get(0);return e.files[0]},_onDrop:function(e){var t;return n(e,"object")?(this._stopStandardEventBehaviour(e),t=this._getDroppedFile(e),this._startUpload(t),!0):!1},_onFail:function(e){var t;return t=e.responseText.length<1?{error:"The file could not be uploaded"}:JSON.parse(e.responseText),this.$el.removeClass("disabled"),this.$el.find("input").removeAttr("disabled",!1),this.model.trigger("file-upload:failed",new s(103,t.error),this.model),!0},_onInputChanged:function(){var e=this._getFile();return this._startUpload(e),!0},_onProgressEvent:function(e){var t=Math.floor(e.loaded/e.total*100);return this.model.trigger("file-upload:progress",t,this.model),!0},_onSuccess:function(e){return this.$el.removeClass("disabled"),this.$el.find("input").removeAttr("disabled",!1),this.model.trigger("file-upload:completed",e,this.model),!0},_startUpload:function(i){var r,o,a=new FormData,l=this._validateFile(i);return l instanceof s?(this.model.trigger("file-upload:failed",l,this.model),!1):(o=this.model.project_id,n(o,"number")?(a.append("project_id",o),a.append("asset",i),r=e.ajax({type:"POST",url:this.url,data:a,cache:!1,dataType:"json",processData:!1,contentType:!1,xhrFields:{withCredentials:!0},xhr:t.bind(function(){var t=e.ajaxSettings.xhr();return t.upload.addEventListener("progress",this._onProgressEvent),t},this)}),r.done(t.bind(this._onSuccess,this)),r.fail(t.bind(this._onFail,this)),this.$el.addClass("disabled"),this.$el.find("input").attr("disabled",!0),this.model.trigger("file-upload:started",this.model),!0):!1)},_stopStandardEventBehaviour:function(e){return e.preventDefault(),e.stopPropagation(),!0},_validateFile:function(e){var i;return e instanceof Blob?(i=t.contains(this.allowed_mime_types,e.type),i?e.size>this.max_file_size?new s(102,"File is too big"):null:new s(101,"Disallowed file type")):new s(100,"Not a file")}})}),define("hbs!ui/element-overlay/templates/asset-source-controls",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return" has-image"}function o(e,t){return'<span class="or">or</span>'}function a(e,t){return'<button class="remove"><span></span>Remove image</button>'}function l(e,t){var n,s="";return s+='<div class="error-message">',(n=i.error)?n=n.call(e,{hash:{}}):(n=e.error,n=typeof n===h?n.apply(e):n),s+=d(n)+"</div>"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="",h="function",d=this.escapeExpression,p=this;return u+='<div class="asset-source-controls',c=i["if"].call(t,t.has_image,{hash:{},inverse:p.noop,fn:p.program(1,r,s)}),(c||0===c)&&(u+=c),u+='">\n    ',c=i["if"].call(t,t.signed_in,{hash:{},inverse:p.noop,fn:p.program(3,o,s)}),(c||0===c)&&(u+=c),u+="\n    ",c=i["if"].call(t,t.has_image,{hash:{},inverse:p.noop,fn:p.program(5,a,s)}),(c||0===c)&&(u+=c),u+="\n    ",c=i["if"].call(t,t.error,{hash:{},inverse:p.noop,fn:p.program(7,l,s)}),(c||0===c)&&(u+=c),u+='\n    <a href="#" class="close-cross simple" title="Close">\n        <span aria-hidden="true" data-icon="ÓÄ¶"></span>\n        <span class="screen-reader-text">Close</span>\n    </a>\n</div>\n'});return t.registerPartial("ui_element-overlay_templates_asset-source-controls",i),i}),define("hbs!ui/element-overlay/templates/spinner",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="spinner">Loading...</div>\n'});return t.registerPartial("ui_element-overlay_templates_spinner",i),i}),define("ui/element-overlay/views/AssetSourceControls",["jquery","backbone","core/utils/is","core/utils/dom","./SrcInput","core/components/file-upload/views/FileUpload","hbs!../templates/asset-source-controls","hbs!../templates/spinner"],function(e,t,i,n,s,r,o,a){var l=t.View.extend({className:"asset-source-controls-wrapper",events:{"click .close-cross":"_onCloseButtonClick","click button.remove":"_onRemoveButtonClick"},template:o,views:null,error:null,model:null,initialize:function(e){this.views={},this.config=e.config,this.views.src_input=new s({config:this.config,model:this.model}),this.views.file_upload=new r({model:this.model}),this.model.on("error:set",this._onSrcInputError,this),this.model.on("file-upload:started",this._onUploadStarted,this),this.model.on("file-upload:failed",this._onUploadError,this),this.model.on("file-upload:completed",this._onUploadCompleted,this)},clearErrorMessage:function(){return this.error=null,this.$el.find(".error-message").remove(),!0},render:function(){var t=this.model.get("element").element.attributes.src||"";return this.views.src_input.remove(),this.views.src_input.setSrc(t),this.views.src_input.render(),this.$el.html(e(this.template({signed_in:i(this.config.user,"object")&&null!==this.config.user,has_image:!this.model.isPlaceholder(),error:this.error}))),this.$el.find(".asset-source-controls").append(this.views.src_input.$el),i(this.config.user,"object")&&null!==this.config.user&&(this.views.file_upload.render(),this.$el.find(".asset-source-controls").prepend(this.views.file_upload.$el)),this.delegateEvents(),this},remove:function(){return this.views.src_input.remove(),this.views.file_upload.remove(),l.__super__.remove.apply(this,arguments),!0},_onCloseButtonClick:function(e){return e.preventDefault(),this.model.trigger("remove:asset-source-controls"),!0},_onRemoveButtonClick:function(){return this.model.trigger("change:src",""),!0},_onSrcInputError:function(e){return this._showError(e),!0},_onUploadCompleted:function(e){return this._toggleSpinner(),i(e,"object")&&i(e.url,"string")&&e.url.length>0&&this.model.trigger("change:src",e.url),!0},_onUploadError:function(e){var t;return i(e,"object")?(t=e.message,101===e.errorCode?t="Not a valid file type, please choose a "+this.model.outputAllowedFileExtensions():102===e.errorCode&&(t="File is too big. Files should be less than 5MB."),this._showError(t),!0):!1},_onUploadStarted:function(){return this.clearErrorMessage(),this._toggleSpinner(),!0},_showError:function(e){return!i(e,"string")||e.length<1?!1:(this.error=e,this.render(),this.error=null,!0)},_toggleSpinner:function(){var e,t,s=this.$el.find(".spinner"),r=this.model.get("element").getElement(),o=this.model.get("style_declaration").getStyleDeclaration();return i(o.media_query_id,"string")&&i(r.id,"string")?s.length>0?(s.remove(),!0):(this.$el.find(".asset-source-controls").append(a()),s=this.$el.find(".spinner"),e=n.getElement(o.media_query_id,r.id),t=e.offset(),s.offset({left:t.left+e.width()/2-s.width()/2,top:t.top+e.height()/2-s.height()/2}),!0):!1}});return l}),define("ui/element-overlay/index",["jquery","backbone","underscore","core/utils/is","core/typecastError","core/components/dropdown/index","./views/controls","./views/dragBar","./model/active-element","./views/AssetSourceControls","core/utils/dom","chosen"],function(e,t,i,n,s,r,o,a,l,c,u){"use strict";var h=r.extend({namespace:"ui:element-overlay",className:"element-dropdown",relevant_width_css_props:null,relevant_css_props:null,is_dragging:!1,views:null,bar:null,target_el:null,position:null,model:null,element_location:null,current_dragging_index:null,listeners:i.extend({"[remote]data:project:ready":"_onProjectDataReady","[remote]data:styles:changed":"onChangeStyleDeclaration","[remote]data:elements:updated:element":"onUpdateActiveElement","[remote]data:styles:deleted:styleDeclaration":"onDeleteStyleDeclaration","[remote]ui:elements:updateElement:complete":"updateTargetElement"},t.UIController.prototype.listeners),initialize:function(){return this.views={},this.position={my:"left bottom-5",at:"left top",collision:"flip none"},this.relevant_width_css_props=["font-size","width","padding","padding-left","padding-right","border-left","border-left-width","border-right","border-right-width","border","border-width"],this.relevant_css_props=["text-align","float","clear","display","font-size","line-height","height"].concat(this.relevant_width_css_props),this.model=new l({config:this.config}),this.model.setPlaceholdersDir(this.config.placeholders_path),n(this.config.uploads,"object")&&n(this.config.uploads.images,"object")&&n(this.config.uploads.images.allowed_file_extensions,"array")&&this.config.uploads.images.allowed_file_extensions.length>0&&this.model.setAllowedFileExtensions(this.config.uploads.images.allowed_file_extensions),this.views.controls=new o({model:this.model,config:this.config}),this.views.bar=new a({model:this.model}),this.views.asset_source_controls=new c({model:this.model,config:this.config}),this.$el.addClass("typecast-dropdown-base"),this},listenToEvents:function(){return this.listenTo(this.views.controls,"select-parent",this.selectParent,this),this.listenTo(this.views.controls,"change-element-type",this.changeElementType,this),this.listenTo(this.views.controls,"show-advanced-controls",this.showAdvancedControls,this),this.listenTo(this.views.controls,"duplicate-element",this.duplicateElement,this),this.listenTo(this.views.controls,"delete-element",this.deleteElement,this),this.listenTo(this.views.controls,"set-style",this.setStyle,this),this.listenTo(this.views.controls,"remove-style",this.removeStyle,this),this.listenTo(this.views.controls,"log-error",this.logError,this),this.listenTo(this.views.controls,"on:hover:select-parent",this.highlightParentOutline,this),this.listenTo(this.views.controls,"off:hover:select-parent",this.fadeParentOutline,this),this.listenTo(this.model,"change:src",this.changeSrc,this),this.listenTo(this.model,"display:asset-source-controls",i.partial(this.render,!0),this),this.listenTo(this.model,"remove:asset-source-controls",i.partial(this.render,!1),this),!0},highlightParentOutline:function(){this.imc.trigger("ui:parent-outline:highlight:on")},fadeParentOutline:function(){this.imc.trigger("ui:parent-outline:highlight:off")},logError:function(e){this.imc.trigger("service:log:error",e)},changeSrc:function(e){var t=this.model.get("element"),i={};return n(t,"element")?((!n(e,"string")||e.length<1)&&(e=this.config.placeholder_image),i.attributes={src:e},this.imc.trigger("data:elements:updateElement",t.getElement().id,i),this.views.asset_source_controls.remove(),!0):!1},selectParent:function(){var e,t=this.model.get("element");return n(t,"element")?(e=t.getElement().parent_id,this.imc.trigger("data:state:set","active-element",e),this.imc.trigger("ui:element-overlay:select-parent:complete"),this.log("metric","Select parent",{location:"element overlay"}),!0):!1},changeElementType:function(){this.imc.trigger("ui:element-dialog:toggle")},showAdvancedControls:function(){this.imc.trigger("ui:layout-dialog:toggle")},duplicateElement:function(){var t,i,s,r,o;return n(this.model,"object")?(t=this.model.get("element"),n(t,"element")?(s=e(u.getDomNodesForElementTree(t.getElement(),!0)),i=this._getElement(t.getElement().id),r=t.getElement().parent_id,n(r,"string")&&void 0!==s?(s.attr("data-retain-classes","yes"),s.find("*").attr("data-retain-classes","yes"),s.attr("data-make-active","yes"),s=s.get(0).outerHTML,o=i.parent().contents().index(i),this.imc.trigger("ui:elements:insertHTML",r,o+1,s),!0):!1):!1):!1},deleteElement:function(){var e=this.model.get("element");return n(e,"element")?(this.imc.trigger("data:elements:deleteElement",e.getElement().id),!0):!1},setStyle:function(e){var t=this.model.get("element");return n(e,"object")&&n(this.active_style_id,"number")&&n(t,"element")&&n(this.active_media_query,"media_query")?(this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,t.getSelector(),e,null,function(t){return n(t,"object")&&"TypecastError"===t.constructor.name&&this.imc.trigger("service:log:error",{message:"Could not set style. Data error: "+t.getMessage(),code:t.getCode()}),n(e.width,"array")&&e.width.length>0&&this.updateWidth(),!0},this),this):!1},removeStyle:function(e){var t=this.model.get("element");return!n(e,"array")||e.length<1?!1:n(this.active_style_id,"number")&&n(t,"element")&&n(this.active_media_query,"media_query")?(this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,t.getSelector(),e,null,function(t){return n(t,"object")&&"TypecastError"===t.constructor.name&&this.imc.trigger("service:log:error",{message:"Could not remove attributes. Data error: "+t.getMessage(),code:t.getCode()}),-1!==e.indexOf("width")&&this.updateWidth(),!0},this),this):!1},updateWidth:function(){return!n(this.target_el,"object")||this.target_el.length<1?!1:(this.$el.width(this.target_el.outerWidth()),!0)},render:function(t){var i=this.views.controls;return this.isRendered()&&this.remove(),t&&(i=this.views.asset_source_controls),this.$el.append(i.render().$el),this.$el.append(this.views.bar.render().$el),this.updateTargetElement(),e(this.app_el).append(this.$el),this.updateWidth(),this.$el.position(this.position),this.setRendered(!0),this.listenToEvents(),this},updateTargetElement:function(){var t,i=this.model.get("element");return this.target_el=void 0,delete this.position.of,n(i,"element")?(t=this._getElement(i.getElement().id),!(t instanceof e)||t.length<1?!1:(this.target_el=t,this.position.of=this.target_el,!0)):!1},onChangeActiveElement:function(t){var i,s;return this.imc.off(null,this.onActiveElementUpdated,this),n(t,"element")?(i=t.getElement().id,"body"===i?(this.clear(),!1):(s=this._getElement(i),!(s instanceof e)||s.length<1?!1:(this.element_location=s.offset(),this.model.set("element",t),void this.onChangeActiveElement_getElementStyleDeclaration()))):(this.clear(),!1)},onActiveElementUpdated:function(e){this.model.set({element:e}),this.onChangeActiveElement_getElementStyleDeclaration()},onChangeActiveElement_getElementStyleDeclaration:function(){return this._fetchActiveElementStyle(function(){return n(this.model.get("element"),"object")&&n(this.active_style_id,"number")&&n(this.model.get("style_declaration"),"object")?void this.render():(this.clear(),!1)}),this},onChangeActiveStyle:function(e){return n(e,"number")?(this._fetchActiveElementStyle(),this):(this.clear(),!1)},onChangeStyleDeclaration:function(t,s,r,o,a){var l,c,u,h,d=this.model.get("element");return n(d,"element")&&n(a,"array")?(u=this._getElement(d.getElement().id),u instanceof e&&u.length>0&&(h=u.offset(),(a.indexOf("margin")>=0||a.indexOf("margin-left")>=0||!n(this.element_location,"object")||this.element_location.top!==h.top||this.element_location.left!==h.left)&&(this.updateWidth(),this.$el.position(this.position),this.element_location=h)),l=i.intersection(a,this.relevant_css_props),0===l.length?!1:(c=i.intersection(a,this.relevant_width_css_props),c.length>0&&this.updateWidth(),this._fetchActiveElementStyle(),this)):!1},onDeleteStyleDeclaration:function(){return this._fetchActiveElementStyle(this.render),!0},onUpdateActiveElement:function(e){var t=this.model.get("element");return n(e,"element")&&n(t,"element")?t.getElement().id!==e.getElement().id?!1:this.isRendered()?(this.model.set("element",e),this.render(),!0):!1:!1},clear:function(){return this.model.clear(),this.updateTargetElement(),this.remove(),!0},_fetchActiveElementStyle:function(e){var t=this.model.get("element");return n(t,"element")&&n(this.active_style_id,"number")&&n(this.active_media_query,"media_query")?(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,t.getSelector(),{attributes:this.relevant_css_props,element_id:t.getElement().id},function(t,i){return n(t,"object")&&"TypecastError"===t.constructor.name?void this.imc.trigger("service:log:error",{message:"Could not fetch style. Data error says:"+t.getMessage(),code:t.getCode()}):void(n(i,"object")&&(this.model.set("style_declaration",i),n(e,"function")&&e.call(this)))},this),this):!1},_getElement:function(e){return n(this.active_media_query,"object")?u.getElement(this.active_media_query.getMediaQuery().id,e):!1},_onProjectDataReady:function(){return this.imc.trigger("data:project:get","id",function(e,t){return e?(this.log("error","Unable to get project ID"),!1):(t=parseInt(t,10),void(this.model.project_id=t))},this),!0}});return h}),define("ui/inline-dropdown/model/active-element",["backbone"],function(e){"use strict";var t=e.Model.extend({defaults:{element_id:null,element:null,link_style:null,hover_style:null,visited_style:null}});return t}),define("hbs!ui/inline-dropdown/templates/inline-style",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div  id="inline-dialog">  <!--class="closed"-->\n    <ul>\n        <li><a id="italic" href="#">Italic</a></li>\n        <li><a id="bold" href="#">Bold</a></li>\n        <li><a id="anchor" href="#">Link</a>\n            <!-- LinkStyles Dialog-->\n            <ul id="linkstyles" class="closed">\n                <h1>',(r=i.selector)?r=r.call(t,{hash:{}}):(r=t.selector,r=typeof r===a?r.apply(t):r),o+=l(r)+'</h1>\n                <span></span>\n                <li id="inlinelink">\n                    <h2>link</h2>\n                    <div class="no-color" id="colorpicker"></div>\n                    <form>\n                        <input type="checkbox" name="underline" value="yes" /> Underlined\n                \n                    </form>\n                </li>\n                <li id="hover">\n                    <h2>hover</h2>\n                    <div class="no-color" id="colorpicker"></div>\n                    <form>\n                        <input type="checkbox" name="underline" value="yes" /> Underlined\n                \n                    </form>\n                    \n                </li>\n                <li id="visited">\n                    <h2>visited</h2>\n                    <div class="no-color" id="colorpicker"></div>\n                    <form>\n                        <input type="checkbox" name="underline" value="yes" /> Underlined\n                \n                    </form>\n                </li>\n                \n                <!--<p><a href="#" id="apply">Apply</a></p>-->\n            </ul>\n        </li>\n        \n    </ul>\n    \n</div>\n'});return t.registerPartial("ui_inline-dropdown_templates_inline-style",i),i}),define("ui/inline-dropdown/views/inline",["jquery","backbone","underscore","core/utils/is","hbs!../templates/inline-style"],function(e,t,i,n,s){return t.View.extend({className:"inline-controls",events:{"click #anchor":"createAnchorInlineElement","click #bold":"createStrongInlineElement","click #italic":"createEmInlineElement",'click input[type="checkbox"]':"toggleUnderline","click #colorpicker":"openLinkStyleColorPalette"},inline_elements:null,render:function(e){var t={};return n(this.model.get("element"),"object")?t.selector=[this.model.get("element").getSelector()," a"].join(""):t.selector="Active element link styles:",this.inline_elements=e||[],this.$el.html(s(t)),this.update(),this.delegateEvents(),this.listenTo(this.model,"restyle",this._updateColorPickersAndUnderlines),this},openLinkStyleColorPalette:function(t){var i,s,r,o;t.preventDefault(),t.stopPropagation(),i=e(t.currentTarget).siblings("h2").text(),["hover","link","visited"].indexOf(i)>=0&&(s="link"===i?"a":"a:"+i,r=this.model.get(i+"_style"),n(r,"object")&&(o=r.getStyleDeclaration().attributes.color),this.trigger("open-color-dialog",s,o))},update:function(){var e,t,i=this.inline_elements,s={a:this.$el.find("#anchor"),strong:this.$el.find("#bold"),em:this.$el.find("#italic")};if(!n(i,"Array"))return!1;for(e in s)s[e].hasClass("applied")&&s[e].removeClass("applied"),-1!==i.indexOf(e)&&s[e].addClass("applied");t=s.a.siblings("ul"),s.a.hasClass("applied")?(s.a.addClass("active"),t.hasClass("closed")&&(t.removeClass("closed"),t.addClass("open")),this._updateColorPickersAndUnderlines()):s.a.hasClass("active")&&(s.a.removeClass("active"),
t.hasClass("open")&&t.addClass("closed"))},_updateColorPickersAndUnderlines:function(){var e={link:this.model.get("link_style"),hover:this.model.get("hover_style"),visited:this.model.get("visited_style")};Object.keys(e).forEach(function(t){var i,s,r,o,a;r=e[t].getStyleDeclaration().attributes.color,i=t,"link"===t&&(i="inlinelink"),s=this.$el.find("#"+i+" > #colorpicker"),this._isValidStyleValue(r)&&"inherit"!==r[0]&&(s.css("background-color",r[0]),s.removeClass("no-color")),(n(r,"undefined")||this._isValidStyleValue(r)&&"inherit"===r[0])&&(s.css("background-color","inherit"),s.addClass("no-color")),o=e[t].getStyleDeclaration().attributes["text-decoration"],a=this.$("#"+i+" input"),this._isValidStyleValue(o)&&"underline"===o[0]?a.prop("checked",!0):a.removeAttr("checked")},this)},_isValidStyleValue:function(e){return n(e,"array")&&e.length>0&&n(e[0],"string")},toggleUnderline:function(t){var i,n,s;return t.stopPropagation(),t.stopImmediatePropagation(),s=e(t.currentTarget).parent().siblings("h2").text(),["hover","link","visited"].indexOf(s)>=0&&(i="link"===s?"a":"a:"+s,n=e(t.currentTarget).is(":checked"),e(t.currentTarget).attr("checked",!n),n?this.trigger("set-style",{"text-decoration":["underline"]},i):this.trigger("set-style",{"text-decoration":["none"]},i)),!0},createAnchorInlineElement:function(e){e.preventDefault(),e.stopPropagation(),-1===this.inline_elements.indexOf("a")?this.trigger("create","a"):this.trigger("remove","a")},createEmInlineElement:function(e){e.preventDefault(),e.stopPropagation(),-1===this.inline_elements.indexOf("em")?this.trigger("create","em"):this.trigger("remove","em")},createStrongInlineElement:function(e){e.preventDefault(),e.stopPropagation(),-1===this.inline_elements.indexOf("strong")?this.trigger("create","strong"):this.trigger("remove","strong")}})}),define("ui/inline-dropdown/index",["jquery","backbone","underscore","core/utils/is","core/utils/dom","core/components/dropdown/index","./model/active-element","./views/inline"],function(e,t,i,n,s,r,o,a){"use strict";var l=r.extend({namespace:"ui:inline-dropdown",className:"inline-dropdown",views:null,position:null,relevant_css_props:["color","text-decoration"],listeners:i.extend({"[remote]ui:elements:selection-occurred":"onSelectionOccur","[remote]ui:elements:selection-collapsed":"remove","[remote]data:styles:changed":"onStyleChange"},t.UIController.prototype.listeners),initialize:function(){this.position={my:"left+30 top+10",at:"right top",collision:"none none"},this.model=new o,this.controls=new a({model:this.model}),this.views=[],this.views.push(this.controls),this.$el.addClass("typecast-dropdown-base"),this.listenTo(this.controls,"create",this.createInline,this),this.listenTo(this.controls,"remove",this.removeInline,this),this.listenTo(this.controls,"set-style",this.setStyle,this),this.listenTo(this.controls,"open-color-dialog",this.openColorDialog,this)},openColorDialog:function(e,t){return n(e,"string")?(this.imc.trigger("ui:colour-dialog:open",t,function(t){n(t,"string")&&this.setStyle({color:[t]},e)},this),this):!1},createInline:function(e){var t="";return this.isValidInlineTagName(e)?("a"===e&&(t=' href="javascript:void(0)"'),this.imc.trigger("ui:elements:createInlineElement","<"+e+t+"></"+e+">"),this):!1},removeInline:function(e){return this.isValidInlineTagName(e)?(this.imc.trigger("ui:elements:removeInlineElement","<"+e+"></"+e+">"),this):!1},isValidInlineTagName:function(e){return["em","strong","a"].indexOf(e)>=0},setStyle:function(e,t){var i;return n(e,"object")&&this._isValidModelObject()&&n(this.active_media_query,"media_query")?(i=this.model.get("element").getSelector(),n(t,"string")&&(i=i+" "+t),this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,i,e,null,function(e){n(e,"object")&&"TypecastError"===e.constructor.name&&this.imc.trigger("service:log:error",{message:e.getMessage(),code:e.getCode()})},this),this):!1},removeStyle:function(e,t){var i;return n(e,"array")&&0!==e.length&&n(t,"string")&&this._isValidModelObject()&&n(this.active_media_query,"media_query")?(i=this.model.get("element").getSelector(),n(t,"string")&&(i=i+" "+t),this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,i,e,null,function(e){n(e,"object")&&"TypecastError"===e.constructor.name&&this.imc.trigger("service:log:error",{message:"Could not remove attributes. Data error: "+e.getMessage(),code:e.getCode()})},this),this):!1},onSelectionOccur:function(e,t,i){return e===t&&n(i,"Array")?(this.wrappers=i,this.imc.trigger("data:elements:getElementById",e,this._imcHandleWrapper(function(t){this.model.set("element",t),this.position.of=this._getElement(e),this._fetchLinksStyle()})),this):(this.isRendered()&&this.remove(),!1)},onStyleChange:function(e,t,s,r,o){var a;return n(o,"array")?(a=i.intersection(o,this.relevant_css_props),0===a.length?!1:void this._fetchLinksStyle(function(){this.model.trigger("restyle")})):!1},render:function(){return e(this.app_el).append(this.$el),this.views.forEach(function(e){this.$el.append(e.render(this.wrappers).$el)},this),this.$el.position(this.position),this.setRendered(!0),n(this.views.close,"object")&&this.listenTo(this.views.close,"dropdown:close",this.close,this),this},remove:function(){i.each(this.views,function(e){e.remove()}),this.setRendered(!1),this.$el.remove(),this.model.clear(),this.imc.trigger("ui:colour-dialog:close")},onChangeActiveStyle:function(e){return n(e,"number")?!0:(this.remove(),!1)},onChangeActiveElement:function(e){return n(e,"object")?!0:(this.remove(),!1)},_fetchLinksStyle:function(e){this._fetchStylesForActiveElementChildren([{selector:"a",model_name:"link_style"},{selector:"a:hover",model_name:"hover_style"},{selector:"a:visited",model_name:"visited_style"}],n(e,"function")?e:this.render)},_fetchStylesForActiveElementChildren:function(e,t){var i,s;if(n(e,"Array")&&e.length>0){if(!(n(this.model.get("element"),"object")&&n(this.active_style_id,"number")&&n(e[0].selector,"string")&&n(e[0].model_name,"string")&&n(this.active_media_query,"media_query")))return!1;i=[this.model.get("element").getSelector()," ",e[0].selector].join(""),s=i.replace(/:\w+/g,""),this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,i,{selector:s,attributes:["text-decoration"]},this._imcHandleWrapper(function(i){n(i,"object")&&(this.model.set(e[0].model_name,i),e.splice(0,1),this._fetchStylesForActiveElementChildren(e,t))}),this)}else n(t,"function")&&t.call(this);return this},_imcHandleWrapper:function(t){return e.proxy(function(e,i){return n(e,"object")&&"TypecastError"===e.constructor.name?void this.imc.trigger("service:log:error",{message:e.getMessage(),code:e.getCode()}):void t.apply(this,[i])},this)},_isValidModelObject:function(){return n(this.active_style_id,"number")&&n(this.model.get("element"),"element")},_getElement:function(e){return n(this.active_media_query,"object")?s.getElement(this.active_media_query.getMediaQuery().id,e):!1}});return l}),define("base64",[],function(){var e={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var i,n,s,r,o,a,l,c="",u=0;for(t=e._utf8_encode(t);u<t.length;)i=t.charCodeAt(u++),n=t.charCodeAt(u++),s=t.charCodeAt(u++),r=i>>2,o=(3&i)<<4|n>>4,a=(15&n)<<2|s>>6,l=63&s,isNaN(n)?a=l=64:isNaN(s)&&(l=64),c=c+this._keyStr.charAt(r)+this._keyStr.charAt(o)+this._keyStr.charAt(a)+this._keyStr.charAt(l);return c},decode:function(t){var i,n,s,r,o,a,l,c="",u=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");u<t.length;)r=this._keyStr.indexOf(t.charAt(u++)),o=this._keyStr.indexOf(t.charAt(u++)),a=this._keyStr.indexOf(t.charAt(u++)),l=this._keyStr.indexOf(t.charAt(u++)),i=r<<2|o>>4,n=(15&o)<<4|a>>2,s=(3&a)<<6|l,c+=String.fromCharCode(i),64!==a&&(c+=String.fromCharCode(n)),64!==l&&(c+=String.fromCharCode(s));return c=e._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){var t,i,n,s,r="",o=0;for(t=i=n=0;o<e.length;)t=e.charCodeAt(o),128>t?(r+=String.fromCharCode(t),o++):t>191&&224>t?(n=e.charCodeAt(o+1),r+=String.fromCharCode((31&t)<<6|63&n),o+=2):(n=e.charCodeAt(o+1),s=e.charCodeAt(o+2),r+=String.fromCharCode((15&t)<<12|(63&n)<<6|63&s),o+=3);return r}};return e}),define("hbs!ui/insert-dropdown/templates/buttonDisplay",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+="\r\n",n=i.each.call(e,e.sections,{hash:{},inverse:w.noop,fn:w.program(2,o,t)}),(n||0===n)&&(s+=n),s+="\r\n"}function o(e,t){var n,s="";return s+="\r\n<section",n=i["if"].call(e,e.isBlock,{hash:{},inverse:w.noop,fn:w.program(3,a,t)}),(n||0===n)&&(s+=n),s+=">\r\n    ",n=i["if"].call(e,e.name,{hash:{},inverse:w.noop,fn:w.program(5,l,t)}),(n||0===n)&&(s+=n),s+="\r\n    ",n=i["if"].call(e,e.subtitle,{hash:{},inverse:w.noop,fn:w.program(7,c,t)}),(n||0===n)&&(s+=n),s+="\r\n    ",n=i["if"].call(e,e.buttons,{hash:{},inverse:w.noop,fn:w.program(9,u,t)}),(n||0===n)&&(s+=n),s+="\r\n</section>\r\n"}function a(e,t){return' class="is-draggable cf"'}function l(e,t){var n,s="";return s+="<h4>",(n=i.name)?n=n.call(e,{hash:{}}):(n=e.name,n=typeof n===_?n.apply(e):n),s+=b(n)+"</h4>"}function c(e,t){var n,s="";return s+="<h5>",(n=i.subtitle)?n=n.call(e,{hash:{}}):(n=e.subtitle,n=typeof n===_?n.apply(e):n),s+=b(n)+"</h5>"}function u(e,t){var n,s="";return s+="\r\n    <ul>\r\n        ",n=i.each.call(e,e.buttons,{hash:{},inverse:w.noop,fn:w.program(10,h,t)}),(n||0===n)&&(s+=n),s+="\r\n    </ul>\r\n    "}function h(e,t){var n,s="";return s+="\r\n        <li\r\n            ",n=i["if"].call(e,e.label,{hash:{},inverse:w.noop,fn:w.program(11,d,t)}),(n||0===n)&&(s+=n),s+='>\r\n\r\n            <div class="insert-button"',n=i["if"].call(e,e.shortDescription,{hash:{},inverse:w.noop,fn:w.program(14,f,t)}),(n||0===n)&&(s+=n),s+=">\r\n                <span>",n=i["if"].call(e,e.buttonText,{hash:{},inverse:w.program(18,m,t),fn:w.program(16,g,t)}),(n||0===n)&&(s+=n),s+="</span>\r\n            </div>\r\n        </li>\r\n        "}function d(e,t){var n,s="";return s+='\r\n                data-label="',(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===_?n.apply(e):n),s+=b(n)+'"\r\n                ',n=i["if"].call(e,e.isBlock,{hash:{},inverse:w.noop,fn:w.program(12,p,t)}),(n||0===n)&&(s+=n),s+="\r\n            "}function p(e,t){var n,s="";return s+='\r\n                    data-droppable\r\n                    data-droppable-complete-event="ui:insert-dropdown:insert-template-css-for-reference"\r\n                    data-droppable-complete-event-reference="',(n=i.label)?n=n.call(e,{hash:{}}):(n=e.label,n=typeof n===_?n.apply(e):n),s+=b(n)+'"\r\n                    data-droppable-html="',(n=i.base64_item_html)?n=n.call(e,{hash:{}}):(n=e.base64_item_html,n=typeof n===_?n.apply(e):n),s+=b(n)+'"\r\n                '}function f(e,t){var n,s="";return s+=' data-tooltips-title="',(n=i.shortDescription)?n=n.call(e,{hash:{}}):(n=e.shortDescription,n=typeof n===_?n.apply(e):n),s+=b(n)+'"'}function g(e,t){var n;return(n=i.buttonText)?n=n.call(e,{hash:{}}):(n=e.buttonText,n=typeof n===_?n.apply(e):n),b(n)}function m(e,t){return"&nbsp;"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var v,y="",_="function",b=this.escapeExpression,w=this;return v=i["if"].call(t,t.sections,{hash:{},inverse:w.noop,fn:w.program(1,r,s)}),(v||0===v)&&(y+=v),y+="\r\n"});return t.registerPartial("ui_insert-dropdown_templates_buttonDisplay",i),i}),define("ui/insert-dropdown/views/buttonsDisplay",["jquery","backbone","underscore","core/utils/is","base64","hbs!./../templates/buttonDisplay"],function(e,t,i,n,s,r){var o=t.View.extend({className:"tab-body",events:{"click section li div.insert-button":"onElementSelected","mouseenter section li div.insert-button":"onElementHoverStart","mouseleave section li div.insert-button":"onElementHoverEnd"},tabConfig:{},render:function(){return this.preprocesTabConfig(),this.$el.html(r({sections:this.tabConfig})),this.delegateEvents(),this},onElementSelected:function(t){return t instanceof e.Event?(t.preventDefault(),this.trigger("menu:item-selected",this.getClickedButtonConfig(t)),!0):!1},onElementHoverStart:function(t){return t instanceof e.Event?(t.preventDefault(),this.trigger("menu:item-hover-start",this.getClickedButtonConfig(t)),!0):!1},onElementHoverEnd:function(){return this.trigger("menu:item-hover-end"),!0},getClickedButtonConfig:function(t){var n,s,r,o=this;return n=e(t.target).closest("li").index(),s=e(t.target).closest("section").index(),r=e.extend(!0,{},this.tabConfig[s].buttons[n]),i.each(r.insert,function(e){void 0===e.isBlock&&(e.isBlock=o.tabConfig[s].isBlock),void 0===e.isBlock&&(e.isBlock=!0)}),r},preprocesTabConfig:function(){return i.each(this.tabConfig,function(t){i.each(t.buttons,function(r){var o,a=i.pluck(r.insert,"html");t.isBlock||n(t.isBlock,"undefined")?(a[0]=e(a[0]).first().attr("data-make-active","yes")[0].outerHTML,a=i.map(a,function(t){return e(t).first()[0].outerHTML}),o=a.join(""),r.base64_item_html=s.encode(o),r.isBlock=!0):r.isBlock=!1},this)},this),!0}});return o}),define("hbs!ui/insert-dropdown/templates/dropdown",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="dialog insert-dialog">\r\n    <div class="header">\r\n        <h4>Insert Elements</h4>\r\n    </div>\r\n    <div class="dialog-header">\r\n    </div>\r\n    <div class="dialog-body">\r\n        <div class="section typography">\r\n            <section class="insert-collection block-level-elements">\r\n            </section>\r\n        </div>\r\n    </div>\r\n</div>\r\n'});return t.registerPartial("ui_insert-dropdown_templates_dropdown",i),i}),define("hbs!ui/insert-dropdown/templates/pinAndClose",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l=this;return a+='<span class="dialog-pin',o=i["if"].call(t,t.is_pinned,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+='" title="Pin this dialog" data-title-pinned="Unpin this dialog" data-title-unpinned="Pin this dialog">Pin Dialog</span>\r\n<a href="#" class="close-cross simple" title="Close"><span aria-hidden="true" data-icon="ÓÄ¶"></span><span class="screen-reader-text">Close</span></a>'});return t.registerPartial("ui_insert-dropdown_templates_pinAndClose",i),i}),define("ui/insert-dropdown/views/pinAndClose",["jquery","backbone","core/utils/is","hbs!./../templates/pinAndClose"],function(e,t,i,n){return t.View.extend({className:"pin-close",events:{"click .dialog-pin":"pinEmit","click .close-cross":"closeEmit"},is_pinned:!1,render:function(){return this.$el.html(n({is_pinned:this.is_pinned})),this.delegateEvents(),this},pinEmit:function(e){e&&e.preventDefault(),this.is_pinned=!this.is_pinned,this.render(),this.trigger("pin-click",this.is_pinned)},closeEmit:function(e){e&&e.preventDefault(),this.trigger("close")}})}),define("hbs!ui/insert-dropdown/templates/tabs",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return" class='active'"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l=this;return a+='<h4>Add content</h4>\r\n<ul class="cf">\r\n    <li ',o=i["if"].call(t,t.sections,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+=" data-tab='sections'>Big chunks</li>\r\n    <li ",o=i["if"].call(t,t.elements,{hash:{},inverse:l.noop,fn:l.program(1,r,s)}),(o||0===o)&&(a+=o),a+=" data-tab='elements'>Little bits</li>\r\n</ul>\r\n"});return t.registerPartial("ui_insert-dropdown_templates_tabs",i),i}),define("ui/insert-dropdown/views/tabs",["jquery","backbone","core/utils/is","hbs!./../templates/tabs"],function(e,t,i,n){return t.View.extend({className:"tabs header",active_tab:"sections",events:{"click li":"tabEmit"},render:function(){var e={};return e[this.active_tab]=!0,this.$el.html(n(e)),this.delegateEvents(),this},tabEmit:function(t){var n=e(t.currentTarget);return i(n.data().tab,"string")&&n.data().tab!==this.active_tab?(this.active_tab=n.data().tab,this.render(),this.trigger("tab:changed",this.active_tab),!0):!1}})}),define("ui/insert-dropdown/tabsMapping",[],function(){return{sections:[{name:"Layout containers",subtitle:"Group and structure content",isBlock:!0,buttons:[{label:"basic-div",buttonText:"Basic div",shortDescription:"Basic div",insert:[{html:"<div class='basic' data-retain-classes='yes'><p>A basic div element</p></div>",style_declarations:[{selector:"div.basic",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"div-50-50",buttonText:"50 / 50",shortDescription:"50 / 50",insert:[{html:"<section class='half-half' data-retain-classes='yes'><div class='half' data-retain-classes='yes'><p>A floated div (first half)</p></div><div class='half' data-retain-classes='yes'><p>A floated div (second half)</p></div></section>",style_declarations:[{selector:"section.half-half:before",defaultCss:{content:['""'],display:["table"]}},{selector:"section.half-half:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"section.half-half",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}},{selector:"div.half",defaultCss:{"float":["left"],width:["50%"],margin:["0"],"text-align":["center"],"-webkit-box-sizing":["border-box"],"-moz-box-sizing":["border-box"],"box-sizing":["border-box"]}}]}]},{label:"thirds",buttonText:"33 / 33 / 33",shortDescription:"33 / 33 / 33",insert:[{html:"<section class='thirds' data-retain-classes='yes'><div class='third' data-retain-classes='yes'><p>Column 1</p></div><div class='third' data-retain-classes='yes'><p>Column 2</p></div><div class='third' data-retain-classes='yes'><p>Column 3</p></div></section>",style_declarations:[{selector:"section.thirds:before",defaultCss:{content:['""'],display:["table"]}},{selector:"section.thirds:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"section.thirds",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}},{selector:"div.third",defaultCss:{"float":["left"],width:["33.33%"],"text-align":["center"],margin:["0"],"padding-right":["10px"],"-webkit-box-sizing":["border-box"],"-moz-box-sizing":["border-box"],"box-sizing":["border-box"]}}]}]},{label:"main-with-sidebar",buttonText:"Main with sidebar",shortDescription:"Main with sidebar",insert:[{html:"<section class='main-with-sidebar' data-retain-classes='yes'><div class='div-main' data-retain-classes='yes'><p>Main content area</p></div><aside class='sidebar' data-retain-classes='yes'><p>A sidebar area</p></aside></section>",style_declarations:[{selector:"section.main-with-sidebar:before",defaultCss:{content:['""'],display:["table"]}},{selector:"section.main-with-sidebar:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"section.main-with-sidebar",defaultCss:{margin:["0 auto"],width:["auto"]}},{selector:"div.div-main",defaultCss:{"float":["left"],width:["75%"],"text-align":["center"],margin:["0"],"-webkit-box-sizing":["border-box"],"-moz-box-sizing":["border-box"],"box-sizing":["border-box"]}},{selector:"aside.sidebar",defaultCss:{"float":["right"],width:["25%"],margin:["0"],"-webkit-box-sizing":["border-box"],"-moz-box-sizing":["border-box"],"box-sizing":["border-box"]}}]}]},{label:"slice",buttonText:"Content slice",shortDescription:"Content slice",insert:[{html:"<section class='slice' data-retain-classes='yes'><p>A content slice</p></section>",style_declarations:[{selector:"section.slice:before",defaultCss:{content:['""'],display:["table"]}},{selector:"section.slice:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"section.slice",defaultCss:{background:["#dedede"],"text-align":["center"],margin:["0"],padding:["3%"],width:["auto"]}}]}]},{label:"website_masthead",buttonText:"Masthead",shortDescription:"Masthead",insert:[{html:"<header class='masthead' data-retain-classes='yes'><img class='logo' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/logo.png\"><ul class='masthead-ul' data-retain-classes='yes'><li class='masthead-li' data-retain-classes='yes'><a href='#'>Sign In</a></li><li class='masthead-li' data-retain-classes='yes'><a href='#'>Blog</a></li><li class='masthead-li' data-retain-classes='yes'><a href='#'>Pricing</a></li><li class='masthead-li' data-retain-classes='yes'><a href='#'>Features</a></li><li class='masthead-li' data-retain-classes='yes'><a href='#'>Home</a></li></ul></header>",style_declarations:[{selector:"header.masthead:before",defaultCss:{content:['""'],display:["table"]}},{selector:"header.masthead:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"header.masthead",defaultCss:{margin:["0 auto 0 auto"],padding:["3%"]}},{selector:"img.logo",defaultCss:{"max-width":["100%"],width:["130px"],"float":["left"]}},{selector:"ul.masthead-ul",defaultCss:{"float":["right"],margin:["0 0 1em 0"]}},{selector:"li.masthead-li",defaultCss:{"float":["right"],margin:["0 0 0 1em"],"line-height":["1em"],"font-size":["16px"],"list-style":["none"]}}]}]},{label:"site-footer",buttonText:"Site footer",shortDescription:"Site footer",insert:[{html:'<footer class="site-footer" data-retain-classes=\'yes\'><ul class="footer-nav" data-retain-classes=\'yes\'><li class="footer-li" data-retain-classes=\'yes\'><a href="#" class="footer-a" data-retain-classes=\'yes\'>Home</a></li><li class="footer-li" data-retain-classes=\'yes\'><a href="#" class="footer-a" data-retain-classes=\'yes\'>Features</a></li><li class="footer-li" data-retain-classes=\'yes\'><a href="#" class="footer-a" data-retain-classes=\'yes\'>Pricing</a></li><li class="footer-li" data-retain-classes=\'yes\'><a href="#" class="footer-a" data-retain-classes=\'yes\'>Blog</a></li><li class="footer-li" data-retain-classes=\'yes\'><a href="#" class="footer-a" data-retain-classes=\'yes\'>Sign in</a></li></ul></footer>',style_declarations:[{selector:"footer.site-footer:before",defaultCss:{content:['""'],display:["table"]}},{selector:"footer.site-footer:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"footer.site-footer",defaultCss:{"background-color":["#333"],color:["#fff"],"text-align":["center"],padding:["5em 2em"],width:["auto"],margin:["0 auto"]}},{selector:"ul.footer-nav",defaultCss:{"list-style":["none"]}},{selector:"li.footer-li",defaultCss:{margin:["0 0.5em 0 0.5em"],"font-size":["16px"],display:["inline-block"]}},{selector:"a.footer-a",defaultCss:{color:["#ffffff"]}}]}]}]},{name:"Images & Galleries",subtitle:"Components and galleries with imagery",isBlock:!0,buttons:[{label:"img-16x9",buttonText:"Wide",shortDescription:"Wide",insert:[{html:'<img class="wide" data-retain-classes=\'yes\' src="http://typecast.com/js/src/images/placeholders/16x9.png">',style_declarations:[{selector:"img.wide",defaultCss:{"max-width":["100%"]}}]}]},{label:"img-4x3",buttonText:"Standard",shortDescription:"Standard",insert:[{html:'<img class="standard" data-retain-classes=\'yes\' src="http://typecast.com/js/src/images/placeholders/4x3.png">',style_declarations:[{selector:"img.standard",defaultCss:{"max-width":["100%"]}}]}]},{label:"img-1x1",buttonText:"Square",shortDescription:"Square",insert:[{html:'<img class="square" data-retain-classes=\'yes\' src="http://typecast.com/js/src/images/placeholders/1x1.png">',style_declarations:[{selector:"img.square",defaultCss:{"max-width":["100%"]}}]}]},{label:"testimonial",buttonText:"Testimonial",shortDescription:"Testimonial",insert:[{html:"<div class=\"testimonial\" data-retain-classes='yes' data-make-active='yes'><img src=\"http://typecast.com/js/src/images/placeholders/1x1.png\" class=\"testimonial-avatar\" data-retain-classes='yes'><h4 class=\"testimonial-name\" data-retain-classes='yes'>John Martins</h4><p class=\"testimonial-title\" data-retain-classes='yes'>Designer</p><div class=\"testimonial-content\" data-retain-classes='yes'><p class=\"testimonial-text\" data-retain-classes='yes'>Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts?</p></div></div>",style_declarations:[{selector:"div.testimonial",defaultCss:{margin:["0 auto 1em auto"],width:["auto"],"text-align":["center"]}},{selector:"img.testimonial-avatar",defaultCss:{"max-width":["100%"],width:["120px"],"border-radius":["50%"],display:["block"],margin:["0 auto 10px auto"]}},{selector:"h4.testimonial-name",defaultCss:{"font-size":["1.1em"],"text-align":["center"],margin:["0 0 4px 0"]}},{selector:"p.testimonial-title",defaultCss:{margin:["0 0 1em 0em"],"text-align":["center"],"font-size":["1em"]}},{selector:"div.testimonial-content",defaultCss:{margin:["0 auto 1em auto"],"text-align":["center"],padding:["0.5em"],"background-color":["#ffffff"]}},{selector:"p.testimonial-text",defaultCss:{"text-align":["center"],color:["#666"]}},{selector:"p.testimonial-text:last-child",defaultCss:{"margin-bottom":["0"]}}]}]},{label:"image_and_p",buttonText:"Image & paragraph",shortDescription:"Image & paragraph",insert:[{html:'<img src="http://typecast.com/js/src/images/placeholders/placeholder.png">',style_declarations:[{selector:"img",defaultCss:{"max-width":["100%"]}}]},{html:"<p>Did you ever heat a piece of paper before the fire until it was real hot, then lay it upon the table and rub it from end to end with your hand, and finally see it cling to the wall? Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts?</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]}]},{label:"image_3_col_gallery",buttonText:"3 column gallery",shortDescription:"3 column gallery",insert:[{html:"<div class='three-col-gallery' data-retain-classes='yes'><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"><img class='three-col-img' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/placeholder.png\"></div>",style_declarations:[{selector:"div.three-col-gallery:before",defaultCss:{content:['""'],display:["table"]}},{selector:"div.three-col-gallery:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"div.three-col-gallery",defaultCss:{width:["auto"],"text-align":["center"],margin:["0 auto"]}},{selector:"img.three-col-img",defaultCss:{width:["30%"],"float":["left"],margin:["1.666%"]}}]}]},{label:"article-media-list",buttonText:"Article media list",shortDescription:"Article media list",insert:[{html:"<article class='img-media-list' data-retain-classes='yes'><div class='image-media' data-retain-classes='yes'><img class='image-media-left' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/1x1.png\"><h3>Things A Boy Should Know About Electricity</h3><p>If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p></div><div class='image-media' data-retain-classes='yes'><img class='image-media-left' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/1x1.png\"><h3>Things A Boy Should Know About Electricity</h3><p>If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p></div><div class='image-media' data-retain-classes='yes'><img class='image-media-left' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/1x1.png\"><h3>Things A Boy Should Know About Electricity</h3><p>If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p></div></article>",style_declarations:[{selector:"div.image-media:before",defaultCss:{content:['""'],display:["table"]}},{selector:"div.image-media:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"article.img-media-list",defaultCss:{width:["auto"],"text-align":["left"],margin:["0 auto"]}},{selector:"div.image-media",defaultCss:{width:["auto"],"text-align":["left"],margin:["0"]}},{selector:"img.image-media-left",defaultCss:{"max-width":["100%"],"float":["left"],width:["150px"],margin:["0 1em 1em 0"]}},{selector:"h3",defaultCss:{"font-size":["28px"],"line-height":["1.2em"],"margin-bottom":["0.819em"]}},{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]}]},{label:"image_media_block",buttonText:"Image media block",shortDescription:"Image media block",insert:[{html:"<div class='image-media' data-retain-classes='yes'><img class='image-media-left' data-retain-classes='yes' src=\"http://typecast.com/js/src/images/placeholders/1x1.png\"><h3>Some Simple Experiments</h3><p>If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p></div>",style_declarations:[{selector:"div.image-media:before",defaultCss:{content:['""'],display:["table"]}},{selector:"div.image-media:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"div.image-media",defaultCss:{width:["auto"],"text-align":["left"],margin:["0"]}},{selector:"img.image-media-left",defaultCss:{"max-width":["100%"],"float":["left"],width:["150px"],margin:["0 1em 1em 0"]}},{selector:"h3",defaultCss:{"font-size":["28px"],"line-height":["1.2em"],"margin-bottom":["0.819em"]}},{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]}]}]},{name:"Presentational ideas",subtitle:"Create texture with headings, text and emphasis",isBlock:!0,buttons:[{label:"h+p",buttonText:"Heading & Paragraph",shortDescription:"Heading & paragraph",insert:[{html:"<h1>Some Simple Experiments</h1>",style_declarations:[{selector:"h1",defaultCss:{"font-size":["34px"],"margin-bottom":["0.819em"]}}]},{html:"<p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]}]},{label:"h-p-waterfall",buttonText:"Headings & Paragraphs Waterfall",shortDescription:"Headings & Paragraphs Waterfall",insert:[{html:"<h1>Some Simple Experiments</h1>",style_declarations:[{selector:"h1",defaultCss:{"font-size":["34px"],"margin-bottom":["0.819em"]}}]},{html:"<p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p>",
style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]},{html:"<h2>Some Simple Experiments</h2>",style_declarations:[{selector:"h2",defaultCss:{"font-size":["28px"],"margin-bottom":["0.819em"]}}]},{html:"<p>Did you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]},{html:"<h3>Some Simple Experiments</h3>",style_declarations:[{selector:"h3",defaultCss:{"font-size":["22px"],"margin-bottom":["0.819em"]}}]},{html:"<p>Did you ever heat a piece of paper before the fire until it was real hot, then lay it upon the table and rub it from end to end with your hand, and finally see it cling to the wall? Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts?</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["1em"]}}]}]},{label:"p-indented",buttonText:"Paragraphs indented",shortDescription:"Paragraphs indented",insert:[{html:"<p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"],"margin-bottom":["0em"]}}]},{html:"<p class='indented' data-retain-classes='yes'>Did you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.</p>",style_declarations:[{selector:"p.indented",defaultCss:{"text-indent":["1em"]}}]},{html:"<p class='indented' data-retain-classes='yes'>Did you ever heat a piece of paper before the fire until it was real hot, then lay it upon the table and rub it from end to end with your hand, and finally see it cling to the wall? Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts?</p>",style_declarations:[{selector:"p.indented",defaultCss:{"text-indent":["1em"]}}]},{html:"<p class='indented' data-retain-classes='yes'>We‚Äôre looking for that sweet spot, the thing that fits just right, plus or minus zero. With that said, this isn‚Äôt a zen, simple living blog post. By being an apostle for nothingness, we lose touch with reality. Philosophy is worthless if it is not practical. My intent is to be helpful and useful, not dogmatic. Your mileage may vary, if only because of differing needs.</p>",style_declarations:[{selector:"p.indented",defaultCss:{"text-indent":["1em"]}}]},{html:"<p class='indented' data-retain-classes='yes'>If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p>",style_declarations:[{selector:"p.indented",defaultCss:{"text-indent":["1em"]}}]}]},{label:"h1-intro-p",buttonText:"Heading & intro paragraph",shortDescription:"Heading & intro paragraph",insert:[{html:"<h1 class='intro-h1' data-retain-classes='yes'>About Frictional Electricity</h1>",style_declarations:[{selector:"h1.intro-h1",defaultCss:{"text-align":["center"],"font-size":["36px"],"line-height":["1.2em"],"margin-bottom":["1em"]}}]},{html:"<p class='intro-p' data-retain-classes='yes'>There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p>",style_declarations:[{selector:"p.intro-p",defaultCss:{"text-align":["center"],"font-size":["18px"],"margin-bottom":["1em"]}}]}]},{label:"left-head-and-paragraphs",buttonText:"Left heading & paragraphs",shortDescription:"Left heading & paragraphs",insert:[{html:"<div class='left-head' data-retain-classes='yes'><h1 class='left-head-h1' data-retain-classes='yes'>Things A Boy Should Know About Electricity</h1><p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p></div>",style_declarations:[{selector:"div.left-head:before",defaultCss:{content:['""'],display:["table"]}},{selector:"div.left-head:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"div.left-head",defaultCss:{width:["auto"],margin:["0"]}},{selector:"h1.left-head-h1",defaultCss:{"float":["left"],width:["40%"],"margin-right":["10%"],"font-size":["2.5em"],"line-height":["1.2em"]}},{selector:"p",defaultCss:{"font-size":["16px"]}}]}]},{label:"pull-quote-with-p",buttonText:"Pull quote & paragraphs",shortDescription:"Pull quote & paragraphs",insert:[{html:"<div class='pull-quote-p' data-retain-classes='yes'><p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p><blockquote class='pull-quote-left' data-retain-classes='yes'><p>&ldquo;You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.&rdquo;</p></blockquote><p>Did you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room. If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p></div>",style_declarations:[{selector:"div.pull-quote-p:before",defaultCss:{content:['""'],display:["table"]}},{selector:"div.pull-quote-p:after",defaultCss:{content:['""'],display:["table"],clear:["both"]}},{selector:"div.pull-quote-p",defaultCss:{width:["auto"],margin:["0"]}},{selector:"p",defaultCss:{"font-size":["16px"]}},{selector:"blockquote.pull-quote-left",defaultCss:{margin:["0em 1em 1em 0em"],width:["40%"],"float":["left"],"font-size":["1.6em"],"line-height":["1.2em"],"border-left":["3px solid #ccc"],padding:["0em 0em 0em 0.7em"],color:["#666666"]}}]}]},{label:"col_2",buttonText:"Two columns",shortDescription:"2 column paragraph",insert:[{html:"<p class='two-col' data-retain-classes='yes'>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ? Did you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room. Did you ever heat a piece of paper before the fire until it was real hot, then lay it upon the table and rub it from end to end with your hand, and finally see it cling to the wall?¬†Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts? If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p>",style_declarations:[{selector:"p.two-col",defaultCss:{"-moz-column-count":["2"],"-moz-column-gap":["20px"],"-webkit-column-count":["2"],"-webkit-column-gap":["20px"],"column-count":["2"],"column-gap":["20px"]}}]}]},{label:"col_3",buttonText:"Three columns",shortDescription:"3 column paragraph",insert:[{html:"<p class='three-col' data-retain-classes='yes'>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ? Did you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room. Did you ever heat a piece of paper before the fire until it was real hot, then lay it upon the table and rub it from end to end with your hand, and finally see it cling to the wall?¬†Were you ever in a factory where there were large belts running rapidly over pulleys or wheels, and where large sparks would jump to your hands when held near the belts? If you have never performed any of the four experiments mentioned, you should try them the first time a chance occurs. There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p>",style_declarations:[{selector:"p.three-col",defaultCss:{"-moz-column-count":["3"],"-moz-column-gap":["20px"],"-webkit-column-count":["3"],"-webkit-column-gap":["20px"],"column-count":["3"],"column-gap":["20px"]}}]}]},{label:"pull-quote",buttonText:"Pull quote",shortDescription:"Pull quote",insert:[{html:"<blockquote class='pull-quote' data-retain-classes='yes'><p class='quote' data-retain-classes='yes'>&ldquo;You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.&rdquo;</p></blockquote>",style_declarations:[{selector:"blockquote.pull-quote",defaultCss:{margin:["0em 1em 1em 0em"],width:["40%"],"float":["left"],"border-left":["3px solid #ccc"],padding:["0em 0em 0em 0.7em"]}},{selector:"p.quote",defaultCss:{"margin-bottom":["0"],"font-size":["1.6em"],"line-height":["1.2em"],color:["#666666"]}}]}]},{label:"dropcap_p",buttonText:"Dropcap & text",shortDescription:"Dropcap & text",insert:[{html:"<p><span class='dropcap' data-retain-classes='yes'>D</span>id you ever succeed in proving to the pussy-cat that something unusual occurs when you thoroughly rub his warm fur with your hand? Did you notice the bright sparks that passed to your hand when it was held just above the cat's back? You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.</p>",style_declarations:[{selector:"span.dropcap",defaultCss:{"float":["left"],color:["#333333"],"font-size":["95px"],"line-height":["60px"],"padding-top":["12px"],"padding-right":["12px"],"padding-left":["3px"]}}]}]},{label:"intro-paragraph",buttonText:"Intro paragraph",shortDescription:"Intro paragraph",insert:[{html:"<p class='intro-paragraph' data-retain-classes='yes'>There are dozens of simple, fascinating experiments that may be performed with this kind of electricity.</p>",style_declarations:[{selector:"p.intro-paragraph",defaultCss:{"text-align":["center"],"font-size":["29px"],"line-height":["39px"],"margin-bottom":["1.2em"],"margin-top":["1.2em"],padding:["1em 1em 1em 1em"],"border-top":["1px solid #ccc"],"border-bottom":["1px solid #ccc"]}}]}]},{label:"author-byline",buttonText:"Author byline",shortDescription:"Author byline",insert:[{html:"<p class='author-byline' data-retain-classes='yes'><em class=\"emphasis\" data-retain-classes='yes'>by</em> Jon Snow <small class=\"small\" data-retain-classes='yes'>on</small> 22nd October 2014</p>",style_declarations:[{selector:"p.author-byline",defaultCss:{"text-align":["center"],"font-size":["16px"],"line-height":["20px"],"margin-bottom":["1em"]}},{selector:"em.emphasis",defaultCss:{}},{selector:"small.small",defaultCss:{"font-size":["80%"]}},{selector:"strong.strong",defaultCss:{}}]}]}]},{name:"Lists & Nav",subtitle:"Sequence and nest content",isBlock:!0,buttons:[{label:"unordered-list",buttonText:"Unordered list",shortDescription:"Unordered list",insert:[{html:"<ul data-make-active='yes'><li>The first item in an unordered list</li><li>Second item right here</li><li>This is the third item in the list</li></ul>",style_declarations:[{selector:"ul",defaultCss:{margin:["10px 20px"],padding:["10px 20px"]}}]}]},{label:"ordered-list",buttonText:"Ordered list",shortDescription:"Ordered list",insert:[{html:"<ol data-make-active='yes'><li>Item number one of three</li><li>The second place item</li><li>Last but not least in an ordered list</li></ol>",style_declarations:[{selector:"ol",defaultCss:{margin:["10px 20px"],padding:["10px 20px"]}}]}]},{label:"nav-menu-nested",buttonText:"Nested Menu",shortDescription:"Nested Menu",insert:[{html:"<nav class='menu-nav' data-retain-classes='yes'><ul class='menu' data-retain-classes='yes'><li><a href='#'>Home</a></li><li><a href='#'>Features</a><ul class='menu-nested' data-retain-classes='yes'><li><a href='#'>Feature one</a></li><li><a href='#'>Second feature</a></li><li><a href='#'>Third item</a></li><li><a href='#'>Number four</a></li><li><a href='#'>Fifth feature</a></li></ul></li><li><a href='#'>Pricing</a></li><li><a href='#'>Blog</a></li><li><a href='#'>Sign in</a></li></ul></nav>",style_declarations:[{selector:"nav.menu-nav",defaultCss:{margin:["0 auto"]}},{selector:"ul.menu",defaultCss:{margin:["0 0 1em 0"],"font-size":["16px"],"list-style":["none"]}},{selector:"ul.menu-nested",defaultCss:{margin:["0 0 0em 2em"],"font-size":["16px"],color:["#ccc"],"list-style":["none"]}}]}]},{label:"nav-menu-horizontal",buttonText:"Menu horizontal",shortDescription:"Menu horizontal",insert:[{html:"<nav class='menu-nav-hz' data-retain-classes='yes'><ul class='menu-hz' data-retain-classes='yes'><li class='menu-hz-li' data-retain-classes='yes'><a href='#'>Home</a></li><li class='menu-hz-li' data-retain-classes='yes'><a href='#'>Features</a></li><li class='menu-hz-li' data-retain-classes='yes'><a href='#'>Pricing</a></li><li class='menu-hz-li' data-retain-classes='yes'><a href='#'>Blog</a></li><li class='menu-hz-li' data-retain-classes='yes'><a href='#'>Sign in</a></li></ul></nav>",style_declarations:[{selector:"nav.menu-nav-hz",defaultCss:{margin:["0 auto"]}},{selector:"ul.menu-hz",defaultCss:{margin:["0 0 1em 0"],"list-style":["none"],"text-align":["center"]}},{selector:"li.menu-hz-li",defaultCss:{margin:["0 0.5em 0 0.5em"],"font-size":["16px"],display:["inline-block"]}}]}]}]}],elements:[{name:"Text elements",subtitle:"Choose building blocks for written content",isBlock:!0,buttons:[{label:"reg_p",buttonText:"Paragraph",shortDescription:"Paragraph",insert:[{html:"<p>Have you ever shuffled your feet along over the carpet on a winter's evening and then quickly touched your finger to the nose of an unsuspecting friend? Did he jump when a bright spark leaped from your finger and struck him fairly on the very tip of his sensitive nasal organ?</p>",style_declarations:[{selector:"p",defaultCss:{"font-size":["16px"]}}]}]},{label:"unordered-list-lbl",buttonText:"ul",shortDescription:"Unordered list",insert:[{html:"<ul data-make-active='yes'><li>The first item in an unordered list</li><li>Second item right here</li><li>This is the third item in the list</li></ul>",style_declarations:[{selector:"ul",defaultCss:{margin:["10px 20px"],padding:["10px 20px"]}}]}]},{label:"ordered-list-lbl",buttonText:"ol",shortDescription:"Ordered list",insert:[{html:"<ol data-make-active='yes'><li>Item number one of three</li><li>The second place item</li><li>Last but not least in an ordered list</li></ol>",style_declarations:[{selector:"ol",defaultCss:{margin:["10px 20px"],padding:["10px 20px"]}}]}]},{label:"blockquote-lbl",buttonText:"blockquote",shortDescription:"Blockquote",insert:[{html:"<blockquote><p>&ldquo;You should be able to see, hear, and feel these sparks, especially when the air is dry and you are in a dark room.&rdquo;</p></blockquote>",style_declarations:[{selector:"blockquote",defaultCss:{"text-align":["right"],"font-size":["20px"]}}]}]},{label:"h-lvl1",buttonText:"h1",shortDescription:"Level 1",insert:[{html:"<h1>Some Simple Experiments</h1>",style_declarations:[{selector:"h1",defaultCss:{"font-size":["34px"]}}]}]},{label:"h-lvl2",buttonText:"h2",shortDescription:"Level 2",insert:[{html:"<h2>A second level heading</h2>",style_declarations:[{selector:"h2",defaultCss:{"font-size":["28px"]}}]}]},{label:"h-lvl3",buttonText:"h3",shortDescription:"Level 3",insert:[{html:"<h3>A third level heading</h3>",style_declarations:[{selector:"h3",defaultCss:{"font-size":["22px"]}}]}]},{label:"h-lvl4",buttonText:"h4",shortDescription:"Level 4",insert:[{html:"<h4>A fourth level heading</h4>",style_declarations:[{selector:"h4",defaultCss:{"font-size":["18px"]}}]}]},{label:"h-lvl5",buttonText:"h5",shortDescription:"Level 5",insert:[{html:"<h5>A fifth level heading</h5>",style_declarations:[{selector:"h5",defaultCss:{"font-size":["16px"]}}]}]},{label:"h-lvl6",buttonText:"h6",shortDescription:"Level 6",insert:[{html:"<h6>A sixth level heading</h6>",style_declarations:[{selector:"h6",defaultCss:{"font-size":["14px"]}}]}]},{label:"code",buttonText:"Code",shortDescription:"Code",insert:[{html:"<code>&lt;div&gt;&lt;p&gt;A code example&lt;/p&gt;&lt;/div&gt;</code>",style_declarations:[{selector:"code",defaultCss:{"background-color":["#f1f1f1"],display:["block"],padding:["6px"],"margin-bottom":["20px"],"font-size":["15px"]}}]}]}]},{name:"Containing elements",subtitle:"Structure your canvas at the highest level",isBlock:!0,buttons:[{label:"div",buttonText:"Div",shortDescription:"Div",insert:[{html:"<div><p>A div element</p></div>",style_declarations:[{selector:"div",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"article",buttonText:"Article",shortDescription:"Article",insert:[{html:"<article><p>An article element</p></article>",style_declarations:[{selector:"article",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"section",buttonText:"Section",shortDescription:"Section",insert:[{html:"<section><p>A section element</p></section>",style_declarations:[{selector:"section",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"aside",buttonText:"Aside",shortDescription:"Aside",insert:[{html:"<aside><p>An aside element</p></aside>",style_declarations:[{selector:"aside",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"nav",buttonText:"Nav",shortDescription:"Nav",insert:[{html:"<nav><p>A nav element</p></nav>",style_declarations:[{selector:"nav",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"header",buttonText:"Header",shortDescription:"Header",insert:[{html:"<header><p>A header element</p></header>",style_declarations:[{selector:"header",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]},{label:"footer",buttonText:"Footer",shortDescription:"Footer",insert:[{html:"<footer><p>A footer element</p></footer>",style_declarations:[{selector:"footer",defaultCss:{margin:["0 auto"],"text-align":["center"],width:["auto"]}}]}]}]},{name:"Object elements",subtitle:"Insert graphics and non-text links",isBlock:!0,buttons:[{label:"img",buttonText:"Image",shortDescription:"Image",insert:[{html:'<img src="http://typecast.com/js/src/images/placeholders/placeholder.png">',style_declarations:[{selector:"img",defaultCss:{"max-width":["100%"]}}]}]}]},{name:"Inline text elements",subtitle:"Fine tune individual words",isBlock:!1,buttons:[{label:"strong",buttonText:"Strong",shortDescription:"Strong",insert:[{html:"<strong>Some bold text</strong>"}]},{label:"emphasis",buttonText:"Emphasis",shortDescription:"Emphasis",insert:[{html:"<em>Some italic text</em>"}]},{label:"link",buttonText:"Link",shortDescription:"Link",insert:[{html:"<a href='#'>A link</a>"}]},{label:"del",buttonText:"Del",shortDescription:"Del",insert:[{html:"<del>Some deleted text</del>"}]},{label:"span",buttonText:"Span",shortDescription:"Span",insert:[{html:"<span>A span</span>"}]},{label:"superscript",buttonText:"Superscript",shortDescription:"Superscript",insert:[{html:"<sup>Superscript text</sup>",style_declarations:[{selector:"sup",defaultCss:{top:["-0.5em"],"font-size":["75%"],"line-height":["0"],position:["relative"],"vertical-align":["baseline"]}}]}]},{label:"subscript",buttonText:"Subscript",shortDescription:"Subscript",insert:[{html:"<sub>Subscript text</sub>",style_declarations:[{selector:"sub",defaultCss:{bottom:["-0.25"],"font-size":["75%"],"line-height":["0"],position:["relative"],"vertical-align":["baseline"]}}]}]}]},{name:"Punctuation marks",subtitle:"En dash, em dash, double and single quotes",isBlock:!1,buttons:[{label:"deco_open_dbl_quot",shortDescription:"Decorative open double quote",buttonText:"‚ùù",insert:[{html:"&#10077;"}]},{label:"deco_close_dbl_quot",shortDescription:"Decorative close double quote",buttonText:"‚ùû",insert:[{html:"&#10078;"}]},{label:"deco_open_quot",shortDescription:"Decorative open quote",buttonText:"‚ùõ",insert:[{html:"&#10075;"}]},{label:"deco_close_quot",shortDescription:"Decorative close quote",buttonText:"‚ùú",insert:[{html:"&#10076;"}]},{label:"dash",shortDescription:"En dash",buttonText:"‚Äì",insert:[{html:"‚Äì"}]},{label:"long_dash",shortDescription:"Em dash",buttonText:"‚Äî",insert:[{html:"‚Äî"}]},{label:"laquo",shortDescription:"Left pointing double angle quotation mark",buttonText:"¬´",insert:[{html:"&#171;"}]},{label:"raquo",shortDescription:"Right pointing double angle quotation mark",buttonText:"¬ª",insert:[{html:"&#187;"}]},{label:"lsaquo",shortDescription:"Left pointing single angle quotation mark",buttonText:"‚Äπ",insert:[{html:"&lsaquo;"}]},{label:"rsaquo",shortDescription:"Right pointing single angle quotation mark",buttonText:"‚Ä∫",insert:[{html:"&rsaquo;"}]},{label:"mdot",shortDescription:"Middle dot",buttonText:"¬∑",insert:[{html:"&#183;"}]},{label:"invert_question",shortDescription:"Inverted question mark",buttonText:"¬ø",insert:[{html:"¬ø"}]},{label:"invert_exclam",shortDescription:"Inverted exclamation mark",buttonText:"¬°",insert:[{html:"¬°"}]},{label:"exclam+quest",shortDescription:"Interrobang",buttonText:"‚ÄΩ",insert:[{html:"‚ÄΩ"}]}]},{name:"Math & finance symbols",subtitle:"Pi, yen, and per mille symbol",isBlock:!1,buttons:[{label:"cross_c",shortDescription:"Cent",buttonText:"¬¢",insert:[{html:"¬¢"}]},{label:"euro",shortDescription:"Euro",buttonText:"‚Ç¨",insert:[{html:"‚Ç¨"}]},{label:"ex",shortDescription:"Multiplication sign",buttonText:"√ó",insert:[{html:"√ó"}]},{label:"divide",shortDescription:"Division sign",buttonText:"√∑",insert:[{html:"√∑"}]},{label:"tilde",shortDescription:"Tilde",buttonText:"~",insert:[{html:"~"}]},{label:"pi",shortDescription:"Pi",buttonText:"œÄ",insert:[{html:"œÄ"}]},{label:"square",shortDescription:"Squared",buttonText:"¬≤",insert:[{html:"¬≤"}]},{label:"hex",shortDescription:"Cubed",buttonText:"¬≥",insert:[{html:"¬≥"}]},{label:"china",shortDescription:"Yen",buttonText:"¬•",insert:[{html:"¬•"}]},{label:"permil",shortDescription:"Per mille",buttonText:"‚Ä∞",insert:[{html:"‚Ä∞"}]}]},{name:"Legal, doc & type marks",isBlock:!1,buttons:[{label:"copyright",shortDescription:"Copyright",buttonText:"¬©",insert:[{html:"¬©"}]},{label:"circle_r",shortDescription:"Registered trademark",buttonText:"¬Æ",insert:[{html:"¬Æ"}]},{label:"parag",shortDescription:"Pilcrow",buttonText:"¬∂",insert:[{html:"¬∂"}]},{label:"tm",shortDescription:"Trademark",buttonText:"‚Ñ¢",insert:[{html:"‚Ñ¢"}]},{label:"cross",shortDescription:"Dagger",buttonText:"‚Ä†",insert:[{html:"‚Ä†"}]},{label:"at",shortDescription:"At",buttonText:"@",insert:[{html:"@"}]},{label:"and",shortDescription:"Ampersand",buttonText:"&",insert:[{html:"&"}]},{label:"section-entity",shortDescription:"Section",buttonText:"¬ß",insert:[{html:"¬ß"}]}]},{name:"Arrows and shapes",isBlock:!1,buttons:[{label:"left_arw",shortDescription:"Leftwards arrow",buttonText:"‚Üê",insert:[{html:"&#8592;"}]},{label:"right_arw",shortDescription:"Rightwards arrow",buttonText:"‚Üí",insert:[{html:"&#8594;"}]},{label:"up_arw",shortDescription:"Upwards arrow",buttonText:"‚Üë",insert:[{html:"&#8593;"}]},{label:"down_arw",shortDescription:"Downwards arrow",buttonText:"‚Üì",insert:[{html:"&#8595;"}]},{label:"left_right",shortDescription:"Left right arrow",buttonText:"‚Üî",insert:[{html:"&#8596;"}]},{label:"left_right_dbl",shortDescription:"Left right double arrow",buttonText:"‚áî",insert:[{html:"&#8660;"}]},{label:"left_dbl",shortDescription:"Left double arrow",buttonText:"‚áê",insert:[{html:"&#8656;"}]},{label:"right_dbl",shortDescription:"Right double arrow",buttonText:"‚áí",insert:[{html:"&#8658;"}]},{label:"top_dbl",shortDescription:"Upwards double arrow",buttonText:"‚áë",insert:[{html:"&#8657;"}]},{label:"down_dbl",shortDescription:"Downwards double arrow",buttonText:"‚áì",insert:[{html:"&#8659;"}]},{label:"clubs",shortDescription:"Black club suit",buttonText:"‚ô£",insert:[{html:"&#9827;"}]},{label:"heart",shortDescription:"Black heart suit",buttonText:"‚ô•",insert:[{html:"&#9829;"}]},{label:"diams",shortDescription:"Black diamond suit",buttonText:"‚ô¶",insert:[{html:"&#9830;"}]},{label:"spades",shortDescription:"Black spade suit",buttonText:"‚ô†",insert:[{html:"&#9824;"}]},{label:"loz",shortDescription:"Lozenge",buttonText:"‚óä",insert:[{html:"&#9674;"}]}]}]}}),define("hbs!ui/insert-dropdown/templates/linePreviewer",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,"<div class='left-arrow'></div><div class='right-arrow'></div>"});return t.registerPartial("ui_insert-dropdown_templates_linePreviewer",i),i}),define("ui/insert-dropdown/views/linePreviewer",["jquery","underscore","backbone","core/utils/is","core/utils/dom","hbs!../templates/linePreviewer"],function(e,t,i,n,s,r){return i.View.extend({className:"insert-here-line",app_el:null,position:null,initialize:function(){return n(this.options.app_el,"object")?(this.app_el=e(this.options.app_el),!0):!1},render:function(){return n(this.app_el,"object")?(this.$el.html(r()),this.app_el.append(this.$el),this):!1},showInAt:function(e,t,i){var r,o=s.getElement(t,e);return 1!==o.length?!1:(n(i,"number")?(r={my:"center bottom",at:"center top-1",collision:"none none"},r.of=o.find("[data-id]").eq(i)):(r={my:"center top",at:"center bottom+1",collision:"none none"},r.of=o.find("[data-id]").last()),this.render()&&this.$el.css("width",r.of.outerWidth()).position(r),!0)},showAfter:function(e,t){var i,n=s.getElement(t,e);return 1!==n.length?!1:(i={my:"center top",at:"center bottom+1",of:n,collision:"none none"},this.render()&&this.$el.css("width",i.of.outerWidth()).position(i),!0)},showBefore:function(e,t){var i,n=s.getElement(t,e);return 1!==n.length?!1:(i={my:"center bottom",at:"center top-1",of:n,collision:"none none"},this.render()&&this.$el.css("width",i.of.outerWidth()).position(i),!0)}})}),define("hbs!ui/insert-dropdown/templates/cursorPreviewer",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,"<div class='top-arrow'></div><div class='bottom-arrow'></div>"});return t.registerPartial("ui_insert-dropdown_templates_cursorPreviewer",i),i}),define("hbs!ui/insert-dropdown/templates/cursorPreviewerAnchor",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="cursor-preview-anchor" style="display:inline-block;"></div>'});return t.registerPartial("ui_insert-dropdown_templates_cursorPreviewerAnchor",i),i}),define("ui/insert-dropdown/views/cursorPreviewer",["jquery","underscore","backbone","core/utils/is","core/utils/dom","hbs!../templates/cursorPreviewer","hbs!../templates/cursorPreviewerAnchor"],function(e,t,i,n,s,r,o){return i.View.extend({className:"insert-here-cursor",app_el:null,position:null,initialize:function(){return n(this.options.app_el,"object")?(this.app_el=e(this.options.app_el),!0):!1},render:function(){return n(this.app_el,"object")?(this.$el.html(r()),this.app_el.append(this.$el),this):!1},showAtEnd:function(t,i,r){var a,l,c,u,h,d=s.getElement(i,t);return 1!==d.length?!1:n(r,"object")&&n(r.start,"number")&&n(r.end,"number")?(a=e(d[0].outerHTML),u=a.contents(),h=a.html().trim(),(0===u.length||1===u.length&&3===u[0].nodeType)&&(h=h.substr(0,r.end)),a.html(h),c=this.extendWithGetAllStyle(d).getAllStyle(),l=e(o()),a.removeAttr("data-id").append(l),e(this.app_el).append(a),a.css(c).css("position","absolute"),a.position({my:"left top",at:"left top",collision:"none none",of:d}),this.render(),this.$el.css("height",c.fontSize),this.$el.position({my:"left bottom",at:"right center",collision:"none none",of:l}),a.remove(),!0):!1},extendWithGetAllStyle:function(e){return n(e,"object")?(e.getAllStyle=function(){var e,t,i,n,s,r,o,a=this.get(0),l={};if(window.getComputedStyle){for(s=function(e,t){return t.toUpperCase()},e=window.getComputedStyle(a,null),o=e.length,r=0;o>r;r++)t=e[r],i=t.replace(/\-([a-z])/g,s),n=e.getPropertyValue(t),l[i]=n;return l}if(a.currentStyle){e=a.currentStyle;for(t in e)l[t]=e[t];return l}return this.css()},e):!1}})}),define("ui/insert-dropdown/dropdown",["jquery","backbone","underscore","core/utils/is","core/utils/dom","core/typecastError","core/utils/scroll","core/components/dropdown/index","./views/buttonsDisplay","hbs!./templates/dropdown","./views/pinAndClose","./views/tabs","./tabsMapping","./views/linePreviewer","./views/cursorPreviewer"],function(e,t,i,n,s,r,o,a,l,c,u,h,d,p,f){var g=a.extend({namespace:"ui:insert-dropdown",className:"insert-element-menu",views:null,insert_position:null,selection_range:null,active_style_ready:null,listeners:i.extend({"[remote]data:project:ready":"_setProjectType","[remote]ui:elements:loaded":"onChangeActiveElement","[remote]ui:elements:selection-range":"onElementsSelectionRange","[remote]ui:insert-dropdown:insert-template-css-for-reference":"insertTemplateCssForReference"},a.prototype.listeners,t.UIController.prototype.listeners),events:i.extend({},o.getScrollEventsToStopScrolling(),o.getScrollEventsToStopScrolling(".tab-body")),elementMapping:d,project_type:"webpage",initialize:function(){return this.views={},g.__super__.initialize.apply(this,arguments),this.active_style_ready=e.Deferred(),this.position.my="left top",this.position.at="right top",this.position.collision="none none",this.position.of=window,this.positionOpen={my:"right top",at:"right top",of:window,collision:"none none"},this.views.buttons_display=new l,this.views.buttons_display.tabConfig=this.elementMapping.sections,this.views.pinClose=new u,this.views.tabs=new h,this.views.line_preview=new p({app_el:this.target_el}),this.views.cursor_preview=new f({app_el:this.target_el}),this},_setProjectType:function(){this.imc.trigger("data:project:get","type",function(e,t){return e?!1:!n(t,"string")||t.length<1?!1:(this.project_type=t,!0)},this)},isAdProject:function(){return"advert"===this.project_type},onElementsSelectionRange:function(e){return n(e,"object")&&n(e.start,"number")&&n(e.end,"number")?(this.selection_range=e,!0):!1},render:function(){return this.$el.off("transitionend webkitTransitionEnd otransitionend"),this.$el.addClass("no-transition"),
g.__super__.render.call(this,[this.views.pinClose,this.views.tabs,this.views.buttons_display]),this.delegateEvents(),window.getComputedStyle(this.el).getPropertyValue("top"),this.$el.addClass("dropdown-shown"),this.$el.removeClass("no-transition"),this.$el.position(this.positionOpen),this.listenTo(this.views.buttons_display,"menu:item-selected",this.addHTML,this),this.listenTo(this.views.buttons_display,"menu:item-hover-start",this.onItemHoverStart,this),this.listenTo(this.views.buttons_display,"menu:item-hover-end",this.onItemHoverEnd,this),this.listenTo(this.views.tabs,"tab:changed",this.onTabChange,this),this.listenTo(this.views.pinClose,"close",this.remove,this),this},onTabChange:function(e){var t;return n(e,"string")?("sections"===e&&(t="sections"),"elements"===e&&(t="elements"),n(t,"string")?(this.views.buttons_display.tabConfig=this.elementMapping[t],this.views.buttons_display.render(),!0):!1):!1},onItemHoverStart:function(e){return this.validateButtonConfig(e)?(this.highlightPosition(e),!0):!1},onItemHoverEnd:function(){return this.views.line_preview.remove(),this.views.cursor_preview.remove(),!0},highlightPosition:function(e){return n(e,"object")&&n(e.insert,"array")&&n(this.insert_position,"object")?(this.insert_position.is_container?this.views.line_preview.showInAt(this.insert_position.active_id,this.insert_position.media_query_id,this.insert_position.index):e.insert[0].isBlock?this.views.line_preview.showAfter(this.insert_position.active_id,this.insert_position.media_query_id):this.views.cursor_preview.showAtEnd(this.insert_position.active_id,this.insert_position.media_query_id,this.selection_range),!0):!1},createPositionDataObject:function(e,t,i,s,r){return n(this.active_media_query,"media_query")?{active_id:e,media_query_id:this.active_media_query.getMediaQuery().id,is_container:t,index:i,parent_id:s,child_ids:r}:!1},onChangeActiveStyle:function(){return this.active_style_ready.resolve(),!0},onChangeActiveElement:function(t){var s=new e.Deferred;return n(t,"element")?s.resolve(null,t):this.imc.trigger("data:elements:getElements",s.resolve),e.when(s).then(i.bind(function(e,t){return e?!1:n(t,"element")?"body"===t.getElement().id?(this._generateInsertPositionForContainer(t,this._setInsertPosition,this),!0):void this._generateInsertPositionForElement(t,this._setInsertPosition,this):!1},this)),!0},_setInsertPosition:function(e,t){return e?(this.insert_position=void 0,!1):(this.insert_position=t,!0)},_generateInsertPositionForContainer:function(e,t,s){return n(t,"function")?(this.findClosestContainerId(function(n,r){var o;return n?(this.log("error",{message:"Could not find Closest Container Id. Error: "+n.getMessage(),code:n.getCode()}),t.call(s,n),!1):(o=this.createPositionDataObject(r,!0,0,void 0,i.compact(i.pluck(e.getElement().children,"id"))),void t.call(s,null,o))},this),!0):!1},_generateInsertPositionForElement:function(e,t,s){var r;return n(t,"function")?(r=e.getElement().id,this.imc.trigger("data:elements:getIndexByElementId",r,{block_level:!0},function(o,a){var l;return o?(this.log("error",{message:"data:elements:getIndexByElementId returned Error: "+o.getMessage(),code:o.getCode()}),t.call(s,o),!1):n(a,"object")?(l=this.createPositionDataObject(r,!1,a.index,a.parent.getElement().id,i.compact(i.pluck(e.getElement().children,"id"))),void t.call(s,null,l)):(this.log("error","data:elements:getIndexByElementId returned invalid response"),t.call(s,o),!1)},this),!0):!1},insertTemplateCssForReference:function(e){var t;return i.some(this.elementMapping,function(n){return i.some(n,function(n){return i.some(n.buttons,function(s){return s.label===e?(t=s,i.each(t.insert,function(e){void 0===e.isBlock&&(e.isBlock=n.isBlock),void 0===e.isBlock&&(e.isBlock=!0)}),!0):!1})})}),n(t,"object")?(this._checkAndAddStyleDeclarations(t),this.views.pinClose.is_pinned||this.remove(),!0):!1},addHTML:function(e){return this.validateButtonConfig(e)?(this.insertHtmlAtPosition(e),!0):!1},insertHtmlAtPosition:function(t){var s,r,o,a;return n(t,"object")&&n(t.insert,"array")&&n(this.insert_position,"object")?(s=i.pluck(t.insert,"html"),t.insert[0].isBlock?(s[0]=e(s[0]).first().attr("data-make-active","yes")[0].outerHTML,r=i.map(s,function(t){return e(t).first()[0].outerHTML}).join(""),this.insert_position.is_container?(o=this.insert_position.active_id,a=this.insert_position.index):(o=this.insert_position.parent_id,a=this.insert_position.index+1),this.isAdProject()&&(this.insert_position.is_container?(o=this.insert_position.child_ids[0],a=0):"body"===this.insert_position.parent_id?(o=this.insert_position.active_id,a=this.insert_position.index):(o=this.insert_position.parent_id,a=this.insert_position.index+1))):(this.insert_position.is_container?(r=["<p data-make-active='yes'>",s.join(""),"</p>"].join(""),o=this.insert_position.active_id,a=this.insert_position.index):(s[0].indexOf("<")>=0?(s[0]=e(s[0]).first()[0].outerHTML,r=s.join("")):r=s.join(""),o=this.insert_position.active_id,a=void 0),this.isAdProject()&&this.insert_position.is_container&&(o=this.insert_position.child_ids[0],a=0)),this.imc.trigger("ui:elements:insertHTML",o,a,r,this.selection_range),this._checkAndAddStyleDeclarations(t),this.views.pinClose.is_pinned||this.remove(),!0):!1},checkStyleAndAddDefaultCssCallback:function(t){return e.proxy(function(e,i){return!e&&n(i,"object")&&n(i.style_declaration,"object")&&n(i.style_declaration.attributes,"object")&&n(t.selector,"string")&&n(t.defaultCss,"object")&&n(i.style_declaration.media_query_id,"string")&&!(Object.keys(i.style_declaration.attributes).length>0)?(this.imc.trigger("data:styles:setAttributesForStyleDeclaration",i.style.id,i.style_declaration.media_query_id,t.selector,t.defaultCss),!0):!1},this)},validateButtonConfig:function(e){var t=!0;return n(e,"object")&&n(e.insert,"array")?(e.insert.forEach(function(i){t=t&&n(i.html,"string")&&void 0!==i.isBlock&&i.isBlock===e.insert[0].isBlock&&(n(i.style_declarations,"undefined")||n(i.style_declarations,"array")),n(i.style_declarations,"array")&&i.style_declarations.forEach(function(e){t=t&&(void 0===e.selector&&void 0===e.defaultCss||n(e.selector,"string")&&n(e.defaultCss,"object"))})}),t):!1},findClosestContainerId:function(t,o){var a,l,c,u,h;return n(t,"function")?(e.when(this.active_style_ready.promise()).then(i.bind(function(){this.imc.trigger("data:styles:getMediaQueries",this.active_style_id,function(d,p){var f,g;return d?(t.call(o,d),!1):!n(p,"array")||p.length<1?(t.call(o,new r(103,"Invalid response from getMediaQueries")),!1):(a=p.map(function(t){return e(s.getMediaQuerySelector(t.getMediaQuery().id))}),l=Math.floor(document.documentElement.clientWidth/2),c=l+e(document).scrollLeft(),h=i.min(a,function(e){return u=e.offset().left+e.width()/2,Math.abs(c-u)}),f=h.attr("data-id"),g=h.attr("data-media-query-id"),n(this.active_media_query,"media_query")||p.some(function(e){return e.getMediaQuery().id!==g?!1:(this.active_media_query=e,!0)},this),void t.call(o,null,f))},this)},this)),n(this.active_style_id,"number")&&this.active_style_ready.resolve(),!0):!1},remove:function(){return this.$el.on("transitionend webkitTransitionEnd otransitionend",i.bind(function(){g.__super__.remove.apply(this,arguments)},this)),this.onItemHoverEnd(),this.$el.removeClass("dropdown-shown"),this.$el.position(this.position),!0},_checkAndAddStyleDeclarations:function(e){return e.insert.forEach(function(e){return n(e.style_declarations,"array")?void e.style_declarations.forEach(function(e){this.imc.trigger("data:styles:getDefaultMediaQuery",function(t,i){return n(e.selector,"string")&&n(e.defaultCss,"object")&&n(i,"media_query")&&n(this.active_style_id,"number")?void this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,i.getMediaQuery().id,e.selector,{},this.checkStyleAndAddDefaultCssCallback(e),this):!1},this)},this):!1},this),!0},_getElement:function(e){return n(this.active_media_query,"media_query")?s.getElement(this.active_media_query.getMediaQuery().id,e):!1}});return g}),define("hbs!ui/insert-dropdown/templates/menuButton",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<span class="fragment-insert is-active">Add content</span>\r\n'});return t.registerPartial("ui_insert-dropdown_templates_menuButton",i),i}),define("ui/insert-dropdown/views/menuButton",["jquery","backbone","core/utils/is","hbs!../templates/menuButton"],function(e,t,i,n){var s=t.View.extend({className:"insert-menu-button",tagName:"div",events:{click:"onClick"},initialize:function(){this.parent_el=this.options.parent_el,this.$el.html(n())},onClick:function(){this.trigger("menu:button-clicked")},render:function(){return i(this.options.parent_el,"object")&&1===this.options.parent_el.length?(this.parent_el.append(this.$el),this):(this.trigger("error","MenuButtonView from insert-dropdown should has parent_el JQuery object passed during instantiation."),!1)}});return s}),define("ui/insert-dropdown/index",["jquery","underscore","backbone","core/utils/is","./dropdown","./views/menuButton"],function(e,t,i,n,s,r){var o=i.UIController.extend({namespace:"ui:add-element-menu",views:null,initialize:function(){return n(this.app_el,"htmldivelement")?(this.app_el=e(this.app_el),this.views={menuButton:new r({parent_el:this.app_el.find(".primary-nav .insert-nav")})},this.listenTo(this.views.menuButton,"menu:button-clicked",this.toggleDropdown,this),this.listenTo(this.views.menuButton,"error",function(e){this.imc.trigger("service:log:error",e)},this),this.views.menuButton.render(),void(this.addElementDropdown=new s({imc:this.imc,target_el:this.app_el,parent_el:this.app_el}))):(this.imc.trigger("service:log:error","Insert Dropdown Index should have app_el passed as JQuery object."),!1)},toggleDropdown:function(){return this.addElementDropdown.toggle(),!0},remove:function(){return n(this.views,"object")&&n(this.views,"object")&&this.views.menuButton.remove(),n(this.addElementDropdown,"object")&&this.addElementDropdown.remove(),o.__super__.remove.apply(this,arguments),!0},destroy:function(){return this.remove(),o.__super__.destroy.apply(this,arguments),!0}});return o}),define("hbs!ui/body-active-element/templates/body",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<span>body</span>\n<div class="top"></div>\n<div class="right"></div>\n<div class="bottom"></div>\n<div class="left"></div>\n'});return t.registerPartial("ui_body-active-element_templates_body",i),i}),define("ui/body-active-element/index",["jquery","underscore","backbone","core/utils/is","core/utils/dom","hbs!./templates/body","jquery-ui-position"],function(e,t,i,n,s,r){"use strict";var o=i.UIController.extend({template:r,namespace:"ui:body-active-element",className:"body-selected",listeners:t.extend({},i.UIController.prototype.listeners,{"[remote]data:styles:updated:mediaQuery":"_onMediaQueryUpdated"}),initialize:function(){return this.position={my:"left top",at:"left top"},this.imc.trigger(this.namespace+":ready"),!0},onChangeActiveElement:function(e){var t;return delete this.position.of,n(e,"element")?(t=e.getElement().id,"body"!==t?(this.remove(),!1):(this.position.of=this._getElement(t),this.render(),!0)):(this.remove(),!1)},render:function(){var t=this.position.of;return!n(t,"object")||t.length<1?!1:(this.$el.html(this.template()),e(this.app_el).append(this.$el),this._setPositionAndDimensions()?!0:!1)},_getElement:function(e){return n(this.active_media_query,"object")?s.getElement(this.active_media_query.getMediaQuery().id,e):!1},_setPositionAndDimensions:function(){var e,t=this.position.of;return!n(t,"object")||t.length<1?!1:(e=t.outerHeight(),this.$el.css({width:t.width()}),this.$(".left, .right").css({height:e}),this.$(".bottom").css({top:e}),this.$el.position(this.position),!0)},_onMediaQueryUpdated:function(){return n(this.position.of,"object")&&!this._setPositionAndDimensions()?!1:!0}});return o}),define("hbs!ui/style-guide/templates/index",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<ul class="style-guide navigation-alt">\n    <li>\n        <a href="styleguide/',(r=i.share_url)?r=r.call(t,{hash:{}}):(r=t.share_url,r=typeof r===a?r.apply(t):r),o+=l(r)+'" target="_',(r=i.share_url)?r=r.call(t,{hash:{}}):(r=t.share_url,r=typeof r===a?r.apply(t):r),o+=l(r)+'_styleguide">Style Guide</a>\n    </li>\n</ul>\n'});return t.registerPartial("ui_style-guide_templates_index",i),i}),define("ui/style-guide/index",["jquery","backbone","hbs!./templates/index"],function(e,t,i){"use strict";var n=t.UIController.extend({namespace:"ui:style-guide",className:"style-guide-container",template:i,share_url:null,listeners:{"[remote]data:project:ready":"_getShareURL","[remote]ui:style-guide:open":"saveProject"},initialize:function(){return this.imc.trigger(this.namespace+":ready"),!0},saveProject:function(){var e="_"+this.share_url+"_styleguide";return this.imc.once("data:project:save:success",function(){var t=location.protocol+"//"+location.host+"/"+location.pathname.split("/")[1]+"/styleguide/"+this.share_url;window.open(t,e)},this),this.imc.trigger("data:project:saveProject",{snapshot:!1}),window.open("",e),!0},_getShareURL:function(){return this.imc.trigger("data:project:get","share_url",function(e,t){return e?(this.log("error","Error retreiving the share_url",e),!1):void(this.share_url=t)},this),!0}});return n}),define("ui/controls-contrast/index",["jquery","backbone","underscore","core/utils/is","core/utils/css"],function(e,t,i,n,s){"use strict";var r=t.UIController.extend({namespace:"ui:controls-contrast",views:{},body:null,contrast_class:"light-controls",background_attributes:["background-color","background"],listeners:i.extend({"[remote]data:styles:changed:body":"bodyBackgroundColorChanged"},t.UIController.prototype.listeners),initialize:function(){return this.imc.trigger(this.namespace+":ready"),this.body=e("body"),!0},setControlStyleForBackgroundColourFromBodyModel:function(){var e,t;return n(this.active_media_query,"object")?(this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,"body",null,function(i,n){return i?!1:(e=n.getStyleDeclaration(),t=this.getBackgroundColor(e.attributes),this.setControlStyleForBackgroundColour(t))},this),!0):!1},bodyBackgroundColorChanged:function(e,t,n,s){var r,o;return 0===i.intersection(s,this.background_attributes).length?!0:(r=n.getStyleDeclaration(),o=this.getBackgroundColor(r.attributes),this.setControlStyleForBackgroundColour(o))},setControlStyleForBackgroundColour:function(e){var t;return n(e,"string")?(t=s.getColorObject(e),n(t,"object")?(this._isBodyBackgroundDark(t)?this.body.addClass(this.contrast_class):this.body.removeClass(this.contrast_class),!0):!1):(this.body.removeClass(this.contrast_class),n(e,"undefined"))},_isBodyBackgroundDark:function(e){var t;return n(e,"object")?(t=(299*e.r+587*e.g+114*e.b)/1e3*(1/(e.a/255)),128>t&&!isNaN(t)):!1},onChangeActiveStyle:function(){return this.setControlStyleForBackgroundColourFromBodyModel(),!0},getBackgroundColor:function(e){var t=Object.keys(e),n=!1;return t.forEach(function(t){-1!==i.indexOf(this.background_attributes,t)&&(n=i.last(e[t]))},this),n=s.getColorFromValue(n)},remove:function(){return this.body.removeClass(this.contrast_class),r.__super__.remove.apply(this,arguments),!0}});return r}),function(e,t,i){function n(t){c.logging&&e.console&&e.console.log&&e.console.log(t)}function s(e,t,i,n,s,r){var o,a,l,u,h=c.Util.getCSS(t,e,s);if(1===h.length&&(u=h[0],h=[],h[0]=u,h[1]=u),-1!==h[0].toString().indexOf("%"))l=parseFloat(h[0])/100,a=i.width*l,"backgroundSize"!==e&&(a-=(r||n).width*l);else if("backgroundSize"===e)if("auto"===h[0])a=n.width;else if(h[0].match(/contain|cover/)){var d=c.Util.resizeBounds(n.width,n.height,i.width,i.height,h[0]);a=d.width,o=d.height}else a=parseInt(h[0],10);else a=parseInt(h[0],10);return"auto"===h[1]?o=a/n.width*n.height:-1!==h[1].toString().indexOf("%")?(l=parseFloat(h[1])/100,o=i.height*l,"backgroundSize"!==e&&(o-=(r||n).height*l)):o=parseInt(h[1],10),[a,o]}function r(e,t){var i=[];return{storage:i,width:e,height:t,clip:function(){i.push({type:"function",name:"clip",arguments:arguments})},translate:function(){i.push({type:"function",name:"translate",arguments:arguments})},fill:function(){i.push({type:"function",name:"fill",arguments:arguments})},save:function(){i.push({type:"function",name:"save",arguments:arguments})},restore:function(){i.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){i.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){i.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var e=[];return i.push({type:"function",name:"drawShape",arguments:e}),{moveTo:function(){e.push({name:"moveTo",arguments:arguments})},lineTo:function(){e.push({name:"lineTo",arguments:arguments})},arcTo:function(){e.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){e.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){e.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){i.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){i.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(e,t){i.push({type:"variable",name:e,arguments:t})}}}function o(e){return{zindex:e,children:[]}}var a,l,c={};c.Util={},c.Util.trimText=function(e){return function(t){return e?e.apply(t):((t||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),c.Util.parseBackgroundImage=function(e){var t,i,n,s,r,o,a,l,c=" \r\n	",u=[],h=0,d=0,p=function(){t&&('"'===i.substr(0,1)&&(i=i.substr(1,i.length-2)),i&&l.push(i),"-"===t.substr(0,1)&&(s=t.indexOf("-",1)+1)>0&&(n=t.substr(0,s),t=t.substr(s)),u.push({prefix:n,method:t.toLowerCase(),value:r,args:l})),l=[],t=n=i=r=""};p();for(var f=0,g=e.length;g>f;f++)if(o=e[f],!(0===h&&c.indexOf(o)>-1)){switch(o){case'"':a?a===o&&(a=null):a=o;break;case"(":if(a)break;if(0===h){h=1,r+=o;continue}d++;break;case")":if(a)break;if(1===h){if(0===d){h=0,r+=o,p();continue}d--}break;case",":if(a)break;if(0===h){p();continue}if(1===h&&0===d&&!t.match(/^url$/i)){l.push(i),i="",r+=o;continue}}r+=o,0===h?t+=o:i+=o}return p(),u},c.Util.Bounds=function(e){var t,i={};return e.getBoundingClientRect?(t=e.getBoundingClientRect(),i.top=t.top,i.bottom=t.bottom||t.top+t.height,i.left=t.left,i.width=t.width||t.right-t.left,i.height=t.height||t.bottom-t.top,i):void 0},c.Util.getCSS=function(e,n,s){function r(t,i){var n,s=e.runtimeStyle&&e.runtimeStyle[t],r=e.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(i)&&/^-?\d/.test(i)&&(n=r.left,s&&(e.runtimeStyle.left=e.currentStyle.left),r.left="fontSize"===t?"1em":i||0,i=r.pixelLeft+"px",r.left=n,s&&(e.runtimeStyle.left=s)),/^(thin|medium|thick)$/i.test(i)?i:Math.round(parseFloat(i))+"px"}var o,u=n.match(/^background(Size|Position)$/);if(a!==e&&(l=t.defaultView.getComputedStyle(e,null)),o=l[n],u)if(o=(o||"").split(","),o=o[s||0]||o[0]||"auto",o=c.Util.trimText(o).split(" "),"backgroundSize"!==n||o[0]&&!o[0].match(/cover|contain|auto/)){if(o[0]=-1===o[0].indexOf("%")?r(n+"X",o[0]):o[0],o[1]===i){if("backgroundSize"===n)return o[1]="auto",o;o[1]=o[0]}o[1]=-1===o[1].indexOf("%")?r(n+"Y",o[1]):o[1]}else;else if(/border(Top|Bottom)(Left|Right)Radius/.test(n)){var h=o.split(" ");h.length<=1&&(h[1]=h[0]),h[0]=parseInt(h[0],10),h[1]=parseInt(h[1],10),o=h}return o},c.Util.resizeBounds=function(e,t,i,n,s){var r,o,a=i/n,l=e/t;return s&&"auto"!==s?l>a^"contain"===s?(o=n,r=n*l):(r=i,o=i/l):(r=i,o=n),{width:r,height:o}},c.Util.BackgroundPosition=function(e,t,i,n,r){var o=s("backgroundPosition",e,t,i,n,r);return{left:o[0],top:o[1]}},c.Util.BackgroundSize=function(e,t,i,n){var r=s("backgroundSize",e,t,i,n);return{width:r[0],height:r[1]}},c.Util.Extend=function(e,t){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},c.Util.Children=function(e){var t;try{t=e.nodeName&&"IFRAME"===e.nodeName.toUpperCase()?e.contentDocument||e.contentWindow.document:function(e){var t=[];return null!==e&&!function(e,t){var n=e.length,s=0;if("number"==typeof t.length)for(var r=t.length;r>s;s++)e[n++]=t[s];else for(;t[s]!==i;)e[n++]=t[s++];return e.length=n,e}(t,e),t}(e.childNodes)}catch(s){n("html2canvas.Util.Children failed with exception: "+s.message),t=[]}return t},c.Util.Font=function(){var e={};return function(t,n,s){if(e[t+"-"+n]!==i)return e[t+"-"+n];var r,o,a,l=s.createElement("div"),c=s.createElement("img"),u=s.createElement("span"),h="Hidden Text";return l.style.visibility="hidden",l.style.fontFamily=t,l.style.fontSize=n,l.style.margin=0,l.style.padding=0,s.body.appendChild(l),c.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",c.width=1,c.height=1,c.style.margin=0,c.style.padding=0,c.style.verticalAlign="baseline",u.style.fontFamily=t,u.style.fontSize=n,u.style.margin=0,u.style.padding=0,u.appendChild(s.createTextNode(h)),l.appendChild(u),l.appendChild(c),r=c.offsetTop-u.offsetTop+1,l.removeChild(u),l.appendChild(s.createTextNode(h)),l.style.lineHeight="normal",c.style.verticalAlign="super",o=c.offsetTop-l.offsetTop+1,a={baseline:r,lineWidth:1,middle:o},e[t+"-"+n]=a,s.body.removeChild(l),a}}(),function(){c.Generate={};var e=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];c.Generate.parseGradient=function(t,i){var n,s,r,o,a,l,c,u,h,d,p,f,g=e.length;for(s=0;g>s&&!(r=t.match(e[s]));s+=1);if(r)switch(r[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(n={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},a=r[2].match(/\w+/g))for(l=a.length,s=0;l>s;s+=1)switch(a[s]){case"top":n.y0=0,n.y1=i.height;break;case"right":n.x0=i.width,n.x1=0;break;case"bottom":n.y0=i.height,n.y1=0;break;case"left":n.x0=0,n.x1=i.width}if(null===n.x0&&null===n.x1&&(n.x0=n.x1=i.width/2),null===n.y0&&null===n.y1&&(n.y0=n.y1=i.height/2),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=a.length,c=1/Math.max(l-1,1),s=0;l>s;s+=1)u=a[s].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(o=parseFloat(u[2]),o/="%"===u[3]?100:i.width):o=s*c,n.colorStops.push({color:u[1],stop:o});break;case"-webkit-gradient":if(n={type:"radial"===r[2]?"circle":r[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.x0=a[1]*i.width/100,n.y0=a[2]*i.height/100,n.x1=a[3]*i.width/100,n.y1=a[4]*i.height/100),a=r[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=a.length,s=0;l>s;s+=1)u=a[s].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),o=parseFloat(u[2]),"from"===u[1]&&(o=0),"to"===u[1]&&(o=1),n.colorStops.push({color:u[3],stop:o});break;case"-moz-linear-gradient":if(n={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.x0=a[1]*i.width/100,n.y0=a[2]*i.height/100,n.x1=i.width-n.x0,n.y1=i.height-n.y0),a=r[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=a.length,c=1/Math.max(l-1,1),s=0;l>s;s+=1)u=a[s].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),u[2]?(o=parseFloat(u[2]),u[3]&&(o/=100)):o=s*c,n.colorStops.push({color:u[1],stop:o});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(n={type:"circle",x0:0,y0:0,x1:i.width,y1:i.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},a=r[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),a&&(n.cx=a[1]*i.width/100,n.cy=a[2]*i.height/100),a=r[3].match(/\w+/),u=r[4].match(/[a-z\-]*/),a&&u)switch(u[0]){case"farthest-corner":case"cover":case"":h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.max(h,d,p,f);break;case"closest-corner":h=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.cy,2)),d=Math.sqrt(Math.pow(n.cx,2)+Math.pow(n.y1-n.cy,2)),p=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.y1-n.cy,2)),f=Math.sqrt(Math.pow(n.x1-n.cx,2)+Math.pow(n.cy,2)),n.rx=n.ry=Math.min(h,d,p,f);break;case"farthest-side":"circle"===a[0]?n.rx=n.ry=Math.max(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=a[0],n.rx=Math.max(n.cx,n.x1-n.cx),n.ry=Math.max(n.cy,n.y1-n.cy));break;case"closest-side":case"contain":"circle"===a[0]?n.rx=n.ry=Math.min(n.cx,n.cy,n.x1-n.cx,n.y1-n.cy):(n.type=a[0],n.rx=Math.min(n.cx,n.x1-n.cx),n.ry=Math.min(n.cy,n.y1-n.cy))}if(a=r[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=a.length,c=1/Math.max(l-1,1),s=0;l>s;s+=1)u=a[s].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),u[2]?(o=parseFloat(u[2]),o/="%"===u[3]?100:i.width):o=s*c,n.colorStops.push({color:u[1],stop:o})}return n},c.Generate.Gradient=function(e,i){if(0!==i.width&&0!==i.height){var s,r,o,a,l=t.createElement("canvas"),u=l.getContext("2d");if(l.width=i.width,l.height=i.height,s=c.Generate.parseGradient(e,i))if("linear"===s.type){for(r=u.createLinearGradient(s.x0,s.y0,s.x1,s.y1),o=0,a=s.colorStops.length;a>o;o+=1)try{r.addColorStop(s.colorStops[o].stop,s.colorStops[o].color)}catch(h){n(["failed to add color stop: ",h,"; tried to add: ",s.colorStops[o],"; stop: ",o,"; in: ",e])}u.fillStyle=r,u.fillRect(0,0,i.width,i.height)}else if("circle"===s.type){for(r=u.createRadialGradient(s.cx,s.cy,0,s.cx,s.cy,s.rx),o=0,a=s.colorStops.length;a>o;o+=1)try{r.addColorStop(s.colorStops[o].stop,s.colorStops[o].color)}catch(h){n(["failed to add color stop: ",h,"; tried to add: ",s.colorStops[o],"; stop: ",o,"; in: ",e])}u.fillStyle=r,u.fillRect(0,0,i.width,i.height)}else if("ellipse"===s.type){var d=t.createElement("canvas"),p=d.getContext("2d"),f=Math.max(s.rx,s.ry),g=2*f;for(d.width=d.height=g,r=p.createRadialGradient(s.rx,s.ry,0,s.rx,s.ry,f),o=0,a=s.colorStops.length;a>o;o+=1)try{r.addColorStop(s.colorStops[o].stop,s.colorStops[o].color)}catch(h){n(["failed to add color stop: ",h,"; tried to add: ",s.colorStops[o],"; stop: ",o,"; in: ",e])}p.fillStyle=r,p.fillRect(0,0,g,g),u.fillStyle=s.colorStops[o-1].color,u.fillRect(0,0,l.width,l.height),u.drawImage(d,s.cx-s.rx,s.cy-s.ry,2*s.rx,2*s.ry)}return l}},c.Generate.ListAlpha=function(e){var t,i="";do t=e%26,i=String.fromCharCode(t+64)+i,e/=26;while(26*e>26);return i},c.Generate.ListRoman=function(e){var t,i=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],n=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],s="",r=i.length;if(0>=e||e>=4e3)return e;for(t=0;r>t;t+=1)for(;e>=n[t];)e-=n[t],s+=i[t];return s}}(),c.Parse=function(s,a){function l(){return Math.max(Math.max(ae.body.scrollWidth,ae.documentElement.scrollWidth),Math.max(ae.body.offsetWidth,ae.documentElement.offsetWidth),Math.max(ae.body.clientWidth,ae.documentElement.clientWidth))}function u(){return Math.max(Math.max(ae.body.scrollHeight,ae.documentElement.scrollHeight),Math.max(ae.body.offsetHeight,ae.documentElement.offsetHeight),Math.max(ae.body.clientHeight,ae.documentElement.clientHeight))}function h(e,t){var i=parseInt(he(e,t),10);return isNaN(i)?0:i}function d(e,t,i,n,s,r){"transparent"!==r&&(e.setVariable("fillStyle",r),e.fillRect(t,i,n,s),oe+=1)}function p(e,t){switch(t){case"lowercase":return e.toLowerCase();case"capitalize":return e.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(e,t,i){return e.length>0?t+i.toUpperCase():void 0});case"uppercase":return e.toUpperCase();default:return e}}function f(e){return/^(normal|none|0px)$/.test(e)}function g(e,t,i,n){null!==e&&c.Util.trimText(e).length>0&&(n.fillText(e,t,i),oe+=1)}function m(e,t,i,n){var s=!1,r=he(t,"fontWeight"),o=he(t,"fontFamily"),a=he(t,"fontSize");switch(parseInt(r,10)){case 401:r="bold";break;case 400:r="normal"}return e.setVariable("fillStyle",n),e.setVariable("font",[he(t,"fontStyle"),he(t,"fontVariant"),r,a,o].join(" ")),e.setVariable("textAlign",s?"right":"left"),"none"!==i?c.Util.Font(o,a,ae):void 0}function v(e,t,i,n,s){switch(t){case"underline":d(e,i.left,Math.round(i.top+n.baseline+n.lineWidth),i.width,1,s);break;case"overline":d(e,i.left,Math.round(i.top),i.width,1,s);break;case"line-through":d(e,i.left,Math.ceil(i.top+n.middle+n.lineWidth),i.width,1,s)}}function y(e,t,i,n){var s;if(le.rangeBounds)("none"!==i||0!==c.Util.trimText(t).length)&&(s=_(t,e.node,e.textOffset)),e.textOffset+=t.length;else if(e.node&&"string"==typeof e.node.nodeValue){var r=n?e.node.splitText(t.length):null;s=b(e.node),e.node=r}return s}function _(e,t,i){var n=ae.createRange();return n.setStart(t,i),n.setEnd(t,i+e.length),n.getBoundingClientRect()}function b(e){var t=e.parentNode,i=ae.createElement("wrapper"),n=e.cloneNode(!0);i.appendChild(e.cloneNode(!0)),t.replaceChild(i,e);var s=c.Util.Bounds(i);return t.replaceChild(n,i),s}function w(e,t,i){var n,s,r=i.ctx,o=he(e,"color"),l=he(e,"textDecoration"),u=he(e,"textAlign"),h={node:t,textOffset:0};c.Util.trimText(t.nodeValue).length>0&&(t.nodeValue=p(t.nodeValue,he(e,"textTransform")),u=u.replace(["-webkit-auto"],["auto"]),s=!a.letterRendering&&/^(left|right|justify|auto)$/.test(u)&&f(he(e,"letterSpacing"))?t.nodeValue.split(/(\b| )/):t.nodeValue.split(""),n=m(r,e,l,o),a.chinese&&s.forEach(function(e,t){/.*[\u4E00-\u9FA5].*$/.test(e)&&(e=e.split(""),e.unshift(t,1),s.splice.apply(s,e))}),s.forEach(function(e,t){var i=y(h,e,l,t<s.length-1);i&&(g(e,i.left,i.bottom,r),v(r,l,i,n,o))}))}function C(e,t){var i,n,s=ae.createElement("boundelement");return s.style.display="inline",i=e.style.listStyleType,e.style.listStyleType="none",s.appendChild(ae.createTextNode(t)),e.insertBefore(s,e.firstChild),n=c.Util.Bounds(s),e.removeChild(s),e.style.listStyleType=i,n}function x(e){var t=-1,i=1,n=e.parentNode.childNodes;if(e.parentNode){for(;n[++t]!==e;)1===n[t].nodeType&&i++;return i}return-1}function E(e,t){var i,n=x(e);switch(t){case"decimal":i=n;break;case"decimal-leading-zero":i=1===n.toString().length?n="0"+n.toString():n.toString();break;case"upper-roman":i=c.Generate.ListRoman(n);break;case"lower-roman":i=c.Generate.ListRoman(n).toLowerCase();break;case"lower-alpha":i=c.Generate.ListAlpha(n).toLowerCase();break;case"upper-alpha":i=c.Generate.ListAlpha(n)}return i+=". "}function S(e,t,i){var n,s,r,o=t.ctx,a=he(e,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(a)){if(s=E(e,a),r=C(e,s),m(o,e,"none",he(e,"color")),"inside"!==he(e,"listStylePosition"))return;o.setVariable("textAlign","left"),n=i.left,g(s,n,r.bottom,o)}}function A(e){var t=s[e];return t&&t.succeeded===!0?t.img:!1}function k(e,t){var i=Math.max(e.left,t.left),n=Math.max(e.top,t.top),s=Math.min(e.left+e.width,t.left+t.width),r=Math.min(e.top+e.height,t.top+t.height);return{left:i,top:n,width:s-i,height:r-n}}function F(e,t){var i;return t?"auto"!==e?(i=o(e),t.children.push(i),i):t:i=o(0)}function D(e,t,i,n,s){var r=h(t,"paddingLeft"),o=h(t,"paddingTop"),a=h(t,"paddingRight"),l=h(t,"paddingBottom");q(e,i,0,0,i.width,i.height,n.left+r+s[3].width,n.top+o+s[0].width,n.width-(s[1].width+s[3].width+r+a),n.height-(s[0].width+s[2].width+o+l))}function T(e){
return["Top","Right","Bottom","Left"].map(function(t){return{width:h(e,"border"+t+"Width"),color:he(e,"border"+t+"Color")}})}function $(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){return he(e,"border"+t+"Radius")})}function B(e,t,i,n){var s=function(e,t,i){return{x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}};return{start:e,startControl:t,endControl:i,end:n,subdivide:function(r){var o=s(e,t,r),a=s(t,i,r),l=s(i,n,r),c=s(o,a,r),u=s(a,l,r),h=s(c,u,r);return[B(e,o,c,h),B(h,u,l,n)]},curveTo:function(e){e.push(["bezierCurve",t.x,t.y,i.x,i.y,n.x,n.y])},curveToReversed:function(n){n.push(["bezierCurve",i.x,i.y,t.x,t.y,e.x,e.y])}}}function j(e,t,i,n,s,r,o){t[0]>0||t[1]>0?(e.push(["line",n[0].start.x,n[0].start.y]),n[0].curveTo(e),n[1].curveTo(e)):e.push(["line",r,o]),(i[0]>0||i[1]>0)&&e.push(["line",s[0].start.x,s[0].start.y])}function M(e,t,i,n,s,r,o){var a=[];return t[0]>0||t[1]>0?(a.push(["line",n[1].start.x,n[1].start.y]),n[1].curveTo(a)):a.push(["line",e.c1[0],e.c1[1]]),i[0]>0||i[1]>0?(a.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(a),a.push(["line",o[0].end.x,o[0].end.y]),o[0].curveToReversed(a)):(a.push(["line",e.c2[0],e.c2[1]]),a.push(["line",e.c3[0],e.c3[1]])),t[0]>0||t[1]>0?(a.push(["line",s[1].end.x,s[1].end.y]),s[1].curveToReversed(a)):a.push(["line",e.c4[0],e.c4[1]]),a}function L(e,t,i){var n=e.left,s=e.top,r=e.width,o=e.height,a=t[0][0],l=t[0][1],c=t[1][0],u=t[1][1],h=t[2][0],d=t[2][1],p=t[3][0],f=t[3][1],g=r-c,m=o-h,v=r-d,y=o-f;return{topLeftOuter:fe(n,s,a,l).topLeft.subdivide(.5),topLeftInner:fe(n+i[3].width,s+i[0].width,Math.max(0,a-i[3].width),Math.max(0,l-i[0].width)).topLeft.subdivide(.5),topRightOuter:fe(n+g,s,c,u).topRight.subdivide(.5),topRightInner:fe(n+Math.min(g,r+i[3].width),s+i[0].width,g>r+i[3].width?0:c-i[3].width,u-i[0].width).topRight.subdivide(.5),bottomRightOuter:fe(n+v,s+m,d,h).bottomRight.subdivide(.5),bottomRightInner:fe(n+Math.min(v,r+i[3].width),s+Math.min(m,o+i[0].width),Math.max(0,d-i[1].width),Math.max(0,h-i[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:fe(n,s+y,p,f).bottomLeft.subdivide(.5),bottomLeftInner:fe(n+i[3].width,s+y,Math.max(0,p-i[3].width),Math.max(0,f-i[2].width)).bottomLeft.subdivide(.5)}}function I(e,t,i,n,s){var r=he(e,"backgroundClip"),o=[];switch(r){case"content-box":case"padding-box":j(o,n[0],n[1],t.topLeftInner,t.topRightInner,s.left+i[3].width,s.top+i[0].width),j(o,n[1],n[2],t.topRightInner,t.bottomRightInner,s.left+s.width-i[1].width,s.top+i[0].width),j(o,n[2],n[3],t.bottomRightInner,t.bottomLeftInner,s.left+s.width-i[1].width,s.top+s.height-i[2].width),j(o,n[3],n[0],t.bottomLeftInner,t.topLeftInner,s.left+i[3].width,s.top+s.height-i[2].width);break;default:j(o,n[0],n[1],t.topLeftOuter,t.topRightOuter,s.left,s.top),j(o,n[1],n[2],t.topRightOuter,t.bottomRightOuter,s.left+s.width,s.top),j(o,n[2],n[3],t.bottomRightOuter,t.bottomLeftOuter,s.left+s.width,s.top+s.height),j(o,n[3],n[0],t.bottomLeftOuter,t.topLeftOuter,s.left,s.top+s.height)}return o}function P(e,t,i){var n,s,r,o,a,l,c=t.left,u=t.top,h=t.width,d=t.height,p=$(e),f=L(t,p,i),g={clip:I(e,f,i,p,t),borders:[]};for(n=0;4>n;n++)if(i[n].width>0){switch(s=c,r=u,o=h,a=d-i[2].width,n){case 0:a=i[0].width,l=M({c1:[s,r],c2:[s+o,r],c3:[s+o-i[1].width,r+a],c4:[s+i[3].width,r+a]},p[0],p[1],f.topLeftOuter,f.topLeftInner,f.topRightOuter,f.topRightInner);break;case 1:s=c+h-i[1].width,o=i[1].width,l=M({c1:[s+o,r],c2:[s+o,r+a+i[2].width],c3:[s,r+a],c4:[s,r+i[0].width]},p[1],p[2],f.topRightOuter,f.topRightInner,f.bottomRightOuter,f.bottomRightInner);break;case 2:r=r+d-i[2].width,a=i[2].width,l=M({c1:[s+o,r+a],c2:[s,r+a],c3:[s+i[3].width,r],c4:[s+o-i[2].width,r]},p[2],p[3],f.bottomRightOuter,f.bottomRightInner,f.bottomLeftOuter,f.bottomLeftInner);break;case 3:o=i[3].width,l=M({c1:[s,r+a+i[2].width],c2:[s,r],c3:[s+o,r+i[0].width],c4:[s+o,r+a]},p[3],p[0],f.bottomLeftOuter,f.bottomLeftInner,f.topLeftOuter,f.topLeftInner)}g.borders.push({args:l,color:i[n].color})}return g}function R(e,t){var i=e.drawShape();return t.forEach(function(e,t){i[0===t?"moveTo":e[0]+"To"].apply(null,e.slice(1))}),i}function O(e,t,i){"transparent"!==i&&(e.setVariable("fillStyle",i),R(e,t),e.fill(),oe+=1)}function N(e,t,i){var s,r,o=ae.createElement("valuewrap"),a=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];a.forEach(function(t){try{o.style[t]=he(e,t)}catch(i){n("html2canvas: Parse: Exception caught in renderFormValue: "+i.message)}}),o.style.borderColor="black",o.style.borderStyle="solid",o.style.display="block",o.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(e.type)||"SELECT"===e.nodeName)&&(o.style.lineHeight=he(e,"height")),o.style.top=t.top+"px",o.style.left=t.left+"px",s="SELECT"===e.nodeName?(e.options[e.selectedIndex]||0).text:e.value,s||(s=e.placeholder),r=ae.createTextNode(s),o.appendChild(r),ue.appendChild(o),w(e,r,i),ue.removeChild(o)}function q(e){e.drawImage.apply(e,Array.prototype.slice.call(arguments,1)),oe+=1}function z(i,s){var r=e.getComputedStyle(i,s);if(r&&r.content&&"none"!==r.content&&"-moz-alt-content"!==r.content){var o=r.content+"",a=o.substr(0,1);a===o.substr(o.length-1)&&a.match(/'|"/)&&(o=o.substr(1,o.length-2));var l="url"===o.substr(0,3),u=t.createElement(l?"img":"span");return u.className=de+"-before "+de+"-after",Object.keys(r).filter(H).forEach(function(e){try{u.style[e]=r[e]}catch(t){n(["Tried to assign readonly property ",e,"Error:",t])}}),l?u.src=c.Util.parseBackgroundImage(o)[0].args[0]:u.innerHTML=o,u}}function H(t){return isNaN(e.parseInt(t,10))}function V(e,t){var i=z(e,":before"),n=z(e,":after");(i||n)&&(i&&(e.className+=" "+de+"-before",e.parentNode.insertBefore(i,e),ie(i,t,!0),e.parentNode.removeChild(i),e.className=e.className.replace(de+"-before","").trim()),n&&(e.className+=" "+de+"-after",e.appendChild(n),ie(n,t,!0),e.removeChild(n),e.className=e.className.replace(de+"-after","").trim()))}function W(e,t,i,n){var s=Math.round(n.left+i.left),r=Math.round(n.top+i.top);e.createPattern(t),e.translate(s,r),e.fill(),e.translate(-s,-r)}function U(e,t,i,n,s,r,o,a){var l=[];l.push(["line",Math.round(s),Math.round(r)]),l.push(["line",Math.round(s+o),Math.round(r)]),l.push(["line",Math.round(s+o),Math.round(a+r)]),l.push(["line",Math.round(s),Math.round(a+r)]),R(e,l),e.save(),e.clip(),W(e,t,i,n),e.restore()}function Q(e,t,i){d(e,t.left,t.top,t.width,t.height,i)}function G(e,t,i,n,s){var r=c.Util.BackgroundSize(e,t,n,s),o=c.Util.BackgroundPosition(e,t,n,s,r),a=he(e,"backgroundRepeat").split(",").map(function(e){return e.trim()});switch(n=Y(n,r),a=a[s]||a[0]){case"repeat-x":U(i,n,o,t,t.left,t.top+o.top,99999,n.height);break;case"repeat-y":U(i,n,o,t,t.left+o.left,t.top,n.width,99999);break;case"no-repeat":U(i,n,o,t,t.left+o.left,t.top+o.top,n.width,n.height);break;default:W(i,n,o,{top:t.top,left:t.left,width:n.width,height:n.height})}}function K(e,t,i){for(var s,r=he(e,"backgroundImage"),o=c.Util.parseBackgroundImage(r),a=o.length;a--;)if(r=o[a],r.args&&0!==r.args.length){var l="url"===r.method?r.args[0]:r.value;s=A(l),s?G(e,t,i,s,a):n("html2canvas: Error loading background:",r)}}function Y(e,t){if(e.width===t.width&&e.height===t.height)return e;var i,n=ae.createElement("canvas");return n.width=t.width,n.height=t.height,i=n.getContext("2d"),q(i,e,0,0,e.width,e.height,0,0,t.width,t.height),n}function X(e,t,i){var n=he(t,"opacity")*(i?i.opacity:1);return e.setVariable("globalAlpha",n),n}function J(e,t,i){var n=r(t?i.width:l(),t?i.height:u()),s={ctx:n,zIndex:F(he(e,"zIndex"),t?t.zIndex:null),opacity:X(n,e,t),cssPosition:he(e,"position"),borders:T(e),clip:t&&t.clip?c.Util.Extend({},t.clip):null};return a.useOverflow===!0&&/(hidden|scroll|auto)/.test(he(e,"overflow"))===!0&&/(BODY)/i.test(e.nodeName)===!1&&(s.clip=s.clip?k(s.clip,i):i),s.zIndex.children.push(s),s}function Z(e,t,i){var n={left:t.left+e[3].width,top:t.top+e[0].width,width:t.width-(e[1].width+e[3].width),height:t.height-(e[0].width+e[2].width)};return i&&(n=k(n,i)),n}function ee(e,t,i){var s,r=c.Util.Bounds(e),o=ce.test(e.nodeName)?"#efefef":he(e,"backgroundColor"),a=J(e,t,r),l=a.borders,u=a.ctx,h=Z(l,r,a.clip),d=P(e,r,l);switch(R(u,d.clip),u.save(),u.clip(),h.height>0&&h.width>0&&(Q(u,r,o),K(e,h,u)),u.restore(),d.borders.forEach(function(e){O(u,e.args,e.color)}),i||V(e,a),e.nodeName){case"IMG":(s=A(e.getAttribute("src")))?D(u,e,s,r,l):n("html2canvas: Error loading <img>:"+e.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(e.type)&&(e.value||e.placeholder).length>0&&N(e,r,a);break;case"TEXTAREA":(e.value||e.placeholder||"").length>0&&N(e,r,a);break;case"SELECT":(e.options||e.placeholder||"").length>0&&N(e,r,a);break;case"LI":S(e,a,h);break;case"CANVAS":D(u,e,e,r,l)}return a}function te(e){return"none"!==he(e,"display")&&"hidden"!==he(e,"visibility")&&!e.hasAttribute("data-html2canvas-ignore")}function ie(e,t,i){te(e)&&(t=ee(e,t,i)||t,ce.test(e.nodeName)||c.Util.Children(e).forEach(function(n){1===n.nodeType?ie(n,t,i):3===n.nodeType&&w(e,n,t)}))}function ne(e,t){function i(e){var t,n,s,r,a,l=c.Util.Children(e),u=l.length;for(a=0;u>a;a+=1)if(r=l[a],3===r.nodeType)o+=r.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===r.nodeType&&!/^(script|meta|title)$/.test(r.nodeName.toLowerCase())){if(o+="<"+r.nodeName.toLowerCase(),r.hasAttributes())for(t=r.attributes,s=t.length,n=0;s>n;n+=1)o+=" "+t[n].name+'="'+t[n].value+'"';o+=">",i(r),o+="</"+r.nodeName.toLowerCase()+">"}}var n=new Image,s=l(),r=u(),o="";i(e),n.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+s+"' height='"+r+"'>","<foreignObject width='"+s+"' height='"+r+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",o.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),n.onload=function(){t.svgRender=n}}function se(){var e=ee(re,null);return le.svgRendering&&ne(t.documentElement,e),Array.prototype.slice.call(re.children,0).forEach(function(t){ie(t,e)}),e.backgroundColor=he(t.documentElement,"backgroundColor"),ue.removeChild(pe),e}e.scroll(0,0);var re=a.elements===i?t.body:a.elements[0],oe=0,ae=re.ownerDocument,le=c.Util.Support(a,ae),ce=new RegExp("("+a.ignoreElements+")"),ue=ae.body,he=c.Util.getCSS,de="___html2canvas___pseudoelement",pe=ae.createElement("style");pe.innerHTML="."+de+'-before:before { content: "" !important; display: none !important; }.'+de+'-after:after { content: "" !important; display: none !important; }',ue.appendChild(pe),s=s||{};var fe=function(e){return function(t,i,n,s){var r=n*e,o=s*e,a=t+n,l=i+s;return{topLeft:B({x:t,y:l},{x:t,y:l-o},{x:a-r,y:i},{x:a,y:i}),topRight:B({x:t,y:i},{x:t+r,y:i},{x:a,y:l-o},{x:a,y:l}),bottomRight:B({x:a,y:i},{x:a,y:i+o},{x:t+r,y:l},{x:t,y:l}),bottomLeft:B({x:a,y:l},{x:a-r,y:l},{x:t,y:i+o},{x:t,y:i})}}}(4*((Math.sqrt(2)-1)/3));return se()},c.Preload=function(s){function r(e){A.href=e,A.href=A.href;var t=A.protocol+A.host;return t===m}function o(){n("html2canvas: start: images: "+b.numLoaded+" / "+b.numTotal+" (failed: "+b.numFailed+")"),!b.firstRun&&b.numLoaded>=b.numTotal&&(n("Finished loading images: # "+b.numTotal+" (failed: "+b.numFailed+")"),"function"==typeof s.complete&&s.complete(b))}function a(t,n,r){var a,l,c=s.proxy;A.href=t,t=A.href,a="html2canvas_"+w++,r.callbackname=a,c+=c.indexOf("?")>-1?"&":"?",c+="url="+encodeURIComponent(t)+"&callback="+a,l=x.createElement("script"),e[a]=function(t){"error:"===t.substring(0,6)?(r.succeeded=!1,b.numLoaded++,b.numFailed++,o()):(g(n,r),n.src=t),e[a]=i;try{delete e[a]}catch(s){}l.parentNode.removeChild(l),l=null,delete r.script,delete r.callbackname},l.setAttribute("type","text/javascript"),l.setAttribute("src",c),r.script=l,e.document.body.appendChild(l)}function l(t,i){var n=e.getComputedStyle(t,i),s=n.content;"url"===s.substr(0,3)&&v.loadImage(c.Util.parseBackgroundImage(s)[0].args[0]),p(n.backgroundImage,t)}function u(e){l(e,":before"),l(e,":after")}function h(e,t){var n=c.Generate.Gradient(e,t);n!==i&&(b[e]={img:n,succeeded:!0},b.numTotal++,b.numLoaded++,o())}function d(e){return e&&e.method&&e.args&&e.args.length>0}function p(e,t){var n;c.Util.parseBackgroundImage(e).filter(d).forEach(function(e){"url"===e.method?v.loadImage(e.args[0]):e.method.match(/\-?gradient$/)&&(n===i&&(n=c.Util.Bounds(t)),h(e.value,n))})}function f(e){var t=!1;try{c.Util.Children(e).forEach(function(e){f(e)})}catch(s){}try{t=e.nodeType}catch(r){t=!1,n("html2canvas: failed to access some element's nodeType - Exception: "+r.message)}if(1===t||t===i){u(e);try{p(c.Util.getCSS(e,"backgroundImage"),e)}catch(s){n("html2canvas: failed to get background-image - Exception: "+s.message)}p(e)}}function g(t,n){t.onload=function(){n.timer!==i&&e.clearTimeout(n.timer),b.numLoaded++,n.succeeded=!0,t.onerror=t.onload=null,o()},t.onerror=function(){if("anonymous"===t.crossOrigin&&(e.clearTimeout(n.timer),s.proxy)){var i=t.src;return t=new Image,n.img=t,t.src=i,void a(t.src,t,n)}b.numLoaded++,b.numFailed++,n.succeeded=!1,t.onerror=t.onload=null,o()}}var m,v,y,_,b={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},w=0,C=s.elements[0]||t.body,x=C.ownerDocument,E=x.images,S=E.length,A=x.createElement("a"),k=function(e){return e.crossOrigin!==i}(new Image);for(A.href=e.location.href,m=A.protocol+A.host,v={loadImage:function(t){var n,o;t&&b[t]===i&&(n=new Image,t.match(/data:image\/.*;base64,/i)?(n.src=t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),o=b[t]={img:n},b.numTotal++,g(n,o)):r(t)||s.allowTaint===!0?(o=b[t]={img:n},b.numTotal++,g(n,o),n.src=t):k&&!s.allowTaint&&s.useCORS?(n.crossOrigin="anonymous",o=b[t]={img:n},b.numTotal++,g(n,o),n.src=t,n.customComplete=function(){this.img.complete?this.img.onerror():this.timer=e.setTimeout(this.img.customComplete,100)}.bind(o),n.customComplete()):s.proxy&&(o=b[t]={img:n},b.numTotal++,a(t,n,o)))},cleanupDOM:function(r){var a,l;if(!b.cleanupDone){n(r&&"string"==typeof r?"html2canvas: Cleanup because: "+r:"html2canvas: Cleanup after timeout: "+s.timeout+" ms.");for(l in b)if(b.hasOwnProperty(l)&&(a=b[l],"object"==typeof a&&a.callbackname&&a.succeeded===i)){e[a.callbackname]=i;try{delete e[a.callbackname]}catch(c){}a.script&&a.script.parentNode&&(a.script.setAttribute("src","about:blank"),a.script.parentNode.removeChild(a.script)),b.numLoaded++,b.numFailed++,n("html2canvas: Cleaned up failed img: '"+l+"' Steps: "+b.numLoaded+" / "+b.numTotal)}e.stop!==i?e.stop():t.execCommand!==i&&t.execCommand("Stop",!1),t.close!==i&&t.close(),b.cleanupDone=!0,r&&"string"==typeof r||o()}},renderingDone:function(){_&&e.clearTimeout(_)}},s.timeout>0&&(_=e.setTimeout(v.cleanupDOM,s.timeout)),n("html2canvas: Preload starts: finding background-images"),b.firstRun=!0,f(C),n("html2canvas: Preload: Finding images"),y=0;S>y;y+=1)v.loadImage(E[y].getAttribute("src"));return b.firstRun=!1,n("html2canvas: Preload: Done."),b.numTotal===b.numLoaded&&o(),v},c.Renderer=function(e,n){function s(e){var t=[],i=function(e){var n=[],s=[];e.children.forEach(function(e){e.children&&e.children.length>0?(n.push(e),s.push(e.zindex)):t.push(e)}),s.sort(function(e,t){return e-t}),s.forEach(function(e){var t;n.some(function(i,n){return t=n,i.zindex===e}),i(n.splice(t,1)[0])})};return i(e.zIndex),t}function r(e){var t;if("string"==typeof n.renderer&&c.Renderer[e]!==i)t=c.Renderer[e](n);else{if("function"!=typeof e)throw new Error("Unknown renderer");t=e(n)}if("function"!=typeof t)throw new Error("Invalid renderer defined");return t}return r(n.renderer)(e,n,t,s(e),c)},c.Util.Support=function(e,t){function s(){var e=new Image,s=t.createElement("canvas"),r=s.getContext===i?!1:s.getContext("2d");if(r===!1)return!1;s.width=s.height=10,e.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{r.drawImage(e,0,0),s.toDataURL()}catch(o){return!1}return n("html2canvas: Parse: SVG powered rendering available"),!0}function r(){var e,i,n,s,r=!1;return t.createRange&&(e=t.createRange(),e.getBoundingClientRect&&(i=t.createElement("boundtest"),i.style.height="123px",i.style.display="block",t.body.appendChild(i),e.selectNode(i),n=e.getBoundingClientRect(),s=n.height,123===s&&(r=!0),t.body.removeChild(i))),r}return{rangeBounds:r(),svgRendering:e.svgRendering&&s()}},e.html2canvas=function(t,i){t=t.length?t:[t];var s,r,o={logging:!1,elements:t,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return o=c.Util.Extend(i,o),c.logging=o.logging,o.complete=function(e){("function"!=typeof o.onpreloaded||o.onpreloaded(e)!==!1)&&(s=c.Parse(e,o),("function"!=typeof o.onparsed||o.onparsed(s)!==!1)&&(r=c.Renderer(s,o),"function"==typeof o.onrendered&&o.onrendered(r)))},e.setTimeout(function(){c.Preload(o)},0),{render:function(e,t){return c.Renderer(e,c.Util.Extend(t,o))},parse:function(e,t){return c.Parse(e,c.Util.Extend(t,o))},preload:function(e){return c.Preload(c.Util.Extend(e,o))},log:n}},e.html2canvas.log=n,e.html2canvas.Renderer={Canvas:i},c.Renderer.Canvas=function(e){function s(e,t){e.beginPath(),t.forEach(function(t){e[t.name].apply(e,t.arguments)}),e.closePath()}function r(e){if(-1===c.indexOf(e.arguments[0].src)){h.drawImage(e.arguments[0],0,0);try{h.getImageData(0,0,1,1)}catch(t){return u=l.createElement("canvas"),h=u.getContext("2d"),!1}c.push(e.arguments[0].src)}return!0}function o(e){return"transparent"===e||"rgba(0, 0, 0, 0)"===e}function a(t,i){switch(i.type){case"variable":t[i.name]=i.arguments;break;case"function":if("createPattern"===i.name){if(i.arguments[0].width>0&&i.arguments[0].height>0)try{t.fillStyle=t.createPattern(i.arguments[0],"repeat")}catch(o){n("html2canvas: Renderer: Error creating pattern",o.message)}}else"drawShape"===i.name?s(t,i.arguments):"drawImage"===i.name?i.arguments[8]>0&&i.arguments[7]>0&&(!e.taintTest||e.taintTest&&r(i))&&t.drawImage.apply(t,i.arguments):t[i.name].apply(t,i.arguments)}}e=e||{};var l=t,c=[],u=t.createElement("canvas"),h=u.getContext("2d"),d=e.canvas||l.createElement("canvas");return function(e,t,s,r,l){var c,u,h,p,f,g,m=d.getContext("2d");if(d.width=d.style.width=t.width||e.ctx.width,d.height=d.style.height=t.height||e.ctx.height,g=m.fillStyle,m.fillStyle=o(e.backgroundColor)&&t.background!==i?t.background:e.backgroundColor,m.fillRect(0,0,d.width,d.height),m.fillStyle=g,t.svgRendering&&e.svgRender!==i)m.drawImage(e.svgRender,0,0);else for(u=0,h=r.length;h>u;u+=1)c=r.splice(0,1)[0],c.canvasPosition=c.canvasPosition||{},m.textBaseline="bottom",c.clip&&(m.save(),m.beginPath(),m.rect(c.clip.left,c.clip.top,c.clip.width,c.clip.height),m.clip()),c.ctx.storage&&c.ctx.storage.forEach(a.bind(null,m)),c.clip&&m.restore();return n("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),h=t.elements.length,1===h&&"object"==typeof t.elements[0]&&"BODY"!==t.elements[0].nodeName?(f=l.Util.Bounds(t.elements[0]),p=s.createElement("canvas"),p.width=f.width,p.height=f.height,m=p.getContext("2d"),m.drawImage(d,f.left,f.top,f.width,f.height,0,0,f.width,f.height),d=null,p):d}}}(window,document),define("html2canvas",["poly-get-set"],function(e){return function(){var t;return t||e.html2canvas}}(this)),define("hbs!ui/export/templates/download_project",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<iframe src="/project/download_project/',(r=i.project_id)?r=r.call(t,{hash:{}}):(r=t.project_id,r=typeof r===a?r.apply(t):r),o+=l(r)+'" name="download_project_iframe" id="download_project_iframe" width="1px" height="1px" style="display: none"></iframe>\n'});return t.registerPartial("ui_export_templates_download_project",i),i}),define("ui/export/views/download_project",["jquery","backbone","core/utils/is","core/typecastError","hbs!./../templates/download_project"],function(e,t,i,n,s){"use strict";return t.View.extend({className:"hidden-download-project-container",project_id:null,tagName:"div",template:s,initialize:function(e){i(e,"object")&&i(e.project_id,"number")&&(this.project_id=e.project_id)},render:function(){var e;return i(this.project_id,"number")?(e=this.template({project_id:this.project_id}),this.$el.html(e),this):!1},submitForm:function(){var e=this._getFormElement();return e?(e.submit(),!0):!1},_getFormElement:function(){var t,i;return t=this.$el.find("#download_project_iframe"),t.length?(i=t.get(0).contentDocument,i?e(i).find("#download_project_form"):!1):!1}})}),define("ui/export/index",["jquery","backbone","core/utils/is","html2canvas","./views/download_project"],function(e,t,i,n,s){"use strict";var r=t.UIController.extend({namespace:"ui:export",root_element_selector:".elements",transparent:!0,listeners:{"[remote]data:project:ready":"setUpDownloadProjectView",png:"png","html-css":"htmlCss"},views:null,initialize:function(){return this.imc.trigger(this.namespace+":ready"),this.export_styling="%root_element_selector% { width: auto !important; padding: 0 50px !important; } %root_element_selector% > .container { margin-top: 0 !important; } .container-controls{ display: none !important; } ",this.exported_styles="body{ background: url('"+window.location.origin+"/images/transparency.png'); margin: 16px; }",this.views={},!0},setUpDownloadProjectView:function(){return this.imc.trigger("data:project:get","id",function(e,t){var i=parseInt(t,10);return e||isNaN(i)?(this.log("error","Couldn't get a project ID",e),!1):(this.views.download_project=new s({project_id:i}),void this.render())},this),!0},render:function(){return i(this.views.download_project,"object")?(this.views.download_project.render(),e(this.app_el).append(this.views.download_project.$el),this):!1},htmlCss:function(){return i(this.views.download_project,"object")?(this.imc.once("data:project:save:success",function(){this.views.download_project.submitForm()},this),this.imc.trigger("data:project:saveProject"),!0):!1},png:function(t,s,r){var o,a,l=this;return i(t,"boolean")||(t=!1),i(r,"string")||(r=this.root_element_selector),this.trigger("menu:deselect-active-element"),o=e(r),o.length?(this._setRenderingStyles(t,r),a={onrendered:function(e){l._renderComplete(e,s)},proxy:"/proxy/index.php"},t&&(a.background=void 0),n(o,a),!0):!1},_setRenderingStyles:function(t,n){var s,r,o;return i(t,"boolean")||(t=!1),i(n,"string")||(n=".elements"),s=this.export_styling.replace(/%root_element_selector%/g,n),r=e('<style id="typecast-render-image-temp-style"/>'),r.text(s),o=e(document.body),r.text(r.text()+n+" > .viewport-wrapper { background-color: transparent; } "),o.append(r),o.addClass("rendering-image"),!0},_renderComplete:function(e,t){var i,n;return e&&t?(i=t.document.createElement("img"),i.src=e.toDataURL(),n=t.document.createElement("style"),n.innerText=this.exported_styles,t.document.body.appendChild(n),t.document.body.appendChild(i),this._clearRenderingStyles(),!0):!1},_clearRenderingStyles:function(){return e("style#typecast-render-image-temp-style").remove(),e(document.body).removeClass("rendering-image"),!0}});return r}),define("ui/project/index",["jquery","backbone","core/utils/is"],function(e,t,i){"use strict";var n=t.UIController.extend({namespace:"ui:project",views:{},review_mode_disabled:!1,_has_unsaved_changes:!1,$event_namespace:".tca-project-window-resize",listeners:{"review-mode":"showReviewMode","disable-review-mode":"disableReviewMode","enable-review-mode":"enableReviewMode","[remote]data:project:ready":"_onProjectDataReady","[remote]data:project:locked":"_onProjectDataLocked","[remote]data:project:save:success":"showSaveSuccessNotification","[remote]data:state:changed:saved":"_onChangeSavedState"},initialize:function(){var t=e(window);return this.imc.trigger(this.namespace+":ready"),t.on("resize"+this.$event_namespace,e.proxy(this,"showReviewMode")),t.on("beforeunload"+this.$event_namespace,e.proxy(this,"onBeforeUnload")),t.on("unload"+this.$event_namespace,e.proxy(this,"_saveProject")),e(document).on("click"+this.$event_namespace,".primary-nav",e.proxy(this,"primaryNavDeselect")),!0},showReviewMode:function(){return this.review_mode_disabled?!1:(this.imc.trigger("data:state:set","active-element",void 0),this.imc.trigger("ui:dropdowns:close"),!0)},onBeforeUnload:function(){return this._has_unsaved_changes?"You are about to leave Typecast and any unsaved changes will be lost.":void 0},disableReviewMode:function(){return this.review_mode_disabled=!0,!0},enableReviewMode:function(){return this.review_mode_disabled=!1,!0},showSaveSuccessNotification:function(e){var t=this;return e?!0:(this.imc.trigger("ui:error:open",220,"info"),setTimeout(function(){t.imc.trigger("ui:error:close")},2e3),!0)},primaryNavDeselect:function(t){return e(t.target).hasClass("primary-nav")&&this.showReviewMode(),!0},destroy:function(){var t=e(window);return t.off("resize"+this.$event_namespace),t.off("beforeunload"+this.$event_namespace),t.off("unload"+this.$event_namespace),e(document).off("click"+this.$event_namespace),n.__super__.destroy.apply(this,arguments)},_onProjectDataReady:function(){return this._setProjectTypeAttr()},_onProjectDataLocked:function(e){return this.showReviewMode(),"user"===e?this.imc.trigger("ui:error:open",217,"fatal"):"tab"===e&&this.imc.trigger("ui:error:open",218,"fatal"),!0},_setProjectTypeAttr:function(){return this.imc.trigger("data:project:get","type",function(t,n){return t?!1:!i(n,"string")||n.length<1?!1:(e(this.app_el).attr("data-project-type",n),!0)},this),!0},_saveProject:function(){return this._has_unsaved_changes?(this.imc.trigger("data:project:saveProject",{snapshot:!1}),!0):!1},_onChangeSavedState:function(e){return this._has_unsaved_changes=!e,!0}});return n}),define("hbs!ui/parent-outline/templates/outline",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="top" data-tooltips-title="Select ',(r=i.selector)?r=r.call(t,{hash:{}}):(r=t.selector,r=typeof r===a?r.apply(t):r),o+=l(r)+'" data-tooltips-margin="-10"></div>\n<div class="left"></div>\n<div class="right"></div>\n<div class="bottom"></div>\n'});return t.registerPartial("ui_parent-outline_templates_outline",i),i}),define("ui/parent-outline/views/outline",["jquery","backbone","core/utils/is","hbs!../templates/outline"],function(e,t,i,n){"use strict";var s=t.View.extend({className:"outline-box",events:{click:"onClick",mouseover:"onHover",mouseout:"offHover"},template:n,initialize:function(){},render:function(e){return this.$el.html(this.template({selector:this._getSelector(this.model.get("element"))})),this.$top=this.$(".top"),this.$right=this.$(".right"),this.$bottom=this.$(".bottom"),this.$left=this.$(".left"),this.updateOutlinePosition(e),this.delegateEvents(),!0},updateOutlinePosition:function(e){return i(e,"object")?(this.$el.css({position:"absolute"}),this.$el.css(e),this.$top.css({top:-10,left:-11,width:e.width+20,height:10}),this.$left.css({top:0,left:-11,width:10,height:e.height}),this.$right.css({top:0,left:e.width,width:10,height:e.height}),this.$bottom.css({top:e.height,left:-11,width:e.width+20,height:10}),!0):!1},onHover:function(){return this.trigger("on:hover"),!0},offHover:function(){return this.trigger("off:hover"),!0},onClick:function(){return this.trigger("select-element"),!0},_getSelector:function(e){var t;return i(e,"object")?(t=e.tag_name,e.attributes["class"]&&(t+="."+e.attributes["class"]),t):"parent"}});return s}),define("ui/parent-outline/index",["underscore","jquery","backbone","core/utils/is","core/utils/image","core/utils/dom","./views/outline"],function(e,t,i,n,s,r,o){"use strict";var a=i.UIController.extend({namespace:"ui:parent-outline",className:"parent-outline",outline_data_attribute:"data-parent-outline",outline_default_state:"show",outline_highlight_state:"highlight",outline_hover_state:"hover",views:null,listeners:e.extend({},i.UIController.prototype.listeners,{"[remote]data:elements:updated:element":"onUpdatedElement","[remote]data:styles:changed":"onChangedStyles","highlight:off":"setOutlineDefaultState","highlight:on":"setOutlineHighlightState"}),initialize:function(){this.views={},this.model=new i.Model,this.views.outline=new o({model:this.model,app_el:this.app_el}),this.views.outline.on("select-element",this.selectParentElement,this),this.views.outline.on("on:hover",this.setOutlineHoverState,this),this.views.outline.on("off:hover",this.setOutlineDefaultState,this)},render:function(){var e=this._getElementPosition();return this.views.outline.render(e),this.$el.append(this.views.outline.$el),t(this.app_el).append(this.$el),!0},onChangeActiveElement:function(e){var i,s;return this.remove(),n(e,"element")?(i=e.getParentElement(),n(i,"object")?(s=this._getElement(i.id),s instanceof t?(this.model.set({element:i}),this.render(),s.attr(this.outline_data_attribute,this.outline_default_state),!0):!1):!1):!1},onUpdatedElement:function(e){var t,i;return n(this.model.get("element"),"object")?"img"===e.getElement().tag_name?(t=this._getElement(e.getElement().id),i=t.get(0),s.onLoad(i,this.render,this)):(this.render(),!0):!1},onChangedStyles:function(){return n(this.model.get("element"),"object")?this.render():!1},selectParentElement:function(){var e=this.model.get("element");return n(e,"object")?(this.imc.trigger("data:state:set","active-element",e.id),this.log("metric","Select parent",{location:"parent outline"}),!0):!1},setOutlineDefaultState:function(){return t(this.app_el).find("["+this.outline_data_attribute+"]").attr(this.outline_data_attribute,this.outline_default_state),!0},setOutlineHoverState:function(){return t(this.app_el).find("["+this.outline_data_attribute+"]").attr(this.outline_data_attribute,this.outline_hover_state),!0},setOutlineHighlightState:function(){return t(this.app_el).find("["+this.outline_data_attribute+"]").attr(this.outline_data_attribute,this.outline_highlight_state),!0},remove:function(){return this.views.outline.remove(),this.model.clear(),t(this.app_el).find("["+this.outline_data_attribute+"]").attr(this.outline_data_attribute,null),a.__super__.remove.apply(this,arguments)},destroy:function(){return this.views.outline.off(null,null,this),a.__super__.destroy.apply(this,arguments)},_getElementPosition:function(){var e,t,i={top:0,left:0,width:0,heigh:0};return e=this.model.get("element").id,t=this._getElement(e),t.length?(i.top=t.offset().top,i.left=t.offset().left,i.width=t.outerWidth(),i.height=t.outerHeight(),i):i},_getElement:function(e){return n(this.active_media_query,"object")?r.getElement(this.active_media_query.getMediaQuery().id,e):!1}});return a}),define("hbs!ui/walkthroughs/templates/tooltip",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var i,n="";return n+="\n            <h4>"+f((i=e.model,i=null==i||i===!1?i:i.title,typeof i===p?i.apply(e):i))+"</h4>\n            "}function o(e,t){return'\n            <a href="#" class="close button white small" title="Quit walkthrough">Close</a>\n            '}function a(e,t){return'\n            <a href="#" class="next button black small">Finish</a>\n            '}function l(e,t){var n,s,r="";return r+="\n                ",s=i["if"].call(e,(n=e.model,null==n||n===!1?n:n.show_next_link),{hash:{},inverse:g.noop,fn:g.program(8,c,t)}),(s||0===s)&&(r+=s),r+="\n            "}function c(e,t){return'\n                <a href="#" class="next button black small">Next ‚Ä∫</a>\n                '}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var u,h,d="",p="function",f=this.escapeExpression,g=this;return d+='<div class="fw-action tooltip '+f((u=t.model,u=null==u||u===!1?u:u.arrow_position,typeof u===p?u.apply(t):u))+'" data-title="'+f((u=t.model,u=null==u||u===!1?u:u.title,typeof u===p?u.apply(t):u))+'">\n    <div>\n        <span class="counter">',
(h=i.current_tooltip)?h=h.call(t,{hash:{}}):(h=t.current_tooltip,h=typeof h===p?h.apply(t):h),d+=f(h)+"/",(h=i.total_tooltips)?h=h.call(t,{hash:{}}):(h=t.total_tooltips,h=typeof h===p?h.apply(t):h),d+=f(h)+'</span>\n        <div class="content cf">\n            ',h=i["if"].call(t,(u=t.model,null==u||u===!1?u:u.title),{hash:{},inverse:g.noop,fn:g.program(1,r,s)}),(h||0===h)&&(d+=h),d+="\n            ",u=t.model,u=null==u||u===!1?u:u.description,h=typeof u===p?u.apply(t):u,(h||0===h)&&(d+=h),d+='\n        </div><!-- end .content -->\n        <div class="footer cf">\n            ',h=i.unless.call(t,t.is_last_tooltip,{hash:{},inverse:g.noop,fn:g.program(3,o,s)}),(h||0===h)&&(d+=h),d+="\n\n            ",h=i["if"].call(t,t.is_last_tooltip,{hash:{},inverse:g.program(7,l,s),fn:g.program(5,a,s)}),(h||0===h)&&(d+=h),d+="\n        </div><!-- end .footer -->\n    </div>\n</div><!-- end .tooltip -->\n"});return t.registerPartial("ui_walkthroughs_templates_tooltip",i),i}),define("ui/walkthroughs/views/tooltip",["jquery","backbone","core/typecastError","core/utils/unit","core/utils/is","hbs!../templates/tooltip"],function(e,t,i,n,s,r){return t.View.extend({template:r,id:"walkthroughs-tooltip",className:"tooltip-position",root_el:null,total_tooltips:null,current_tooltip:null,model:null,dialog_complete:!1,zIndex:501,events:{click:"stopPropagation","click .close":"closeTour","click .next":"nextButton"},main_dialog_selector:"#dialog-main-wrapper-new",element_highlight_class:"tooltip-highlight",initialize:function(e){if(!s(e.model,"object"))throw new i(101,"You must pass in a Tooltip Model.");if(this.model=e.model,!s(e.imc,"object"))throw new i(102,"You must pass in an IMC object.");if(this.imc=e.imc,!s(e.root_el,"htmldivelement"))throw new i(103,"You must pass in an root_el object.");if(this.root_el=e.root_el,!s(e.total_tooltips,"number")||!e.total_tooltips)throw new i(104,"You must pass in total tooltips number.");if(this.total_tooltips=e.total_tooltips,!s(e.current_tooltip,"number")||!e.current_tooltip)throw new i(105,"You must pass in current tooltip index number.");return this.current_tooltip=e.current_tooltip,this.render(),this},render:function(){var e=this.template({model:this.model.toJSON(),current_tooltip:this.current_tooltip,total_tooltips:this.total_tooltips,is_last_tooltip:this.current_tooltip===this.total_tooltips});return this.$el.html(e).appendTo(this.root_el),this.positionTooltip(),this.bindStartupEvents(),this},bindStartupEvents:function(){var e,t,i,n="string"==typeof this.model.get("event")?this.model.get("event").split(","):[];for(t=0,i=n.length;i>t;t++)e=n[t].trim(),this.listenTo(this.imc,e,this.complete,this);return!0},positionTooltip:function(){var t;return"string"!=typeof this.model.get("selector")?!1:(t=e(this.root_el).find(this.model.get("selector")),this.setPositionType(),this.setTooltipWidth(),this.$el.css({"z-index":this.zIndex}),t&&0!==t.length&&t.is(":visible")?(t.addClass(this.element_highlight_class),this.applyVerticalOffset(t),this.applyHorizontalOffset(t),!0):this.positionCentered())},positionCentered:function(){var e,t;return this.$el.find(".fw-action").addClass("no-arrow"),e=n.getValueAndUnit(this.$el.find(".fw-action").css("width")),t=n.getValueAndUnit(this.$el.find(".fw-action").css("height")),this.$el.css({position:"fixed",left:"50%",top:"50%","margin-left":"-"+e.value/2+e.unit,"margin-top":"-"+t.value/2+t.unit,"z-index":this.zIndex}),!0},setTooltipWidth:function(){var e=this.model.get("width")||"15em";return this.$el.width(e),!0},setPositionType:function(){var e=this.model.get("position_type")||"absolute";return this.$el.css({position:e}),!0},applyVerticalOffset:function(e){var t,i,n,s;if(!e)return!1;if(t=this.model.get("vertical_position"),n=this.model.get("vertical_offset")||0,"fixed"===this.model.get("position_type")&&(n-=window.scrollY),i=e.offset(),s=this.$el.find(".fw-action").outerHeight(),!i)return!1;switch(t){case"flush-top":this.$el.css({top:i.top+n||0});break;case"above":this.$el.css({top:i.top-s+n||0});break;case"below":this.$el.css({top:i.top+e.outerHeight()+n||0});break;case"flush-bottom":this.$el.css({top:i.top+e.outerHeight()-s+n||0});break;case"middle":this.$el.css({top:i.top+e.outerHeight()/2-s/2+n||0})}return!0},applyHorizontalOffset:function(e){var t,i,n,s;if(!e)return!1;if(t=this.model.get("horizontal_position"),n=this.model.get("horizontal_offset")||0,"fixed"===this.model.get("position_type")&&(n-=window.scrollX),i=e.offset(),s=this.$el.find(".fw-action").outerWidth(),!i)return!1;switch(t){case"flush-left":this.$el.css({left:i.left+n||0});break;case"left":this.$el.css({left:i.left-s+n||0});break;case"flush-right":this.$el.css({left:i.left+e.outerWidth()-s+n||0});break;case"right":this.$el.css({left:i.left+e.outerWidth()+n||0});break;case"center":this.$el.css({left:i.left+e.outerWidth()/2-this.$el.outerWidth()/2+n||0})}return!0},complete:function(){return this.dialog_complete?!1:(this.dialog_complete=!0,this.trigger("complete"),!0)},closeTour:function(e){return e&&e.preventDefault(),this.trigger("close-tour"),!0},nextButton:function(e){return e&&e.preventDefault(),this.complete(),!0},stopPropagation:function(e){e&&e.stopPropagation()},destroy:function(){var t=e(this.root_el).find(this.model.get("selector"));return t&&t.removeClass(this.element_highlight_class),this.stopListening(),this.$el.undelegate(),this.$el.html(""),this.$el.remove(),this.$el.removeAttr("style"),this}})}),define("ui/walkthroughs/index",["jquery","backbone","underscore","core/utils/is","core/typecastError","./views/tooltip"],function(e,t,i,n,s,r){var o=t.UIController.extend({namespace:"ui:walkthroughs",listeners:{start:"start"},model:null,tooltip_draw_timeout:500,closed_after_tooltip_number:null,tooltip_view_prototype:r,postponed_tooltip_timer:null,tooltip_view:null,initialize:function(){var t=e.Deferred(),i=e.Deferred();return this.imc.on("ui:elements:ready",i.resolve),this.imc.on("data:walkthroughs:ready",t.resolve),e.when(i,t).then(e.proxy(function(){this.imc.trigger("data:walkthroughs:get-incomplete",this._getIncompleteWalkthroughs,this),this.imc.trigger(this.namespace+":ready")},this)),this},start:function(e,t,i){var r;return n(e,"number")&&e?(this.imc.trigger("data:walkthroughs:getById",e,this.populateWalkthroughData(t,i),this),!0):(r=new s(101,"Expected walkthrough id to be a positive number, got: "+e),t&&t.call(i,r,!1),!1)},populateWalkthroughData:function(e,t){var i=this;return function(s,r){return s?(e&&e.call(t,s,!1),!1):n(r,"object")&&n(r.get,"function")&&r.get("id")?(i.activateWalkthrough(r),e&&e.call(t,!1,r),!0):!1}},getTooltip:function(e){return this.model.get("tooltips").at(e)||!1},activateWalkthrough:function(e){var t,i;return this.model&&this.model.get("id")?!1:e?(this.model=e,this.model.get("completed")===!0&&this.markWalkthroughAsIncomplete(this.model.get("id")),(t=this.getTooltip(0))?(this.model.set("current_tooltip",0),this.imc.trigger("ui:project:disable-review-mode"),i=this.model.get("before"),"string"==typeof i&&i.trim()&&this.imc.trigger(i),this.setupTooltip(t),!0):!1):!1},setupTooltip:function(e){if(!(e&&n(e,"object")&&n(e.get,"function")))return!1;var t=this;return this.postponed_tooltip_timer=setTimeout(function(){t.postponed_tooltip_timer=null;var i={root_el:t.app_el,imc:t.imc,model:e,current_tooltip:t.model.get("current_tooltip")+1,total_tooltips:t.model.get("tooltips").length};t.tooltip_view=new r(i),t.listenTo(t.tooltip_view,"close-tour",t.closeTour,t),t.listenTo(t.tooltip_view,"complete",t.completeTooltip,t)},this.tooltip_draw_timeout),!0},finishTour:function(e){var t=this.model.get("id");this.cleanupActiveTooltip(),this.cleanupWalkthrough(),t&&e&&this.markWalkthroughAsComplete(t),this.closed_after_tooltip_number=null,this.imc.trigger("ui:project:enable-review-mode")},markWalkthroughAsComplete:function(e){var t=this.closed_after_tooltip_number+1;this.imc.trigger("data:walkthroughs:set-complete",e,t)},markWalkthroughAsIncomplete:function(e){this.imc.trigger("data:walkthroughs:set-incomplete",e)},closeTour:function(){var e,t=this.model;if(this.closed_after_tooltip_number=this.model.get("current_tooltip"),!t)return this.finishTour(!0),!0;if(t&&1!==t.get("id"))return this.finishTour(!0),!0;this.cleanupActiveTooltip();var i=t.get("tooltips").length-1;return e=this.getTooltip(i),this.model.set("current_tooltip",i),this.setupTooltip(e),!1},cleanupWalkthrough:function(){return this.model.clear(),this.model.set("current_tooltip",-1),!0},completeTooltip:function(){this.cleanupActiveTooltip();var e=this.getNextTooltip();return e?(this.model.set("current_tooltip",this.model.get("current_tooltip")+1),this.setupTooltip(e),!0):(this.finishTour(!0),!0)},getNextTooltip:function(){var e;return this.model?(e=this.getTooltip(this.model.get("current_tooltip")+1),e||!1):!1},cleanupActiveTooltip:function(){return this.tooltip_view?(this.stopListening(this.tooltip_view),this.tooltip_view.destroy(),this.tooltip_view=null,!0):!1},setupWalkthroughBindings:function(e){if(e.get("autorun"))this.activateWalkthrough(e);else{var t=e.get("kick_off_event");this.imc.on(t,function i(){this.model||this.imc.off(t,i),this.activateWalkthrough(e)},this)}return!0},destroy:function(){n(this.tooltip_view,"object")&&this.tooltip_view.destroy(),this.postponed_tooltip_timer&&clearTimeout(this.postponed_tooltip_timer),o.__super__.destroy.apply(this,arguments)},_getIncompleteWalkthroughs:function(e,t){return e?!1:!n(t,"object")||t.length<1?!1:void t.forEach(function(e){this.setupWalkthroughBindings(e)},this)}});return o}),define("ui/drag-and-drop/models/droppable_element",["backbone"],function(e){return e.Model.extend({})}),define("ui/drag-and-drop/views/placeholder",["backbone"],function(e){return e.View.extend({tagName:"span",className:"drag-drop-placeholder"})}),define("ui/drag-and-drop/index",["jquery","underscore","backbone","core/utils/is","base64","core/utils/dom","./models/droppable_element","./views/placeholder"],function(e,t,i,n,s,r,o,a){"use strict";var l=i.UIController.extend({namespace:"ui:drag-and-drop",listeners:t.extend({},i.UIController.prototype.listeners,{"[remote]data:project:ready":"_setProjectType"}),$event_namespace:"dragdropmodule",droppable_namespace:"data-droppable",target_namespace:"data-drop-target",project_type:"webpage",kick_off_distance:10,drag_init:!1,border_thickness:15,$drop_target:null,original_position:null,views:null,initialize:function(){this.app_el=e(this.app_el),this.views={},this.model=new o,n(this.config.supported_elements,"object")&&n(this.config.supported_elements.containers,"array")||this.log("error","supported_elements.containers are required"),this.views.placeholder=new a,e(this.app_el).on("mousedown."+this.$event_namespace,"["+this.droppable_namespace+"]",e.proxy(this,"startDragging"))},_setProjectType:function(){this.imc.trigger("data:project:get","type",function(e,t){return e?!1:!n(t,"string")||t.length<1?!1:(this.project_type=t,!0)},this)},isAdProject:function(){return"advert"===this.project_type},isNewDraggedElement:function(){return n(this.model.get("complete-event"),"string")},isBodyElement:function(t){return t instanceof e?"body"===t.attr("data-id"):!1},onChangeActiveMediaQuery:function(){return this.drag_init&&(this._removeDropTargets(),this._addDropTargets()),!0},render:function(){return e(this.app_el).append(this.views.placeholder.$el),!0},positionPlaceholder:function(e){var t,i;return n(e,"object")?!n(e.index,"number")||e.index<0?!1:n(e.$into,"object")?(e.index<1?t=e.$into.offset().top+this.border_thickness:(i=e.$into.children().eq(e.index-1),t=i.offset().top+i.outerHeight()),this.views.placeholder.$el.css({width:e.$into.outerWidth()-2*this.border_thickness,left:e.$into.offset().left+this.border_thickness,top:t}),!0):!1:!1},remove:function(){return this.views.placeholder.remove(),!0},startDragging:function(t){var i,r,o,a,l,c;return n(t,"object")?(t.preventDefault(),i=this._getClosestDroppable(e(t.target)),r=i.attr(this.droppable_namespace+"-element-id"),o=i.attr(this.droppable_namespace+"-id"),a=i.attr(this.droppable_namespace+"-complete-event"),l=i.attr(this.droppable_namespace+"-complete-event-reference"),c=i.attr(this.droppable_namespace+"-html"),n(c,"string")&&c.length>0?(c=s.decode(c),this.model.set("html",c),this.model.set("complete-event",a),this.model.set("complete-event-reference",l)):n(r,"string")&&r.length>0&&(this.model.set("html",this._getElement(r).get(0).outerHTML),this.model.set("element_id",r),this.original_position=this._getOriginalPosition(r)),n(o,"string")&&o.length>0&&this.model.set("drop_id",o),this.model.set("initial_mouse_y",t.clientY),this.model.set("initial_mouse_x",t.clientX),e(this.app_el).on("mousemove."+this.$event_namespace,e.proxy(this,"onMousemove")),e(this.app_el).one("mouseup."+this.$event_namespace,e.proxy(this,"stopDragging")),!0):!1},onMousemove:function(t){var i,s,r,o,a,l=null;if(!this.drag_init){if(!this._kickOffDistanceReached(t.clientY,t.clientX))return!1;this._dragKickOff()}return r=e(t.target),o=this.isBodyElement(r)?r:r.parents('[data-id="body"]'),a=o.attr("data-media-query-id"),n(a,"string")||(a=null),n(this.active_media_query,"media_query")&&(l=this.active_media_query.getMediaQuery().id),l!==a||n(l,"null")?(this.imc.trigger("data:state:set","active-media-query",a),null===a?this.remove():this.render(),!0):(e("[data-drop-hover]").removeAttr("data-drop-hover"),this.isAdProject()&&this.isBodyElement(r)?(this.remove(),this.isNewDraggedElement()&&(this.$drop_target=null),!1):(this.render(),s=this._getClosestDropTarget(r),!n(s,"object")||s.length<1?!1:(this.$drop_target=s,this.$drop_target.attr("data-drop-hover",""),i=this._getCorrectTargetElement(this.$drop_target,t.clientY),this.positionPlaceholder(i),!0)))},stopDragging:function(i){var s,r,o,a;return e(this.app_el).off("mousemove."+this.$event_namespace),this.drag_init&&n(this.$drop_target,"object")&&this.$drop_target.length>0&&(s=this._getCorrectTargetElement(this.$drop_target,i.clientY)),this.drag_init&&null===this.$drop_target&&n(this.original_position,"object")&&(s=this.original_position),e("[data-drop-hover]").removeAttr("data-drop-hover"),e(".elements").removeClass("dragging"),this._removeDropTargets(),this.remove(),this.original_position=null,this.$drop_target=null,this.drag_init=!1,n(s,"object")?this.isAdProject()&&this.isBodyElement(s.$into)?(this.model.clear(),!1):(o=this.model.get("complete-event"),a=this.model.get("complete-event-reference"),n(o,"string")&&o.length>0&&null!==this.active_media_query?(r=this._prepHtmlForInsert(this.model.get("html")),this.imc.trigger("ui:elements:insertHTML",s.$into.attr("data-id"),s.index,r),t.defer(t.bind(function(){this.imc.trigger(o,a)},this))):(n(this.model.get("element_id"),"string")&&(r=this._prepHtmlForInsert(this.model.get("html")),this.imc.trigger("ui:elements:insertHTML",s.$into.attr("data-id"),s.index,r)),this.announce("inserted",this.model.get("drop_id"))),this.model.clear(),!0):(this.model.clear(),!1)},destroy:function(){return e(this.app_el).off("mousedown."+this.$event_namespace),l.__super__.destroy.apply(this,arguments)},_dragKickOff:function(){var t=this.model.get("element_id");return n(t,"string")&&t.length>0&&this.imc.trigger("data:elements:deleteElement",t),this.imc.trigger("ui:project:review-mode"),e(".elements").addClass("dragging"),this.drag_init=!0,!0},_kickOffDistanceReached:function(e,t){var i,n;return i=this.model.get("initial_mouse_y"),n=this.model.get("initial_mouse_x"),e>i+this.kick_off_distance||e<i-this.kick_off_distance?!0:t>n+this.kick_off_distance||t<n-this.kick_off_distance?!0:!1},_prepHtmlForInsert:function(t){var i,n="";return t=t.replace(/data-id="[-a-z0-9]+"/g,""),i=e(t),i.find("*").addBack().attr("data-retain-classes","yes"),i.each(function(){n+=this.outerHTML}),n},_getCorrectTargetElement:function(i,n){var s=0;return t.some(i.children(),function(t,i){var r=e(t),o=r.offset().top+r.innerHeight()-e(window).scrollTop();return o>n?(s=i,this._isMouseOverUpperHalfOfElement(r,n)&&(s=i+1),!0):(s=i+1,!1)},this),{index:s,$into:i}},_isMouseOverUpperHalfOfElement:function(t,i){var n=t.offset().top-e(window).scrollTop()+t.innerHeight()/2;return i>n},_getSelector:function(e){var i=e.get(0).tagName.toLowerCase(),s=e.attr("class");return n(s,"string")&&s.length>0&&(s=t.first(s.split(" ")),i+="."+s),i},_addDropTargets:function(){var t=this.config.supported_elements.containers.join(", "),i=this._getElement("body"),n=this;return i?(this.isAdProject()||i.attr(this.target_namespace,"body"),i.find(t).each(function(){var t=n._getSelector(e(this)),i=n.target_namespace;e(this).attr(i,t)}),!0):!1},_removeDropTargets:function(){var t=this.target_namespace;return e("["+t+"]").removeAttr(t),!0},_getClosestDropTarget:function(e){return e.closest("["+this.target_namespace+"]")},_getClosestDroppable:function(e){return e.closest("["+this.droppable_namespace+"]")},_getElement:function(e){var t;return n(this.active_media_query,"media_query")&&(t=this.active_media_query.getMediaQuery().id),!n(t,"string")||t.length<1?!1:r.getElement(t,e)},_getOriginalPosition:function(e){var t=r.getElement(this.active_media_query.getMediaQuery().id,e);return{$into:t.parent(),index:t.index()}}});return l}),define("ui/media-queries/models/media_query",["underscore","backbone","core/utils/is"],function(e,t,i){return t.Model.extend({valid_media_query_attrs:["min-width","max-width"],toJSON:function(){return e.extend({},t.Model.prototype.toJSON.apply(this,arguments),{width:this.getWidth(),property:this.getProperty()})},getWidth:function(){var t,i=this.get("attributes")||{};return t=e.chain(i).pick(this.valid_media_query_attrs).compact().value()[0],t=parseInt(t,10)||0},getProperty:function(){var t,n=this.get("attributes")||{};return t=e.intersection(this.valid_media_query_attrs,e.keys(n))[0],i(t,"string")?t.replace(/-width/,""):""}})}),define("ui/media-queries/collections/media_queries",["backbone","../models/media_query"],function(e,t){return e.Collection.extend({model:t})}),define("hbs!core/components/tabbed-view/templates/tabs_navigator",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        <li class="',(n=i.tab_class_name)?n=n.call(e,{hash:{}}):(n=e.tab_class_name,n=typeof n===c?n.apply(e):n),s+=u(n)+"\n        	",n=i["if"].call(e,e.is_active,{hash:{},inverse:h.noop,fn:h.program(2,o,t)}),(n||0===n)&&(s+=n),s+='"\n        	data-tab-name="',(n=i.tab_name)?n=n.call(e,{hash:{}}):(n=e.tab_name,n=typeof n===c?n.apply(e):n),s+=u(n)+'">\n\n            <a href="#">',(n=i.tab_title)?n=n.call(e,{hash:{}}):(n=e.tab_title,n=typeof n===c?n.apply(e):n),s+=u(n)+"</a>\n\n        </li>\n    "}function o(e,t){return" active"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l="",c="function",u=this.escapeExpression,h=this;return l+="<ul>\n    ",a=i.each.call(t,t.tabs,{hash:{},inverse:h.noop,fn:h.program(1,r,s)}),(a||0===a)&&(l+=a),l+="\n</ul>\n"});return t.registerPartial("core_components_tabbed-view_templates_tabs_navigator",i),i}),define("core/components/tabbed-view/views/tabView",["jquery","backbone","core/utils/is","underscore","hbs!./../templates/tabs_navigator"],function(e,t,i,n,s){return t.View.extend({className:"tab-view",events:{"click li":"_selectTab"},initialize:function(){return this.views_definitions=this.options.views_definitions,this},render:function(){var e=Object.keys(this.views_definitions),t=this.model.get("active-tab");return n.each(e,function(e){var i=this.views_definitions[e];i.tab_name=e,i.is_active=e===t},this),this.$el.html(s({tabs:this.views_definitions})),this.delegateEvents(),this},_selectTab:function(t){var n,s=this.model.get("active-tab");return t instanceof e.Event?(t.preventDefault(),n=e(t.currentTarget).attr("data-tab-name"),i(this.views_definitions[n],"undefined")?!1:s===n?!0:(this.model.trigger("switch-tab",n),!0)):!1}})}),define("core/components/tabbed-view/index",["jquery","backbone","core/utils/is","underscore","./views/tabView"],function(e,t,i,n,s){return t.View.extend({initialize:function(){var e,r,o={};return i(this.options.model,"object")?this.model=this.options.model:this.model=new t.Model,i(this.options.views_definitions,"object")?(this.views_definitions=this.options.views_definitions,this.views={},r=Object.keys(this.views_definitions),n.each(r,function(e){var t=this.views_definitions[e];this.views[e]=new t.View({model:this.model,config:i(t.config,"object")?t.config:{}}),o[e]={tab_class_name:t.tab_class_name,tab_title:t.tab_title}},this),e=this.options.active_tab,(i(e,"undefined")||i(this.views_definitions[e],"undefined"))&&(e=r[0]),this.model.set("active-tab",e),this.tab_view=new s({views_definitions:o,model:this.model}),this.listenTo(this.model,"switch-tab",this._switchTabs),this):!1},render:function(){var e=this.model.get("active-tab");return this.$el.empty().append(this.tab_view.render().$el),this.$el.append(this.views[e].render().$el),this},removeCurrentViews:function(){var e=this.model.get("active-tab");return i(this.views[e],"object")&&i(this.tab_view,"object")?(this.tab_view.remove(),this.views[e].remove(),!0):!1},_switchTabs:function(e){if(!i(e,"string"))return!1;if(i(this.views_definitions[e],"undefined"))return!1;if(this.active_tab!==e)return this.removeCurrentViews(),this.model.set("active-tab",e),this.render(),!0}})}),define("hbs!ui/media-queries/templates/create_media_query",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n        --><li class="media-query-item mq-item-',(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===l?n.apply(e):n),s+=c(n)+'" data-mq-type="',(n=i.type)?n=n.call(e,{hash:{}}):(n=e.type,n=typeof n===l?n.apply(e):n),s+=c(n)+'" data-mq-attribute="',(n=i.attr)?n=n.call(e,{hash:{}}):(n=e.attr,n=typeof n===l?n.apply(e):n),s+=c(n)+'" data-mq-value="',(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===l?n.apply(e):n),s+=c(n)+'">\n            <div>\n                <span class="title">',(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===l?n.apply(e):n),s+=c(n)+'</span>\n                <code class="css-buddy-snippet">@media only ',(n=i.type)?n=n.call(e,{hash:{}}):(n=e.type,n=typeof n===l?n.apply(e):n),s+=c(n)+" and (",(n=i.attr)?n=n.call(e,{hash:{}}):(n=e.attr,n=typeof n===l?n.apply(e):n),s+=c(n)+": ",(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===l?n.apply(e):n),s+=c(n)+")</code>\n            </div>\n        </li><!--\n    "}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+="<h3>Create a breakpoint</h3>\n<p>Create a responsive viewport using a <em>",(o=i.attribute)?o=o.call(t,{hash:{}}):(o=t.attribute,o=typeof o===l?o.apply(t):o),a+=c(o)+'</em> media query</p>\n\n<ul class="',(o=i.attribute)?o=o.call(t,{hash:{}}):(o=t.attribute,o=typeof o===l?o.apply(t):o),a+=c(o)+'"><!--\n    ',o=i.each.call(t,t.queries,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+="\n--></ul>\n"});return t.registerPartial("ui_media-queries_templates_create_media_query",i),i}),define("hbs!ui/media-queries/templates/create_media_query_restriction",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="restriction">\n	<p>Desktop-first and mobile-first breakpoints can\'t be mixed with the same Typecast project</p>\n	<small>You can always delete all breakpoints to start ',(r=i.rwd_strategy)?r=r.call(t,{hash:{}}):(r=t.rwd_strategy,r=typeof r===a?r.apply(t):r),o+=l(r)+"<small>\n</div>\n"});return t.registerPartial("ui_media-queries_templates_create_media_query_restriction",i),i}),define("ui/media-queries/views/create_media_query",["backbone","hbs!../templates/create_media_query","core/utils/is","hbs!../templates/create_media_query_restriction"],function(e,t,i,n){var s=e.View.extend({template:t,config:null,events:{"click .media-query-item":"onClick"},initialize:function(e){if(!i(e.config,"Object"))throw new Error("Create Media Query View :: Please provide a config");if(this.config=e.config,!i(e.model,"Object"))throw new Error("Create Media Query View :: Please provide a model");return this},render:function(){var e,t,s=this.model.get("rwd_strategy");return i(s,"object")?(t=s.is_strict&&s.name!==this.config.rwd_strategy?n:this.template,e=t(this.config),this.$el.html(e),this.delegateEvents(),this):!1},onClick:function(e){var t,i,n,s,r={};return e.preventDefault(),s=this.$(e.currentTarget),t=s.attr("data-mq-type"),i=s.attr("data-mq-attribute"),n=s.attr("data-mq-value"),r[i]=n,this.model.trigger("create",t,r),!0}});return s}),define("ui/media-queries/views/dropdown",["underscore","backbone","core/utils/is","core/components/dropdown/index","core/components/tabbed-view/index","./create_media_query"],function(e,t,i,n,s,r){var o=n.extend({className:"dropdown-panel media-query-dropdown",tabs:null,previous_tab_name:null,initialize:function(){return o.__super__.initialize.apply(this,arguments),this.tabs=new s({model:this.model,views_definitions:{"desktop-first":{View:r,config:this.config.max_width,tab_class_name:"desktop-first",tab_title:"Desktop-first"},"mobile-first":{View:r,config:this.config.min_width,tab_class_name:"mobile-first",tab_title:"Mobile-first"}}}),this.model.on("create",this.createMediaQuery,this),this.model.on("switch-tab",this.updateDefaultMediaQueryByTabName,this),this},render:function(){var e=this.model.get("rwd_strategy");return i(e,"object")?(this.model.set("active-tab",e.name),o.__super__.render.call(this,[this.tabs])):!1},createMediaQuery:function(e,t){return this.trigger("create",e,t),this.close(),!0},updateDefaultMediaQueryByTabName:function(e){var t=this.model.get("rwd_strategy");return this.previous_tab_name===e?!1:!i(e,"string")||e.length<1?!1:i(t,"object")&&t.is_strict?!1:(this.trigger("update-default-media-query",e),this.previous_tab_name=e,!0)},destroy:function(){return this.model.off(null,null,this),o.__super__.destroy.apply(this,arguments)}});return o}),define("ui/media-queries/views/dropdown-button",["backbone"],function(e){return e.View.extend({parent_el:null,className:"create-media-query-button",events:{click:"onClick"},initialize:function(e){return this.parent_el=e.parent_el,this},render:function(){return this.parent_el.append(this.$el),this.delegateEvents(),this},onClick:function(e){return e.preventDefault(),this.trigger("toggle"),!0}})}),define("hbs!ui/media-queries/templates/controls",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){return'\n    <span class="default-title">Default styles</span>\n'}function o(e,t){var n,s="";return s+='\n    <div class="width-switcher">\n        <input type="text" class="mq-width-input" value="',(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===u?n.apply(e):n),s+=h(n)+'"> <span class="unit">px</span> <span class="prop">',(n=i.prop)?n=n.call(e,{hash:{}}):(n=e.prop,n=typeof n===u?n.apply(e):n),s+=h(n)+'</span>\n    </div>\n\n    <div class="additional-controls">\n        <span class="delete-mq"><span title="Delete media query" aria-hidden="true" data-icon="&#xe01d;"></span></span>\n    </div>\n    <div class="viewport-handle">\n            <span></span>\n    </div>\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var a,l,c="",u="function",h=this.escapeExpression,d=this;return l=i["if"].call(t,(a=t.model,null==a||a===!1?a:a.is_default),{hash:{},inverse:d.program(3,o,s),fn:d.program(1,r,s)}),(l||0===l)&&(c+=l),c+="\n"});return t.registerPartial("ui_media-queries_templates_controls",i),i}),define("ui/media-queries/views/controls",["jquery","underscore","backbone","core/utils/is","core/utils/cast","core/utils/dom","hbs!../templates/controls"],function(e,t,i,n,s,r,o){return i.View.extend({className:"ui-media-query-controls",template:o,$_namespace:".mq-resize-handle",page_x:null,events:{"click .delete-mq":"deleteMediaQuery","click .mq-width-input":"highlightInputText","blur .mq-width-input":"setInputValue","change .mq-width-input":"updateMediaQuery","mousedown .viewport-handle":"startDrag"},initialize:function(e){return this.model.on("change",this.render,this),this.config=e.config,this},render:function(){var e=this.template({model:this.model.toJSON(),width:this.model.getWidth(),prop:this.model.getProperty()});return this.$el.html(e),this},highlightInputText:function(){return this.$(".mq-width-input").select()},setInputValue:function(){return this.$(".mq-width-input").val(this.model.getWidth()),!0},updateMediaQuery:function(){var e=this.$(".mq-width-input").val(),t={},i=this.model.getProperty();return e=s(e,"number"),e instanceof Error?!1:1>e?!1:e>this.config.values.max_input_width?!1:e<this.config.values.min_input_width?!1:(t[i+"-width"]=e+"px",this._updateMediaQueryAttributes(t),!0)},deleteMediaQuery:function(e){return e.preventDefault(),this.collection.trigger("controls:delete",this.model.get("id")),!0},positionView:function(){var t,i,s=this.model.get("id"),o=e(".elements").find(r.getMediaQuerySelector(s));return!n(o,"object")||o.length<1||!n(o.offset(),"object")?!1:(t=o.parent(),!n(t,"object")||t.length<1?!1:(i=o.offset(),this.$el.css("width",t.css("width")),this.$el.css("left",i.left),!0))},startDrag:function(t){return n(t,"object")?(t.preventDefault(),this.collection.trigger("controls:resize-start"),this.$el.addClass("resize"),this.page_x=t.pageX,e(document).on("mousemove"+this.$_namespace,e.proxy(this,"mouseMoved")),e(document).one("mouseup"+this.$_namespace,e.proxy(this,"stopDrag")),!0):!1},mouseMoved:function(t){var i,s,r,o={};return n(t,"object")?(i=t.pageX-this.page_x,this.page_x=t.pageX,0>i&&this.collection.trigger("controls:resize-left"),e(window).width()-20<t.clientX&&this.collection.trigger("controls:resize-right"),s=this.model.getProperty(),r=parseInt(this.model.get("attributes")[s+"-width"],10)+i,r<this.config.values.min_drag_width&&0>i?!1:(o[s+"-width"]=r+"px",this._updateMediaQueryAttributes(o),!0)):!1},stopDrag:function(){return this.page_x=null,e(document).off("mousemove"+this.$_namespace),this.collection.trigger("controls:resize-complete",this.model.get("id")),this.$el.removeClass("resize"),!0},_updateMediaQueryAttributes:function(e){return e=t.extend({},this.model.get("attributes"),e),this.collection.trigger("controls:update",this.model.get("id"),this.model.get("type"),e),!0}})}),define("hbs!ui/media-queries/templates/navigation",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n<li>\n    <a href="#" class="media-query',n=i["if"].call(e,e.is_active,{hash:{},inverse:p.noop,fn:p.program(2,o,t)}),(n||0===n)&&(s+=n),s+='" data-mq-id="',(n=i.id)?n=n.call(e,{hash:{}}):(n=e.id,n=typeof n===h?n.apply(e):n),s+=d(n)+'">',n=i["if"].call(e,e.is_default,{hash:{},inverse:p.program(6,l,t),fn:p.program(4,a,t)}),(n||0===n)&&(s+=n),s+="</a>\n</li>\n"}function o(e,t){return" active"}function a(e,t){return"Default"}function l(e,t){var n;return(n=i.width)?n=n.call(e,{hash:{}}):(n=e.width,n=typeof n===h?n.apply(e):n),d(n)}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u="",h="function",d=this.escapeExpression,p=this;return c=i.each.call(t,t.media_queries,{hash:{},inverse:p.noop,fn:p.program(1,r,s)}),(c||0===c)&&(u+=c),u+='\n<li>\n    <a href="#" class="add-media-query">+</a>\n</li>\n'});return t.registerPartial("ui_media-queries_templates_navigation",i),i}),define("ui/media-queries/views/navigation",["jquery","underscore","backbone","core/utils/is","hbs!../templates/navigation"],function(e,t,i,n,s){return i.View.extend({tagName:"ul",className:"media-query-navigation",template:s,parent_el:null,active_media_query_id:null,events:{"click .media-query":"onClickMediaQuery","click .add-media-query":"addMediaQuery"},initialize:function(e){return this.parent_el=e.parent_el,this},setActiveMediaQuery:function(e){return this.active_media_query_id=null,n(e,"media_query")?(this.active_media_query_id=e.getMediaQuery().id,!0):!1},render:function(){var e;return e=this.template({media_queries:t.map(this.collection.toJSON(),function(e){return t.extend({},e,{
is_active:e.id===this.active_media_query_id})},this)}),this.$el.html(e),this.parent_el.append(this.$el),this.delegateEvents(),this},onClickMediaQuery:function(e){return e.preventDefault(),this.trigger("select-media-query",this.$(e.currentTarget).attr("data-mq-id")),!0},addMediaQuery:function(e){return e.preventDefault(),this.trigger("add-media-query"),!0}})}),define("ui/media-queries/index",["underscore","jquery","backbone","core/utils/is","core/utils/cast","core/utils/dom","./collections/media_queries","./views/dropdown","./views/dropdown-button","./views/controls","./views/navigation"],function(e,t,i,n,s,r,o,a,l,c,u){"use strict";var h=i.UIController.extend({namespace:"ui:media-queries",className:"media-queries",views:null,valid_media_query_attrs:["max-width","min-width"],is_resize_mode:!1,default_media_query_id:null,listeners:e.extend({},i.UIController.prototype.listeners,{"[remote]data:styles:ready":"onDataStylesReady","[remote]data:styles:new:mediaQuery":"populateCollectionWithMediaQueries","[remote]data:styles:updated:mediaQuery":"onMediaQueryUpdated","[remote]data:styles:deleted:mediaQuery":"onMediaQueryDeleted","[remote]ui:elements:reorder-media-queries-complete":"populateCollectionWithMediaQueries","[remote]data:styles:changed":"_onStylesChanged"}),initialize:function(){var e;return this.app_el=t(this.app_el),e=this.app_el.find(".primary-nav .center"),this.views={controls:{}},this.collection=new o,this.collection.on("remove",this._removeControlsView,this),this.collection.on("reset",function(e){this._removeControlsViews(),e.forEach(function(e){this._addControlsView(e)},this)},this),this.collection.on("controls:update",this.updateMediaQuery,this),this.collection.on("controls:delete",this.deleteMediaQuery,this),this.collection.on("controls:resize-start",this.resizeStart,this),this.collection.on("controls:resize-complete",this.resizeComplete,this),this.collection.on("controls:resize-left",this.resizeLeft,this),this.collection.on("controls:resize-right",this.resizeRight,this),this.views.dropdown_button=new l({parent_el:e}),this.views.dropdown_button.on("toggle",this.toggleDropdown,this),this.views.navigation=new u({parent_el:e,collection:this.collection}),this.views.navigation.on("select-media-query",this.selectMediaQueryById,this),this.views.navigation.on("add-media-query",this.toggleDropdown,this),this.model=new i.Model,this.views.dropdown=new a({imc:this.imc,config:this.config,parent_el:this.app_el,target_el:e,model:this.model}),this.views.dropdown.on("update-default-media-query",this.updateDefaultMediaQuery,this),this.views.dropdown.on("create",this.createMediaQuery,this),this.render(),t(window).resize(t.proxy(this,"repositionControlsViews")),this.announce("ready"),this},onDataStylesReady:function(){return this.imc.trigger("data:styles:getDefaultMediaQuery",function(e,t){return e?(this.log("error","Could not retrieve the default media query"),!1):void(this.default_media_query_id=t.getMediaQuery().id)},this),this.populateCollectionWithMediaQueries(),!0},populateCollectionWithMediaQueries:function(){return this.imc.trigger("data:styles:getMediaQueries",this.active_style_id,function(t,i){return t||!n(i,"array")?!1:(this.collection.reset(e.invoke(i,"getMediaQuery")),void this.toggleDropdownButtonOrNavigation())},this),!0},render:function(){return this.app_el.append(this.$el),!0},toggleDropdown:function(){return this.views.dropdown.isRendered()?(this.views.dropdown.close(),!0):(this.imc.trigger("data:styles:getRWDStrategy",this.active_style_id,function(e,t){return e?(this.log("error","Failed to get RWD Strategy"),!1):(this.model.set("rwd_strategy",t),void this.views.dropdown.toggle())},this),!0)},toggleDropdownButtonOrNavigation:function(){return this.collection.length>1?(this.views.dropdown_button.remove(),this.views.navigation.render()):(this.views.navigation.remove(),this.views.dropdown_button.render()),!0},selectMediaQueryById:function(e){return this.imc.trigger("ui:elements:selectMediaQueryById",e),!0},onMediaQueryUpdated:function(e){var t,i;return n(e,"media_query")?(t=e.getMediaQuery().id,i=this.collection.get(t),i.set(e.getMediaQuery()),this.toggleDropdownButtonOrNavigation(),this.is_resize_mode||this.selectMediaQueryById(t),this.repositionControlsViews()):!1},onMediaQueryDeleted:function(e){return n(e,"media_query")?(this.collection.remove(e.getMediaQuery()),this.views.dropdown.close(),this.toggleDropdownButtonOrNavigation(),this.repositionControlsViews()):!1},updateDefaultMediaQuery:function(e){var t={};return"mobile-first"===e&&(t={"min-width":this.config.values.min_input_width+"px"}),this.imc.trigger("data:styles:updateMediaQuery",this.active_style_id,this.default_media_query_id,{attributes:t}),!0},createMediaQuery:function(t,i){return!n(t,"string")||t.length<1?!1:n(i,"object")?(i=this._ensureValidAttributes(i),e.size(i)<1?!1:(this.imc.trigger("data:styles:createMediaQuery",this.active_style_id,t,i),!0)):!1},updateMediaQuery:function(t,i,s){return n(t,"string")?!n(i,"string")||i.length<1?!1:n(s,"object")?(s=this._ensureValidAttributes(s),e.size(s)<1?!1:(this.imc.trigger("data:styles:updateMediaQuery",this.active_style_id,t,{attributes:s,type:i}),!0)):!1:!1},deleteMediaQuery:function(e){var t,i,s;return n(e,"string")?(t=this.collection.get(e),i=this.collection.indexOf(t),s=this.collection.at(i-1),this.imc.trigger("data:styles:deleteMediaQuery",this.active_style_id,e),n(s,"object")&&this.selectMediaQueryById(s.get("id")),!0):!1},onChangeActiveStyle:function(){return this.populateCollectionWithMediaQueries()},onChangeActiveMediaQuery:function(e){return this.views.navigation.setActiveMediaQuery(e),this.toggleDropdownButtonOrNavigation(),!0},resizeStart:function(){return this.imc.trigger("ui:project:review-mode"),this.announce("resize-start"),this.is_resize_mode=!0,!0},resizeComplete:function(e){return this.announce("resize-complete",e),this.is_resize_mode=!1,!0},resizeLeft:function(){return this.announce("resize-left"),!0},resizeRight:function(){return this.announce("resize-right"),!0},repositionControlsViews:function(){return e.invoke(this.views.controls,"positionView"),!0},remove:function(){return this.views.dropdown_button.remove(),this.views.navigation.remove(),this.views.dropdown.remove(),e.invoke(this.views.controls,"remove"),h.__super__.remove.apply(this,arguments)},destroy:function(){return this.collection.off(null,null,this),this.views.dropdown.off(null,null,this),this.remove(),h.__super__.destroy.apply(this,arguments)},_addControlsView:function(e){var t=new c({model:e,collection:this.collection,config:this.config});return this.views.controls[e.get("id")]=t,t.render().positionView(),this.$el.append(t.$el),!0},_removeControlsView:function(e){var t,i;return n(e,"object")?(t=e.get("id"),i=this.views.controls[t],n(i,"object")?(i.remove(),delete this.views.controls[t],!0):!1):!1},_removeControlsViews:function(){return e.each(this.views.controls,function(e,t){this.views.controls[t].remove(),delete this.views.controls[t]},this),!0},_ensureValidAttributes:function(t){var i=e.pick(t,this.valid_media_query_attrs),n={};return e.each(i,function(e,t){var i=s(e,"number");return i instanceof Error?!1:1>i?!1:void(n[t]=e)}),n},_onStylesChanged:function(t,i,s,r,o){var a=["width","margin","margin-left","margin-right","border-width","border-left-width","border-right-width","padding","padding-left","padding-right"];return n(o,"array")?e.intersection(a,o).length<1?!1:(e.defer(e.bind(this.repositionControlsViews,this)),!0):!1}});return h}),define("ui/scroll/index",["underscore","jquery","backbone","core/utils/dom","core/utils/is"],function(e,t,i,n,s){"use strict";return i.UIController.extend({namespace:"ui:scroll",animation_duration:200,listeners:{to:"to"},to:function(e){return s(e,"string")&&(e=t(e)),!(e instanceof t)||e.length<1?!1:(this._scrollTo(e.offset()),!0)},_scrollTo:function(e){return t("html,body").animate({scrollLeft:e.left},this.animation_duration),!0}})}),define("ui/drop-zone/index",["underscore","backbone","core/utils/is"],function(e,t,i){"use strict";var n=t.UIController.extend({namespace:"ui:drop-zone",el:document.body,events:{dragover:"onDrag",dragenter:"onDrag",drop:"onDrop"},onDrag:function(e){return this._isFiles(e)?(e.preventDefault(),!1):!0},onDrop:function(e){return this._isFiles(e)?(e.preventDefault(),this.imc.trigger("ui:error:open",230,"block-warning"),!1):!0},_isDataTransferEvent:function(e){return i(e,"object")&&(i(e.originalEvent,"MouseEvent")||i(e.originalEvent,"DragEvent"))&&(i(e.originalEvent.dataTransfer,"Clipboard")||i(e.originalEvent.dataTransfer,"DataTransfer"))?!0:!1},_isFiles:function(t){var i;return this._isDataTransferEvent(t)?(i=e.toArray(t.originalEvent.dataTransfer.types),i.length<1?!1:-1===i.indexOf("Files")||-1!==i.indexOf("text/uri-list")?!1:!0):!1}});return n}),define("ui/css-animate/index",["underscore","jquery","backbone","core/utils/dom","core/utils/is"],function(e,t,i,n,s){"use strict";return i.UIController.extend({namespace:"ui:css-animate",listeners:{element:"animateElement"},animateElement:function(e,i){return!s(e,"string")||e.length<1?!1:(s(i,"string")&&(i=t(i)),!(i instanceof t)||i.length<1?!1:this._animate(e,i))},_animate:function(e,i){return i.one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){t(this).removeAttr("data-class")}),i.attr("data-class",e),!0}})}),define("ui/background-image-dialog/models/data",["backbone","core/utils/is"],function(e,t){"use strict";return e.Model.extend({defaults:{style_declaration:null},getBackgroundImageUrl:function(){var e,i=this.get("style_declaration");return t(i,"object")&&t(i.getValue,"function")?(e=i.getValue("background-image")[0],t(e,"string")&&e.match(/url\(/i)?e.replace(/url\(['"]?([^'"]+)['"]?\)/i,"$1"):!1):!1},getBackgroundImageShortName:function(){var e,i,n,s=this.getBackgroundImageUrl(),r=20;return!t(s,"string")||s.length<1?!1:(e=s.split("/"),i=e.pop(),i.length<1&&(i=e.pop()),n=i.length,n>r&&(i="..."+i.substring(n-r+3)),i)}})}),define("hbs!ui/background-image-dialog/templates/image",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n    <img src="',(n=i.image_url)?n=n.call(e,{hash:{}}):(n=e.image_url,n=typeof n===l?n.apply(e):n),s+=c(n)+'" alt="" />\n'}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return o=i["if"].call(t,t.image_url,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+="\n"});return t.registerPartial("ui_background-image-dialog_templates_image",i),i}),define("hbs!ui/background-image-dialog/templates/image-url/input",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<input type="text" value="',(r=i.url)?r=r.call(t,{hash:{}}):(r=t.url,r=typeof r===a?r.apply(t):r),o+=l(r)+'" placeholder="Paste image URL here‚Ä¶" class="input" />\n'});return t.registerPartial("ui_background-image-dialog_templates_image-url_input",i),i}),define("ui/background-image-dialog/views/image-url/input",["jquery","underscore","backbone","core/utils/is","hbs!../../templates/image-url/input","core/typecastError"],function(e,t,i,n,s,r){"use strict";return i.View.extend({template:s,className:"input-wrapper",config:null,events:{"keypress .input":"onKeypressInput","paste .input":"onPasteInput","blur .input":"onBlurInput"},initialize:function(e){return this.config=n(e,"object")&&n(e.config,"object")?e.config:{},this.config.uploads=n(this.config.uploads,"object")?this.config.uploads:{},this.config.uploads.images=n(this.config.uploads.images,"object")?this.config.uploads.images:{},this.config.uploads.images.allowed_file_extensions=n(this.config.uploads.images.allowed_file_extensions,"array")?this.config.uploads.images.allowed_file_extensions:[],this},render:function(){var e=this.model.getBackgroundImageUrl(),i=n(e,"string")&&e.length>0;return this.$el.toggleClass("placeholder",!i),this.$el.html(this.template({url:e})),i&&t.defer(t.bind(function(){this.$(".input").focus()},this)),this.delegateEvents(),this},onKeypressInput:function(t){return t instanceof e.Event?(13===t.which&&this.setUrl(t),!0):!1},onPasteInput:function(e){return t.defer(t.bind(function(){this.setUrl(e)},this)),!0},onBlurInput:function(){return this.model.trigger("image-url:make-editable",!1),!0},setUrl:function(t){var i,n;return t instanceof e.Event?(i=this.$(t.currentTarget),1!==i.length?!1:(n=i.val(),this._isValidImageUrl(n)?(this.model.getBackgroundImageUrl()!==n&&this.model.trigger("image-url:change",n),!0):(this.model.trigger("image-url:error",new r(101,"Not a valid file type, please reference a PNG, JPG, JPEG, or GIF")),!1))):!1},_isValidImageUrl:function(e){var t,i;return!n(e,"string")||e.length<1?!1:(t=e.split("."),t.length<2?!1:(i=t.pop().toLowerCase(),-1===this.config.uploads.images.allowed_file_extensions.indexOf(i)?!1:!0))}})}),define("hbs!ui/background-image-dialog/templates/image-url/label",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="label">',(r=i.label)?r=r.call(t,{hash:{}}):(r=t.label,r=typeof r===a?r.apply(t):r),o+=l(r)+"</div>\n"});return t.registerPartial("ui_background-image-dialog_templates_image-url_label",i),i}),define("ui/background-image-dialog/views/image-url/label",["jquery","backbone","core/utils/is","hbs!../../templates/image-url/label"],function(e,t,i,n){"use strict";return t.View.extend({template:n,className:"label-wrapper",events:{"click .label":"onClickLabel"},render:function(){return this.$el.html(this.template({label:this.model.getBackgroundImageShortName()})),this.delegateEvents(),this},onClickLabel:function(){return this.model.trigger("image-url:make-editable",!0),!0}})}),define("hbs!ui/background-image-dialog/templates/remove",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n    <span class="remove-text">',(n=i.text)?n=n.call(e,{hash:{}}):(n=e.text,n=typeof n===l?n.apply(e):n),s+=c(n)+"</span>\n"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var o,a="",l="function",c=this.escapeExpression,u=this;return a+='<span data-icon="ÓÄù" aria-hidden="true"></span>\n',o=i.unless.call(t,t.is_icon_only,{hash:{},inverse:u.noop,fn:u.program(1,r,s)}),(o||0===o)&&(a+=o),a+="\n"});return t.registerPartial("ui_background-image-dialog_templates_remove",i),i}),define("ui/background-image-dialog/views/remove",["backbone","core/utils/is","hbs!../templates/remove"],function(e,t,i){"use strict";return e.View.extend({template:i,tagName:"section",className:"delete",text:"Remove",info:"Remove",is_icon_only:!1,property_name:null,events:{click:"onClick"},initialize:function(e){return t(e,"object")||(e={}),["text","info","property_name"].forEach(function(i){return!t(e[i],"string")||e[i].length<1?!1:void(this[i]=e[i])},this),["is_icon_only"].forEach(function(i){return t(e[i],"boolean")?void(this[i]=e[i]):!1},this),this},onClick:function(){return this.model.trigger("property:remove",this.property_name),!0},render:function(){return this.$el.attr("data-tooltips-title",this.info),this.$el.html(this.template({text:this.text,is_icon_only:this.is_icon_only})),this.delegateEvents(),this}})}),define("ui/background-image-dialog/views/image-url/index",["jquery","backbone","core/utils/is","./input","./label","../remove"],function(e,t,i,n,s,r){"use strict";return t.View.extend({className:"image-url",property_name:null,config:null,views:null,initialize:function(e){return this.views={},i(e,"object")||(e={}),this.config=i(e.config,"object")?e.config:{},["property_name"].forEach(function(t){return!i(e[t],"string")||e[t].length<1?!1:void(this[t]=e[t])},this),this.views.input=new n({config:this.config,model:this.model}),this.views.label=new s({model:this.model}),this.views.remove=new r({is_icon_only:!0,property_name:this.property_name,model:this.model}),this.model.on("image-url:make-editable",this.makeEditable,this),this},render:function(){var e=this.model.getBackgroundImageUrl(),t=i(e,"string")&&e.length>0,n=this.model.get("style_declaration");return this.$el.empty(),t&&!n.isInherited(this.property_name)&&this.$el.append(this.views.remove.render().$el),this.makeEditable(!1),this.delegateEvents(),this},makeEditable:function(e){var t=this.model.getBackgroundImageUrl(),n=i(t,"string")&&t.length>0;return i(e,"boolean")?(!n||n&&e?(this.views.label.remove(),this.$el.append(this.views.input.render().$el)):(this.views.input.remove(),this.$el.append(this.views.label.render().$el)),!0):!1},remove:function(){return Object.keys(this.views).forEach(function(e){this.views[e].remove()},this),t.View.prototype.remove.apply(this,arguments)}})}),define("hbs!ui/background-image-dialog/templates/file-upload-error",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+='<div class="error">',(r=i.message)?r=r.call(t,{hash:{}}):(r=t.message,r=typeof r===a?r.apply(t):r),o+=l(r)+"</div>\n"});return t.registerPartial("ui_background-image-dialog_templates_file-upload-error",i),i}),define("hbs!ui/background-image-dialog/templates/file-upload-spinner",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){return this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers,'<div class="spinner"></div>\n'});return t.registerPartial("ui_background-image-dialog_templates_file-upload-spinner",i),i}),define("ui/background-image-dialog/views/image",["backbone","core/utils/is","hbs!../templates/image","./image-url/index","core/components/file-upload/views/FileUpload","hbs!../templates/file-upload-error","hbs!../templates/file-upload-spinner"],function(e,t,i,n,s,r,o){"use strict";return e.View.extend({template:i,className:"image",property_name:null,config:null,model:null,views:null,initialize:function(e){return this.views={},t(e,"object")||(e={}),this.config=t(e.config,"object")?e.config:{},["property_name"].forEach(function(i){return!t(e[i],"string")||e[i].length<1?!1:void(this[i]=e[i])},this),this.views.image_url=new n({property_name:this.property_name,config:this.config,model:this.model}),this.views.file_upload=new s({button_text:"Upload",model:this.model}),this.model.on("image-url:change",this.setBackgroundImage,this),this.model.on("image-url:error",this.onFileUploadFailed,this),this.model.on("file-upload:started",this.onFileUploadStarted,this),this.model.on("file-upload:failed",this.onFileUploadFailed,this),this.model.on("file-upload:completed",this.onFileUploadCompleted,this),this},render:function(){var e=this.model.getBackgroundImageUrl(),i=t(e,"string")&&e.length>0,n=t(this.config.user,"object");return this.$el.toggleClass("has-image",i),this.$el.html(this.template({image_url:e})),Object.keys(this.views).forEach(function(e){return n||"file_upload"!==e?void this.$el.append(this.views[e].render().$el):!1},this),this},remove:function(){return Object.keys(this.views).forEach(function(e){this.views[e].remove()},this),e.View.prototype.remove.apply(this,arguments)},setBackgroundImage:function(e){return t(e,"string")&&e.length>0?this.model.trigger("property:set",this.property_name,"url("+e+")"):this.model.trigger("property:remove",this.property_name),!0},onFileUploadStarted:function(){return this.render(),this.$el.append(o()),!0},onFileUploadFailed:function(e){return this.render(),this.$el.append(r(e)),!0},onFileUploadCompleted:function(e){return t(e,"object")?!t(e.url,"string")||e.url.length<1?!1:(this.setBackgroundImage(e.url),!0):!1}})}),define("hbs!ui/background-image-dialog/templates/list",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n    <li class="',(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===h?n.apply(e):n),s+=d(n),n=i["if"].call(e,e.is_active,{hash:{},inverse:p.noop,fn:p.program(2,o,t)}),(n||0===n)&&(s+=n),n=i["if"].call(e,e.is_inherited,{hash:{},inverse:p.noop,fn:p.program(4,a,t)}),(n||0===n)&&(s+=n),s+='" data-value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===h?n.apply(e):n),s+=d(n)+'" data-tooltips-title="',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===h?n.apply(e):n),s+=d(n)+'"></li>\n'}function o(e,t){return" active"}function a(e,t){return" inherited"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var l,c,u="",h="function",d=this.escapeExpression,p=this,f=i.blockHelperMissing;return c={hash:{},inverse:p.noop,fn:p.program(1,r,s)},(l=i.items)?l=l.call(t,c):(l=t.items,l=typeof l===h?l.apply(t):l),i.items||(l=f.call(t,l,c)),(l||0===l)&&(u+=l),u+="\n"});return t.registerPartial("ui_background-image-dialog_templates_list",i),i}),define("ui/background-image-dialog/views/list",["backbone","underscore","core/utils/is","hbs!../templates/list"],function(e,t,i,n){"use strict";return e.View.extend({template:n,tagName:"ul",property_name:null,class_prefix:"",defined_items:null,more_item:null,default_values:null,model:null,events:{"click li":"onClick"},initialize:function(e){return i(e,"object")||(e={}),this.defined_items=[],this.default_values=["auto","auto auto"],["template"].forEach(function(t){return i(e[t],"function")?void(this[t]=e[t]):!1},this),["property_name","class_prefix"].forEach(function(t){return!i(e[t],"string")||e[t].length<1?!1:void(this[t]=e[t])},this),["defined_items","default_values"].forEach(function(t){return i(e[t],"array")?void(this[t]=e[t]):!1},this),["more_item"].forEach(function(t){return i(e[t],"object")?void(this[t]=e[t]):!1},this),this.defined_items.forEach(function(e){return i(e,"object")?void(i(e.alternative_values,"array")||(e.alternative_values=[])):!1},this),i(this.more_item,"object")&&(i(this.more_item.alternative_values,"array")||(this.more_item.alternative_values=[])),this},render:function(){var e=this.model.get("style_declaration");return this.$el.html(this.template({items:this._getItems(e.getValue(this.property_name)[0],e.isInherited(this.property_name))})),this.delegateEvents(),this},onClick:function(e){var t,n,s;return t=this.$(e.currentTarget),n=t.attr("data-value"),s=i(this.more_item,"object")&&this.more_item.value===n,s?this.model.trigger("list:more-item-selected",this.property_name):!t.hasClass("active")||t.hasClass("inherited")?this.model.trigger("property:set",this.property_name,n):this.model.trigger("property:remove",this.property_name),!0},_getItems:function(e,t){var n=[].concat(this.defined_items);return i(this.more_item,"object")&&n.push(this.more_item),n.map(function(i){var n=this._isActiveValue(i,e),s=n&&t;return{value:i.value,title:i.title,class_name:this.class_prefix+i.value,is_active:n,is_inherited:s}},this)},_isActiveValue:function(e,n){return e.value===n?!0:-1!==e.alternative_values.indexOf(n)?!0:i(this.more_item,"object")?this.more_item.value===e.value&&-1===t.pluck(this.defined_items,"value").indexOf(n)&&-1===t.flatten(t.pluck(this.defined_items,"alternative_values")).indexOf(n)&&-1===this.default_values.indexOf(n):!1}})}),define("hbs!ui/background-image-dialog/templates/header",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var r,o="",a="function",l=this.escapeExpression;return o+="<h4>",(r=i.text)?r=r.call(t,{hash:{}}):(r=t.text,r=typeof r===a?r.apply(t):r),o+=l(r)+'</h4>\n<div class="info-tooltip">\n    <span aria-hidden="true" data-icon="ÓÄí"></span>\n    <span class="screen-reader-text">Info</span>\n    <div class="info">\n        <p>',(r=i.info)?r=r.call(t,{hash:{}}):(r=t.info,r=typeof r===a?r.apply(t):r),o+=l(r)+"</p>\n    </div>\n</div>\n"});return t.registerPartial("ui_background-image-dialog_templates_header",i),i}),define("ui/background-image-dialog/views/header",["backbone","core/utils/is","hbs!../templates/header"],function(e,t,i){"use strict";return e.View.extend({template:i,text:"Default header text",info:"Default header info tooltip",initialize:function(e){return t(e,"object")||(e={}),["text","info"].forEach(function(i){return!t(e[i],"string")||e[i].length<1?!1:void(this[i]=e[i])},this),this},render:function(){return this.$el.html(this.template({text:this.text,info:this.info})),this}})}),define("ui/background-image-dialog/views/dropdown",["core/components/dropdown/index","core/utils/is"],function(e,t){var i=e.extend({views_to_render:null,events:{mousedown:"stopPropagation"},initialize:function(e){return t(this.views_to_render,"array")||(this.views_to_render=[]),["views_to_render"].forEach(function(i){return t(e[i],"array")?void(this[i]=e[i]):!1},this),i.__super__.initialize.apply(this,arguments),this.views_to_render.forEach(function(e,t){this.views["view_to_render_"+t]=e},this),this},stopPropagation:function(e){return e.stopPropagation(),!0},render:function(){return this.delegateEvents(),i.__super__.render.call(this,this.views_to_render),this}});return i}),define("hbs!ui/background-image-dialog/templates/list-radio",["hbs","Handlebars"],function(e,t){var i=t.template(function(e,t,i,n,s){function r(e,t){var n,s="";return s+='\n    <li class="',(n=i.class_name)?n=n.call(e,{hash:{}}):(n=e.class_name,n=typeof n===d?n.apply(e):n),s+=p(n),n=i["if"].call(e,e.is_active,{hash:{},inverse:f.noop,fn:f.program(2,o,t)}),(n||0===n)&&(s+=n),n=i["if"].call(e,e.is_inherited,{hash:{},inverse:f.noop,fn:f.program(4,a,t)}),(n||0===n)&&(s+=n),s+='" data-value="',(n=i.value)?n=n.call(e,{hash:{}}):(n=e.value,n=typeof n===d?n.apply(e):n),s+=p(n)+'" data-tooltips-title="',(n=i.title)?n=n.call(e,{hash:{}}):(n=e.title,n=typeof n===d?n.apply(e):n),s+=p(n)+'"><input type="radio"',n=i["if"].call(e,e.is_active,{hash:{},inverse:f.noop,fn:f.program(6,l,t)}),(n||0===n)&&(s+=n),s+="></li>\n"}function o(e,t){return" active"}function a(e,t){return" inherited"}function l(e,t){return" checked"}this.compilerInfo=[2,">= 1.0.0-rc.3"],i=i||e.helpers;var c,u,h="",d="function",p=this.escapeExpression,f=this,g=i.blockHelperMissing;return u={hash:{},inverse:f.noop,fn:f.program(1,r,s)},(c=i.items)?c=c.call(t,u):(c=t.items,c=typeof c===d?c.apply(t):c),i.items||(c=g.call(t,c,u)),(c||0===c)&&(h+=c),h+="\n"});return t.registerPartial("ui_background-image-dialog_templates_list-radio",i),i}),define("ui/background-image-dialog/index",["jquery","underscore","backbone","core/utils/is","core/utils/dom","core/components/extended_dialog/index","./models/data","./views/image","./views/list","./views/header","./views/dropdown","core/components/unitvalue/index","hbs!./templates/list-radio","./views/remove"],function(e,t,i,n,s,r,o,a,l,c,u,h,d,p){"use strict";var f=r.extend({namespace:"ui:background-image-dialog",className:"background-image-dialog dialog",title_text:"Background image",title_info:"Display an image behind the current element.",last_active_element:null,model:null,events:{mousedown:"closeDropdowns"},listeners:t.extend({},r.prototype.listeners,{"[remote]data:project:ready":"_onProjectDataReady"}),initialize:function(){return f.__super__.initialize.apply(this,arguments),this.views.title.setTitle(this.title_text),this.views.title.setInfo(this.title_info),this.model=new o,this.model.set("watched_attributes",["background","background-color","background-image","background-size","background-repeat","background-attachment","background-position"]),this.views.image=new a({property_name:"background-image",config:this.config,model:this.model},this),this.views.header_size_repeat=new c({className:"header size-repeat",text:"Size & Repeat",info:"Control how big or small the background image is and whether it should repeat."}),this.views.header_attachment_position=new c({className:"header attachment-position",text:"Attachment & Position",info:"Choose the starting position of the image and set how it should behave when scrolling."}),this.views.size=new l({className:"size",property_name:"background-size",class_prefix:"bg-size-",defined_items:[{value:"cover",title:"Background-size: cover"},{value:"contain",title:"Background-size: contain"}],more_item:{value:"more",title:"Background-size"},model:this.model}),this.views.repeat=new l({className:"repeat",property_name:"background-repeat",class_prefix:"bg-repeat-",defined_items:[{value:"repeat-x",title:"Background-repeat: repeat-x"},{value:"repeat-y",title:"Background-repeat: repeat-y"},{value:"no-repeat",title:"Background-repeat: no-repeat"}],model:this.model}),this.views.attachment=new l({className:"attachment",property_name:"background-attachment",class_prefix:"bg-attachment-",defined_items:[{value:"local",title:"Background-attachment: local"},{value:"fixed",title:"Background-attachment: fixed"}],model:this.model}),this.views.position=new l({className:"position",property_name:"background-position",class_prefix:"bg-position-",more_item:{value:"more",title:"Background-position"},default_values:["top left","left top","0% 0%","0 0"],model:this.model}),this.views.size_unitvalue=new h({css_property:"background-size",disable_views:["stepper"],units:["%","px"],range:{min:0,max:200},"default":{value:"",unit:"%"}}),this.views.size_remove=new p({property_name:"background-size",model:this.model}),this.views.size_dropdown=new u({className:"dropdown-bg-size",views_to_render:[this.views.size_unitvalue,this.views.size_remove],imc:this.imc,config:this.config,parent_el:this.$el,target_el:this.views.size.$el}),this.views.position_values=new l({template:d,className:"position-values",property_name:"background-position",defined_items:[{value:"top left",alternative_values:["left top","0% 0%","0 0"],title:"top left"},{value:"top center",alternative_values:["center top","top","50% 0%","50 0"],title:"top center"},{value:"top right",alternative_values:["right top","100% 0%","100 0"],title:"top right"},{value:"left center",alternative_values:["center left","left","0% 50%","0 50"],title:"center left"},{value:"center center",alternative_values:["center","50% 50%","50 50"],title:"center center"},{value:"right center",alternative_values:["center right","right","100% 50%","100 50"],title:"center right"},{value:"bottom left",alternative_values:["left bottom","0% 100%","0 100"],title:"bottom left"},{value:"bottom center",alternative_values:["center bottom","bottom","50% 100%","50 100"],title:"bottom center"},{value:"bottom right",alternative_values:["right bottom","100% 100%","100 100"],title:"bottom right"}],model:this.model}),this.views.position_remove=new p({property_name:"background-position",model:this.model}),this.views.position_dropdown=new u({className:"dropdown-bg-position",views_to_render:[this.views.position_values,this.views.position_remove],imc:this.imc,config:this.config,parent_el:this.$el,target_el:this.views.position.$el}),this.model.on("property:set",this.setPropertyValue,this),this.model.on("property:remove",this.removePropertyValue,this),this.model.on("list:more-item-selected",this.showDropdownByPropertyName,this),this.views.size_unitvalue.on("change",this.setPropertyValue,this),this},render:function(){var e,t,i=[];return this._isValidStyleMediaQueryAndElement()?(this.last_active_element=this.active_element,e=this.active_element.getElement().id,t=this.active_element.getSelector(),i.push(this.views.image),i.push(this.views.header_size_repeat),i.push(this.views.size),i.push(this.views.repeat),i.push(this.views.header_attachment_position),i.push(this.views.attachment),i.push(this.views.position),this._getStyleDeclaration(function(){return f.__super__.render.call(this,i),this.delegateEvents(),this.imc.on("data:styles:changed:"+t,this.reRenderViews,this),!0},this),this):!1},remove:function(){return n(this.last_active_element,"element")&&this.imc.off("data:styles:changed:"+this.last_active_element.getSelector(),null,this),f.__super__.remove.apply(this,arguments)},reRenderViews:function(e,s,r,o,a){var l=this.model.get("watched_attributes");return!n(a,"array")||a.length<1?!1:t.intersection(l,a).length<1?!1:-1!==a.indexOf("background")?(this.render(),!0):(this._getStyleDeclaration(function(){a.forEach(function(e){return l.some(function(t){
if(t!==e)return!1;var n=this.views[t.replace("background-","")];n instanceof i.View&&n.render(),"background-position"===t&&this.views.position_values.render()},this),!0},this)},this),!0)},onChangeActiveElement:function(e,t){return n(t,"element")&&this.imc.off("data:elements:updated:element:"+t.getElement().id,null,this),n(e,"element")&&this.imc.on("data:elements:updated:element:"+e.getElement().id,this.onUpdateActiveElement,this),this.closeDialog(),this.views.title.isPinned()&&this.render(),!0},onUpdateActiveElement:function(e){return this.active_element=e,this.isRendered()?(this.render(),!0):!1},setPropertyValue:function(e,t){var i={};return!n(e,"string")||e.length<1?!1:!n(t,"string")||t.length<1?!1:this._isValidStyleMediaQueryAndElement()?(this.replaceGeneralPropertyWithIndividual(),i[e]=[t],this.imc.trigger("data:styles:setAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_element.getSelector(),i),!0):!1},removePropertyValue:function(e){return!n(e,"string")||e.length<1?!1:this._isValidStyleMediaQueryAndElement()?(this.replaceGeneralPropertyWithIndividual(),this.imc.trigger("data:styles:removeAttributesForStyleDeclaration",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_element.getSelector(),[e]),this.closeDropdowns(),!0):!1},replaceGeneralPropertyWithIndividual:function(){var e=this.model.get("style_declaration");return e.isInherited("background")?!1:(e.inherited.push("background"),["color","image","repeat","attachment","position"].forEach(function(t){var i="background-"+t;this.setPropertyValue(i,e.getValue(i)[0])},this),this.removePropertyValue("background"),!0)},showDropdownByPropertyName:function(e){return"background-size"===e&&this.views.size_dropdown.toggle(),"background-position"===e&&this.views.position_dropdown.toggle(),!0},closeDropdowns:function(){return this.views.size_dropdown.close(),this.views.position_dropdown.close(),!0},destroy:function(){return this.model.off(null),this.views.size_unitvalue.off(null,null,this),f.__super__.destroy.apply(this,arguments)},_isValidStyleMediaQueryAndElement:function(){return n(this.active_style_id,"number")&&n(this.active_media_query,"media_query")&&n(this.active_element,"element")?!0:!1},_getStyleDeclaration:function(e,i){return this.imc.trigger("data:styles:getStyleDeclarationBySelector",this.active_style_id,this.active_media_query.getMediaQuery().id,this.active_element.getSelector(),{element_id:this.active_element.getElement().id,attributes:this.model.get("watched_attributes")},function(n,s){return n?(this.log("error","Failed to get style declaration."),!1):(s.isInherited("background")||(s.inherited=t.difference(s.inherited,t.map(["image","repeat","attachment","position"],function(e){return"background-"+e}))),this.model.set({style_declaration:s}),this.views.size_unitvalue.setValueByStyleDeclaration(s),this.views.size_unitvalue.setElementIdAndMediaQueryId(this.active_element.getElement().id,this.active_media_query.getMediaQuery().id),void e.call(i))},this),!0},_onProjectDataReady:function(){return this.imc.trigger("data:project:get","id",function(e,t){return e?(this.log("error","Unable to get project ID",e),!1):(t=parseInt(t,10),void(this.model.project_id=t))},this),!0}});return f}),define("modules/loader",["core/debug","service/connection/index","service/log/index","service/metrics/index","service/collaboration/index","data/project/index","data/clientState/index","data/elements/index","data/styles/index","data/fonts/index","data/walkthroughs/index","data/baseline-grid/index","ui/styles/index","ui/elements/index","ui/main-dialog/index","ui/keyboard-shortcuts/index","ui/font-loader/index","ui/publish-project/index","ui/help-menu/index","ui/open-save-export/index","ui/margin-padding-previewer/index","ui/element-dialog/index","ui/colour-dialog/index","ui/tooltips/index","ui/error-handler/index","ui/layout-properties-dialog/index","ui/baseline-grid/index","ui/font-dialog/index","ui/previous-versions/index","ui/element-resizer/index","ui/css-editor/index","ui/element-overlay/index","ui/inline-dropdown/index","ui/insert-dropdown/index","ui/body-active-element/index","ui/style-guide/index","ui/controls-contrast/index","ui/export/index","ui/project/index","ui/parent-outline/index","ui/walkthroughs/index","ui/drag-and-drop/index","ui/media-queries/index","ui/scroll/index","ui/drop-zone/index","ui/css-animate/index","ui/background-image-dialog/index"],function(e,t,i,n,s,r,o,a,l,c,u,h,d,p,f,g,m,v,y,_,b,w,C,x,E,S,A,k,F,D,T,$,B,j,M,L,I,P,R,O,N,q,z,H,V,W,U){return{service:{debug:e,connection:t,"log-service":i,metrics:n,collaboration:s},data:{project:r,state:o,elements:a,styles:l,fonts:c,grid:h,walkthroughs:u},ui:{styles:d,elements:p,"main-dialog":f,"keyboard-shortcuts":g,"font-loader":m,"publish-project":v,"help-menu":y,"open-save-export":_,"baseline-grid":A,"margin-padding-previewer":b,"element-dialog":w,"colour-dialog":C,tooltips:x,"error-handler":E,"layout-properties-dialog":S,"font-dialog":k,"css-editor":T,"previous-versions":F,"element-dropdown":$,"element-resizer":D,"inline-dropdown":B,"insert-dialog":j,"body-active-element":M,"style-guide":L,"controls-contrast":I,"export-module":P,project:R,"parent-outline":O,walkthroughs:N,"drag-and-drop":q,"media-queries":z,scroll:H,"drop-zone":V,"css-animate":W,"background-image-dialog":U}}}),define("main",["app","modules/loader","core/imc"],function(e,t,i){var n={module_definitions:t,config:"undefined"!=typeof Config?Config:{},imc:i};window.app=new e(n)}),require(["main"])}();